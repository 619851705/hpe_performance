0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> set tez.runtime.io.sort.mb=700;
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> -- set hive.execution.engine=mr;
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> 
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> select
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> nation,
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> o_year,
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> sum(amount) as sum_profit
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> from
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> (
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> select
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> n_name as nation,
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> year(o_orderdate) as o_year,
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> l_extendedprice * (1 - l_discount) - ps_supplycost * l_quantity as amount
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> from
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> part,
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> supplier,
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> lineitem,
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> partsupp,
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> orders,
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> nation
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> where
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> s_suppkey = l_suppkey
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> and ps_suppkey = l_suppkey
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> and ps_partkey = l_partkey
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> and p_partkey = l_partkey
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> and o_orderkey = l_orderkey
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> and s_nationkey = n_nationkey
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> and p_name like '%plum%'
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> ) as profit
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> group by
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> nation,
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> o_year
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> order by
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> nation,
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> o_year desc;
10'
'BRAZIL','1998','6.7993194163466E9'
'BRAZIL','1997','1.1610058686998896E10'
'BRAZIL','1996','1.1672878387083994E10'
'BRAZIL','1995','1.16215334312418E10'
'BRAZIL','1994','1.1644864276842602E10'
'BRAZIL','1993','1.1629788328398304E10'
'BRAZIL','1992','1.1649305422839304E10'
'CANADA','1998','6.8493974536472E9'
'CANADA','1997','1.1725665858338194E10'
'CANADA','1996','1.1735378192352911E10'
'CANADA','1995','1.16605015037234E10'
'CANADA','1994','1.1701536515953012E10'
'CANADA','1993','1.1676519480384008E10'
'CANADA','1992','1.1730292168276804E10'
'CHINA','1998','6.829050200144401E9'
'CHINA','1997','1.1663414167513693E10'
'CHINA','1996','1.1691655087149902E10'
'CHINA','1995','1.1633624908553705E10'
'CHINA','1994','1.1651072261920296E10'
'CHINA','1993','1.1631511394420403E10'
'CHINA','1992','1.1677904124558592E10'
'EGYPT','1998','6.8668871261478E9'
'EGYPT','1997','1.16815127586847E10'
'EGYPT','1996','1.1741414658368994E10'
'EGYPT','1995','1.167625374071959E10'
'EGYPT','1994','1.1702510512454903E10'
'EGYPT','1993','1.1660956408358398E10'
'EGYPT','1992','1.1771391766224306E10'
'ETHIOPIA','1998','6.855825108332098E9'
'ETHIOPIA','1997','1.1661010519965607E10'
'ETHIOPIA','1996','1.1672467040603899E10'
'ETHIOPIA','1995','1.1698815213533995E10'
'ETHIOPIA','1994','1.1691243495181593E10'
'ETHIOPIA','1993','1.1704442515068287E10'
'ETHIOPIA','1992','1.1690038890494896E10'
'FRANCE','1998','6.902412445134799E9'
'FRANCE','1997','1.1708763582212097E10'
'FRANCE','1996','1.17811672013894E10'
'FRANCE','1995','1.1766890911682095E10'
'FRANCE','1994','1.1728659027325802E10'
'FRANCE','1993','1.1707894149901001E10'
'FRANCE','1992','1.1710141341893301E10'
'GERMANY','1998','6.879458190874102E9'
'GERMANY','1997','1.1675741446068405E10'
'GERMANY','1996','1.1705847997362507E10'
'GERMANY','1995','1.1671334037966904E10'
'GERMANY','1994','1.1689484229777302E10'
'GERMANY','1993','1.16931516922791E10'
'GERMANY','1992','1.167487325679839E10'
'INDIA','1998','6.881988178129099E9'
'INDIA','1997','1.1771146933357904E10'
'INDIA','1996','1.1766520531290592E10'
'INDIA','1995','1.1749848106051497E10'
'INDIA','1994','1.1727275192952007E10'
'INDIA','1993','1.1736733005294405E10'
'INDIA','1992','1.1744706442550604E10'
'INDONESIA','1998','6.8269383198366E9'
'INDONESIA','1997','1.1571983581226696E10'
'INDONESIA','1996','1.1632180506908592E10'
'INDONESIA','1995','1.160408439145361E10'
'INDONESIA','1994','1.1605874596097597E10'
'INDONESIA','1993','1.1599058550380194E10'
'INDONESIA','1992','1.1607019432694002E10'
'IRAN','1998','6.833037837120998E9'
'IRAN','1997','1.1684344042634298E10'
'IRAN','1996','1.1718537154860397E10'
'IRAN','1995','1.1651536441130297E10'
'IRAN','1994','1.16580487066845E10'
'IRAN','1993','1.1656633738139204E10'
'IRAN','1992','1.16901797865626E10'
'IRAQ','1998','6.827299891781001E9'
'IRAQ','1997','1.1644401935639502E10'
'IRAQ','1996','1.1644941918710194E10'
'IRAQ','1995','1.1714265572486006E10'
'IRAQ','1994','1.1709584116013899E10'
'IRAQ','1993','1.168451147873219E10'
'IRAQ','1992','1.1685373361637804E10'
'JAPAN','1998','6.771872800686497E9'
'JAPAN','1997','1.1544629793881302E10'
'JAPAN','1996','1.1566101393463198E10'
'JAPAN','1995','1.1591154679157902E10'
'JAPAN','1994','1.1630513233692701E10'
'JAPAN','1993','1.1542332751156693E10'
'JAPAN','1992','1.1617449442886297E10'
'JORDAN','1998','6.7978879385783E9'
'JORDAN','1997','1.1580620447670105E10'
'JORDAN','1996','1.1630425455745098E10'
'JORDAN','1995','1.1576226597395002E10'
'JORDAN','1994','1.1594999082926586E10'
'JORDAN','1993','1.1613610317216297E10'
'JORDAN','1992','1.1658193990483896E10'
'KENYA','1998','6.810311859450908E9'
'KENYA','1997','1.1666393427464705E10'
'KENYA','1996','1.1599609912443998E10'
'KENYA','1995','1.1621046670253502E10'
'KENYA','1994','1.1548469695873499E10'
'KENYA','1993','1.1618120119682796E10'
'KENYA','1992','1.1648866362529995E10'
'MOROCCO','1998','6.849899453245603E9'
'MOROCCO','1997','1.1693246853131395E10'
'MOROCCO','1996','1.1704970239815596E10'
'MOROCCO','1995','1.1665530815591995E10'
'MOROCCO','1994','1.1686124285620502E10'
'MOROCCO','1993','1.1667851899342197E10'
'MOROCCO','1992','1.1742218121697407E10'
'MOZAMBIQUE','1998','6.813216815273401E9'
'MOZAMBIQUE','1997','1.1654785360267197E10'
'MOZAMBIQUE','1996','1.16858834064882E10'
'MOZAMBIQUE','1995','1.1645958954741495E10'
'MOZAMBIQUE','1994','1.1641274236622799E10'
'MOZAMBIQUE','1993','1.1665911370247503E10'
'MOZAMBIQUE','1992','1.1667999242662498E10'
'PERU','1998','6.843626506106998E9'
'PERU','1997','1.1618629888843298E10'
'PERU','1996','1.1721000173458303E10'
'PERU','1995','1.1656819795528904E10'
'PERU','1994','1.16570124756813E10'
'PERU','1993','1.1666510860735594E10'
'PERU','1992','1.1712925610526495E10'
'ROMANIA','1998','6.826068143216803E9'
'ROMANIA','1997','1.1652856635790203E10'
'ROMANIA','1996','1.1653410467114395E10'
'ROMANIA','1995','1.1655750953855392E10'
'ROMANIA','1994','1.1681443980538006E10'
'ROMANIA','1993','1.16381248264909E10'
'ROMANIA','1992','1.1703836694650103E10'
'RUSSIA','1998','6.805590441212798E9'
'RUSSIA','1997','1.1661379992564398E10'
'RUSSIA','1996','1.1680250725980797E10'
'RUSSIA','1995','1.1678825010522606E10'
'RUSSIA','1994','1.1621783196945599E10'
'RUSSIA','1993','1.1637647032685194E10'
'RUSSIA','1992','1.1639926599865705E10'
'SAUDI ARABIA','1998','6.883912372556999E9'
'SAUDI ARABIA','1997','1.17249459767087E10'
'SAUDI ARABIA','1996','1.1765190075647797E10'
'SAUDI ARABIA','1995','1.1731380570196598E10'
'SAUDI ARABIA','1994','1.1731241453784204E10'
'SAUDI ARABIA','1993','1.1723160737135302E10'
'SAUDI ARABIA','1992','1.1753833415615803E10'
'UNITED KINGDOM','1998','6.863321407594799E9'
'UNITED KINGDOM','1997','1.1746222879857204E10'
'UNITED KINGDOM','1996','1.17913572419224E10'
'UNITED KINGDOM','1995','1.1716050614946804E10'
'UNITED KINGDOM','1994','1.1719790290296103E10'
'UNITED KINGDOM','1993','1.1741467904289593E10'
'UNITED KINGDOM','1992','1.1794217897430202E10'
'UNITED STATES','1998','6.831465775417896E9'
'UNITED STATES','1997','1.1626954254947105E10'
'UNITED STATES','1996','1.1708001963346605E10'
'UNITED STATES','1995','1.1633110502228403E10'
'UNITED STATES','1994','1.1672357265601408E10'
'UNITED STATES','1993','1.165289062051859E10'
'UNITED STATES','1992','1.1675723953337196E10'
'VIETNAM','1998','6.859673632519399E9'
'VIETNAM','1997','1.17119634407689E10'
'VIETNAM','1996','1.1705253540962801E10'
'VIETNAM','1995','1.1694708230077404E10'
'VIETNAM','1994','1.1710686042690796E10'
'VIETNAM','1993','1.17140847231294E10'
'VIETNAM','1992','1.1769254108829206E10'
0: jdbc:hive2://h01hn02:10500/tpch_flat_orc_2> 
