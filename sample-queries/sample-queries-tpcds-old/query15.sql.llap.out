0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set ambari.hive.db.schema.name=hive;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.file.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.hdfs.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.sortmerge.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.sortmerge.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.abortedtxn.threshold=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.check.interval=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.num.threshold=10;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.pct.threshold=0.1f;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.initiator.on=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.threads=0;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.timeout=86400;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compute.query.using.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.bucketing=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sorting=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sortmergebucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.limit.pushdown.memory.usage=0.04;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.map.aggr=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapjoin.bucket.cache.size=10000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapred.reduce.tasks.speculative.execution=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.cache.pinobjtypes=Table,Database,Type,FieldSchema,Order;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.client.socket.timeout=60;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.execute.setugi=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.warehouse.dir=/apps/hive/warehouse;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin.sortedmerge=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.index.filter=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.optimize.mapjoin.mapreduce=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication.min.reducer=4;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.orc.splits.include.file.footer=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.authorization.enabled=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.metastore.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.semantic.analyzer.factory.impl=org.apache.hivealog.cli.HCatSemanticAnalyzerFactory;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.enable.doAs=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.default.queues=default;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.initialize.default.sessions=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.sessions.per.default.queue=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.autogather=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.max.open.batch=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.timeout=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.execution.enabled=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.checkinterval=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.flush.percent=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.maxentries=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- These values need to be tuned appropriately to your cluster. These examples are for reference.
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.container.size=6144;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.java.opts=-Xmx5120m;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=100000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=320000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask.size=629145600;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=720000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=1920000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.execution.engine=tez;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.default.fileformat=orc;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.cbo.enable=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.fetch.column.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.dynamic.partition.mode=nonstrict;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.auto.reducer.parallelism=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.exec.reducers.bytes.per.reducer=1000000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.reducers.bytes.per.reducer=67108864;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.support.concurrency=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.exec.print.summary=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.min-size=16777216;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.min-size=8388608;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.max-size=1073741824;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.max-size=1342177280;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.split-waves=1.7;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.runtime.io.sort.mb=174;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> select  ca_zip
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>        ,sum(cs_sales_price)
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from catalog_sales
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      ,customer
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      ,customer_address
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      ,date_dim
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where catalog_sales.cs_bill_customer_sk = customer.c_customer_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and customer.c_current_addr_sk = customer_address.ca_address_sk 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>                                    '85392', '85460', '80348', '81792')
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>        or customer_address.ca_state in ('CA','WA','GA')
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>        or catalog_sales.cs_sales_price > 500)
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and catalog_sales.cs_sold_date_sk = date_dim.d_date_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and date_dim.d_qoy = 2 and date_dim.d_year = 2000
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  group by ca_zip
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  order by ca_zip
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  limit 100;
+---------+---------------------+--+
| ca_zip  |         c1          |
+---------+---------------------+--+
|         | 2509939.760040868   |
| 30001   | 50044.65996345878   |
| 30008   | 32933.80997545272   |
| 30026   | 47029.439992539585  |
| 30029   | 4337.629999607801   |
| 30049   | 1723.9900168180466  |
| 30056   | 800.2399913221598   |
| 30059   | 805263.3499986194   |
| 30068   | 2253.379998445511   |
| 30069   | 918392.010392122    |
| 30116   | 38526.33003127575   |
| 30125   | 58230.80982850492   |
| 30128   | 2227.989996910095   |
| 30141   | 42245.54001115635   |
| 30150   | 877560.0202319399   |
| 30156   | 1376.0599824786186  |
| 30162   | 937205.0897964071   |
| 30163   | 407.770001411438    |
| 30164   | 46651.65996693075   |
| 30169   | 916814.8401224706   |
| 30191   | 846255.8900548331   |
| 30193   | 1232.3200081586838  |
| 30194   | 34563.58002516627   |
| 30204   | 2011.869989156723   |
| 30216   | 52876.59002859518   |
| 30224   | 1538.7300122380257  |
| 30236   | 1846.5000044107437  |
| 30238   | 1005.8399925231934  |
| 30244   | 5215.730014324188   |
| 30245   | 799.2699971199036   |
| 30254   | 1382.190017938614   |
| 30262   | 43830.140072304755  |
| 30268   | 30827.830029208213  |
| 30278   | 3856.8899684622884  |
| 30296   | 51269.94009909034   |
| 30297   | 1152.0899941921234  |
| 30302   | 48355.70000100136   |
| 30307   | 1035.09998857975    |
| 30309   | 32896.7299965322    |
| 30311   | 837.4299972057343   |
| 30314   | 297.199990272522    |
| 30317   | 1272.3099964857101  |
| 30319   | 38105.33000950143   |
| 30320   | 689.3899974822998   |
| 30325   | 2569.129988953471   |
| 30330   | 1271.4399995803833  |
| 30336   | 2601.3600142002106  |
| 30344   | 30000.390091381967  |
| 30348   | 3141.1099893450737  |
| 30369   | 50235.96000687778   |
| 30381   | 1985.24000954628    |
| 30382   | 1364.7600006759167  |
| 30386   | 1344.639999628067   |
| 30399   | 948069.98021755     |
| 30407   | 1615.4299973249435  |
| 30408   | 37331.25000590831   |
| 30411   | 939313.6006283965   |
| 30414   | 1726.2199883460999  |
| 30418   | 31210.419994473457  |
| 30419   | 42699.39992315322   |
| 30428   | 2018.019998908043   |
| 30444   | 982.720000743866    |
| 30445   | 1362.7199993133545  |
| 30451   | 52193.49000912905   |
| 30468   | 1828.7900052070618  |
| 30481   | 3515.770029693842   |
| 30485   | 3534.6800263524055  |
| 30492   | 47537.78995335102   |
| 30499   | 876089.0501401052   |
| 30514   | 4176.720001935959   |
| 30519   | 36444.509929835796  |
| 30522   | 2072.2499881982803  |
| 30525   | 42662.09997463226   |
| 30526   | 755.2699980735779   |
| 30534   | 868229.5796416681   |
| 30540   | 42929.03996427357   |
| 30573   | 41438.750002531335  |
| 30580   | 1875.700001835823   |
| 30584   | 2129.409991621971   |
| 30586   | 1467.640009701252   |
| 30587   | 870172.7699327841   |
| 30589   | 43581.269964680076  |
| 30613   | 3564.3800043165684  |
| 30618   | 46647.520009240136  |
| 30631   | 42905.22994539142   |
| 30634   | 45643.66002838127   |
| 30635   | 43780.84998735599   |
| 30636   | 1554.739970445633   |
| 30647   | 1766.2200047969818  |
| 30662   | 2822.78997695446    |
| 30679   | 396.2700023651123   |
| 30681   | 2592.7899854183197  |
| 30689   | 4754.249989032745   |
| 30702   | 2932.8800048828125  |
| 30725   | 49917.679954752326  |
| 30728   | 545.5099992752075   |
| 30732   | 36640.779951676726  |
| 30744   | 45279.279958859086  |
| 30757   | 3379.2500021755695  |
| 30765   | 1059.9900040626526  |
+---------+---------------------+--+
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
