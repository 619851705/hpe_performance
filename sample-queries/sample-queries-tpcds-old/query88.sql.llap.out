0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set ambari.hive.db.schema.name=hive;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.file.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.hdfs.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.sortmerge.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.sortmerge.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.abortedtxn.threshold=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.check.interval=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.num.threshold=10;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.pct.threshold=0.1f;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.initiator.on=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.threads=0;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.timeout=86400;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compute.query.using.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.bucketing=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sorting=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sortmergebucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.limit.pushdown.memory.usage=0.04;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.map.aggr=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapjoin.bucket.cache.size=10000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapred.reduce.tasks.speculative.execution=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.cache.pinobjtypes=Table,Database,Type,FieldSchema,Order;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.client.socket.timeout=60;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.execute.setugi=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.warehouse.dir=/apps/hive/warehouse;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin.sortedmerge=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.index.filter=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.optimize.mapjoin.mapreduce=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication.min.reducer=4;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.orc.splits.include.file.footer=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.authorization.enabled=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.metastore.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.semantic.analyzer.factory.impl=org.apache.hivealog.cli.HCatSemanticAnalyzerFactory;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.enable.doAs=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.default.queues=default;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.initialize.default.sessions=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.sessions.per.default.queue=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.autogather=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.max.open.batch=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.timeout=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.execution.enabled=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.checkinterval=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.flush.percent=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.maxentries=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- These values need to be tuned appropriately to your cluster. These examples are for reference.
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.container.size=6144;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.java.opts=-Xmx5120m;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=100000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=320000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask.size=629145600;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=720000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=1920000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.execution.engine=tez;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.default.fileformat=orc;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.cbo.enable=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.fetch.column.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.dynamic.partition.mode=nonstrict;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.auto.reducer.parallelism=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.exec.reducers.bytes.per.reducer=1000000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.reducers.bytes.per.reducer=67108864;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.support.concurrency=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.exec.print.summary=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.min-size=16777216;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.min-size=8388608;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.max-size=1073741824;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.max-size=1342177280;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.split-waves=1.7;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.runtime.io.sort.mb=174;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> select  *
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> from
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  (select count(*) h8_30_to_9
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk   
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_hour = 8
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store.s_store_name = 'ese') s1,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  (select count(*) h9_to_9_30 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_store_sk = store.s_store_sk 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_hour = 9 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store.s_store_name = 'ese') s2,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  (select count(*) h9_30_to_10 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_hour = 9
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store.s_store_name = 'ese') s3,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  (select count(*) h10_to_10_30
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_hour = 10 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store.s_store_name = 'ese') s4,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  (select count(*) h10_30_to_11
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_hour = 10 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store.s_store_name = 'ese') s5,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  (select count(*) h11_to_11_30
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_store_sk = store.s_store_sk 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_hour = 11
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store.s_store_name = 'ese') s6,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  (select count(*) h11_30_to_12
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_hour = 11
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store.s_store_name = 'ese') s7,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  (select count(*) h12_to_12_30
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_hour = 12
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      and store.s_store_name = 'ese') s8
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> ;
+----------------+----------------+-----------------+------------------+------------------+------------------+------------------+------------------+--+
| s1.h8_30_to_9  | s2.h9_to_9_30  | s3.h9_30_to_10  | s4.h10_to_10_30  | s5.h10_30_to_11  | s6.h11_to_11_30  | s7.h11_30_to_12  | s8.h12_to_12_30  |
+----------------+----------------+-----------------+------------------+------------------+------------------+------------------+------------------+--+
| 1775406        | 3534516        | 3538775         | 5323926          | 5330419          | 3107148          | 3106279          | 3546915          |
+----------------+----------------+-----------------+------------------+------------------+------------------+------------------+------------------+--+
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
