0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set ambari.hive.db.schema.name=hive;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.file.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.hdfs.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.sortmerge.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.sortmerge.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.abortedtxn.threshold=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.check.interval=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.num.threshold=10;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.pct.threshold=0.1f;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.initiator.on=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.threads=0;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.timeout=86400;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compute.query.using.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.bucketing=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sorting=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sortmergebucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.limit.pushdown.memory.usage=0.04;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.map.aggr=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapjoin.bucket.cache.size=10000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapred.reduce.tasks.speculative.execution=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.cache.pinobjtypes=Table,Database,Type,FieldSchema,Order;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.client.socket.timeout=60;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.execute.setugi=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.warehouse.dir=/apps/hive/warehouse;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin.sortedmerge=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.index.filter=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.optimize.mapjoin.mapreduce=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication.min.reducer=4;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.orc.splits.include.file.footer=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.authorization.enabled=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.metastore.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.semantic.analyzer.factory.impl=org.apache.hivealog.cli.HCatSemanticAnalyzerFactory;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.enable.doAs=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.default.queues=default;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.initialize.default.sessions=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.sessions.per.default.queue=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.autogather=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.max.open.batch=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.timeout=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.execution.enabled=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.checkinterval=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.flush.percent=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.maxentries=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- These values need to be tuned appropriately to your cluster. These examples are for reference.
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.container.size=6144;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.java.opts=-Xmx5120m;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=100000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=320000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask.size=629145600;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=720000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=1920000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.execution.engine=tez;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.default.fileformat=orc;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.cbo.enable=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.fetch.column.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.dynamic.partition.mode=nonstrict;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.auto.reducer.parallelism=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.exec.reducers.bytes.per.reducer=1000000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.reducers.bytes.per.reducer=67108864;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.support.concurrency=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.exec.print.summary=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.min-size=16777216;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.min-size=8388608;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.max-size=1073741824;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.max-size=1342177280;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.split-waves=1.7;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.runtime.io.sort.mb=174;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> select 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>   c_last_name,c_first_name,substr(s_city,1,30) sub,ss_ticket_number,amt,profit
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>   from
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>    (select ss_ticket_number
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           ,ss_customer_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           ,store.s_city
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           ,sum(ss_coupon_amt) amt
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           ,sum(ss_net_profit) profit
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>     from store_sales,date_dim,store,household_demographics
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>     where store_sales.ss_sold_date_sk = date_dim.d_date_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>     and store_sales.ss_store_sk = store.s_store_sk  
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>     and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>     and (household_demographics.hd_dep_count = 8 or household_demographics.hd_vehicle_count > 0)
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>     and date_dim.d_dow = 1
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>     and date_dim.d_year in (1998,1998+1,1998+2) 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>     and store.s_number_employees between 200 and 295
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>     group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>     where ms.ss_customer_sk = customer.c_customer_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  order by c_last_name,c_first_name,sub, profit
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> limit 100;
+--------------+---------------+------+-------------------+---------------------+----------------------+--+
| c_last_name  | c_first_name  | sub  | ss_ticket_number  |         amt         |        profit        |
+--------------+---------------+------+-------------------+---------------------+----------------------+--+
|              |               |      | 145092998         | 0.0                 | NULL                 |
|              |               |      | 9689686           | NULL                | NULL                 |
|              |               |      | 148381816         | 0.0                 | NULL                 |
|              |               |      | 7637261           | NULL                | NULL                 |
|              |               |      | 173755191         | 0.0                 | NULL                 |
|              |               |      | 183681352         | NULL                | NULL                 |
|              |               |      | 40412743          | 0.0                 | NULL                 |
|              |               |      | 189416153         | 2279.999969482422   | -29194.93975830078   |
|              |               |      | 39663291          | 7068.019950866699   | -28591.019738912582  |
|              |               |      | 136605989         | 4731.180061340332   | -28508.0304107666    |
|              |               |      | 101642023         | 8940.589721679688   | -27629.909759521484  |
|              |               |      | 25385243          | 1929.0699462890625  | -27588.450304985046  |
|              |               |      | 90214902          | 542.4400115013123   | -25803.060314178467  |
|              |               |      | 114394124         | 2608.139987230301   | -25578.20987549424   |
|              |               |      | 124084757         | 9115.350006103516   | -24277.109741210938  |
|              |               |      | 177640516         | 6534.619983673096   | -23445.449962615967  |
|              |               |      | 186062232         | 8494.629806518555   | -23432.760261535645  |
|              |               |      | 167117853         | 4418.600141525269   | -22753.570236206055  |
|              |               |      | 47749852          | 5978.820079803467   | -22636.38994216919   |
|              |               |      | 211800801         | 32.06999969482422   | -22519.979858398438  |
|              |               |      | 231571867         | 5122.270088195801   | -22508.24005126953   |
|              |               |      | 33856808          | 10524.510246276855  | -21423.049896240234  |
|              |               |      | 205293111         | 6269.980010986328   | -21322.389907836914  |
|              |               |      | 53721879          | 72.2300033569336    | -21224.000244140625  |
|              |               |      | 166878408         | 759.1800231933594   | -21074.390043973923  |
|              |               |      | 234538097         | 8463.479934692383   | -20419.21009159088   |
|              |               |      | 154382989         | 1165.2699508666992  | -20109.829917907715  |
|              |               |      | 213071684         | 5108.699981689453   | -20000.60004234314   |
|              |               |      | 48542770          | 0.0                 | -19937.71022415161   |
|              |               |      | 75661575          | 6601.320068359375   | -19675.989990234375  |
|              |               |      | 76427194          | 3828.340003967285   | -19566.760223388672  |
|              |               |      | 54646785          | 6538.369842529297   | -18754.629875183105  |
|              |               |      | 161837226         | 0.0                 | -18570.310028076172  |
|              |               |      | 31846193          | 677.8399963378906   | -18470.47023010254   |
|              |               |      | 169192187         | 1141.989990234375   | -18422.209838867188  |
|              |               |      | 108437170         | 1992.9499988555908  | -18236.749994039536  |
|              |               |      | 92806024          | 471.00999450683594  | -17993.34003663063   |
|              |               |      | 196554869         | 6247.52978515625    | -17981.129904270172  |
|              |               |      | 103146595         | 4653.2799072265625  | -17932.170238494873  |
|              |               |      | 22557746          | 4864.210144042969   | -17888.829864501953  |
|              |               |      | 120997920         | 544.719970703125    | -17777.159812927246  |
|              |               |      | 77166223          | 3922.580047607422   | -17762.990089416504  |
|              |               |      | 58686374          | 8172.300197839737   | -17741.399978637695  |
|              |               |      | 102746573         | 5411.009825229645   | -17725.79983997345   |
|              |               |      | 90239123          | 6593.340110778809   | -17708.519722938538  |
|              |               |      | 143547361         | 4811.930076599121   | -17549.630226135254  |
|              |               |      | 119837910         | 1244.459976196289   | -17473.75999069214   |
|              |               |      | 91610252          | 0.0                 | -17289.649612426758  |
|              |               |      | 19432870          | 3762.530019760132   | -17216.709712982178  |
|              |               |      | 225663055         | 6283.7900390625     | -17154.550080299377  |
|              |               |      | 112553192         | 6264.8798828125     | -16979.379928588867  |
|              |               |      | 99878825          | 1639.9599952697754  | -16784.710037231445  |
|              |               |      | 187571800         | 5326.100036621094   | -16711.479663848877  |
|              |               |      | 95802686          | 3532.8100366592407  | -16666.940178394318  |
|              |               |      | 70596998          | 3371.0699768066406  | -16637.870044231415  |
|              |               |      | 179290127         | 4382.580078125      | -16218.17979335785   |
|              |               |      | 227086757         | 1544.6800079345703  | -16218.119815826416  |
|              |               |      | 153601524         | 4660.5901222229     | -16196.379749298096  |
|              |               |      | 177398972         | 8401.989954829216   | -16094.70982170105   |
|              |               |      | 102169390         | 15898.420097589493  | -15898.640197753906  |
|              |               |      | 110189934         | 5500.319902420044   | -15682.699746370316  |
|              |               |      | 230866957         | 0.0                 | -15590.399991035461  |
|              |               |      | 211723230         | 42.29999923706055   | -15526.279685974121  |
|              |               |      | 87881909          | 2770.97998046875    | -15416.569993019104  |
|              |               |      | 184816593         | 1511.6700439453125  | -15412.65994644165   |
|              |               |      | 16513872          | 511.3000030517578   | -15406.020484924316  |
|              |               |      | 9689686           | 1441.6300201416016  | -15392.449913740158  |
|              |               |      | 3762358           | 3963.699951171875   | -15379.660242080688  |
|              |               |      | 19014556          | 2878.259979248047   | -15349.659806251526  |
|              |               |      | 37198646          | 1643.9500617980957  | -15349.599937438965  |
|              |               |      | 1162566           | 4335.81005859375    | -15349.199619293213  |
|              |               |      | 71084339          | 5917.3900718688965  | -15320.059608459473  |
|              |               |      | 160336816         | 189.0               | -15271.530057907104  |
|              |               |      | 211672576         | 723.0               | -15227.440116882324  |
|              |               |      | 178683609         | 4750.08984375       | -15190.36019229889   |
|              |               |      | 174683636         | 5302.670032501221   | -15186.920318603516  |
|              |               |      | 26458257          | 5157.62003326416    | -15140.449893951416  |
|              |               |      | 197401739         | 176.89999389648438  | -15090.270122528076  |
|              |               |      | 222084056         | 598.6600112915039   | -14939.300073623657  |
|              |               |      | 59516730          | 856.4500122070312   | -14869.400081634521  |
|              |               |      | 136020253         | 0.0                 | -14867.149851799011  |
|              |               |      | 3171282           | 299.5399971008301   | -14848.849822998047  |
|              |               |      | 6305359           | 6158.339999198914   | -14665.769687652588  |
|              |               |      | 47455862          | 1030.2699890136719  | -14586.929992675781  |
|              |               |      | 183681352         | 134.3800048828125   | -14447.409801483154  |
|              |               |      | 190973390         | 0.0                 | -14446.179819107056  |
|              |               |      | 149662035         | 2076.6000061035156  | -14405.4799118042    |
|              |               |      | 2650924           | 78.23999786376953   | -14262.800000190735  |
|              |               |      | 43673286          | 3128.290014266968   | -14250.129873275757  |
|              |               |      | 40759300          | 1817.9800262451172  | -14246.10983657837   |
|              |               |      | 91225581          | 247.9000015258789   | -14239.760124206543  |
|              |               |      | 216916724         | 7814.059837341309   | -14194.200015068054  |
|              |               |      | 214303192         | 743.8300075531006   | -14180.489753723145  |
|              |               |      | 80114335          | 1281.0199661254883  | -14134.309665679932  |
|              |               |      | 115337995         | 3120.2999954223633  | -14057.450370788574  |
|              |               |      | 66278935          | 2025.9899444580078  | -14042.759887695312  |
|              |               |      | 42631284          | 3917.4299697875977  | -13941.810081481934  |
|              |               |      | 156178815         | 7286.76025390625    | -13892.830074310303  |
|              |               |      | 45456660          | 2487.000045776367   | -13722.48014831543   |
|              |               |      | 145092998         | 7781.39990234375    | -13696.130020141602  |
+--------------+---------------+------+-------------------+---------------------+----------------------+--+
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
