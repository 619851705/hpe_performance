0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set ambari.hive.db.schema.name=hive;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.file.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.hdfs.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.sortmerge.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.sortmerge.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.abortedtxn.threshold=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.check.interval=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.num.threshold=10;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.pct.threshold=0.1f;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.initiator.on=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.threads=0;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.timeout=86400;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compute.query.using.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.bucketing=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sorting=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sortmergebucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.limit.pushdown.memory.usage=0.04;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.map.aggr=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapjoin.bucket.cache.size=10000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapred.reduce.tasks.speculative.execution=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.cache.pinobjtypes=Table,Database,Type,FieldSchema,Order;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.client.socket.timeout=60;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.execute.setugi=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.warehouse.dir=/apps/hive/warehouse;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin.sortedmerge=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.index.filter=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.optimize.mapjoin.mapreduce=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication.min.reducer=4;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.orc.splits.include.file.footer=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.authorization.enabled=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.metastore.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.semantic.analyzer.factory.impl=org.apache.hivealog.cli.HCatSemanticAnalyzerFactory;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.enable.doAs=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.default.queues=default;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.initialize.default.sessions=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.sessions.per.default.queue=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.autogather=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.max.open.batch=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.timeout=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.execution.enabled=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.checkinterval=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.flush.percent=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.maxentries=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- These values need to be tuned appropriately to your cluster. These examples are for reference.
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.container.size=6144;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.java.opts=-Xmx5120m;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=100000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=320000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask.size=629145600;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=720000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=1920000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.execution.engine=tez;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.default.fileformat=orc;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.cbo.enable=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.fetch.column.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.dynamic.partition.mode=nonstrict;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.auto.reducer.parallelism=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.exec.reducers.bytes.per.reducer=1000000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.reducers.bytes.per.reducer=67108864;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.support.concurrency=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.exec.print.summary=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.min-size=16777216;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.min-size=8388608;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.max-size=1073741824;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.max-size=1342177280;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.split-waves=1.7;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.runtime.io.sort.mb=174;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> select  
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>    w_state
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>   ,i_item_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>   ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date)) 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>   ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date)) 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  then cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>    catalog_sales left outer join catalog_returns on
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>        (catalog_sales.cs_order_number = catalog_returns.cr_order_number 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         and catalog_sales.cs_item_sk = catalog_returns.cr_item_sk)
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>   ,warehouse 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>   ,item
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>   ,date_dim
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      i_current_price between 0.99 and 1.49
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and item.i_item_sk          = catalog_sales.cs_item_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and catalog_sales.cs_warehouse_sk    = warehouse.w_warehouse_sk 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and catalog_sales.cs_sold_date_sk    = date_dim.d_date_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and date_dim.d_date between '1998-03-09' and '1998-05-08'
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  group by
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>     w_state,i_item_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  order by w_state,i_item_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> limit 100;
+----------+-------------------+----------------------+---------------------+--+
| w_state  |     i_item_id     |     sales_before     |     sales_after     |
+----------+-------------------+----------------------+---------------------+--+
| AL       | AAAAAAAAAAAACAAA  | -825.2800335884094   | 547.5400068759918   |
| AL       | AAAAAAAAAAADCAAA  | 537.7199954986572    | 500.73000144958496  |
| AL       | AAAAAAAAAAANAAAA  | 360.2300045490265    | 398.85000801086426  |
| AL       | AAAAAAAAAABFBAAA  | 478.58000802993774   | 167.89000034332275  |
| AL       | AAAAAAAAAABJDAAA  | 530.989990234375     | 369.0799965262413   |
| AL       | AAAAAAAAAABPBAAA  | 199.45999956130981   | 551.9700050354004   |
| AL       | AAAAAAAAAACCEAAA  | 284.4799919128418    | 808.1900053024292   |
| AL       | AAAAAAAAAACDAAAA  | 390.1799964904785    | 819.1399898529053   |
| AL       | AAAAAAAAAACGDAAA  | 648.2900009155273    | 252.3600025177002   |
| AL       | AAAAAAAAAACNCAAA  | -2904.1799488067627  | 1009.7500052452087  |
| AL       | AAAAAAAAAAEDDAAA  | 311.9500341415405    | 498.9599943161011   |
| AL       | AAAAAAAAAAEFBAAA  | 743.5799979567528    | 532.5099983215332   |
| AL       | AAAAAAAAAAEGDAAA  | -1805.2498741149902  | 492.30999517440796  |
| AL       | AAAAAAAAAAEIBAAA  | 228.37000465393066   | 37.8799991607666    |
| AL       | AAAAAAAAAAEJDAAA  | -299.5299701690674   | 368.21000480651855  |
| AL       | AAAAAAAAAAEKCAAA  | 418.03000259399414   | 448.72000312805176  |
| AL       | AAAAAAAAAAFACAAA  | -327.36996698379517  | 392.39999890327454  |
| AL       | AAAAAAAAAAFADAAA  | 700.7300071716309    | 212.71999597549438  |
| AL       | AAAAAAAAAAFBBAAA  | 269.49000453948975   | 275.82000494003296  |
| AL       | AAAAAAAAAAFFBAAA  | 725.8899947404861    | 647.8599983453751   |
| AL       | AAAAAAAAAAFKBAAA  | -668.3600072264671   | 397.01999711990356  |
| AL       | AAAAAAAAAAFLAAAA  | -1071.9299325942993  | 222.3900022506714   |
| AL       | AAAAAAAAAAFPAAAA  | 423.6599922180176    | 596.2499912977219   |
| AL       | AAAAAAAAAAGCCAAA  | 146.89000183343887   | 260.24000120162964  |
| AL       | AAAAAAAAAAGFDAAA  | -366.030011177063    | 604.9499926567078   |
| AL       | AAAAAAAAAAGHDAAA  | 315.0200037956238    | 306.38000106811523  |
| AL       | AAAAAAAAAAGJBAAA  | 438.4200012385845    | 617.1100020706654   |
| AL       | AAAAAAAAAAGOCAAA  | 237.15999794006348   | 306.60000681877136  |
| AL       | AAAAAAAAAAHECAAA  | -106.65001344680786  | 447.21999073028564  |
| AL       | AAAAAAAAAAHGEAAA  | 286.1300001144409    | 150.18000000715256  |
| AL       | AAAAAAAAAAHMAAAA  | -2534.149947166443   | 783.0599987506866   |
| AL       | AAAAAAAAAAHPBAAA  | 290.10000228881836   | 282.0200023651123   |
| AL       | AAAAAAAAAAIIAAAA  | 893.439995765686     | 451.10999870300293  |
| AL       | AAAAAAAAAAJFCAAA  | 134.85000944137573   | 1185.5299897193909  |
| AL       | AAAAAAAAAAJMBAAA  | 353.4799995422363    | 223.91000187397003  |
| AL       | AAAAAAAAAAKBDAAA  | 229.38000416755676   | 648.6400108337402   |
| AL       | AAAAAAAAAAKKDAAA  | 473.39000034332275   | 794.7700035572052   |
| AL       | AAAAAAAAAAKNAAAA  | 588.680004119873     | 631.9100036621094   |
| AL       | AAAAAAAAAALAAAAA  | -424.09997510910034  | 521.0299976468086   |
| AL       | AAAAAAAAAALADAAA  | 280.8999996185303    | 923.6299958229065   |
| AL       | AAAAAAAAAALCBAAA  | 167.46000289916992   | 463.2399934530258   |
| AL       | AAAAAAAAAALFEAAA  | 271.7099962234497    | 602.449996650219    |
| AL       | AAAAAAAAAALGDAAA  | -825.9199643135071   | 150.6199997663498   |
| AL       | AAAAAAAAAAMJBAAA  | 226.91000175476074   | 366.5600021481514   |
| AL       | AAAAAAAAAAMLDAAA  | -893.5600652694702   | 213.41000175476074  |
| AL       | AAAAAAAAAANCBAAA  | -196.92995196580887  | 503.55999732017517  |
| AL       | AAAAAAAAAANDAAAA  | 356.14999866485596   | 397.8600027561188   |
| AL       | AAAAAAAAAANKAAAA  | -1063.8900153636932  | 796.2800028324127   |
| AL       | AAAAAAAAAAOCAAAA  | 384.2699909210205    | 355.31000512838364  |
| AL       | AAAAAAAAAAOFDAAA  | 50.19999980926514    | 578.2300109863281   |
| AL       | AAAAAAAAAAOHCAAA  | 394.5900025367737    | 823.7500032186508   |
| AL       | AAAAAAAAAAPBBAAA  | 352.8599920272827    | 515.3499948978424   |
| AL       | AAAAAAAAAAPEDAAA  | 228.47998905181885   | 232.3200023174286   |
| AL       | AAAAAAAAABAGDAAA  | -4232.829960823059   | 823.2799952030182   |
| AL       | AAAAAAAAABBIEAAA  | -1992.520158290863   | 840.2299933433533   |
| AL       | AAAAAAAAABBLDAAA  | -443.2900288105011   | 395.45000076293945  |
| AL       | AAAAAAAAABCFAAAA  | 351.72999942302704   | 167.43000358343124  |
| AL       | AAAAAAAAABCHEAAA  | -3523.7698917388916  | 291.6299945116043   |
| AL       | AAAAAAAAABCLDAAA  | 863.5000044107437    | 402.9199995994568   |
| AL       | AAAAAAAAABCPBAAA  | 154.20999670028687   | 538.0899920463562   |
| AL       | AAAAAAAAABDAAAAA  | 436.5299997329712    | 607.0999917984009   |
| AL       | AAAAAAAAABDHAAAA  | -1.91998291015625    | 126.58999693393707  |
| AL       | AAAAAAAAABDHCAAA  | 435.7199993133545    | 336.45999813079834  |
| AL       | AAAAAAAAABDPDAAA  | -14.119993209838867  | 290.75999546051025  |
| AL       | AAAAAAAAABECBAAA  | -151.00999689102173  | 481.2599997520447   |
| AL       | AAAAAAAAABEDCAAA  | 697.0699977874756    | 321.69999384880066  |
| AL       | AAAAAAAAABEECAAA  | 27.75                | 414.67999172210693  |
| AL       | AAAAAAAAABEFAAAA  | 130.0899864435196    | 375.4399924278259   |
| AL       | AAAAAAAAABEFEAAA  | -530.379958152771    | 163.61999893188477  |
| AL       | AAAAAAAAABENBAAA  | 48.42997992038727    | 681.7799913883209   |
| AL       | AAAAAAAAABEOAAAA  | 397.1599991321564    | 412.7900056838989   |
| AL       | AAAAAAAAABFABAAA  | 397.81999349594116   | 216.97000455856323  |
| AL       | AAAAAAAAABFCCAAA  | 203.5800266265869    | 352.92999839782715  |
| AL       | AAAAAAAAABGDDAAA  | 464.81999588012695   | 734.0000038146973   |
| AL       | AAAAAAAAABGHCAAA  | 132.5400020480156    | 274.61999797821045  |
| AL       | AAAAAAAAABGMAAAA  | 627.3399965763092    | 361.4699878692627   |
| AL       | AAAAAAAAABGNAAAA  | 320.97998118400574   | 470.69999527931213  |
| AL       | AAAAAAAAABHDCAAA  | -2264.1401176452637  | 199.53999757766724  |
| AL       | AAAAAAAAABHEEAAA  | 304.48000144958496   | 548.3599967956543   |
| AL       | AAAAAAAAABHFBAAA  | 405.76999616622925   | 594.4899864196777   |
| AL       | AAAAAAAAABHFDAAA  | 215.5600025653839    | 817.9000043869019   |
| AL       | AAAAAAAAABHLDAAA  | 153.32999801635742   | 436.30000483989716  |
| AL       | AAAAAAAAABIHAAAA  | 332.3399987220764    | 369.5099959373474   |
| AL       | AAAAAAAAABIMBAAA  | 104.00000190734863   | 344.9400019645691   |
| AL       | AAAAAAAAABJFCAAA  | 431.38998794555664   | 478.0500053167343   |
| AL       | AAAAAAAAABJHCAAA  | 741.479998588562     | 479.12000297009945  |
| AL       | AAAAAAAAABKLDAAA  | 699.9199934005737    | 329.36000674963     |
| AL       | AAAAAAAAABLFAAAA  | -1094.4199477434158  | 1171.7999992370605  |
| AL       | AAAAAAAAABLGEAAA  | -2219.870051383972   | 723.749993801117    |
| AL       | AAAAAAAAABLHBAAA  | 220.6000006198883    | 650.2200217247009   |
| AL       | AAAAAAAAABLNAAAA  | 624.3700008392334    | 299.10999965667725  |
| AL       | AAAAAAAAABMBCAAA  | 601.8099961280823    | 490.75000381469727  |
| AL       | AAAAAAAAABMHCAAA  | 653.870005607605     | 717.9500017166138   |
| AL       | AAAAAAAAABMKCAAA  | 559.1200000047684    | 683.6099983453751   |
| AL       | AAAAAAAAABMLBAAA  | -4827.150249481201   | 229.4999942779541   |
| AL       | AAAAAAAAABNIBAAA  | -1280.0699900388718  | 552.0900068283081   |
| AL       | AAAAAAAAABOKBAAA  | 574.6899871826172    | 484.8699953556061   |
| AL       | AAAAAAAAABOLDAAA  | 160.0200014412403    | 610.5999982357025   |
| AL       | AAAAAAAAABOMBAAA  | 366.01000213623047   | 312.08999967575073  |
| AL       | AAAAAAAAABONBAAA  | 593.5400072336197    | 1000.1300029754639  |
+----------+-------------------+----------------------+---------------------+--+
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
