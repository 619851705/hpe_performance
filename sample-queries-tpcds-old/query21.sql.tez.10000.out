0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set ambari.hive.db.schema.name=hive;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set fs.file.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set fs.hdfs.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.auto.convert.join=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.auto.convert.sortmerge.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.auto.convert.sortmerge.join=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compactor.abortedtxn.threshold=1000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compactor.check.interval=300;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compactor.delta.num.threshold=10;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compactor.delta.pct.threshold=0.1f;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compactor.initiator.on=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compactor.worker.threads=0;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compactor.worker.timeout=86400;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compute.query.using.stats=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.enforce.bucketing=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.enforce.sorting=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.enforce.sortmergebucketmapjoin=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.limit.pushdown.memory.usage=0.04;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.map.aggr=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.mapjoin.bucket.cache.size=10000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.mapred.reduce.tasks.speculative.execution=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.metastore.cache.pinobjtypes=Table,Database,Type,FieldSchema,Order;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.metastore.client.socket.timeout=60;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.metastore.execute.setugi=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.metastore.warehouse.dir=/apps/hive/warehouse;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.optimize.bucketmapjoin.sortedmerge=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.optimize.bucketmapjoin=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.optimize.index.filter=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.optimize.mapjoin.mapreduce=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.optimize.reducededuplication.min.reducer=4;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.optimize.reducededuplication=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.orc.splits.include.file.footer=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.security.authorization.enabled=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.security.metastore.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.semantic.analyzer.factory.impl=org.apache.hivealog.cli.HCatSemanticAnalyzerFactory;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.server2.enable.doAs=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.server2.tez.default.queues=default;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.server2.tez.initialize.default.sessions=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.server2.tez.sessions.per.default.queue=1;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.stats.autogather=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.tez.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.txn.max.open.batch=1000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.txn.timeout=300;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.vectorized.execution.enabled=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.vectorized.groupby.checkinterval=1024;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.vectorized.groupby.flush.percent=1;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.vectorized.groupby.maxentries=1024;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- These values need to be tuned appropriately to your cluster. These examples are for reference.
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.tez.container.size=2048;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.tez.java.opts=-Xmx1900m;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=100000000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask.size=320000000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=720000000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=1920000000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=629145600;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.execution.engine=tez;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.default.fileformat=orc;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.cbo.enable=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.stats.fetch.column.stats=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.exec.dynamic.partition.mode=nonstrict;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.tez.auto.reducer.parallelism=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.exec.reducers.bytes.per.reducer=67108864;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.exec.reducers.bytes.per.reducer=33554432;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.support.concurrency=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.tez.exec.print.summary=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set tez.grouping.min-size=16777216;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set tez.grouping.max-size=33554432;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set tez.grouping.max-size=1073741824;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> --set tez.grouping.split-waves=1.7;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> select  *
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  from(select w_warehouse_name
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>             ,i_item_id
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>             ,sum(case when (cast(d_date as date) < cast ('1998-04-08' as date))
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>                 then inv_quantity_on_hand 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>                       else 0 end) as inv_before
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>             ,sum(case when (cast(d_date as date) >= cast ('1998-04-08' as date))
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>                       then inv_quantity_on_hand 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>                       else 0 end) as inv_after
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>    from inventory
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>        ,warehouse
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>        ,item
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>        ,date_dim
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>    where i_current_price between 0.99 and 1.49
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>      and item.i_item_sk          = inventory.inv_item_sk
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>      and inventory.inv_warehouse_sk   = warehouse.w_warehouse_sk
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>      and inventory.inv_date_sk    = date_dim.d_date_sk
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>      and d_date between '1998-03-09' and '1998-05-07'
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>    group by w_warehouse_name, i_item_id) x
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  where (case when inv_before > 0 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>              then inv_after / inv_before 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>              else null
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>              end) between 2.0/3.0 and 3.0/2.0
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  order by w_warehouse_name
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>          ,i_item_id
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  limit 100;
+---------------------+-------------------+---------------+--------------+--+
| x.w_warehouse_name  |    x.i_item_id    | x.inv_before  | x.inv_after  |
+---------------------+-------------------+---------------+--------------+--+
|                     | AAAAAAAAAAAACAAA  | 2663          | 2358         |
|                     | AAAAAAAAAAADCAAA  | 1844          | 2144         |
|                     | AAAAAAAAAABFBAAA  | 2471          | 2326         |
|                     | AAAAAAAAAACCEAAA  | 2213          | 2325         |
|                     | AAAAAAAAAACDAAAA  | 1351          | 1607         |
|                     | AAAAAAAAAACNCAAA  | 1656          | 1811         |
|                     | AAAAAAAAAAEKCAAA  | 2172          | 2044         |
|                     | AAAAAAAAAAFACAAA  | 1339          | 1942         |
|                     | AAAAAAAAAAFADAAA  | 2166          | 2758         |
|                     | AAAAAAAAAAFBBAAA  | 2118          | 2654         |
|                     | AAAAAAAAAAFFBAAA  | 1837          | 1744         |
|                     | AAAAAAAAAAFKBAAA  | 2235          | 2786         |
|                     | AAAAAAAAAAGCCAAA  | 1554          | 1673         |
|                     | AAAAAAAAAAGHDAAA  | 1292          | 1859         |
|                     | AAAAAAAAAAHECAAA  | 2559          | 2478         |
|                     | AAAAAAAAAAHGEAAA  | 2006          | 2554         |
|                     | AAAAAAAAAAJFCAAA  | 2448          | 3373         |
|                     | AAAAAAAAAAJMBAAA  | 1712          | 1153         |
|                     | AAAAAAAAAAKBDAAA  | 1718          | 2490         |
|                     | AAAAAAAAAALADAAA  | 2389          | 2631         |
|                     | AAAAAAAAAALCBAAA  | 1975          | 2055         |
|                     | AAAAAAAAAALFEAAA  | 1429          | 2136         |
|                     | AAAAAAAAAALGDAAA  | 2315          | 2042         |
|                     | AAAAAAAAAAMLDAAA  | 2051          | 2256         |
|                     | AAAAAAAAAANCBAAA  | 2370          | 3419         |
|                     | AAAAAAAAAAOFDAAA  | 2284          | 3125         |
|                     | AAAAAAAAAAOHCAAA  | 1927          | 1811         |
|                     | AAAAAAAAAAPBBAAA  | 1675          | 2281         |
|                     | AAAAAAAAAAPEDAAA  | 2061          | 3008         |
|                     | AAAAAAAAABAGDAAA  | 1436          | 1857         |
|                     | AAAAAAAAABBIEAAA  | 2404          | 2001         |
|                     | AAAAAAAAABBLDAAA  | 2537          | 2766         |
|                     | AAAAAAAAABCFAAAA  | 2760          | 2579         |
|                     | AAAAAAAAABCHEAAA  | 2498          | 2688         |
|                     | AAAAAAAAABCLDAAA  | 2043          | 2819         |
|                     | AAAAAAAAABCPBAAA  | 2513          | 1966         |
|                     | AAAAAAAAABDPDAAA  | 2233          | 2135         |
|                     | AAAAAAAAABECBAAA  | 2904          | 2921         |
|                     | AAAAAAAAABEDCAAA  | 2172          | 2548         |
|                     | AAAAAAAAABEECAAA  | 2522          | 2092         |
|                     | AAAAAAAAABEFAAAA  | 2614          | 1762         |
|                     | AAAAAAAAABEFEAAA  | 2534          | 1800         |
|                     | AAAAAAAAABENBAAA  | 2195          | 2287         |
|                     | AAAAAAAAABFABAAA  | 1830          | 2615         |
|                     | AAAAAAAAABFCCAAA  | 2535          | 2010         |
|                     | AAAAAAAAABGHCAAA  | 2736          | 3972         |
|                     | AAAAAAAAABGNAAAA  | 1829          | 2173         |
|                     | AAAAAAAAABHDCAAA  | 1754          | 2194         |
|                     | AAAAAAAAABHEEAAA  | 1316          | 1869         |
|                     | AAAAAAAAABHFBAAA  | 2142          | 1585         |
|                     | AAAAAAAAABHFDAAA  | 2261          | 1859         |
|                     | AAAAAAAAABHLDAAA  | 2497          | 2835         |
|                     | AAAAAAAAABIHAAAA  | 2037          | 1937         |
|                     | AAAAAAAAABJFCAAA  | 1968          | 2774         |
|                     | AAAAAAAAABJHCAAA  | 1878          | 2761         |
|                     | AAAAAAAAABKLDAAA  | 2178          | 1626         |
|                     | AAAAAAAAABLFAAAA  | 2390          | 1645         |
|                     | AAAAAAAAABLNAAAA  | 2166          | 2768         |
|                     | AAAAAAAAABMHCAAA  | 2647          | 3596         |
|                     | AAAAAAAAABMLBAAA  | 3090          | 2651         |
|                     | AAAAAAAAABNIBAAA  | 1700          | 1872         |
|                     | AAAAAAAAABOKBAAA  | 1805          | 2554         |
|                     | AAAAAAAAABOLDAAA  | 1360          | 1402         |
|                     | AAAAAAAAABOMBAAA  | 1822          | 1942         |
|                     | AAAAAAAAABPCBAAA  | 3000          | 2487         |
|                     | AAAAAAAAABPHDAAA  | 2228          | 2868         |
|                     | AAAAAAAAACAADAAA  | 1789          | 2261         |
|                     | AAAAAAAAACAKBAAA  | 1304          | 1666         |
|                     | AAAAAAAAACCDBAAA  | 1704          | 1870         |
|                     | AAAAAAAAACCFEAAA  | 3131          | 2721         |
|                     | AAAAAAAAACCKCAAA  | 1875          | 2103         |
|                     | AAAAAAAAACDGCAAA  | 1846          | 2341         |
|                     | AAAAAAAAACDLDAAA  | 3276          | 3782         |
|                     | AAAAAAAAACDMCAAA  | 2130          | 2258         |
|                     | AAAAAAAAACEOCAAA  | 2568          | 3263         |
|                     | AAAAAAAAACEODAAA  | 2765          | 2642         |
|                     | AAAAAAAAACFDBAAA  | 2192          | 1620         |
|                     | AAAAAAAAACGFBAAA  | 1776          | 2539         |
|                     | AAAAAAAAACGHCAAA  | 2040          | 2140         |
|                     | AAAAAAAAACGLAAAA  | 2655          | 2953         |
|                     | AAAAAAAAACGLBAAA  | 2075          | 2591         |
|                     | AAAAAAAAACGOAAAA  | 2367          | 2552         |
|                     | AAAAAAAAACHABAAA  | 2109          | 1661         |
|                     | AAAAAAAAACICBAAA  | 2175          | 2778         |
|                     | AAAAAAAAACIFEAAA  | 2267          | 3320         |
|                     | AAAAAAAAACJBCAAA  | 1866          | 2145         |
|                     | AAAAAAAAACJIAAAA  | 1201          | 1556         |
|                     | AAAAAAAAACJLBAAA  | 1843          | 2438         |
|                     | AAAAAAAAACKMCAAA  | 2126          | 2615         |
|                     | AAAAAAAAACLADAAA  | 2337          | 2150         |
|                     | AAAAAAAAACLDAAAA  | 1764          | 2265         |
|                     | AAAAAAAAACLJDAAA  | 2004          | 2018         |
|                     | AAAAAAAAACMGDAAA  | 1886          | 2117         |
|                     | AAAAAAAAACMHEAAA  | 2123          | 1965         |
|                     | AAAAAAAAACNBBAAA  | 1549          | 1285         |
|                     | AAAAAAAAACNDBAAA  | 1880          | 2654         |
|                     | AAAAAAAAACOBAAAA  | 1966          | 2576         |
|                     | AAAAAAAAACPDAAAA  | 1968          | 2619         |
|                     | AAAAAAAAACPGAAAA  | 3028          | 2476         |
|                     | AAAAAAAAACPLBAAA  | 1829          | 2279         |
+---------------------+-------------------+---------------+--------------+--+
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
