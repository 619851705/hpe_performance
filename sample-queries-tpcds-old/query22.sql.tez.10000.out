0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set ambari.hive.db.schema.name=hive;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set fs.file.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set fs.hdfs.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.auto.convert.join=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.auto.convert.sortmerge.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.auto.convert.sortmerge.join=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compactor.abortedtxn.threshold=1000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compactor.check.interval=300;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compactor.delta.num.threshold=10;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compactor.delta.pct.threshold=0.1f;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compactor.initiator.on=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compactor.worker.threads=0;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compactor.worker.timeout=86400;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.compute.query.using.stats=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.enforce.bucketing=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.enforce.sorting=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.enforce.sortmergebucketmapjoin=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.limit.pushdown.memory.usage=0.04;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.map.aggr=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.mapjoin.bucket.cache.size=10000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.mapred.reduce.tasks.speculative.execution=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.metastore.cache.pinobjtypes=Table,Database,Type,FieldSchema,Order;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.metastore.client.socket.timeout=60;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.metastore.execute.setugi=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.metastore.warehouse.dir=/apps/hive/warehouse;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.optimize.bucketmapjoin.sortedmerge=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.optimize.bucketmapjoin=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.optimize.index.filter=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.optimize.mapjoin.mapreduce=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.optimize.reducededuplication.min.reducer=4;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.optimize.reducededuplication=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.orc.splits.include.file.footer=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.security.authorization.enabled=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.security.metastore.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.semantic.analyzer.factory.impl=org.apache.hivealog.cli.HCatSemanticAnalyzerFactory;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.server2.enable.doAs=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.server2.tez.default.queues=default;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.server2.tez.initialize.default.sessions=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.server2.tez.sessions.per.default.queue=1;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.stats.autogather=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.tez.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.txn.max.open.batch=1000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.txn.timeout=300;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.vectorized.execution.enabled=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.vectorized.groupby.checkinterval=1024;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.vectorized.groupby.flush.percent=1;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.vectorized.groupby.maxentries=1024;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- These values need to be tuned appropriately to your cluster. These examples are for reference.
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.tez.container.size=2048;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.tez.java.opts=-Xmx1900m;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=100000000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask.size=320000000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=720000000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=1920000000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=629145600;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.execution.engine=tez;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.default.fileformat=orc;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.cbo.enable=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.stats.fetch.column.stats=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.exec.dynamic.partition.mode=nonstrict;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.tez.auto.reducer.parallelism=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.exec.reducers.bytes.per.reducer=67108864;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.exec.reducers.bytes.per.reducer=33554432;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.support.concurrency=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set hive.tez.exec.print.summary=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set tez.grouping.min-size=16777216;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> set tez.grouping.max-size=33554432;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set tez.grouping.max-size=1073741824;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> --set tez.grouping.split-waves=1.7;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> select  i_product_name
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>              ,i_brand
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>              ,i_class
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>              ,i_category
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>              ,avg(inv_quantity_on_hand) qoh
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>        from inventory
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>            ,date_dim
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>            ,item
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>            ,warehouse
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>        where inventory.inv_date_sk=date_dim.d_date_sk
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>               and inventory.inv_item_sk=item.i_item_sk
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>               and inventory.inv_warehouse_sk = warehouse.w_warehouse_sk
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>               and date_dim.d_month_seq between 1193 and 1193 + 11
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>        group by i_product_name
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>                        ,i_brand
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>                        ,i_class
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>                        ,i_category with rollup
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> order by qoh, i_product_name, i_brand, i_class, i_category
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> limit 100;
+--------------------------------+------------------------+-----------------+--------------+---------------------+--+
|         i_product_name         |        i_brand         |     i_class     |  i_category  |         qoh         |
+--------------------------------+------------------------+-----------------+--------------+---------------------+--+
| n steingoughtpriable           | NULL                   | NULL            | NULL         | 439.1010101010101   |
| n steingoughtpriable           | amalgnameless #10      | NULL            | NULL         | 439.1010101010101   |
| n steingoughtpriable           | amalgnameless #10      | athletic shoes  | NULL         | 439.1010101010101   |
| n steingoughtpriable           | amalgnameless #10      | athletic shoes  | Sports       | 439.1010101010101   |
| prieseationprieseable          | NULL                   | NULL            | NULL         | 441.8469135802469   |
| prieseationprieseable          | maxicorp #8            | NULL            | NULL         | 441.8469135802469   |
| prieseationprieseable          | maxicorp #8            | womens watch    | NULL         | 441.8469135802469   |
| prieseationprieseable          | maxicorp #8            | womens watch    | Jewelry      | 441.8469135802469   |
| anticallyantieingationought    | NULL                   | NULL            | NULL         | 444.22727272727275  |
| anticallyantieingationought    | exportiexporti #2      | NULL            | NULL         | 444.22727272727275  |
| anticallyantieingationought    | exportiexporti #2      | toddlers        | NULL         | 444.22727272727275  |
| anticallyantieingationought    | exportiexporti #2      | toddlers        | Children     | 444.22727272727275  |
| antin stationableantiought     | NULL                   | NULL            | NULL         | 446.16169154228857  |
| antin stationableantiought     | corpunivamalg #12      | NULL            | NULL         | 446.16169154228857  |
| antin stationableantiought     | corpunivamalg #12      | mystery         | NULL         | 446.16169154228857  |
| antin stationableantiought     | corpunivamalg #12      | mystery         | Books        | 446.16169154228857  |
| priableanticallyantiable       | NULL                   | NULL            | NULL         | 446.4651741293532   |
| priableanticallyantiable       | edu packedu pack #2    | NULL            | NULL         | 446.4651741293532   |
| priableanticallyantiable       | edu packedu pack #2    | athletic        | NULL         | 446.4651741293532   |
| priableanticallyantiable       | edu packedu pack #2    | athletic        | Shoes        | 446.4651741293532   |
| n stpriantiableantiable        | NULL                   | NULL            | NULL         | 447.33830845771143  |
| n stpriantiableantiable        | maximaxi #12           | NULL            | NULL         | 447.33830845771143  |
| n stpriantiableantiable        | maximaxi #12           | science         | NULL         | 447.33830845771143  |
| n stpriantiableantiable        | maximaxi #12           | science         | Books        | 447.33830845771143  |
| n stoughteseationanti          | NULL                   | NULL            | NULL         | 447.8627450980392   |
| n stoughteseationanti          | edu packmaxi #12       | NULL            | NULL         | 447.8627450980392   |
| n stoughteseationanti          | edu packmaxi #12       | entertainments  | NULL         | 447.8627450980392   |
| n stoughteseationanti          | edu packmaxi #12       | entertainments  | Books        | 447.8627450980392   |
| oughtpriableprieseought        | NULL                   | NULL            | NULL         | 448.6184538653367   |
| oughtpriableprieseought        | corpnameless #2        | NULL            | NULL         | 448.6184538653367   |
| oughtpriableprieseought        | corpnameless #2        | furniture       | NULL         | 448.6184538653367   |
| oughtpriableprieseought        | corpnameless #2        | furniture       | Home         | 448.6184538653367   |
| callyn steingationese          | NULL                   | NULL            | NULL         | 449.30531732418524  |
| callyn steingationese          | edu packscholar #1     | NULL            | NULL         | 449.30531732418524  |
| callyn steingationese          | edu packscholar #1     | classical       | NULL         | 449.30531732418524  |
| callyn steingationese          | edu packscholar #1     | classical       | Music        | 449.30531732418524  |
| pribarpriationpriought         | NULL                   | NULL            | NULL         | 449.8151898734177   |
| pribarpriationpriought         | importoedu pack #2     | NULL            | NULL         | 449.8151898734177   |
| pribarpriationpriought         | importoedu pack #2     | mens            | NULL         | 449.8151898734177   |
| pribarpriationpriought         | importoedu pack #2     | mens            | Shoes        | 449.8151898734177   |
| ationn stn stantibarable       | NULL                   | NULL            | NULL         | 450.5280612244898   |
| ationn stn stantibarable       | importoscholar #2      | NULL            | NULL         | 450.5280612244898   |
| ationn stn stantibarable       | importoscholar #2      | country         | NULL         | 450.5280612244898   |
| ationn stn stantibarable       | importoscholar #2      | country         | Music        | 450.5280612244898   |
| baroughteseesen stought        | NULL                   | NULL            | NULL         | 450.5613445378151   |
| baroughteseesen stought        | edu packmaxi #11       | NULL            | NULL         | 450.5613445378151   |
| baroughteseesen stought        | edu packmaxi #11       | entertainments  | NULL         | 450.5613445378151   |
| baroughteseesen stought        | edu packmaxi #11       | entertainments  | Books        | 450.5613445378151   |
| prieingn stablebarought        | NULL                   | NULL            | NULL         | 450.74874371859295  |
| prieingn stablebarought        | edu packscholar #2     | NULL            | NULL         | 450.74874371859295  |
| prieingn stablebarought        | edu packscholar #2     | classical       | NULL         | 450.74874371859295  |
| prieingn stablebarought        | edu packscholar #2     | classical       | Music        | 450.74874371859295  |
| ationpriantin stbarable        | NULL                   | NULL            | NULL         | 451.5267175572519   |
| ationpriantin stbarable        | importoexporti #2      | NULL            | NULL         | 451.5267175572519   |
| ationpriantin stbarable        | importoexporti #2      | infants         | NULL         | 451.5267175572519   |
| ationpriantin stbarable        | importoexporti #2      | infants         | Children     | 451.5267175572519   |
| oughtn steingcallyanti         | NULL                   | NULL            | NULL         | 451.7029702970297   |
| oughtn steingcallyanti         | corpnameless #2        | NULL            | NULL         | 451.7029702970297   |
| oughtn steingcallyanti         | corpnameless #2        | furniture       | NULL         | 451.7029702970297   |
| oughtn steingcallyanti         | corpnameless #2        | furniture       | Home         | 451.7029702970297   |
| oughtcallyationeseeseought     | NULL                   | NULL            | NULL         | 451.91089108910893  |
| oughtcallyationeseeseought     | maximaxi #6            | NULL            | NULL         | 451.91089108910893  |
| oughtcallyationeseeseought     | maximaxi #6            | science         | NULL         | 451.91089108910893  |
| oughtcallyationeseeseought     | maximaxi #6            | science         | Books        | 451.91089108910893  |
| antiationeseese                | NULL                   | NULL            | NULL         | 452.0701754385965   |
| antiationeseese                | exportiedu pack #2     | NULL            | NULL         | 452.0701754385965   |
| antiationeseese                | exportiedu pack #2     | kids            | NULL         | 452.0701754385965   |
| antiationeseese                | exportiedu pack #2     | kids            | Shoes        | 452.0701754385965   |
| oughtableationantieing         | NULL                   | NULL            | NULL         | 452.22636815920396  |
| oughtableationantieing         | corpunivamalg #8       | NULL            | NULL         | 452.22636815920396  |
| oughtableationantieing         | corpunivamalg #8       | musical         | NULL         | 452.22636815920396  |
| oughtableationantieing         | corpunivamalg #8       | musical         | Electronics  | 452.22636815920396  |
| oughtanticallycallyationought  | NULL                   | NULL            | NULL         | 452.28109452736317  |
| oughtanticallycallyationought  | edu packbrand #4       | NULL            | NULL         | 452.28109452736317  |
| oughtanticallycallyationought  | edu packbrand #4       | estate          | NULL         | 452.28109452736317  |
| oughtanticallycallyationought  | edu packbrand #4       | estate          | Jewelry      | 452.28109452736317  |
| n stbarationoughtationable     | NULL                   | NULL            | NULL         | 452.50757575757575  |
| n stbarationoughtationable     | amalgexporti #2        | NULL            | NULL         | 452.50757575757575  |
| n stbarationoughtationable     | amalgexporti #2        | newborn         | NULL         | 452.50757575757575  |
| n stbarationoughtationable     | amalgexporti #2        | newborn         | Children     | 452.50757575757575  |
| eingn stn stationese           | NULL                   | NULL            | NULL         | 452.9795570698467   |
| eingn stn stationese           | edu packbrand #7       | NULL            | NULL         | 452.9795570698467   |
| eingn stn stationese           | edu packbrand #7       | estate          | NULL         | 452.9795570698467   |
| eingn stn stationese           | edu packbrand #7       | estate          | Jewelry      | 452.9795570698467   |
| n stableableationantiought     | NULL                   | NULL            | NULL         | 452.99004975124376  |
| n stableableationantiought     | exportiamalgamalg #14  | NULL            | NULL         | 452.99004975124376  |
| n stableableationantiought     | exportiamalgamalg #14  | stereo          | NULL         | 452.99004975124376  |
| n stableableationantiought     | exportiamalgamalg #14  | stereo          | Electronics  | 452.99004975124376  |
| antieingbarableanti            | NULL                   | NULL            | NULL         | 453.18905472636817  |
| antieingbarableanti            | exportiimporto #2      | NULL            | NULL         | 453.18905472636817  |
| antieingbarableanti            | exportiimporto #2      | pants           | NULL         | 453.18905472636817  |
| antieingbarableanti            | exportiimporto #2      | pants           | Men          | 453.18905472636817  |
| ationoughteseationese          | NULL                   | NULL            | NULL         | 453.3895781637717   |
| ationoughteseationese          | corpcorp #2            | NULL            | NULL         | 453.3895781637717   |
| ationoughteseationese          | corpcorp #2            | rings           | NULL         | 453.3895781637717   |
| ationoughteseationese          | corpcorp #2            | rings           | Jewelry      | 453.3895781637717   |
| eingableantioughtn st          | NULL                   | NULL            | NULL         | 453.679180887372    |
| eingableantioughtn st          | amalgnameless #9       | NULL            | NULL         | 453.679180887372    |
| eingableantioughtn st          | amalgnameless #9       | athletic shoes  | NULL         | 453.679180887372    |
| eingableantioughtn st          | amalgnameless #9       | athletic shoes  | Sports       | 453.679180887372    |
+--------------------------------+------------------------+-----------------+--------------+---------------------+--+
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
