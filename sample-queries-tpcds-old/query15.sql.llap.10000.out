0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set ambari.hive.db.schema.name=hive;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.file.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.hdfs.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.sortmerge.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.sortmerge.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.abortedtxn.threshold=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.check.interval=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.num.threshold=10;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.pct.threshold=0.1f;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.initiator.on=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.threads=0;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.timeout=86400;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compute.query.using.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.bucketing=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sorting=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sortmergebucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.limit.pushdown.memory.usage=0.04;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.map.aggr=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapjoin.bucket.cache.size=10000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapred.reduce.tasks.speculative.execution=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.cache.pinobjtypes=Table,Database,Type,FieldSchema,Order;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.client.socket.timeout=60;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.execute.setugi=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.warehouse.dir=/apps/hive/warehouse;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin.sortedmerge=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.index.filter=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.optimize.mapjoin.mapreduce=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication.min.reducer=4;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.orc.splits.include.file.footer=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.authorization.enabled=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.metastore.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.semantic.analyzer.factory.impl=org.apache.hivealog.cli.HCatSemanticAnalyzerFactory;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.enable.doAs=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.default.queues=default;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.initialize.default.sessions=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.sessions.per.default.queue=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.autogather=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.max.open.batch=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.timeout=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.execution.enabled=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.checkinterval=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.flush.percent=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.maxentries=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- These values need to be tuned appropriately to your cluster. These examples are for reference.
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.container.size=6144;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.java.opts=-Xmx5120m;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=100000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=320000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask.size=629145600;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=720000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=1920000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.execution.engine=tez;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.default.fileformat=orc;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.cbo.enable=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.fetch.column.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.dynamic.partition.mode=nonstrict;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.auto.reducer.parallelism=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.exec.reducers.bytes.per.reducer=1000000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.reducers.bytes.per.reducer=67108864;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.support.concurrency=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.exec.print.summary=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.min-size=16777216;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.min-size=8388608;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.max-size=1073741824;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.max-size=1342177280;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.split-waves=1.7;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.runtime.io.sort.mb=174;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> select  ca_zip
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>        ,sum(cs_sales_price)
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from catalog_sales
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      ,customer
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      ,customer_address
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      ,date_dim
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where catalog_sales.cs_bill_customer_sk = customer.c_customer_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and customer.c_current_addr_sk = customer_address.ca_address_sk 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and ( substr(ca_zip,1,5) in ('85669', '86197','88274','83405','86475',
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>                                    '85392', '85460', '80348', '81792')
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>        or customer_address.ca_state in ('CA','WA','GA')
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>        or catalog_sales.cs_sales_price > 500)
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and catalog_sales.cs_sold_date_sk = date_dim.d_date_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and date_dim.d_qoy = 2 and date_dim.d_year = 2000
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  group by ca_zip
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  order by ca_zip
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  limit 100;
+---------+-----------------------+--+
| ca_zip  |          c1           |
+---------+-----------------------+--+
|         | 2.5557728090374548E7  |
| 30001   | 407341.3102675807     |
| 30008   | 404002.9701356515     |
| 30026   | 439739.1200911496     |
| 30029   | 18782.930030513555    |
| 30049   | 8936.619961544871     |
| 30056   | 13206.519966382533    |
| 30059   | 8628263.629668308     |
| 30068   | 20558.580040305853    |
| 30069   | 9179765.01933457      |
| 30116   | 471433.6498988699     |
| 30125   | 451046.56016639806    |
| 30128   | 29192.320026293397    |
| 30141   | 444088.4100961499     |
| 30149   | 13820.829990208149    |
| 30150   | 8757578.449914046     |
| 30156   | 12588.979974091053    |
| 30162   | 8777331.551183818     |
| 30163   | 13072.56995202601     |
| 30164   | 439624.66020284407    |
| 30169   | 8831604.649635471     |
| 30191   | 8822905.439627824     |
| 30193   | 11695.309928812087    |
| 30194   | 471378.0399103835     |
| 30204   | 26674.860050946474    |
| 30216   | 443893.19974156097    |
| 30224   | 17859.000042244792    |
| 30236   | 11972.000009853393    |
| 30238   | 10752.869997099042    |
| 30244   | 12647.129969924688    |
| 30245   | 15512.430015288293    |
| 30254   | 14325.940020263195    |
| 30262   | 471122.8299869485     |
| 30268   | 456867.5798091162     |
| 30275   | 17035.15996400267     |
| 30278   | 13876.769988417625    |
| 30296   | 474039.91972267255    |
| 30297   | 16070.699992254376    |
| 30302   | 465725.59008057415    |
| 30307   | 9546.179977193475     |
| 30309   | 385315.0398959443     |
| 30311   | 6030.190006017685     |
| 30314   | 17065.57998548448     |
| 30317   | 18157.100010186434    |
| 30319   | 401991.4598410763     |
| 30320   | 21094.380061745644    |
| 30323   | 9643.18001022935      |
| 30325   | 16980.999976694584    |
| 30330   | 13523.320013115183    |
| 30336   | 24864.280004888773    |
| 30344   | 459880.6701268256     |
| 30348   | 14190.52996942401     |
| 30369   | 421749.38011021167    |
| 30381   | 10723.750008374453    |
| 30382   | 14858.359971374273    |
| 30383   | 9424.949979871511     |
| 30386   | 21325.429943673313    |
| 30399   | 8560651.650503995     |
| 30407   | 19554.81995011866     |
| 30408   | 418462.1799508482     |
| 30411   | 9251832.79093899      |
| 30414   | 13437.90001615882     |
| 30418   | 412873.20973603986    |
| 30419   | 468591.7199317701     |
| 30428   | 10808.890025764704    |
| 30444   | 14724.670017398894    |
| 30445   | 21352.359973087907    |
| 30451   | 419869.0999352485     |
| 30468   | 11673.309995234013    |
| 30481   | 35487.23007181287     |
| 30485   | 10645.640046924353    |
| 30492   | 410256.0300653111     |
| 30499   | 8654062.389393173     |
| 30514   | 22659.22005021572     |
| 30519   | 497367.35018762946    |
| 30522   | 4743.070003211498     |
| 30525   | 423881.8199210316     |
| 30526   | 16343.440014600754    |
| 30534   | 8634799.050689632     |
| 30540   | 419395.67990105785    |
| 30573   | 432858.4800141286     |
| 30580   | 18971.340033022687    |
| 30584   | 17389.519987381995    |
| 30586   | 10171.139976918697    |
| 30587   | 8796723.340436317     |
| 30589   | 442632.4202841334     |
| 30613   | 11694.360023215413    |
| 30618   | 461823.65984662995    |
| 30631   | 454456.5401601903     |
| 30634   | 434045.8200481795     |
| 30635   | 453169.90985206515    |
| 30636   | 8114.300024308264     |
| 30647   | 12669.809980332851    |
| 30662   | 23056.349951058626    |
| 30663   | 20896.290030241013    |
| 30679   | 15658.189993619919    |
| 30681   | 11063.490009278059    |
| 30689   | 18451.259967153892    |
| 30702   | 12191.97996339947     |
| 30725   | 435670.82957258075    |
+---------+-----------------------+--+
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
