0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set ambari.hive.db.schema.name=hive;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.file.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.hdfs.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.sortmerge.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.sortmerge.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.abortedtxn.threshold=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.check.interval=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.num.threshold=10;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.pct.threshold=0.1f;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.initiator.on=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.threads=0;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.timeout=86400;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compute.query.using.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.bucketing=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sorting=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sortmergebucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.limit.pushdown.memory.usage=0.04;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.map.aggr=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapjoin.bucket.cache.size=10000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapred.reduce.tasks.speculative.execution=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.cache.pinobjtypes=Table,Database,Type,FieldSchema,Order;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.client.socket.timeout=60;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.execute.setugi=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.warehouse.dir=/apps/hive/warehouse;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin.sortedmerge=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.index.filter=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.optimize.mapjoin.mapreduce=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication.min.reducer=4;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.orc.splits.include.file.footer=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.authorization.enabled=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.metastore.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.semantic.analyzer.factory.impl=org.apache.hivealog.cli.HCatSemanticAnalyzerFactory;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.enable.doAs=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.default.queues=default;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.initialize.default.sessions=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.sessions.per.default.queue=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.autogather=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.max.open.batch=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.timeout=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.execution.enabled=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.checkinterval=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.flush.percent=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.maxentries=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- These values need to be tuned appropriately to your cluster. These examples are for reference.
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.container.size=6144;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.java.opts=-Xmx5120m;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=100000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=320000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask.size=629145600;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=720000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=1920000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.execution.engine=tez;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.default.fileformat=orc;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.cbo.enable=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.fetch.column.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.dynamic.partition.mode=nonstrict;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.auto.reducer.parallelism=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.exec.reducers.bytes.per.reducer=1000000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.reducers.bytes.per.reducer=67108864;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.support.concurrency=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.exec.print.summary=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.min-size=16777216;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.min-size=8388608;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.max-size=1073741824;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.max-size=1342177280;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.split-waves=1.7;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.runtime.io.sort.mb=174;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> select  
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         cc_call_center_id Call_Center,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         cc_name Call_Center_Name,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         cc_manager Manager,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         sum(cr_net_loss) Returns_Loss
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> from
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         call_center,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         catalog_returns,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         date_dim,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         customer,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         customer_address,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         customer_demographics,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         household_demographics
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> where
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         catalog_returns.cr_call_center_sk       = call_center.cc_call_center_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> and     catalog_returns.cr_returned_date_sk     = date_dim.d_date_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> and     catalog_returns.cr_returning_customer_sk= customer.c_customer_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> and     customer_demographics.cd_demo_sk              = customer.c_current_cdemo_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> and     household_demographics.hd_demo_sk              = customer.c_current_hdemo_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> and     customer_address.ca_address_sk           = customer.c_current_addr_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> and     d_year                  = 1999 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> and     d_moy                   = 11
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> and     ( (cd_marital_status       = 'M' and cd_education_status     = 'Unknown')
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         or(cd_marital_status       = 'W' and cd_education_status     = 'Advanced Degree'))
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> and     hd_buy_potential like '0-500%'
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> and     ca_gmt_offset           = -7
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> group by cc_call_center_id,cc_name,cc_manager,cd_marital_status,cd_education_status
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> order by Returns_Loss desc;
+-------------------+----------------------+--------------------+---------------------+--+
|    call_center    |   call_center_name   |      manager       |    returns_loss     |
+-------------------+----------------------+--------------------+---------------------+--+
| AAAAAAAAOAAAAAAA  | Mid Atlantic_1       | Clyde Scott        | 47475.020228385925  |
| AAAAAAAAGCAAAAAA  | Mid Atlantic_3       | Michael Morrison   | 46473.94040679932   |
| AAAAAAAAEAAAAAAA  | North Midwest        | Larry Mccray       | 44929.1195640564    |
| AAAAAAAACAAAAAAA  | Mid Atlantic         | Felipe Perkins     | 44344.37002182007   |
| AAAAAAAAHAAAAAAA  | Pacific Northwest    | Alden Snyder       | 43962.44984340668   |
| AAAAAAAAKBAAAAAA  | Mid Atlantic_2       | Rene Sampson       | 42134.28980946541   |
| AAAAAAAAACAAAAAA  | California_2         | Jason Johnson      | 41862.509799957275  |
| AAAAAAAAIAAAAAAA  | California           | Wayne Ray          | 41338.50997543335   |
| AAAAAAAANAAAAAAA  | NY Metro_1           | Jack Little        | 40502.07024002075   |
| AAAAAAAAFCAAAAAA  | NY Metro_3           | Marshall Pate      | 36834.129917144775  |
| AAAAAAAAIAAAAAAA  | California           | Wayne Ray          | 36088.89009666443   |
| AAAAAAAAACAAAAAA  | California_2         | Jason Johnson      | 35767.21017074585   |
| AAAAAAAAHAAAAAAA  | Pacific Northwest    | Alden Snyder       | 35444.219469070435  |
| AAAAAAAACAAAAAAA  | Mid Atlantic         | Felipe Perkins     | 35380.370054244995  |
| AAAAAAAABAAAAAAA  | NY Metro             | Bob Belcher        | 34789.17986679077   |
| AAAAAAAAGBAAAAAA  | Hawaii/Alaska_1      | Travis Wilson      | 33966.129811286926  |
| AAAAAAAADBAAAAAA  | Pacific Northwest_1  | Roderick Walls     | 33836.43033313751   |
| AAAAAAAAICAAAAAA  | North Midwest_3      | Edgar Tate         | 33789.16968917847   |
| AAAAAAAAPBAAAAAA  | Pacific Northwest_2  | Shane Crews        | 33540.57039642334   |
| AAAAAAAAPBAAAAAA  | Pacific Northwest_2  | Shane Crews        | 33445.8000831604    |
| AAAAAAAAABAAAAAA  | North Midwest_1      | Timothy Bourgeois  | 33216.02983093262   |
| AAAAAAAAABAAAAAA  | North Midwest_1      | Timothy Bourgeois  | 31800.07982635498   |
| AAAAAAAAKAAAAAAA  | Hawaii/Alaska        | Gregory Altman     | 31786.21014022827   |
| AAAAAAAACCAAAAAA  | Hawaii/Alaska_2      | Kendall Jones      | 31164.749738693237  |
| AAAAAAAAOAAAAAAA  | Mid Atlantic_1       | Clyde Scott        | 31052.33982181549   |
| AAAAAAAAJBAAAAAA  | NY Metro_2           | Richard James      | 30532.279697418213  |
| AAAAAAAAGCAAAAAA  | Mid Atlantic_3       | Michael Morrison   | 29679.250240325928  |
| AAAAAAAAEBAAAAAA  | California_1         | Jason Brito        | 29454.63988494873   |
| AAAAAAAAFCAAAAAA  | NY Metro_3           | Marshall Pate      | 29189.639919281006  |
| AAAAAAAANAAAAAAA  | NY Metro_1           | Jack Little        | 28902.61018180847   |
| AAAAAAAABAAAAAAA  | NY Metro             | Bob Belcher        | 26646.55001592636   |
| AAAAAAAAMBAAAAAA  | North Midwest_2      | Ryan Burchett      | 26505.23994255066   |
| AAAAAAAAICAAAAAA  | North Midwest_3      | Edgar Tate         | 26248.749835968018  |
| AAAAAAAAGBAAAAAA  | Hawaii/Alaska_1      | Travis Wilson      | 26028.79990196228   |
| AAAAAAAAEBAAAAAA  | California_1         | Jason Brito        | 25554.499940872192  |
| AAAAAAAAEAAAAAAA  | North Midwest        | Larry Mccray       | 25383.06998348236   |
| AAAAAAAAKAAAAAAA  | Hawaii/Alaska        | Gregory Altman     | 23815.289684295654  |
| AAAAAAAAMBAAAAAA  | North Midwest_2      | Ryan Burchett      | 23319.68007659912   |
| AAAAAAAAKBAAAAAA  | Mid Atlantic_2       | Rene Sampson       | 21792.930377960205  |
| AAAAAAAADBAAAAAA  | Pacific Northwest_1  | Roderick Walls     | 19096.949891090393  |
| AAAAAAAACCAAAAAA  | Hawaii/Alaska_2      | Kendall Jones      | 18075.209964752197  |
| AAAAAAAAJBAAAAAA  | NY Metro_2           | Richard James      | 13486.220024108887  |
+-------------------+----------------------+--------------------+---------------------+--+
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
