0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set ambari.hive.db.schema.name=hive;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.file.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.hdfs.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.sortmerge.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.sortmerge.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.abortedtxn.threshold=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.check.interval=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.num.threshold=10;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.pct.threshold=0.1f;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.initiator.on=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.threads=0;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.timeout=86400;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compute.query.using.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.bucketing=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sorting=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sortmergebucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.limit.pushdown.memory.usage=0.04;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.map.aggr=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapjoin.bucket.cache.size=10000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapred.reduce.tasks.speculative.execution=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.cache.pinobjtypes=Table,Database,Type,FieldSchema,Order;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.client.socket.timeout=60;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.execute.setugi=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.warehouse.dir=/apps/hive/warehouse;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin.sortedmerge=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.index.filter=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.optimize.mapjoin.mapreduce=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication.min.reducer=4;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.orc.splits.include.file.footer=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.authorization.enabled=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.metastore.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.semantic.analyzer.factory.impl=org.apache.hivealog.cli.HCatSemanticAnalyzerFactory;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.enable.doAs=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.default.queues=default;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.initialize.default.sessions=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.sessions.per.default.queue=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.autogather=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.max.open.batch=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.timeout=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.execution.enabled=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.checkinterval=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.flush.percent=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.maxentries=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- These values need to be tuned appropriately to your cluster. These examples are for reference.
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.container.size=6144;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.java.opts=-Xmx5120m;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=100000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=320000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask.size=629145600;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=720000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=1920000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.execution.engine=tez;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.default.fileformat=orc;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.cbo.enable=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.fetch.column.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.dynamic.partition.mode=nonstrict;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.auto.reducer.parallelism=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.exec.reducers.bytes.per.reducer=1000000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.reducers.bytes.per.reducer=67108864;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.support.concurrency=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.exec.print.summary=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.min-size=16777216;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.min-size=8388608;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.max-size=1073741824;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.max-size=1342177280;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.split-waves=1.7;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.runtime.io.sort.mb=174;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> with ss as (
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  select i_item_id,sum(ss_ext_sales_price) total_sales
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         store_sales,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         date_dim,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>          customer_address,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>          item
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where item.i_item_id in (select
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      i.i_item_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> from item i
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> where i_color in ('purple','burlywood','indian'))
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     ss_item_sk              = i_item_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     ss_sold_date_sk         = d_date_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     d_year                  = 2001
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     d_moy                   = 1
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     ss_addr_sk              = ca_address_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     ca_gmt_offset           = -6 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  group by i_item_id),
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  cs as (
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  select i_item_id,sum(cs_ext_sales_price) total_sales
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         catalog_sales,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         date_dim,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>          customer_address,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>          item
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>          item.i_item_id               in (select
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>   i.i_item_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> from item i
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> where i_color in ('purple','burlywood','indian'))
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     cs_item_sk              = i_item_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     cs_sold_date_sk         = d_date_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     d_year                  = 2001
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     d_moy                   = 1
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     cs_bill_addr_sk         = ca_address_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     ca_gmt_offset           = -6 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  group by i_item_id),
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  ws as (
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  select i_item_id,sum(ws_ext_sales_price) total_sales
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         web_sales,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         date_dim,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>          customer_address,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>          item
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>          item.i_item_id               in (select
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>   i.i_item_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> from item i
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> where i_color in ('purple','burlywood','indian'))
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     ws_item_sk              = i_item_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     ws_sold_date_sk         = d_date_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     d_year                  = 2001
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     d_moy                   = 1
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     ws_bill_addr_sk         = ca_address_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and     ca_gmt_offset           = -6
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  group by i_item_id)
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>   select  i_item_id ,sum(total_sales) total_sales
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from  (select * from ss 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         union all
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         select * from cs 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         union all
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         select * from ws) tmp1
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  group by i_item_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  order by total_sales
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  limit 100;
+-------------------+---------------------+--+
|     i_item_id     |     total_sales     |
+-------------------+---------------------+--+
| AAAAAAAAOFDDAAAA  | 181353.48143148422  |
| AAAAAAAAMFGEEAAA  | 181370.4996688366   |
| AAAAAAAAIANGCAAA  | 188293.2997698784   |
| AAAAAAAAEEEODAAA  | 190602.40871429443  |
| AAAAAAAAKFMJCAAA  | 193263.62028121948  |
| AAAAAAAALJDDCAAA  | 194145.49000930786  |
| AAAAAAAACGJCEAAA  | 195686.29978179932  |
| AAAAAAAAMFOKDAAA  | 201266.87997460365  |
| AAAAAAAAOKLFDAAA  | 201789.54930973053  |
| AAAAAAAAODKMBAAA  | 202727.11965942383  |
| AAAAAAAAKEMGDAAA  | 202786.04034161568  |
| AAAAAAAAMBAKCAAA  | 203158.75015181303  |
| AAAAAAAABKLCEAAA  | 203852.09021663666  |
| AAAAAAAAOGPLAAAA  | 206337.35849905014  |
| AAAAAAAAEAMADAAA  | 206705.11847794056  |
| AAAAAAAAEAPCBAAA  | 208843.82965564728  |
| AAAAAAAACIEDDAAA  | 208935.94039416313  |
| AAAAAAAAOENABAAA  | 209542.86856746674  |
| AAAAAAAAGLDBEAAA  | 209760.37138092518  |
| AAAAAAAAKFLHCAAA  | 210693.00944948196  |
| AAAAAAAADAGPBAAA  | 210705.11061668396  |
| AAAAAAAAOLDJDAAA  | 210710.2615776062   |
| AAAAAAAAJNGFEAAA  | 210973.0790681839   |
| AAAAAAAAGFKACAAA  | 211520.41100525856  |
| AAAAAAAAEBCMBAAA  | 211607.94007730484  |
| AAAAAAAAGEJABAAA  | 212106.9911994934   |
| AAAAAAAAALKHEAAA  | 212129.80063581467  |
| AAAAAAAAIHKBAAAA  | 213139.8404185772   |
| AAAAAAAAAKNPDAAA  | 213371.33050012589  |
| AAAAAAAAKPEBBAAA  | 213675.62058591843  |
| AAAAAAAAKIGPCAAA  | 214114.96990776062  |
| AAAAAAAAKBEABAAA  | 214281.13095521927  |
| AAAAAAAACPPCDAAA  | 214579.8101835251   |
| AAAAAAAAKPLABAAA  | 215531.53060150146  |
| AAAAAAAAEJHFAAAA  | 215816.591293931    |
| AAAAAAAAGCNCAAAA  | 216407.4884661436   |
| AAAAAAAAAHKGAAAA  | 216759.80976200104  |
| AAAAAAAAOMIGDAAA  | 217129.0400915146   |
| AAAAAAAAIGDCBAAA  | 217700.6994550228   |
| AAAAAAAAMBAOBAAA  | 217798.87989735603  |
| AAAAAAAABBJHEAAA  | 217960.11981201172  |
| AAAAAAAAMCBAEAAA  | 218521.86983799934  |
| AAAAAAAAOKCKBAAA  | 218927.78877067566  |
| AAAAAAAAKCLKCAAA  | 219144.01900482178  |
| AAAAAAAAGAJCDAAA  | 219178.7999768257   |
| AAAAAAAAMMMCDAAA  | 219192.11932563782  |
| AAAAAAAAIMHMBAAA  | 219237.51944816113  |
| AAAAAAAAKPPMBAAA  | 219744.23107624054  |
| AAAAAAAAAJEPBAAA  | 219832.70069885254  |
| AAAAAAAAEOMBBAAA  | 220231.38190054893  |
| AAAAAAAAOCMLBAAA  | 220694.649433136    |
| AAAAAAAAKGEGCAAA  | 220855.86968274415  |
| AAAAAAAAEKPFAAAA  | 220989.4391860962   |
| AAAAAAAAANAFCAAA  | 221029.97970199585  |
| AAAAAAAALMHNAAAA  | 221089.2196855545   |
| AAAAAAAAMPMCCAAA  | 221096.71047091484  |
| AAAAAAAAEDPMAAAA  | 221662.1695369482   |
| AAAAAAAAKGBGCAAA  | 221779.01067829132  |
| AAAAAAAAAOLIEAAA  | 222122.0595855713   |
| AAAAAAAAHDEODAAA  | 222142.46940517426  |
| AAAAAAAAFPGJCAAA  | 222283.92874383926  |
| AAAAAAAACMIDDAAA  | 223484.8301229477   |
| AAAAAAAAGJIECAAA  | 223561.96033620834  |
| AAAAAAAAJLBAEAAA  | 224273.78002929688  |
| AAAAAAAAKMLHDAAA  | 224559.7789516449   |
| AAAAAAAAALKDCAAA  | 224731.7810666561   |
| AAAAAAAAMNJIBAAA  | 224974.37086868286  |
| AAAAAAAAEDINBAAA  | 224991.2201743126   |
| AAAAAAAAOCBNBAAA  | 224995.95984360576  |
| AAAAAAAAGHNEBAAA  | 225139.5904598236   |
| AAAAAAAAHKCMAAAA  | 225666.68947148323  |
| AAAAAAAAALBICAAA  | 225996.29104709625  |
| AAAAAAAAMNDOCAAA  | 226185.57055163383  |
| AAAAAAAABPIDEAAA  | 226389.16978645325  |
| AAAAAAAAPGNDDAAA  | 226393.45019984245  |
| AAAAAAAAKKJFDAAA  | 226926.2309627533   |
| AAAAAAAAGPKPDAAA  | 226953.16871023178  |
| AAAAAAAAMMFCEAAA  | 226958.22900867462  |
| AAAAAAAANFBIBAAA  | 227006.15011167526  |
| AAAAAAAAKIEPAAAA  | 227108.74892401695  |
| AAAAAAAAABDDDAAA  | 227159.34899806976  |
| AAAAAAAAKBMBEAAA  | 227278.2405796051   |
| AAAAAAAACBKOCAAA  | 227474.09838724136  |
| AAAAAAAAEKGGAAAA  | 227664.08911848068  |
| AAAAAAAAOOHKBAAA  | 227870.9601573944   |
| AAAAAAAAOKIHBAAA  | 227885.38061141968  |
| AAAAAAAADENDCAAA  | 228003.0598540306   |
| AAAAAAAAADLFDAAA  | 228045.34934830666  |
| AAAAAAAADNINDAAA  | 228114.67194080353  |
| AAAAAAAAEDJEAAAA  | 228514.33925676346  |
| AAAAAAAACHIPCAAA  | 228654.83957386017  |
| AAAAAAAAOFACEAAA  | 228680.70044517517  |
| AAAAAAAAAMJFDAAA  | 228802.79979896545  |
| AAAAAAAAGGBFCAAA  | 228971.85960054398  |
| AAAAAAAAJKNCAAAA  | 229301.57981729507  |
| AAAAAAAANOGMBAAA  | 229403.19022512436  |
| AAAAAAAAEIGPBAAA  | 229564.13028240204  |
| AAAAAAAADCFGDAAA  | 229713.09939289093  |
| AAAAAAAACDGLDAAA  | 229935.11107182503  |
| AAAAAAAAIHIJDAAA  | 230147.33809357882  |
+-------------------+---------------------+--+
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
