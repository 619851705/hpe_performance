0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set ambari.hive.db.schema.name=hive;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.file.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.hdfs.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.sortmerge.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.sortmerge.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.abortedtxn.threshold=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.check.interval=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.num.threshold=10;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.pct.threshold=0.1f;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.initiator.on=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.threads=0;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.timeout=86400;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compute.query.using.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.bucketing=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sorting=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sortmergebucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.limit.pushdown.memory.usage=0.04;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.map.aggr=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapjoin.bucket.cache.size=10000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapred.reduce.tasks.speculative.execution=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.cache.pinobjtypes=Table,Database,Type,FieldSchema,Order;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.client.socket.timeout=60;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.execute.setugi=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.warehouse.dir=/apps/hive/warehouse;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin.sortedmerge=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.index.filter=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.optimize.mapjoin.mapreduce=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication.min.reducer=4;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.orc.splits.include.file.footer=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.authorization.enabled=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.metastore.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.semantic.analyzer.factory.impl=org.apache.hivealog.cli.HCatSemanticAnalyzerFactory;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.enable.doAs=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.default.queues=default;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.initialize.default.sessions=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.sessions.per.default.queue=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.autogather=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.max.open.batch=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.timeout=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.execution.enabled=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.checkinterval=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.flush.percent=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.maxentries=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- These values need to be tuned appropriately to your cluster. These examples are for reference.
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.container.size=6144;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.java.opts=-Xmx5120m;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=100000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=320000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask.size=629145600;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=720000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=1920000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.execution.engine=tez;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.default.fileformat=orc;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.cbo.enable=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.fetch.column.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.dynamic.partition.mode=nonstrict;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.auto.reducer.parallelism=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.exec.reducers.bytes.per.reducer=1000000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.reducers.bytes.per.reducer=67108864;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.support.concurrency=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.exec.print.summary=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.min-size=16777216;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.min-size=8388608;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.max-size=1073741824;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.max-size=1342177280;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.split-waves=1.7;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.runtime.io.sort.mb=174;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> select  i_brand_id brand_id, i_brand brand, i_manufact_id, i_manufact,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  sum(ss_ext_sales_price) ext_price
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from date_dim, store_sales, item,customer,customer_address,store
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where date_dim.d_date_sk = store_sales.ss_sold_date_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>    and store_sales.ss_item_sk = item.i_item_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>    and i_manager_id=7
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>    and d_moy=11
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>    and d_year=1999
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>    and store_sales.ss_customer_sk = customer.c_customer_sk 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>    and customer.c_current_addr_sk = customer_address.ca_address_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>    and substr(ca_zip,1,5) <> substr(s_zip,1,5) 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>    and store_sales.ss_store_sk = store.s_store_sk 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  group by i_brand
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>       ,i_brand_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>       ,i_manufact_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>       ,i_manufact
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  order by ext_price desc
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>          ,i_brand
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>          ,i_brand_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>          ,i_manufact_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>          ,i_manufact
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> limit 100 ;
+-----------+------------------------+----------------+------------------+---------------------+--+
| brand_id  |         brand          | i_manufact_id  |    i_manufact    |      ext_price      |
+-----------+------------------------+----------------+------------------+---------------------+--+
| 2004001   | edu packimporto #1     | 217            | ationoughtable   | 2331035.5575328767  |
| 3001001   | amalgexporti #1        | 30             | barpri           | 2281508.910106778   |
| 3002002   | importoexporti #2      | 215            | antioughtable    | 2272472.310425639   |
| 5003001   | exportischolar #1      | 108            | eingbarought     | 2240793.941549897   |
| 3003001   | exportiexporti #1      | 128            | eingableought    | 2229065.0323474407  |
| 2002001   | importoimporto #1      | 249            | n steseable      | 2207176.403924674   |
| 4003001   | exportiedu pack #1     | 129            | n stableought    | 2200090.0057754517  |
| 5004001   | edu packscholar #1     | 158            | eingantiought    | 2198264.291111633   |
| 1002001   | importoamalg #1        | 236            | callypriable     | 2196916.747720003   |
| 2003002   | exportiimporto #2      | 323            | priablepri       | 2191814.029996693   |
| 2004001   | edu packimporto #1     | 126            | callyableought   | 2189617.8581553698  |
| 5004001   | edu packscholar #1     | 111            | oughtoughtought  | 2185710.6219819784  |
| 2004002   | edu packimporto #2     | 154            | eseantiought     | 2183707.239125252   |
| 2002001   | importoimporto #1      | 126            | callyableought   | 2183465.928130716   |
| 5001001   | amalgscholar #1        | 97             | ationn st        | 2181115.1001080573  |
| 5002001   | importoscholar #1      | 69             | n stcally        | 2178232.2024309635  |
| 1004001   | edu packamalg #1       | 311            | oughtoughtpri    | 2160688.332513571   |
| 1003001   | exportiamalg #1        | 202            | ablebarable      | 2147305.982738495   |
| 1001001   | amalgamalg #1          | 9              | n st             | 2137522.03854537    |
| 5001001   | amalgscholar #1        | 404            | esebarese        | 2133596.1799500585  |
| 4003001   | exportiedu pack #1     | 153            | priantiought     | 2123984.821292639   |
| 2004001   | edu packimporto #1     | 218            | eingoughtable    | 2121440.5758211613  |
| 1004001   | edu packamalg #1       | 108            | eingbarought     | 2116214.5348387957  |
| 6002001   | importocorp #1         | 126            | callyableought   | 2115802.4999297857  |
| 4004001   | edu packedu pack #1    | 246            | callyeseable     | 2112440.7329051495  |
| 3002001   | importoexporti #1      | 295            | antin stable     | 2100032.657754779   |
| 3001001   | amalgexporti #1        | 14             | eseought         | 2097383.287474394   |
| 1003001   | exportiamalg #1        | 397            | ationn stpri     | 2090875.6942481995  |
| 3002002   | importoexporti #2      | 330            | barpripri        | 2074679.9109082222  |
| 4004001   | edu packedu pack #1    | 378            | eingationpri     | 2067424.6700907946  |
| 1001001   | amalgamalg #1          | 180            | bareingought     | 2048503.784573555   |
| 3002002   | importoexporti #2      | 22             | ableable         | 2045406.5478816032  |
| 5002001   | importoscholar #1      | 280            | bareingable      | 2043570.9994921684  |
| 2004001   | edu packimporto #1     | 263            | pricallyable     | 2037782.2511014938  |
| 2004001   | edu packimporto #1     | 54             | eseanti          | 2030211.0578666925  |
| 3003001   | exportiexporti #1      | 149            | n steseought     | 2018884.5598489642  |
| 5001001   | amalgscholar #1        | 29             | n stable         | 1998481.981817007   |
| 3002001   | importoexporti #1      | 104            | esebarought      | 1966471.6938979626  |
| 10010017  | univamalgamalg #17     | 239            | n stpriable      | 1322798.8305792809  |
| 3004001   | edu packexporti #1     | 468            | eingcallyese     | 1303044.9683897495  |
| 4003002   | exportiedu pack #2     | 95             | antin st         | 1298283.8989538252  |
| 1001001   | amalgamalg #1          | 38             | eingpri          | 1283418.9663443267  |
| 6016005   | corpbrand #5           | 393            | prin stpri       | 1282698.8180186749  |
| 3002001   | importoexporti #1      | 971            | oughtationn st   | 1282021.6458420157  |
| 10003005  | exportiunivamalg #5    | 385            | antieingpri      | 1281416.3374402523  |
| 9005009   | scholarmaxi #9         | 338            | eingpripri       | 1280240.0791395903  |
| NULL      |                        | 513            | prioughtanti     | 1279705.4833652526  |
| 10015002  | scholaramalgamalg #2   | 121            | oughtableought   | 1279488.0722600222  |
| 1003001   | exportiamalg #1        | 311            | oughtoughtpri    | 1279091.1711893082  |
| 2003001   | exportiimporto #1      | 310            | baroughtpri      | 1278979.3285882473  |
| 1002001   | importoamalg #1        | 365            | anticallypri     | 1276101.2080203295  |
| 2001002   | amalgimporto #2        | 1              | ought            | 1269608.321104288   |
| 5001001   | amalgscholar #1        | 211            | oughtoughtable   | 1266794.3089311123  |
| 8004005   | edu packnameless #5    | 172            | ableationought   | 1263390.3393399715  |
| 5002001   | importoscholar #1      | 127            | ationableought   | 1258226.5113126934  |
| 3001001   | amalgexporti #1        | 121            | oughtableought   | 1257568.0315761566  |
| 10008011  | namelessunivamalg #11  | 94             | esen st          | 1255537.9408768713  |
| 3003001   | exportiexporti #1      | 194            | esen stought     | 1254708.3204421997  |
| 6009003   | maxicorp #3            | 50             | baranti          | 1252833.6489464045  |
| 10007008  | brandunivamalg #8      | 183            | prieingought     | 1250636.002032876   |
| 3003001   | exportiexporti #1      | 216            | callyoughtable   | 1250502.790844202   |
| 9003011   | exportimaxi #11        | 24             | eseable          | 1248276.6703317165  |
| 9014003   | edu packunivamalg #3   | 73             | priation         | 1247993.4976714551  |
| 5004001   | edu packscholar #1     | 322            | ableablepri      | 1247876.2515906692  |
| 7012007   | importonameless #7     | 449            | n steseese       | 1247006.981329918   |
| 4004001   | edu packedu pack #1    | 32             | ablepri          | 1246633.575872749   |
| 2002001   | importoimporto #1      | 514            | eseoughtanti     | 1246372.1106250882  |
| 10002002  | importounivamalg #2    | 50             | baranti          | 1245003.9679325968  |
| 4004001   | edu packedu pack #1    | 493            | prin stese       | 1243658.3906121254  |
| 6013006   | exportibrand #6        | 972            | ableationn st    | 1243365.28029567    |
| 7012004   | importonameless #4     | 147            | ationeseought    | 1242073.4801831245  |
| 4002001   | importoedu pack #1     | 782            | ableeingation    | 1239774.2787938118  |
| 5001002   | amalgscholar #2        | 296            | callyn stable    | 1237441.7709102035  |
| 9002009   | importomaxi #9         | 681            | oughteingcally   | 1237394.7739670277  |
| 3003002   | exportiexporti #2      | 558            | eingantianti     | 1237365.1012111902  |
| 4004002   | edu packedu pack #2    | 297            | ationn stable    | 1237027.57918185    |
| 5001001   | amalgscholar #1        | 89             | n steing         | 1235870.3137096763  |
| 3002001   | importoexporti #1      | 608            | eingbarcally     | 1233963.089266777   |
| 9010002   | univunivamalg #2       | 6              | cally            | 1233723.102256894   |
| 7009004   | maxibrand #4           | 46             | callyese         | 1231571.038583517   |
| 5004002   | edu packscholar #2     | 494            | esen stese       | 1228886.360759616   |
| 10004007  | edu packunivamalg #7   | 487            | ationeingese     | 1228485.33805871    |
| 4004001   | edu packedu pack #1    | 854            | eseantieing      | 1228169.039121151   |
| 5001001   | amalgscholar #1        | 421            | oughtableese     | 1228071.3876714706  |
| 8012001   | importomaxi #1         | 743            | prieseation      | 1226909.7393636703  |
| 3003001   | exportiexporti #1      | 220            | barableable      | 1226748.7203263342  |
| 5002001   | importoscholar #1      | 22             | ableable         | 1226510.0309772491  |
| 2003001   | exportiimporto #1      | 177            | ationationought  | 1225275.6402465105  |
| 9013009   | exportiunivamalg #9    | 535            | antiprianti      | 1224946.6971783936  |
| 10007009  | brandunivamalg #9      | 327            | ationablepri     | 1224851.6673235893  |
| 3004002   | edu packexporti #2     | 182            | ableeingought    | 1224302.267692089   |
| 2001001   | amalgimporto #1        | 106            | callybarought    | 1223392.7227900028  |
| 6010005   | univbrand #5           | 580            | bareinganti      | 1223062.1215612888  |
| 8013005   | exportimaxi #5         | 245            | antieseable      | 1222091.7632693052  |
| 4004001   | edu packedu pack #1    | 69             | n stcally        | 1220888.9907712936  |
| 8016005   | corpmaxi #5            | 408            | eingbarese       | 1220255.6095705032  |
| 7001007   | amalgbrand #7          | 170            | barationought    | 1220055.7379813194  |
| 1001002   | amalgamalg #2          | 32             | ablepri          | 1219917.15731287    |
| 5001001   | amalgscholar #1        | 10             | barought         | 1218517.1196358204  |
| 4004001   | edu packedu pack #1    | 781            | oughteingation   | 1218288.0469580889  |
+-----------+------------------------+----------------+------------------+---------------------+--+
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
