0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set ambari.hive.db.schema.name=hive;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.file.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set fs.hdfs.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.sortmerge.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.sortmerge.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.abortedtxn.threshold=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.check.interval=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.num.threshold=10;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.delta.pct.threshold=0.1f;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.initiator.on=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.threads=0;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compactor.worker.timeout=86400;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.compute.query.using.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.bucketing=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sorting=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.enforce.sortmergebucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.limit.pushdown.memory.usage=0.04;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.map.aggr=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapjoin.bucket.cache.size=10000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.mapred.reduce.tasks.speculative.execution=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.cache.pinobjtypes=Table,Database,Type,FieldSchema,Order;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.client.socket.timeout=60;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.execute.setugi=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.metastore.warehouse.dir=/apps/hive/warehouse;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin.sortedmerge=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.bucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.index.filter=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.optimize.mapjoin.mapreduce=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication.min.reducer=4;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.optimize.reducededuplication=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.orc.splits.include.file.footer=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.authorization.enabled=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.security.metastore.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.semantic.analyzer.factory.impl=org.apache.hivealog.cli.HCatSemanticAnalyzerFactory;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.enable.doAs=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.default.queues=default;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.initialize.default.sessions=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.server2.tez.sessions.per.default.queue=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.autogather=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.max.open.batch=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.timeout=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.execution.enabled=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.checkinterval=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.flush.percent=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.vectorized.groupby.maxentries=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- These values need to be tuned appropriately to your cluster. These examples are for reference.
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.container.size=6144;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.java.opts=-Xmx5120m;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=100000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.join.noconditionaltask.size=320000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.auto.convert.join.noconditionaltask.size=629145600;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=720000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=1920000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.execution.engine=tez;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.default.fileformat=orc;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.cbo.enable=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.stats.fetch.column.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.dynamic.partition.mode=nonstrict;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.auto.reducer.parallelism=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.exec.reducers.bytes.per.reducer=1000000000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.exec.reducers.bytes.per.reducer=67108864;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.support.concurrency=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set hive.tez.exec.print.summary=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.min-size=16777216;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.min-size=8388608;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.grouping.max-size=1073741824;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.max-size=1342177280;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set tez.grouping.split-waves=1.7;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> set tez.runtime.io.sort.mb=174;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> select  dt.d_year
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  ,item.i_brand_id brand_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  ,item.i_brand brand
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  ,sum(ss_ext_sales_price) ext_price
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from date_dim dt
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      ,store_sales
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      ,item
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where dt.d_date_sk = store_sales.ss_sold_date_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>     and store_sales.ss_item_sk = item.i_item_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>     and item.i_manager_id = 1
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>     and dt.d_moy=12
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>     and dt.d_year=1998
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  group by dt.d_year
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  ,item.i_brand
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  ,item.i_brand_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  order by dt.d_year
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  ,ext_price desc
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  ,brand_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> limit 100 ;
+------------+-----------+-----------------------+-----------------------+--+
| dt.d_year  | brand_id  |         brand         |       ext_price       |
+------------+-----------+-----------------------+-----------------------+--+
| 1998       | 2002001   | importoimporto #1     | 6.098463131351534E7   |
| 1998       | 3004001   | edu packexporti #1    | 6.011117042980234E7   |
| 1998       | 3001001   | amalgexporti #1       | 5.676672225288677E7   |
| 1998       | 4003001   | exportiedu pack #1    | 5.56064286052946E7    |
| 1998       | 1003001   | exportiamalg #1       | 5.51781510400915E7    |
| 1998       | 1004001   | edu packamalg #1      | 5.47933559174422E7    |
| 1998       | 3003001   | exportiexporti #1     | 5.339947558259031E7   |
| 1998       | 1001001   | amalgamalg #1         | 5.209755914122999E7   |
| 1998       | 3002001   | importoexporti #1     | 5.183466653596376E7   |
| 1998       | 4002001   | importoedu pack #1    | 5.0884724761021316E7  |
| 1998       | 2003001   | exportiimporto #1     | 5.048205743164058E7   |
| 1998       | 2001001   | amalgimporto #1       | 5.038759811497614E7   |
| 1998       | 4004001   | edu packedu pack #1   | 4.990904585987228E7   |
| 1998       | 4001001   | amalgedu pack #1      | 4.872578218154373E7   |
| 1998       | 5001001   | amalgscholar #1       | 4.831657987403941E7   |
| 1998       | 1002001   | importoamalg #1       | 4.794656106721327E7   |
| 1998       | 5003001   | exportischolar #1     | 4.15488757921723E7    |
| 1998       | 5004001   | edu packscholar #1    | 4.0231557314146705E7  |
| 1998       | 2004001   | edu packimporto #1    | 3.815834930328443E7   |
| 1998       | 2001002   | amalgimporto #2       | 3.721124784155439E7   |
| 1998       | 2004002   | edu packimporto #2    | 3.646991824841569E7   |
| 1998       | 5002001   | importoscholar #1     | 3.608698740284851E7   |
| 1998       | 5003002   | exportischolar #2     | 3.5994562157394305E7  |
| 1998       | 1001002   | amalgamalg #2         | 3.597124387191881E7   |
| 1998       | 3002002   | importoexporti #2     | 3.3858300584058195E7  |
| 1998       | 2003002   | exportiimporto #2     | 3.180042336122273E7   |
| 1998       | 1004002   | edu packamalg #2      | 3.0881325293107226E7  |
| 1998       | 3003002   | exportiexporti #2     | 3.0174646959746137E7  |
| 1998       | 1003002   | exportiamalg #2       | 2.843326035086429E7   |
| 1998       | 5001002   | amalgscholar #2       | 2.82282939111883E7    |
| 1998       | 3001002   | amalgexporti #2       | 2.7737024297790825E7  |
| 1998       | 4004002   | edu packedu pack #2   | 2.7679235107740656E7  |
| 1998       | 4003002   | exportiedu pack #2    | 2.7248814372177947E7  |
| 1998       | 3004002   | edu packexporti #2    | 2.5587576076474067E7  |
| 1998       | 4002002   | importoedu pack #2    | 2.1863774793694824E7  |
| 1998       | 5004002   | edu packscholar #2    | 2.003506430635616E7   |
| 1998       | 1002002   | importoamalg #2       | 1.9654257716118082E7  |
| 1998       | 4001002   | amalgedu pack #2      | 1.883472481829688E7   |
| 1998       | 2002002   | importoimporto #2     | 1.8658806352681756E7  |
| 1998       | 5002002   | importoscholar #2     | 1.6891158676385313E7  |
| 1998       | 6005001   | scholarcorp #1        | 9673045.216237545     |
| 1998       | 7001005   | amalgbrand #5         | 9368560.427426815     |
| 1998       | 8004005   | edu packnameless #5   | 9001567.586791709     |
| 1998       | 7016001   | corpnameless #1       | 8436747.106446475     |
| 1998       | 6016003   | corpbrand #3          | 8070841.627916604     |
| 1998       | 8006009   | corpnameless #9       | 7985370.198919237     |
| 1998       | 9014008   | edu packunivamalg #8  | 7185436.716488868     |
| 1998       | 9015002   | scholarunivamalg #2   | 7038653.2103229165    |
| 1998       | 10003004  | exportiunivamalg #4   | 7002228.067090452     |
| 1998       | 9011008   | amalgunivamalg #8     | 6950478.593426228     |
| 1998       | 9009002   | maximaxi #2           | 6925216.735161006     |
| 1998       | 6011003   | amalgbrand #3         | 6909935.36584872      |
| 1998       | 7012005   | importonameless #5    | 6725613.8355048895    |
| 1998       | 9003005   | exportimaxi #5        | 6650964.820457503     |
| 1998       | 6003005   | exporticorp #5        | 6145373.556344569     |
| 1998       | 7004009   | edu packbrand #9      | 6094928.2595267445    |
| 1998       | 8008003   | namelessnameless #3   | 6088956.74293071      |
| 1998       | 9007008   | brandmaxi #8          | 6088732.402515531     |
| 1998       | 7010008   | univnameless #8       | 6041257.937778711     |
| 1998       | 9015005   | scholarunivamalg #5   | 6001648.053745493     |
| 1998       | 8013007   | exportimaxi #7        | 5933970.336485103     |
| 1998       | 6003003   | exporticorp #3        | 5838916.409469724     |
| 1998       | 7006006   | corpbrand #6          | 5804028.978154898     |
| 1998       | 9006009   | corpmaxi #9           | 5793255.7583258       |
| 1998       | 9003008   | exportimaxi #8        | 5776092.297464013     |
| 1998       | 6010007   | univbrand #7          | 5774231.432068229     |
| 1998       | 8008007   | namelessnameless #7   | 5763478.322470784     |
| 1998       | 9004005   | edu packmaxi #5       | 5727385.833759755     |
| 1998       | 7007004   | brandbrand #4         | 5727332.512819946     |
| 1998       | 7007005   | brandbrand #5         | 5713505.418715835     |
| 1998       | 9011009   | amalgunivamalg #9     | 5677581.000686407     |
| 1998       | 7001007   | amalgbrand #7         | 5666635.779306576     |
| 1998       | 7011001   | amalgnameless #1      | 5650732.067923173     |
| 1998       | 9013009   | exportiunivamalg #9   | 5611874.124953598     |
| 1998       | 9002002   | importomaxi #2        | 5607002.839238912     |
| 1998       | 9001009   | amalgmaxi #9          | 5603889.259958893     |
| 1998       | 6013007   | exportibrand #7       | 5490732.787801385     |
| 1998       | 8004003   | edu packnameless #3   | 5451502.153662562     |
| 1998       | 9006005   | corpmaxi #5           | 5424759.289910197     |
| 1998       | 7014001   | edu packnameless #1   | 4934533.097640842     |
| 1998       | 6015006   | scholarbrand #6       | 4886271.192836747     |
| 1998       | 8015009   | scholarmaxi #9        | 4864853.705193371     |
| 1998       | 7010009   | univnameless #9       | 4862699.698382169     |
| 1998       | 7014009   | edu packnameless #9   | 4848502.472005457     |
| 1998       | 10006003  | corpunivamalg #3      | 4801454.238798678     |
| 1998       | 6006003   | corpcorp #3           | 4781830.656355143     |
| 1998       | 6001007   | amalgcorp #7          | 4750764.975469381     |
| 1998       | 7006001   | corpbrand #1          | 4746295.879732728     |
| 1998       | 9015011   | scholarunivamalg #11  | 4745143.167606354     |
| 1998       | 6004007   | edu packcorp #7       | 4739950.295130968     |
| 1998       | 6001001   | amalgcorp #1          | 4739450.0508803725    |
| 1998       | 9006011   | corpmaxi #11          | 4731213.921513855     |
| 1998       | 7016009   | corpnameless #9       | 4731142.39111805      |
| 1998       | 8005001   | scholarnameless #1    | 4719052.8842116445    |
| 1998       | 9004008   | edu packmaxi #8       | 4718353.559403539     |
| 1998       | 6010002   | univbrand #2          | 4716878.36714375      |
| 1998       | 9015003   | scholarunivamalg #3   | 4708362.305868208     |
| 1998       | 8011005   | amalgmaxi #5          | 4695730.10342741      |
| 1998       | 8012007   | importomaxi #7        | 4691617.207428485     |
| 1998       | 6014003   | edu packbrand #3      | 4681973.767710775     |
+------------+-----------+-----------------------+-----------------------+--+
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
