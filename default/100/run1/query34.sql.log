15/04/06 19:58:17 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 19:58:17 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 19:58:17 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 19:58:17 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query34.sql;
OK
Time taken: 2.942 seconds
Query ID = root_20150406195858_c8b24ac4-e847-423d-89d7-09150c1db2f1
Total jobs = 2
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 19:58:45 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 19:58:45 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 19:58:45 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 19:58:45 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406195858_c8b24ac4-e847-423d-89d7-09150c1db2f1.log
2015-04-06 07:58:46	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 07:58:51	Dump the side-table for tag: 1 with group count: 1040 into file: file:/tmp/root/15956540-a4ae-41e9-a698-70e6ae9ede5d/hive_2015-04-06_19-58-25_085_581498070070197769-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile11--.hashtable
2015-04-06 07:58:51	Uploaded 1 File to: file:/tmp/root/15956540-a4ae-41e9-a698-70e6ae9ede5d/hive_2015-04-06_19-58-25_085_581498070070197769-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile11--.hashtable (35270 bytes)
2015-04-06 07:58:51	Dump the side-table for tag: 1 with group count: 99 into file: file:/tmp/root/15956540-a4ae-41e9-a698-70e6ae9ede5d/hive_2015-04-06_19-58-25_085_581498070070197769-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile21--.hashtable
2015-04-06 07:58:51	Uploaded 1 File to: file:/tmp/root/15956540-a4ae-41e9-a698-70e6ae9ede5d/hive_2015-04-06_19-58-25_085_581498070070197769-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile21--.hashtable (3859 bytes)
2015-04-06 07:58:51	Dump the side-table for tag: 1 with group count: 252 into file: file:/tmp/root/15956540-a4ae-41e9-a698-70e6ae9ede5d/hive_2015-04-06_19-58-25_085_581498070070197769-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile31--.hashtable
2015-04-06 07:58:51	Uploaded 1 File to: file:/tmp/root/15956540-a4ae-41e9-a698-70e6ae9ede5d/hive_2015-04-06_19-58-25_085_581498070070197769-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile31--.hashtable (6845 bytes)
2015-04-06 07:58:51	End of local task; Time Taken: 4.709 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 2
Number of reduce tasks not specified. Estimated from input data size: 179
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0058, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0058/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0058
Hadoop job information for Stage-2: number of mappers: 46; number of reducers: 179
2015-04-06 19:59:10,512 Stage-2 map = 0%,  reduce = 0%
2015-04-06 19:59:29,089 Stage-2 map = 1%,  reduce = 0%, Cumulative CPU 37.71 sec
2015-04-06 19:59:30,166 Stage-2 map = 5%,  reduce = 0%, Cumulative CPU 211.83 sec
2015-04-06 19:59:32,311 Stage-2 map = 10%,  reduce = 0%, Cumulative CPU 293.59 sec
2015-04-06 19:59:33,387 Stage-2 map = 23%,  reduce = 0%, Cumulative CPU 474.4 sec
2015-04-06 19:59:35,530 Stage-2 map = 28%,  reduce = 0%, Cumulative CPU 506.99 sec
2015-04-06 19:59:36,607 Stage-2 map = 42%,  reduce = 0%, Cumulative CPU 596.94 sec
2015-04-06 19:59:38,753 Stage-2 map = 52%,  reduce = 0%, Cumulative CPU 636.02 sec
2015-04-06 19:59:39,798 Stage-2 map = 70%,  reduce = 0%, Cumulative CPU 722.12 sec
2015-04-06 19:59:40,843 Stage-2 map = 74%,  reduce = 0%, Cumulative CPU 730.92 sec
2015-04-06 19:59:41,914 Stage-2 map = 84%,  reduce = 0%, Cumulative CPU 753.73 sec
2015-04-06 19:59:42,959 Stage-2 map = 93%,  reduce = 0%, Cumulative CPU 797.35 sec
2015-04-06 19:59:44,033 Stage-2 map = 98%,  reduce = 0%, Cumulative CPU 807.01 sec
2015-04-06 19:59:46,185 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 813.61 sec
2015-04-06 19:59:47,237 Stage-2 map = 100%,  reduce = 16%, Cumulative CPU 884.7 sec
2015-04-06 19:59:48,276 Stage-2 map = 100%,  reduce = 37%, Cumulative CPU 990.19 sec
2015-04-06 19:59:49,330 Stage-2 map = 100%,  reduce = 44%, Cumulative CPU 1020.77 sec
2015-04-06 19:59:50,378 Stage-2 map = 100%,  reduce = 49%, Cumulative CPU 1046.48 sec
2015-04-06 19:59:51,422 Stage-2 map = 100%,  reduce = 54%, Cumulative CPU 1066.55 sec
2015-04-06 19:59:52,469 Stage-2 map = 100%,  reduce = 79%, Cumulative CPU 1178.08 sec
2015-04-06 19:59:53,515 Stage-2 map = 100%,  reduce = 90%, Cumulative CPU 1224.52 sec
2015-04-06 19:59:54,570 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 1270.21 sec
MapReduce Total cumulative CPU time: 21 minutes 10 seconds 210 msec
Ended Job = job_1428164231378_0058
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 20:00:01 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 20:00:01 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 20:00:01 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 20:00:01 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406195858_c8b24ac4-e847-423d-89d7-09150c1db2f1.log
2015-04-06 08:00:02	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 08:00:09	Processing rows:	200000	Hashtable size:	199999	Memory usage:	95058016	percentage:	0.089
2015-04-06 08:00:10	Processing rows:	300000	Hashtable size:	299999	Memory usage:	138743752	percentage:	0.13
2015-04-06 08:00:12	Processing rows:	400000	Hashtable size:	399999	Memory usage:	177845400	percentage:	0.167
2015-04-06 08:00:13	Processing rows:	500000	Hashtable size:	499999	Memory usage:	219143864	percentage:	0.206
2015-04-06 08:00:14	Processing rows:	600000	Hashtable size:	599999	Memory usage:	264619424	percentage:	0.248
2015-04-06 08:00:15	Processing rows:	700000	Hashtable size:	699999	Memory usage:	306061448	percentage:	0.287
2015-04-06 08:00:16	Processing rows:	800000	Hashtable size:	799999	Memory usage:	347107544	percentage:	0.326
2015-04-06 08:00:18	Processing rows:	900000	Hashtable size:	899999	Memory usage:	388962840	percentage:	0.365
2015-04-06 08:00:19	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	449745528	percentage:	0.422
2015-04-06 08:00:20	Processing rows:	1100000	Hashtable size:	1099999	Memory usage:	490963576	percentage:	0.461
2015-04-06 08:00:21	Processing rows:	1200000	Hashtable size:	1199999	Memory usage:	530911528	percentage:	0.498
2015-04-06 08:00:22	Processing rows:	1300000	Hashtable size:	1299999	Memory usage:	572235264	percentage:	0.537
2015-04-06 08:00:22	Processing rows:	1400000	Hashtable size:	1399999	Memory usage:	613762424	percentage:	0.576
2015-04-06 08:00:24	Processing rows:	1500000	Hashtable size:	1499999	Memory usage:	654834360	percentage:	0.615
2015-04-06 08:00:24	Processing rows:	1600000	Hashtable size:	1599999	Memory usage:	695214032	percentage:	0.652
2015-04-06 08:00:25	Processing rows:	1700000	Hashtable size:	1699999	Memory usage:	735970376	percentage:	0.691
2015-04-06 08:00:25	Processing rows:	1800000	Hashtable size:	1799999	Memory usage:	778817976	percentage:	0.731
2015-04-06 08:00:28	Processing rows:	1900000	Hashtable size:	1899999	Memory usage:	802899256	percentage:	0.754
2015-04-06 08:00:29	Processing rows:	2000000	Hashtable size:	1999999	Memory usage:	842752112	percentage:	0.791
2015-04-06 08:00:29	Dump the side-table for tag: 1 with group count: 2000000 into file: file:/tmp/root/15956540-a4ae-41e9-a698-70e6ae9ede5d/hive_2015-04-06_19-58-25_085_581498070070197769-1/-local-10009/HashTable-Stage-4/MapJoin-mapfile01--.hashtable
2015-04-06 08:00:31	Uploaded 1 File to: file:/tmp/root/15956540-a4ae-41e9-a698-70e6ae9ede5d/hive_2015-04-06_19-58-25_085_581498070070197769-1/-local-10009/HashTable-Stage-4/MapJoin-mapfile01--.hashtable (83630525 bytes)
2015-04-06 08:00:31	End of local task; Time Taken: 28.881 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 2 out of 2
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0059, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0059/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0059
Hadoop job information for Stage-4: number of mappers: 4; number of reducers: 1
2015-04-06 20:00:43,528 Stage-4 map = 0%,  reduce = 0%
2015-04-06 20:01:20,802 Stage-4 map = 25%,  reduce = 0%, Cumulative CPU 115.38 sec
2015-04-06 20:01:23,996 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 115.38 sec
MapReduce Total cumulative CPU time: 1 minutes 55 seconds 380 msec
Ended Job = job_1428164231378_0059 with errors
Error during job, obtaining debugging information...
Examining task ID: task_1428164231378_0059_m_000002 (and more) from job job_1428164231378_0059
Examining task ID: task_1428164231378_0059_m_000000 (and more) from job job_1428164231378_0059

Task with the most failures(4): 
-----
Task ID:
  task_1428164231378_0059_m_000001

URL:
  http://f01hn02.hadoop:8088/taskdetails.jsp?jobid=job_1428164231378_0059&tipid=task_1428164231378_0059_m_000001
-----
Diagnostic Messages for this Task:
Container [pid=32213,containerID=container_1428164231378_0059_01_000017] is running beyond physical memory limits. Current usage: 2.0 GB of 2 GB physical memory used; 3.8 GB of 4.2 GB virtual memory used. Killing container.
Dump of the process-tree for container_1428164231378_0059_01_000017 :
	|- PID PPID PGRPID SESSID CMD_NAME USER_MODE_TIME(MILLIS) SYSTEM_TIME(MILLIS) VMEM_USAGE(BYTES) RSSMEM_USAGE(PAGES) FULL_CMD_LINE
	|- 32213 32211 32213 32213 (bash) 0 0 108658688 305 /bin/bash -c /usr/jdk64/jdk1.7.0_67/bin/java -server -XX:NewRatio=8 -Djava.net.preferIPv4Stack=true -Dhdp.version=2.2.0.0-2041 -Xmx3072m -Djava.io.tmpdir=/data/4/hadoop/yarn/local/usercache/root/appcache/application_1428164231378_0059/container_1428164231378_0059_01_000017/tmp -Dlog4j.configuration=container-log4j.properties -Dyarn.app.container.log.dir=/data/3/hadoop/yarn/log/application_1428164231378_0059/container_1428164231378_0059_01_000017 -Dyarn.app.container.log.filesize=0 -Dhadoop.root.logger=INFO,CLA org.apache.hadoop.mapred.YarnChild 172.27.1.3 38062 attempt_1428164231378_0059_m_000001_3 17 1>/data/3/hadoop/yarn/log/application_1428164231378_0059/container_1428164231378_0059_01_000017/stdout 2>/data/3/hadoop/yarn/log/application_1428164231378_0059/container_1428164231378_0059_01_000017/stderr  
	|- 32229 32213 32213 32213 (java) 7476 134 3993206784 535484 /usr/jdk64/jdk1.7.0_67/bin/java -server -XX:NewRatio=8 -Djava.net.preferIPv4Stack=true -Dhdp.version=2.2.0.0-2041 -Xmx3072m -Djava.io.tmpdir=/data/4/hadoop/yarn/local/usercache/root/appcache/application_1428164231378_0059/container_1428164231378_0059_01_000017/tmp -Dlog4j.configuration=container-log4j.properties -Dyarn.app.container.log.dir=/data/3/hadoop/yarn/log/application_1428164231378_0059/container_1428164231378_0059_01_000017 -Dyarn.app.container.log.filesize=0 -Dhadoop.root.logger=INFO,CLA org.apache.hadoop.mapred.YarnChild 172.27.1.3 38062 attempt_1428164231378_0059_m_000001_3 17 

Container killed on request. Exit code is 143
Container exited with a non-zero exit code 143


FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask
MapReduce Jobs Launched: 
Stage-Stage-2: Map: 46  Reduce: 179   Cumulative CPU: 1270.21 sec   HDFS Read: 991738418 HDFS Write: 298113 SUCCESS
Stage-Stage-4: Map: 4  Reduce: 1   Cumulative CPU: 115.38 sec   HDFS Read: 17700 HDFS Write: 0 FAIL
Total MapReduce CPU Time Spent: 23 minutes 5 seconds 590 msec
hive> 