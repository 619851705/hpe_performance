15/04/06 20:14:26 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 20:14:26 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 20:14:26 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 20:14:26 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query46.sql;
OK
Time taken: 2.779 seconds
Query ID = root_20150406201414_0af6a1d5-f698-4f75-b164-e2659d2f4e01
Total jobs = 2
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 20:14:54 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 20:14:54 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 20:14:54 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 20:14:54 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406201414_0af6a1d5-f698-4f75-b164-e2659d2f4e01.log
2015-04-06 08:14:55	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 08:15:02	Processing rows:	200000	Hashtable size:	199999	Memory usage:	64045296	percentage:	0.06
2015-04-06 08:15:03	Processing rows:	300000	Hashtable size:	299999	Memory usage:	92952560	percentage:	0.087
2015-04-06 08:15:04	Processing rows:	400000	Hashtable size:	399999	Memory usage:	117331568	percentage:	0.11
2015-04-06 08:15:05	Processing rows:	500000	Hashtable size:	499999	Memory usage:	147514888	percentage:	0.138
2015-04-06 08:15:06	Processing rows:	600000	Hashtable size:	599999	Memory usage:	174350984	percentage:	0.164
2015-04-06 08:15:06	Processing rows:	700000	Hashtable size:	699999	Memory usage:	201122072	percentage:	0.189
2015-04-06 08:15:07	Processing rows:	800000	Hashtable size:	799999	Memory usage:	227304024	percentage:	0.213
2015-04-06 08:15:08	Processing rows:	900000	Hashtable size:	899999	Memory usage:	249823224	percentage:	0.234
2015-04-06 08:15:09	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	275435504	percentage:	0.259
2015-04-06 08:15:09	Dump the side-table for tag: 1 with group count: 1000000 into file: file:/tmp/root/33636aa1-d0ec-4544-bc5e-28b65098dc82/hive_2015-04-06_20-14-33_171_8332708347128949670-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile21--.hashtable
2015-04-06 08:15:10	Uploaded 1 File to: file:/tmp/root/33636aa1-d0ec-4544-bc5e-28b65098dc82/hive_2015-04-06_20-14-33_171_8332708347128949670-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile21--.hashtable (31770711 bytes)
2015-04-06 08:15:10	Dump the side-table for tag: 1 with group count: 1800 into file: file:/tmp/root/33636aa1-d0ec-4544-bc5e-28b65098dc82/hive_2015-04-06_20-14-33_171_8332708347128949670-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile31--.hashtable
2015-04-06 08:15:10	Uploaded 1 File to: file:/tmp/root/33636aa1-d0ec-4544-bc5e-28b65098dc82/hive_2015-04-06_20-14-33_171_8332708347128949670-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile31--.hashtable (41863 bytes)
2015-04-06 08:15:10	Dump the side-table for tag: 1 with group count: 0 into file: file:/tmp/root/33636aa1-d0ec-4544-bc5e-28b65098dc82/hive_2015-04-06_20-14-33_171_8332708347128949670-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile41--.hashtable
2015-04-06 08:15:10	Uploaded 1 File to: file:/tmp/root/33636aa1-d0ec-4544-bc5e-28b65098dc82/hive_2015-04-06_20-14-33_171_8332708347128949670-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile41--.hashtable (260 bytes)
2015-04-06 08:15:10	Dump the side-table for tag: 1 with group count: 314 into file: file:/tmp/root/33636aa1-d0ec-4544-bc5e-28b65098dc82/hive_2015-04-06_20-14-33_171_8332708347128949670-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile51--.hashtable
2015-04-06 08:15:10	Uploaded 1 File to: file:/tmp/root/33636aa1-d0ec-4544-bc5e-28b65098dc82/hive_2015-04-06_20-14-33_171_8332708347128949670-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile51--.hashtable (8462 bytes)
2015-04-06 08:15:10	End of local task; Time Taken: 15.425 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 2
Number of reduce tasks not specified. Estimated from input data size: 179
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0068, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0068/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0068
Hadoop job information for Stage-3: number of mappers: 46; number of reducers: 179
2015-04-06 20:15:30,878 Stage-3 map = 0%,  reduce = 0%
2015-04-06 20:15:51,716 Stage-3 map = 3%,  reduce = 0%, Cumulative CPU 393.99 sec
2015-04-06 20:15:53,887 Stage-3 map = 4%,  reduce = 0%, Cumulative CPU 417.58 sec
2015-04-06 20:15:54,964 Stage-3 map = 17%,  reduce = 0%, Cumulative CPU 525.99 sec
2015-04-06 20:15:57,125 Stage-3 map = 20%,  reduce = 0%, Cumulative CPU 546.68 sec
2015-04-06 20:15:58,204 Stage-3 map = 45%,  reduce = 0%, Cumulative CPU 647.03 sec
2015-04-06 20:15:59,285 Stage-3 map = 52%,  reduce = 0%, Cumulative CPU 657.82 sec
2015-04-06 20:16:00,355 Stage-3 map = 59%,  reduce = 0%, Cumulative CPU 680.07 sec
2015-04-06 20:16:01,413 Stage-3 map = 79%,  reduce = 0%, Cumulative CPU 756.61 sec
2015-04-06 20:16:02,468 Stage-3 map = 85%,  reduce = 0%, Cumulative CPU 768.44 sec
2015-04-06 20:16:03,545 Stage-3 map = 94%,  reduce = 0%, Cumulative CPU 797.14 sec
2015-04-06 20:16:04,618 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 811.44 sec
2015-04-06 20:16:05,697 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 813.53 sec
2015-04-06 20:16:06,785 Stage-3 map = 100%,  reduce = 7%, Cumulative CPU 832.82 sec
2015-04-06 20:16:07,862 Stage-3 map = 100%,  reduce = 27%, Cumulative CPU 907.31 sec
2015-04-06 20:16:08,938 Stage-3 map = 100%,  reduce = 37%, Cumulative CPU 945.83 sec
2015-04-06 20:16:09,996 Stage-3 map = 100%,  reduce = 45%, Cumulative CPU 973.71 sec
2015-04-06 20:16:11,066 Stage-3 map = 100%,  reduce = 51%, Cumulative CPU 991.62 sec
2015-04-06 20:16:12,138 Stage-3 map = 100%,  reduce = 72%, Cumulative CPU 1061.53 sec
2015-04-06 20:16:13,190 Stage-3 map = 100%,  reduce = 75%, Cumulative CPU 1073.09 sec
2015-04-06 20:16:14,235 Stage-3 map = 100%,  reduce = 98%, Cumulative CPU 1152.73 sec
2015-04-06 20:16:15,281 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 1156.18 sec
2015-04-06 20:16:16,321 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 1157.84 sec
MapReduce Total cumulative CPU time: 19 minutes 17 seconds 840 msec
Ended Job = job_1428164231378_0068
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 20:16:23 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 20:16:23 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 20:16:23 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 20:16:23 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406201414_0af6a1d5-f698-4f75-b164-e2659d2f4e01.log
2015-04-06 08:16:24	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 08:16:31	Processing rows:	200000	Hashtable size:	199999	Memory usage:	81034600	percentage:	0.076
2015-04-06 08:16:32	Processing rows:	300000	Hashtable size:	299999	Memory usage:	116321304	percentage:	0.109
2015-04-06 08:16:33	Processing rows:	400000	Hashtable size:	399999	Memory usage:	149395936	percentage:	0.14
2015-04-06 08:16:34	Processing rows:	500000	Hashtable size:	499999	Memory usage:	180481304	percentage:	0.169
2015-04-06 08:16:35	Processing rows:	600000	Hashtable size:	599999	Memory usage:	217614808	percentage:	0.204
2015-04-06 08:16:36	Processing rows:	700000	Hashtable size:	699999	Memory usage:	251082184	percentage:	0.236
2015-04-06 08:16:36	Processing rows:	800000	Hashtable size:	799999	Memory usage:	284138240	percentage:	0.267
2015-04-06 08:16:38	Processing rows:	900000	Hashtable size:	899999	Memory usage:	326315224	percentage:	0.306
2015-04-06 08:16:39	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	351446144	percentage:	0.33
2015-04-06 08:16:40	Processing rows:	1100000	Hashtable size:	1099999	Memory usage:	385003360	percentage:	0.361
2015-04-06 08:16:41	Processing rows:	1200000	Hashtable size:	1199999	Memory usage:	416905808	percentage:	0.391
2015-04-06 08:16:42	Processing rows:	1300000	Hashtable size:	1299999	Memory usage:	450455424	percentage:	0.423
2015-04-06 08:16:42	Processing rows:	1400000	Hashtable size:	1399999	Memory usage:	483947304	percentage:	0.454
2015-04-06 08:16:44	Processing rows:	1500000	Hashtable size:	1499999	Memory usage:	516668600	percentage:	0.485
2015-04-06 08:16:44	Processing rows:	1600000	Hashtable size:	1599999	Memory usage:	549969272	percentage:	0.516
2015-04-06 08:16:44	Processing rows:	1700000	Hashtable size:	1699999	Memory usage:	583001264	percentage:	0.547
2015-04-06 08:16:46	Processing rows:	1800000	Hashtable size:	1799999	Memory usage:	615299192	percentage:	0.577
2015-04-06 08:16:47	Processing rows:	1900000	Hashtable size:	1899999	Memory usage:	649545912	percentage:	0.61
2015-04-06 08:16:47	Processing rows:	2000000	Hashtable size:	1999999	Memory usage:	685754864	percentage:	0.644
2015-04-06 08:16:50	Processing rows:	200000	Hashtable size:	199999	Memory usage:	728774432	percentage:	0.684
2015-04-06 08:16:50	Processing rows:	300000	Hashtable size:	299999	Memory usage:	758681192	percentage:	0.712
2015-04-06 08:16:50	Processing rows:	400000	Hashtable size:	399999	Memory usage:	782789320	percentage:	0.735
2015-04-06 08:16:50	Processing rows:	500000	Hashtable size:	499999	Memory usage:	815377088	percentage:	0.765
2015-04-06 08:16:51	Processing rows:	600000	Hashtable size:	599999	Memory usage:	837682768	percentage:	0.786
2015-04-06 08:16:51	Processing rows:	700000	Hashtable size:	699999	Memory usage:	866076200	percentage:	0.813
2015-04-06 08:16:54	Processing rows:	800000	Hashtable size:	799999	Memory usage:	894845136	percentage:	0.84
2015-04-06 08:16:54	Processing rows:	900000	Hashtable size:	899999	Memory usage:	922949888	percentage:	0.866
2015-04-06 08:16:54	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	946194104	percentage:	0.888
2015-04-06 08:16:54	Dump the side-table for tag: 1 with group count: 1000000 into file: file:/tmp/root/33636aa1-d0ec-4544-bc5e-28b65098dc82/hive_2015-04-06_20-14-33_171_8332708347128949670-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile01--.hashtable
2015-04-06 08:16:58	Uploaded 1 File to: file:/tmp/root/33636aa1-d0ec-4544-bc5e-28b65098dc82/hive_2015-04-06_20-14-33_171_8332708347128949670-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile01--.hashtable (31770711 bytes)
2015-04-06 08:16:58	Dump the side-table for tag: 1 with group count: 2000000 into file: file:/tmp/root/33636aa1-d0ec-4544-bc5e-28b65098dc82/hive_2015-04-06_20-14-33_171_8332708347128949670-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile11--.hashtable
2015-04-06 08:17:02	Uploaded 1 File to: file:/tmp/root/33636aa1-d0ec-4544-bc5e-28b65098dc82/hive_2015-04-06_20-14-33_171_8332708347128949670-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile11--.hashtable (79289890 bytes)
2015-04-06 08:17:02	End of local task; Time Taken: 37.925 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 2 out of 2
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0069, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0069/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0069
Hadoop job information for Stage-6: number of mappers: 4; number of reducers: 1
2015-04-06 20:17:16,525 Stage-6 map = 0%,  reduce = 0%
2015-04-06 20:17:22,917 Stage-6 map = 100%,  reduce = 0%, Cumulative CPU 8.83 sec
2015-04-06 20:17:29,340 Stage-6 map = 100%,  reduce = 100%, Cumulative CPU 10.01 sec
MapReduce Total cumulative CPU time: 10 seconds 10 msec
Ended Job = job_1428164231378_0069
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 46  Reduce: 179   Cumulative CPU: 1157.84 sec   HDFS Read: 2433021196 HDFS Write: 17184 SUCCESS
Stage-Stage-6: Map: 4  Reduce: 1   Cumulative CPU: 10.01 sec   HDFS Read: 64483 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 19 minutes 27 seconds 850 msec
OK
Time taken: 177.282 seconds
hive> 