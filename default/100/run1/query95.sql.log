15/04/06 22:41:00 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 22:41:00 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 22:41:00 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 22:41:00 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query95.sql;
OK
Time taken: 2.83 seconds
Query ID = root_20150406224141_ec642dfd-ad83-4da3-8b57-269ef835b24a
Total jobs = 7
Stage-7 is selected by condition resolver.
Stage-10 is selected by condition resolver.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 22:41:41 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 22:41:41 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 22:41:41 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 22:41:41 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406224141_ec642dfd-ad83-4da3-8b57-269ef835b24a.log
2015-04-06 10:41:42	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 10:41:47	Dump the side-table for tag: 1 with group count: 61 into file: file:/tmp/root/86bfc04b-91d2-475f-a7a9-8df020937467/hive_2015-04-06_22-41-07_745_5488197613398911281-1/-local-10013/HashTable-Stage-16/MapJoin-mapfile11--.hashtable
2015-04-06 10:41:48	Uploaded 1 File to: file:/tmp/root/86bfc04b-91d2-475f-a7a9-8df020937467/hive_2015-04-06_22-41-07_745_5488197613398911281-1/-local-10013/HashTable-Stage-16/MapJoin-mapfile11--.hashtable (1549 bytes)
2015-04-06 10:41:48	Dump the side-table for tag: 1 with group count: 2 into file: file:/tmp/root/86bfc04b-91d2-475f-a7a9-8df020937467/hive_2015-04-06_22-41-07_745_5488197613398911281-1/-local-10013/HashTable-Stage-16/MapJoin-mapfile21--.hashtable
2015-04-06 10:41:48	Uploaded 1 File to: file:/tmp/root/86bfc04b-91d2-475f-a7a9-8df020937467/hive_2015-04-06_22-41-07_745_5488197613398911281-1/-local-10013/HashTable-Stage-16/MapJoin-mapfile21--.hashtable (296 bytes)
2015-04-06 10:41:48	Dump the side-table for tag: 1 with group count: 49289 into file: file:/tmp/root/86bfc04b-91d2-475f-a7a9-8df020937467/hive_2015-04-06_22-41-07_745_5488197613398911281-1/-local-10013/HashTable-Stage-16/MapJoin-mapfile31--.hashtable
2015-04-06 10:41:48	Uploaded 1 File to: file:/tmp/root/86bfc04b-91d2-475f-a7a9-8df020937467/hive_2015-04-06_22-41-07_745_5488197613398911281-1/-local-10013/HashTable-Stage-16/MapJoin-mapfile31--.hashtable (1037163 bytes)
2015-04-06 10:41:48	End of local task; Time Taken: 5.732 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 7
Number of reduce tasks not specified. Estimated from input data size: 68
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0191, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0191/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0191
Hadoop job information for Stage-7: number of mappers: 18; number of reducers: 68
2015-04-06 22:42:04,497 Stage-7 map = 0%,  reduce = 0%
2015-04-06 22:42:15,234 Stage-7 map = 10%,  reduce = 0%, Cumulative CPU 76.4 sec
2015-04-06 22:42:16,307 Stage-7 map = 14%,  reduce = 0%, Cumulative CPU 136.15 sec
2015-04-06 22:42:18,418 Stage-7 map = 31%,  reduce = 0%, Cumulative CPU 209.28 sec
2015-04-06 22:42:19,491 Stage-7 map = 33%,  reduce = 0%, Cumulative CPU 216.32 sec
2015-04-06 22:42:21,626 Stage-7 map = 51%,  reduce = 0%, Cumulative CPU 279.81 sec
2015-04-06 22:42:24,824 Stage-7 map = 66%,  reduce = 0%, Cumulative CPU 343.25 sec
2015-04-06 22:42:28,022 Stage-7 map = 67%,  reduce = 0%, Cumulative CPU 402.29 sec
2015-04-06 22:42:31,223 Stage-7 map = 69%,  reduce = 0%, Cumulative CPU 461.99 sec
2015-04-06 22:42:36,557 Stage-7 map = 70%,  reduce = 0%, Cumulative CPU 527.1 sec
2015-04-06 22:42:37,598 Stage-7 map = 78%,  reduce = 0%, Cumulative CPU 573.45 sec
2015-04-06 22:42:38,647 Stage-7 map = 83%,  reduce = 0%, Cumulative CPU 575.35 sec
2015-04-06 22:42:39,690 Stage-7 map = 85%,  reduce = 0%, Cumulative CPU 584.19 sec
2015-04-06 22:42:40,753 Stage-7 map = 89%,  reduce = 0%, Cumulative CPU 604.67 sec
2015-04-06 22:42:41,821 Stage-7 map = 93%,  reduce = 0%, Cumulative CPU 607.68 sec
2015-04-06 22:42:42,898 Stage-7 map = 98%,  reduce = 7%, Cumulative CPU 622.81 sec
2015-04-06 22:42:43,967 Stage-7 map = 98%,  reduce = 11%, Cumulative CPU 629.63 sec
2015-04-06 22:42:45,033 Stage-7 map = 100%,  reduce = 16%, Cumulative CPU 635.88 sec
2015-04-06 22:42:46,103 Stage-7 map = 100%,  reduce = 27%, Cumulative CPU 656.75 sec
2015-04-06 22:42:47,171 Stage-7 map = 100%,  reduce = 44%, Cumulative CPU 710.11 sec
2015-04-06 22:42:48,242 Stage-7 map = 100%,  reduce = 55%, Cumulative CPU 774.74 sec
2015-04-06 22:42:49,312 Stage-7 map = 100%,  reduce = 67%, Cumulative CPU 936.1 sec
2015-04-06 22:42:50,382 Stage-7 map = 100%,  reduce = 70%, Cumulative CPU 1052.41 sec
2015-04-06 22:42:51,450 Stage-7 map = 100%,  reduce = 73%, Cumulative CPU 1146.5 sec
2015-04-06 22:42:52,519 Stage-7 map = 100%,  reduce = 77%, Cumulative CPU 1259.11 sec
2015-04-06 22:42:53,587 Stage-7 map = 100%,  reduce = 81%, Cumulative CPU 1351.52 sec
2015-04-06 22:42:54,654 Stage-7 map = 100%,  reduce = 84%, Cumulative CPU 1419.54 sec
2015-04-06 22:42:55,721 Stage-7 map = 100%,  reduce = 88%, Cumulative CPU 1518.77 sec
2015-04-06 22:42:56,785 Stage-7 map = 100%,  reduce = 91%, Cumulative CPU 1598.2 sec
2015-04-06 22:42:57,849 Stage-7 map = 100%,  reduce = 95%, Cumulative CPU 1700.44 sec
2015-04-06 22:42:58,888 Stage-7 map = 100%,  reduce = 99%, Cumulative CPU 1800.73 sec
2015-04-06 22:42:59,921 Stage-7 map = 100%,  reduce = 100%, Cumulative CPU 1824.23 sec
MapReduce Total cumulative CPU time: 30 minutes 24 seconds 230 msec
Ended Job = job_1428164231378_0191
Launching Job 2 out of 7
Number of reduce tasks not specified. Estimated from input data size: 68
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0192, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0192/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0192
Hadoop job information for Stage-10: number of mappers: 18; number of reducers: 68
2015-04-06 22:43:14,357 Stage-10 map = 0%,  reduce = 0%
2015-04-06 22:43:26,099 Stage-10 map = 14%,  reduce = 0%, Cumulative CPU 136.58 sec
2015-04-06 22:43:29,286 Stage-10 map = 34%,  reduce = 0%, Cumulative CPU 216.74 sec
2015-04-06 22:43:32,471 Stage-10 map = 51%,  reduce = 0%, Cumulative CPU 279.79 sec
2015-04-06 22:43:35,665 Stage-10 map = 66%,  reduce = 0%, Cumulative CPU 343.14 sec
2015-04-06 22:43:38,848 Stage-10 map = 67%,  reduce = 0%, Cumulative CPU 402.38 sec
2015-04-06 22:43:40,976 Stage-10 map = 69%,  reduce = 0%, Cumulative CPU 408.59 sec
2015-04-06 22:43:47,351 Stage-10 map = 70%,  reduce = 0%, Cumulative CPU 543.66 sec
2015-04-06 22:43:48,418 Stage-10 map = 76%,  reduce = 0%, Cumulative CPU 570.79 sec
2015-04-06 22:43:49,480 Stage-10 map = 80%,  reduce = 0%, Cumulative CPU 573.61 sec
2015-04-06 22:43:50,541 Stage-10 map = 83%,  reduce = 0%, Cumulative CPU 607.45 sec
2015-04-06 22:43:51,622 Stage-10 map = 93%,  reduce = 0%, Cumulative CPU 612.94 sec
2015-04-06 22:43:52,684 Stage-10 map = 100%,  reduce = 6%, Cumulative CPU 627.32 sec
2015-04-06 22:43:53,741 Stage-10 map = 100%,  reduce = 11%, Cumulative CPU 633.66 sec
2015-04-06 22:43:54,805 Stage-10 map = 100%,  reduce = 18%, Cumulative CPU 646.0 sec
2015-04-06 22:43:55,869 Stage-10 map = 100%,  reduce = 36%, Cumulative CPU 704.02 sec
2015-04-06 22:43:56,937 Stage-10 map = 100%,  reduce = 54%, Cumulative CPU 783.04 sec
2015-04-06 22:43:58,001 Stage-10 map = 100%,  reduce = 67%, Cumulative CPU 875.94 sec
2015-04-06 22:43:59,063 Stage-10 map = 100%,  reduce = 76%, Cumulative CPU 987.83 sec
2015-04-06 22:44:00,127 Stage-10 map = 100%,  reduce = 81%, Cumulative CPU 1073.22 sec
2015-04-06 22:44:01,190 Stage-10 map = 100%,  reduce = 89%, Cumulative CPU 1168.55 sec
2015-04-06 22:44:02,251 Stage-10 map = 100%,  reduce = 96%, Cumulative CPU 1306.61 sec
2015-04-06 22:44:03,311 Stage-10 map = 100%,  reduce = 100%, Cumulative CPU 1395.99 sec
MapReduce Total cumulative CPU time: 23 minutes 15 seconds 990 msec
Ended Job = job_1428164231378_0192
Launching Job 3 out of 7
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1428164231378_0193, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0193/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0193
Hadoop job information for Stage-16: number of mappers: 18; number of reducers: 0
2015-04-06 22:44:16,760 Stage-16 map = 0%,  reduce = 0%
2015-04-06 22:44:28,383 Stage-16 map = 35%,  reduce = 0%, Cumulative CPU 60.91 sec
2015-04-06 22:44:29,445 Stage-16 map = 86%,  reduce = 0%, Cumulative CPU 167.51 sec
2015-04-06 22:44:30,505 Stage-16 map = 100%,  reduce = 0%, Cumulative CPU 187.45 sec
MapReduce Total cumulative CPU time: 3 minutes 7 seconds 450 msec
Ended Job = job_1428164231378_0193
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 22:44:36 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 22:44:36 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 22:44:36 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 22:44:36 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406224141_ec642dfd-ad83-4da3-8b57-269ef835b24a.log
2015-04-06 10:44:38	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 10:44:47	Processing rows:	200000	Hashtable size:	199999	Memory usage:	39882016	percentage:	0.037
2015-04-06 10:44:49	Processing rows:	300000	Hashtable size:	299999	Memory usage:	46642168	percentage:	0.044
2015-04-06 10:44:50	Processing rows:	400000	Hashtable size:	399999	Memory usage:	62065576	percentage:	0.058
2015-04-06 10:44:50	Processing rows:	500000	Hashtable size:	499999	Memory usage:	71003264	percentage:	0.067
2015-04-06 10:44:51	Processing rows:	600000	Hashtable size:	599999	Memory usage:	80129984	percentage:	0.075
2015-04-06 10:44:52	Processing rows:	700000	Hashtable size:	699999	Memory usage:	89523488	percentage:	0.084
2015-04-06 10:44:54	Processing rows:	800000	Hashtable size:	799999	Memory usage:	110575640	percentage:	0.104
2015-04-06 10:44:57	Processing rows:	900000	Hashtable size:	899999	Memory usage:	126368208	percentage:	0.119
2015-04-06 10:44:59	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	131457832	percentage:	0.123
2015-04-06 10:45:00	Processing rows:	1100000	Hashtable size:	1099999	Memory usage:	149292152	percentage:	0.14
2015-04-06 10:45:02	Processing rows:	1200000	Hashtable size:	1199999	Memory usage:	152855392	percentage:	0.143
2015-04-06 10:45:04	Processing rows:	1300000	Hashtable size:	1299999	Memory usage:	167566472	percentage:	0.157
2015-04-06 10:45:06	Processing rows:	1400000	Hashtable size:	1399999	Memory usage:	176575296	percentage:	0.166
2015-04-06 10:45:08	Processing rows:	1500000	Hashtable size:	1499999	Memory usage:	190464232	percentage:	0.179
2015-04-06 10:45:10	Processing rows:	1600000	Hashtable size:	1599999	Memory usage:	221843128	percentage:	0.208
2015-04-06 10:45:12	Processing rows:	1700000	Hashtable size:	1699999	Memory usage:	242857648	percentage:	0.228
2015-04-06 10:45:15	Processing rows:	1800000	Hashtable size:	1799999	Memory usage:	243307160	percentage:	0.228
2015-04-06 10:45:16	Processing rows:	1900000	Hashtable size:	1899999	Memory usage:	271014640	percentage:	0.254
2015-04-06 10:45:19	Processing rows:	2000000	Hashtable size:	1999999	Memory usage:	285050024	percentage:	0.268
2015-04-06 10:45:22	Processing rows:	2100000	Hashtable size:	2099999	Memory usage:	287023248	percentage:	0.269
2015-04-06 10:45:24	Processing rows:	2200000	Hashtable size:	2199999	Memory usage:	298995104	percentage:	0.281
2015-04-06 10:45:25	Processing rows:	2300000	Hashtable size:	2299999	Memory usage:	320246048	percentage:	0.301
2015-04-06 10:45:29	Processing rows:	2400000	Hashtable size:	2399999	Memory usage:	322408040	percentage:	0.303
2015-04-06 10:45:31	Processing rows:	2500000	Hashtable size:	2499999	Memory usage:	357451360	percentage:	0.335
2015-04-06 10:45:33	Processing rows:	2600000	Hashtable size:	2599999	Memory usage:	373058552	percentage:	0.35
2015-04-06 10:45:37	Processing rows:	2700000	Hashtable size:	2699999	Memory usage:	390001952	percentage:	0.366
2015-04-06 10:45:39	Processing rows:	2800000	Hashtable size:	2799999	Memory usage:	402815200	percentage:	0.378
2015-04-06 10:45:41	Processing rows:	2900000	Hashtable size:	2899999	Memory usage:	414686992	percentage:	0.389
2015-04-06 10:45:44	Processing rows:	3000000	Hashtable size:	2999999	Memory usage:	432055104	percentage:	0.406
2015-04-06 10:45:48	Processing rows:	3100000	Hashtable size:	3099999	Memory usage:	451649184	percentage:	0.424
2015-04-06 10:45:50	Processing rows:	3200000	Hashtable size:	3199999	Memory usage:	508203144	percentage:	0.477
2015-04-06 10:45:53	Processing rows:	3300000	Hashtable size:	3299999	Memory usage:	532156056	percentage:	0.499
2015-04-06 10:45:58	Processing rows:	3400000	Hashtable size:	3399999	Memory usage:	498265480	percentage:	0.468
2015-04-06 10:46:00	Processing rows:	3500000	Hashtable size:	3499999	Memory usage:	530421736	percentage:	0.498
2015-04-06 10:46:02	Processing rows:	3600000	Hashtable size:	3599999	Memory usage:	533889232	percentage:	0.501
2015-04-06 10:46:04	Processing rows:	3700000	Hashtable size:	3699999	Memory usage:	555495080	percentage:	0.521
2015-04-06 10:46:05	Processing rows:	3800000	Hashtable size:	3799999	Memory usage:	589491816	percentage:	0.553
Execution failed with exit status: 3
Obtaining error information

Task failed!
Task ID:
  Stage-28

Logs:

/tmp/root/hive.log
FAILED: Execution Error, return code 3 from org.apache.hadoop.hive.ql.exec.mr.MapredLocalTask
MapReduce Jobs Launched: 
Stage-Stage-7: Map: 18  Reduce: 68   Cumulative CPU: 1824.47 sec   HDFS Read: 134856970 HDFS Write: 16452427184 SUCCESS
Stage-Stage-10: Map: 18  Reduce: 68   Cumulative CPU: 1395.99 sec   HDFS Read: 134856970 HDFS Write: 127190451 SUCCESS
Stage-Stage-16: Map: 18   Cumulative CPU: 187.45 sec   HDFS Read: 761335741 HDFS Write: 168458 SUCCESS
Total MapReduce CPU Time Spent: 56 minutes 47 seconds 910 msec
hive> 