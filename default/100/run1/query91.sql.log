15/04/06 22:23:53 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 22:23:53 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 22:23:53 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 22:23:53 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query91.sql;
OK
Time taken: 3.22 seconds
Query ID = root_20150406222424_b915bbdc-23ff-415b-a0cc-895cd638baba
Total jobs = 2
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 22:24:22 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 22:24:22 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 22:24:22 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 22:24:22 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406222424_b915bbdc-23ff-415b-a0cc-895cd638baba.log
2015-04-06 10:24:23	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 10:24:36	Processing rows:	200000	Hashtable size:	199999	Memory usage:	116906328	percentage:	0.11
2015-04-06 10:24:37	Processing rows:	300000	Hashtable size:	299999	Memory usage:	145929168	percentage:	0.137
2015-04-06 10:24:37	Processing rows:	400000	Hashtable size:	399999	Memory usage:	173195408	percentage:	0.163
2015-04-06 10:24:38	Processing rows:	500000	Hashtable size:	499999	Memory usage:	203861584	percentage:	0.191
2015-04-06 10:24:39	Processing rows:	600000	Hashtable size:	599999	Memory usage:	234956192	percentage:	0.221
2015-04-06 10:24:40	Processing rows:	700000	Hashtable size:	699999	Memory usage:	252813552	percentage:	0.237
2015-04-06 10:24:41	Processing rows:	800000	Hashtable size:	799999	Memory usage:	287272488	percentage:	0.27
2015-04-06 10:24:42	Processing rows:	900000	Hashtable size:	899999	Memory usage:	322870160	percentage:	0.303
2015-04-06 10:24:43	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	350182064	percentage:	0.329
2015-04-06 10:24:44	Processing rows:	1100000	Hashtable size:	1099999	Memory usage:	377333240	percentage:	0.354
2015-04-06 10:24:44	Processing rows:	1200000	Hashtable size:	1199999	Memory usage:	404123032	percentage:	0.379
2015-04-06 10:24:45	Processing rows:	1300000	Hashtable size:	1299999	Memory usage:	430555384	percentage:	0.404
2015-04-06 10:24:45	Processing rows:	1400000	Hashtable size:	1399999	Memory usage:	457451752	percentage:	0.429
2015-04-06 10:24:46	Processing rows:	1500000	Hashtable size:	1499999	Memory usage:	483471584	percentage:	0.454
2015-04-06 10:24:48	Processing rows:	1600000	Hashtable size:	1599999	Memory usage:	495990864	percentage:	0.466
2015-04-06 10:24:48	Processing rows:	1700000	Hashtable size:	1699999	Memory usage:	521620512	percentage:	0.49
2015-04-06 10:24:48	Processing rows:	1800000	Hashtable size:	1799999	Memory usage:	551436040	percentage:	0.518
2015-04-06 10:24:50	Dump the side-table for tag: 1 with group count: 1200 into file: file:/tmp/root/fba7aa19-fca8-4a25-a7e4-5ea772991f63/hive_2015-04-06_22-24-00_487_227377725286223744-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile01--.hashtable
2015-04-06 10:24:51	Uploaded 1 File to: file:/tmp/root/fba7aa19-fca8-4a25-a7e4-5ea772991f63/hive_2015-04-06_22-24-00_487_227377725286223744-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile01--.hashtable (32736 bytes)
2015-04-06 10:24:51	Dump the side-table for tag: 1 with group count: 109760 into file: file:/tmp/root/fba7aa19-fca8-4a25-a7e4-5ea772991f63/hive_2015-04-06_22-24-00_487_227377725286223744-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile11--.hashtable
2015-04-06 10:24:51	Uploaded 1 File to: file:/tmp/root/fba7aa19-fca8-4a25-a7e4-5ea772991f63/hive_2015-04-06_22-24-00_487_227377725286223744-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile11--.hashtable (3967134 bytes)
2015-04-06 10:24:51	Dump the side-table for tag: 1 with group count: 108673 into file: file:/tmp/root/fba7aa19-fca8-4a25-a7e4-5ea772991f63/hive_2015-04-06_22-24-00_487_227377725286223744-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile21--.hashtable
2015-04-06 10:24:51	Uploaded 1 File to: file:/tmp/root/fba7aa19-fca8-4a25-a7e4-5ea772991f63/hive_2015-04-06_22-24-00_487_227377725286223744-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile21--.hashtable (2286241 bytes)
2015-04-06 10:24:51	Dump the side-table for tag: 1 with group count: 1895253 into file: file:/tmp/root/fba7aa19-fca8-4a25-a7e4-5ea772991f63/hive_2015-04-06_22-24-00_487_227377725286223744-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile31--.hashtable
2015-04-06 10:24:53	Uploaded 1 File to: file:/tmp/root/fba7aa19-fca8-4a25-a7e4-5ea772991f63/hive_2015-04-06_22-24-00_487_227377725286223744-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile31--.hashtable (62495429 bytes)
2015-04-06 10:24:53	Dump the side-table for tag: 1 with group count: 30 into file: file:/tmp/root/fba7aa19-fca8-4a25-a7e4-5ea772991f63/hive_2015-04-06_22-24-00_487_227377725286223744-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile41--.hashtable
2015-04-06 10:24:53	Uploaded 1 File to: file:/tmp/root/fba7aa19-fca8-4a25-a7e4-5ea772991f63/hive_2015-04-06_22-24-00_487_227377725286223744-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile41--.hashtable (893 bytes)
2015-04-06 10:24:53	Dump the side-table for tag: 0 with group count: 30 into file: file:/tmp/root/fba7aa19-fca8-4a25-a7e4-5ea772991f63/hive_2015-04-06_22-24-00_487_227377725286223744-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile50--.hashtable
2015-04-06 10:24:53	Uploaded 1 File to: file:/tmp/root/fba7aa19-fca8-4a25-a7e4-5ea772991f63/hive_2015-04-06_22-24-00_487_227377725286223744-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile50--.hashtable (2177 bytes)
2015-04-06 10:24:53	End of local task; Time Taken: 29.716 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 2
Number of reduce tasks not specified. Estimated from input data size: 14
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0179, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0179/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0179
Hadoop job information for Stage-2: number of mappers: 6; number of reducers: 14
2015-04-06 22:25:17,485 Stage-2 map = 0%,  reduce = 0%
2015-04-06 22:25:50,859 Stage-2 map = 33%,  reduce = 0%, Cumulative CPU 187.6 sec
2015-04-06 22:25:51,928 Stage-2 map = 17%,  reduce = 0%, Cumulative CPU 98.56 sec
2015-04-06 22:26:02,539 Stage-2 map = 17%,  reduce = 1%, Cumulative CPU 99.19 sec
2015-04-06 22:26:03,610 Stage-2 map = 17%,  reduce = 6%, Cumulative CPU 184.0 sec
2015-04-06 22:26:12,142 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 98.56 sec
MapReduce Total cumulative CPU time: 1 minutes 38 seconds 560 msec
Ended Job = job_1428164231378_0179 with errors
Error during job, obtaining debugging information...
Examining task ID: task_1428164231378_0179_m_000002 (and more) from job job_1428164231378_0179
Examining task ID: task_1428164231378_0179_m_000003 (and more) from job job_1428164231378_0179

Task with the most failures(4): 
-----
Task ID:
  task_1428164231378_0179_m_000001

URL:
  http://f01hn02.hadoop:8088/taskdetails.jsp?jobid=job_1428164231378_0179&tipid=task_1428164231378_0179_m_000001
-----
Diagnostic Messages for this Task:
Container [pid=21411,containerID=container_1428164231378_0179_01_000051] is running beyond physical memory limits. Current usage: 2.0 GB of 2 GB physical memory used; 3.8 GB of 4.2 GB virtual memory used. Killing container.
Dump of the process-tree for container_1428164231378_0179_01_000051 :
	|- PID PPID PGRPID SESSID CMD_NAME USER_MODE_TIME(MILLIS) SYSTEM_TIME(MILLIS) VMEM_USAGE(BYTES) RSSMEM_USAGE(PAGES) FULL_CMD_LINE
	|- 21427 21411 21411 21411 (java) 8587 126 3993513984 526998 /usr/jdk64/jdk1.7.0_67/bin/java -server -XX:NewRatio=8 -Djava.net.preferIPv4Stack=true -Dhdp.version=2.2.0.0-2041 -Xmx3072m -Djava.io.tmpdir=/data/8/hadoop/yarn/local/usercache/root/appcache/application_1428164231378_0179/container_1428164231378_0179_01_000051/tmp -Dlog4j.configuration=container-log4j.properties -Dyarn.app.container.log.dir=/data/2/hadoop/yarn/log/application_1428164231378_0179/container_1428164231378_0179_01_000051 -Dyarn.app.container.log.filesize=0 -Dhadoop.root.logger=INFO,CLA org.apache.hadoop.mapred.YarnChild 172.27.1.1 43796 attempt_1428164231378_0179_m_000001_3 51 
	|- 21411 21408 21411 21411 (bash) 0 0 108658688 305 /bin/bash -c /usr/jdk64/jdk1.7.0_67/bin/java -server -XX:NewRatio=8 -Djava.net.preferIPv4Stack=true -Dhdp.version=2.2.0.0-2041 -Xmx3072m -Djava.io.tmpdir=/data/8/hadoop/yarn/local/usercache/root/appcache/application_1428164231378_0179/container_1428164231378_0179_01_000051/tmp -Dlog4j.configuration=container-log4j.properties -Dyarn.app.container.log.dir=/data/2/hadoop/yarn/log/application_1428164231378_0179/container_1428164231378_0179_01_000051 -Dyarn.app.container.log.filesize=0 -Dhadoop.root.logger=INFO,CLA org.apache.hadoop.mapred.YarnChild 172.27.1.1 43796 attempt_1428164231378_0179_m_000001_3 51 1>/data/2/hadoop/yarn/log/application_1428164231378_0179/container_1428164231378_0179_01_000051/stdout 2>/data/2/hadoop/yarn/log/application_1428164231378_0179/container_1428164231378_0179_01_000051/stderr  

Container killed on request. Exit code is 143
Container exited with a non-zero exit code 143


FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask
MapReduce Jobs Launched: 
Stage-Stage-2: Map: 6  Reduce: 14   Cumulative CPU: 98.56 sec   HDFS Read: 1959981 HDFS Write: 0 FAIL
Total MapReduce CPU Time Spent: 1 minutes 38 seconds 560 msec
hive> 