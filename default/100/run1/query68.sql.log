15/04/06 21:21:53 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 21:21:53 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 21:21:53 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 21:21:53 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query68.sql;
OK
Time taken: 2.898 seconds
Query ID = root_20150406212222_d263c73d-1565-4ab4-b2a8-360531afb145
Total jobs = 2
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 21:22:20 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 21:22:20 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 21:22:20 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 21:22:20 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406212222_d263c73d-1565-4ab4-b2a8-360531afb145.log
2015-04-06 09:22:21	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 09:22:29	Processing rows:	200000	Hashtable size:	199999	Memory usage:	64209040	percentage:	0.06
2015-04-06 09:22:30	Processing rows:	300000	Hashtable size:	299999	Memory usage:	93035920	percentage:	0.087
2015-04-06 09:22:30	Processing rows:	400000	Hashtable size:	399999	Memory usage:	117416608	percentage:	0.11
2015-04-06 09:22:31	Processing rows:	500000	Hashtable size:	499999	Memory usage:	147808240	percentage:	0.139
2015-04-06 09:22:32	Processing rows:	600000	Hashtable size:	599999	Memory usage:	174574432	percentage:	0.164
2015-04-06 09:22:33	Processing rows:	700000	Hashtable size:	699999	Memory usage:	200299032	percentage:	0.188
2015-04-06 09:22:34	Processing rows:	800000	Hashtable size:	799999	Memory usage:	223008944	percentage:	0.209
2015-04-06 09:22:34	Processing rows:	900000	Hashtable size:	899999	Memory usage:	250181240	percentage:	0.235
2015-04-06 09:22:35	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	275719800	percentage:	0.259
2015-04-06 09:22:35	Dump the side-table for tag: 1 with group count: 1000000 into file: file:/tmp/root/865c1e47-9943-4896-a05a-0ba6f6323f8c/hive_2015-04-06_21-22-00_569_4104747881965487027-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile21--.hashtable
2015-04-06 09:22:36	Uploaded 1 File to: file:/tmp/root/865c1e47-9943-4896-a05a-0ba6f6323f8c/hive_2015-04-06_21-22-00_569_4104747881965487027-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile21--.hashtable (31770711 bytes)
2015-04-06 09:22:36	Dump the side-table for tag: 1 with group count: 1800 into file: file:/tmp/root/865c1e47-9943-4896-a05a-0ba6f6323f8c/hive_2015-04-06_21-22-00_569_4104747881965487027-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile31--.hashtable
2015-04-06 09:22:36	Uploaded 1 File to: file:/tmp/root/865c1e47-9943-4896-a05a-0ba6f6323f8c/hive_2015-04-06_21-22-00_569_4104747881965487027-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile31--.hashtable (41863 bytes)
2015-04-06 09:22:36	Dump the side-table for tag: 1 with group count: 0 into file: file:/tmp/root/865c1e47-9943-4896-a05a-0ba6f6323f8c/hive_2015-04-06_21-22-00_569_4104747881965487027-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile41--.hashtable
2015-04-06 09:22:36	Uploaded 1 File to: file:/tmp/root/865c1e47-9943-4896-a05a-0ba6f6323f8c/hive_2015-04-06_21-22-00_569_4104747881965487027-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile41--.hashtable (260 bytes)
2015-04-06 09:22:36	Dump the side-table for tag: 1 with group count: 72 into file: file:/tmp/root/865c1e47-9943-4896-a05a-0ba6f6323f8c/hive_2015-04-06_21-22-00_569_4104747881965487027-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile51--.hashtable
2015-04-06 09:22:36	Uploaded 1 File to: file:/tmp/root/865c1e47-9943-4896-a05a-0ba6f6323f8c/hive_2015-04-06_21-22-00_569_4104747881965487027-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile51--.hashtable (2140 bytes)
2015-04-06 09:22:36	End of local task; Time Taken: 15.062 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 2
Number of reduce tasks not specified. Estimated from input data size: 179
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0126, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0126/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0126
Hadoop job information for Stage-3: number of mappers: 46; number of reducers: 179
2015-04-06 21:22:57,957 Stage-3 map = 0%,  reduce = 0%
2015-04-06 21:23:17,542 Stage-3 map = 1%,  reduce = 0%, Cumulative CPU 266.71 sec
2015-04-06 21:23:18,612 Stage-3 map = 3%,  reduce = 0%, Cumulative CPU 393.94 sec
2015-04-06 21:23:20,757 Stage-3 map = 5%,  reduce = 0%, Cumulative CPU 422.85 sec
2015-04-06 21:23:21,832 Stage-3 map = 16%,  reduce = 0%, Cumulative CPU 509.54 sec
2015-04-06 21:23:22,905 Stage-3 map = 18%,  reduce = 0%, Cumulative CPU 519.14 sec
2015-04-06 21:23:23,976 Stage-3 map = 24%,  reduce = 0%, Cumulative CPU 543.11 sec
2015-04-06 21:23:25,040 Stage-3 map = 47%,  reduce = 0%, Cumulative CPU 643.95 sec
2015-04-06 21:23:26,108 Stage-3 map = 54%,  reduce = 0%, Cumulative CPU 656.93 sec
2015-04-06 21:23:27,159 Stage-3 map = 77%,  reduce = 0%, Cumulative CPU 707.43 sec
2015-04-06 21:23:28,211 Stage-3 map = 90%,  reduce = 0%, Cumulative CPU 750.22 sec
2015-04-06 21:23:29,253 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 758.49 sec
2015-04-06 21:23:30,333 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 766.03 sec
2015-04-06 21:23:31,416 Stage-3 map = 100%,  reduce = 5%, Cumulative CPU 782.21 sec
2015-04-06 21:23:32,461 Stage-3 map = 100%,  reduce = 15%, Cumulative CPU 814.82 sec
2015-04-06 21:23:33,507 Stage-3 map = 100%,  reduce = 23%, Cumulative CPU 844.23 sec
2015-04-06 21:23:34,582 Stage-3 map = 100%,  reduce = 36%, Cumulative CPU 898.31 sec
2015-04-06 21:23:35,653 Stage-3 map = 100%,  reduce = 45%, Cumulative CPU 930.75 sec
2015-04-06 21:23:36,725 Stage-3 map = 100%,  reduce = 54%, Cumulative CPU 963.5 sec
2015-04-06 21:23:37,771 Stage-3 map = 100%,  reduce = 64%, Cumulative CPU 995.2 sec
2015-04-06 21:23:38,833 Stage-3 map = 100%,  reduce = 73%, Cumulative CPU 1026.7 sec
2015-04-06 21:23:39,902 Stage-3 map = 100%,  reduce = 90%, Cumulative CPU 1090.62 sec
2015-04-06 21:23:40,994 Stage-3 map = 100%,  reduce = 99%, Cumulative CPU 1122.18 sec
2015-04-06 21:23:42,061 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 1123.86 sec
MapReduce Total cumulative CPU time: 18 minutes 43 seconds 860 msec
Ended Job = job_1428164231378_0126
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 21:23:48 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 21:23:48 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 21:23:48 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 21:23:48 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406212222_d263c73d-1565-4ab4-b2a8-360531afb145.log
2015-04-06 09:23:49	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 09:23:56	Processing rows:	200000	Hashtable size:	199999	Memory usage:	81024656	percentage:	0.076
2015-04-06 09:23:58	Processing rows:	300000	Hashtable size:	299999	Memory usage:	116336464	percentage:	0.109
2015-04-06 09:23:58	Processing rows:	400000	Hashtable size:	399999	Memory usage:	149398032	percentage:	0.14
2015-04-06 09:24:00	Processing rows:	500000	Hashtable size:	499999	Memory usage:	180382376	percentage:	0.169
2015-04-06 09:24:01	Processing rows:	600000	Hashtable size:	599999	Memory usage:	217818600	percentage:	0.204
2015-04-06 09:24:02	Processing rows:	700000	Hashtable size:	699999	Memory usage:	250924192	percentage:	0.236
2015-04-06 09:24:02	Processing rows:	800000	Hashtable size:	799999	Memory usage:	284100712	percentage:	0.267
2015-04-06 09:24:03	Processing rows:	900000	Hashtable size:	899999	Memory usage:	325500768	percentage:	0.305
2015-04-06 09:24:05	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	351045528	percentage:	0.329
2015-04-06 09:24:05	Processing rows:	1100000	Hashtable size:	1099999	Memory usage:	384755776	percentage:	0.361
2015-04-06 09:24:05	Processing rows:	1200000	Hashtable size:	1199999	Memory usage:	417986832	percentage:	0.392
2015-04-06 09:24:07	Processing rows:	1300000	Hashtable size:	1299999	Memory usage:	451813120	percentage:	0.424
2015-04-06 09:24:07	Processing rows:	1400000	Hashtable size:	1399999	Memory usage:	482839312	percentage:	0.453
2015-04-06 09:24:09	Processing rows:	1500000	Hashtable size:	1499999	Memory usage:	516421744	percentage:	0.485
2015-04-06 09:24:10	Processing rows:	1600000	Hashtable size:	1599999	Memory usage:	549304616	percentage:	0.516
2015-04-06 09:24:10	Processing rows:	1700000	Hashtable size:	1699999	Memory usage:	584518224	percentage:	0.549
2015-04-06 09:24:10	Processing rows:	1800000	Hashtable size:	1799999	Memory usage:	617214824	percentage:	0.579
2015-04-06 09:24:12	Processing rows:	1900000	Hashtable size:	1899999	Memory usage:	654142392	percentage:	0.614
2015-04-06 09:24:12	Processing rows:	2000000	Hashtable size:	1999999	Memory usage:	685765944	percentage:	0.644
2015-04-06 09:24:13	Processing rows:	200000	Hashtable size:	199999	Memory usage:	742153192	percentage:	0.697
2015-04-06 09:24:16	Processing rows:	300000	Hashtable size:	299999	Memory usage:	758291568	percentage:	0.712
2015-04-06 09:24:16	Processing rows:	400000	Hashtable size:	399999	Memory usage:	781949472	percentage:	0.734
2015-04-06 09:24:16	Processing rows:	500000	Hashtable size:	499999	Memory usage:	814381888	percentage:	0.764
2015-04-06 09:24:17	Processing rows:	600000	Hashtable size:	599999	Memory usage:	836025120	percentage:	0.785
2015-04-06 09:24:17	Processing rows:	700000	Hashtable size:	699999	Memory usage:	864065600	percentage:	0.811
2015-04-06 09:24:19	Processing rows:	800000	Hashtable size:	799999	Memory usage:	892321416	percentage:	0.837
2015-04-06 09:24:20	Processing rows:	900000	Hashtable size:	899999	Memory usage:	920483896	percentage:	0.864
2015-04-06 09:24:20	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	945307448	percentage:	0.887
2015-04-06 09:24:20	Dump the side-table for tag: 1 with group count: 1000000 into file: file:/tmp/root/865c1e47-9943-4896-a05a-0ba6f6323f8c/hive_2015-04-06_21-22-00_569_4104747881965487027-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile01--.hashtable
2015-04-06 09:24:26	Uploaded 1 File to: file:/tmp/root/865c1e47-9943-4896-a05a-0ba6f6323f8c/hive_2015-04-06_21-22-00_569_4104747881965487027-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile01--.hashtable (31770711 bytes)
2015-04-06 09:24:26	Dump the side-table for tag: 1 with group count: 2000000 into file: file:/tmp/root/865c1e47-9943-4896-a05a-0ba6f6323f8c/hive_2015-04-06_21-22-00_569_4104747881965487027-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile11--.hashtable
2015-04-06 09:24:31	Uploaded 1 File to: file:/tmp/root/865c1e47-9943-4896-a05a-0ba6f6323f8c/hive_2015-04-06_21-22-00_569_4104747881965487027-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile11--.hashtable (79289890 bytes)
2015-04-06 09:24:31	End of local task; Time Taken: 41.488 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 2 out of 2
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0127, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0127/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0127
Hadoop job information for Stage-6: number of mappers: 4; number of reducers: 1
2015-04-06 21:24:44,972 Stage-6 map = 0%,  reduce = 0%
2015-04-06 21:24:51,349 Stage-6 map = 75%,  reduce = 0%, Cumulative CPU 6.28 sec
2015-04-06 21:24:52,419 Stage-6 map = 100%,  reduce = 0%, Cumulative CPU 8.64 sec
2015-04-06 21:24:57,757 Stage-6 map = 100%,  reduce = 100%, Cumulative CPU 9.73 sec
MapReduce Total cumulative CPU time: 9 seconds 730 msec
Ended Job = job_1428164231378_0127
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 46  Reduce: 179   Cumulative CPU: 1123.86 sec   HDFS Read: 3766219469 HDFS Write: 17184 SUCCESS
Stage-Stage-6: Map: 4  Reduce: 1   Cumulative CPU: 9.73 sec   HDFS Read: 64483 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 18 minutes 53 seconds 590 msec
OK
Time taken: 178.443 seconds
hive> 