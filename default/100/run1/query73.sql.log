15/04/06 21:38:45 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 21:38:45 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 21:38:45 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 21:38:45 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query73.sql;
OK
Time taken: 2.8 seconds
Query ID = root_20150406213838_db650caf-2c29-4500-a806-1a430d8e0419
Total jobs = 2
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 21:39:11 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 21:39:11 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 21:39:11 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 21:39:11 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406213838_db650caf-2c29-4500-a806-1a430d8e0419.log
2015-04-06 09:39:13	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 09:39:17	Dump the side-table for tag: 1 with group count: 1040 into file: file:/tmp/root/6f95443e-3e38-453b-8a6e-a4f891c4f163/hive_2015-04-06_21-38-52_239_4935191116692585385-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile11--.hashtable
2015-04-06 09:39:18	Uploaded 1 File to: file:/tmp/root/6f95443e-3e38-453b-8a6e-a4f891c4f163/hive_2015-04-06_21-38-52_239_4935191116692585385-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile11--.hashtable (35270 bytes)
2015-04-06 09:39:18	Dump the side-table for tag: 1 with group count: 50 into file: file:/tmp/root/6f95443e-3e38-453b-8a6e-a4f891c4f163/hive_2015-04-06_21-38-52_239_4935191116692585385-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile21--.hashtable
2015-04-06 09:39:18	Uploaded 1 File to: file:/tmp/root/6f95443e-3e38-453b-8a6e-a4f891c4f163/hive_2015-04-06_21-38-52_239_4935191116692585385-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile21--.hashtable (2075 bytes)
2015-04-06 09:39:18	Dump the side-table for tag: 1 with group count: 72 into file: file:/tmp/root/6f95443e-3e38-453b-8a6e-a4f891c4f163/hive_2015-04-06_21-38-52_239_4935191116692585385-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile31--.hashtable
2015-04-06 09:39:18	Uploaded 1 File to: file:/tmp/root/6f95443e-3e38-453b-8a6e-a4f891c4f163/hive_2015-04-06_21-38-52_239_4935191116692585385-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile31--.hashtable (2140 bytes)
2015-04-06 09:39:18	End of local task; Time Taken: 4.782 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 2
Number of reduce tasks not specified. Estimated from input data size: 179
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0140, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0140/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0140
Hadoop job information for Stage-2: number of mappers: 46; number of reducers: 179
2015-04-06 21:39:37,995 Stage-2 map = 0%,  reduce = 0%
2015-04-06 21:39:56,317 Stage-2 map = 1%,  reduce = 0%, Cumulative CPU 37.95 sec
2015-04-06 21:39:57,392 Stage-2 map = 9%,  reduce = 0%, Cumulative CPU 256.67 sec
2015-04-06 21:39:59,535 Stage-2 map = 12%,  reduce = 0%, Cumulative CPU 280.79 sec
2015-04-06 21:40:00,609 Stage-2 map = 30%,  reduce = 0%, Cumulative CPU 477.49 sec
2015-04-06 21:40:02,757 Stage-2 map = 34%,  reduce = 0%, Cumulative CPU 498.37 sec
2015-04-06 21:40:03,828 Stage-2 map = 53%,  reduce = 0%, Cumulative CPU 601.85 sec
2015-04-06 21:40:04,901 Stage-2 map = 58%,  reduce = 0%, Cumulative CPU 610.06 sec
2015-04-06 21:40:05,974 Stage-2 map = 80%,  reduce = 0%, Cumulative CPU 663.26 sec
2015-04-06 21:40:07,248 Stage-2 map = 97%,  reduce = 0%, Cumulative CPU 707.03 sec
2015-04-06 21:40:08,319 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 710.16 sec
2015-04-06 21:40:10,479 Stage-2 map = 100%,  reduce = 5%, Cumulative CPU 730.22 sec
2015-04-06 21:40:11,551 Stage-2 map = 100%,  reduce = 10%, Cumulative CPU 750.78 sec
2015-04-06 21:40:12,626 Stage-2 map = 100%,  reduce = 23%, Cumulative CPU 806.01 sec
2015-04-06 21:40:13,700 Stage-2 map = 100%,  reduce = 34%, Cumulative CPU 863.36 sec
2015-04-06 21:40:14,778 Stage-2 map = 100%,  reduce = 45%, Cumulative CPU 911.21 sec
2015-04-06 21:40:15,851 Stage-2 map = 100%,  reduce = 49%, Cumulative CPU 925.05 sec
2015-04-06 21:40:16,928 Stage-2 map = 100%,  reduce = 63%, Cumulative CPU 982.42 sec
2015-04-06 21:40:17,975 Stage-2 map = 100%,  reduce = 68%, Cumulative CPU 1004.86 sec
2015-04-06 21:40:19,024 Stage-2 map = 100%,  reduce = 87%, Cumulative CPU 1089.63 sec
2015-04-06 21:40:20,096 Stage-2 map = 100%,  reduce = 99%, Cumulative CPU 1139.48 sec
2015-04-06 21:40:21,165 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 1141.73 sec
MapReduce Total cumulative CPU time: 19 minutes 1 seconds 730 msec
Ended Job = job_1428164231378_0140
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 21:40:27 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 21:40:27 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 21:40:27 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 21:40:27 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406213838_db650caf-2c29-4500-a806-1a430d8e0419.log
2015-04-06 09:40:28	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 09:40:36	Processing rows:	200000	Hashtable size:	199999	Memory usage:	96399904	percentage:	0.09
2015-04-06 09:40:37	Processing rows:	300000	Hashtable size:	299999	Memory usage:	138160792	percentage:	0.13
2015-04-06 09:40:38	Processing rows:	400000	Hashtable size:	399999	Memory usage:	179423376	percentage:	0.168
2015-04-06 09:40:39	Processing rows:	500000	Hashtable size:	499999	Memory usage:	220622448	percentage:	0.207
2015-04-06 09:40:40	Processing rows:	600000	Hashtable size:	599999	Memory usage:	261562776	percentage:	0.245
2015-04-06 09:40:41	Processing rows:	700000	Hashtable size:	699999	Memory usage:	302839176	percentage:	0.284
2015-04-06 09:40:43	Processing rows:	800000	Hashtable size:	799999	Memory usage:	344185512	percentage:	0.323
2015-04-06 09:40:43	Processing rows:	900000	Hashtable size:	899999	Memory usage:	393539616	percentage:	0.369
2015-04-06 09:40:45	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	439928584	percentage:	0.413
2015-04-06 09:40:45	Processing rows:	1100000	Hashtable size:	1099999	Memory usage:	481854048	percentage:	0.452
2015-04-06 09:40:47	Processing rows:	1200000	Hashtable size:	1199999	Memory usage:	512030000	percentage:	0.481
2015-04-06 09:40:48	Processing rows:	1300000	Hashtable size:	1299999	Memory usage:	551721976	percentage:	0.518
2015-04-06 09:40:50	Processing rows:	1400000	Hashtable size:	1399999	Memory usage:	592752560	percentage:	0.556
2015-04-06 09:40:50	Processing rows:	1500000	Hashtable size:	1499999	Memory usage:	633861144	percentage:	0.595
2015-04-06 09:40:51	Processing rows:	1600000	Hashtable size:	1599999	Memory usage:	674510408	percentage:	0.633
2015-04-06 09:40:53	Processing rows:	1700000	Hashtable size:	1699999	Memory usage:	715555088	percentage:	0.672
2015-04-06 09:40:53	Processing rows:	1800000	Hashtable size:	1799999	Memory usage:	756191288	percentage:	0.71
2015-04-06 09:40:54	Processing rows:	1900000	Hashtable size:	1899999	Memory usage:	804413800	percentage:	0.755
2015-04-06 09:40:54	Processing rows:	2000000	Hashtable size:	1999999	Memory usage:	841963344	percentage:	0.79
2015-04-06 09:40:54	Dump the side-table for tag: 1 with group count: 2000000 into file: file:/tmp/root/6f95443e-3e38-453b-8a6e-a4f891c4f163/hive_2015-04-06_21-38-52_239_4935191116692585385-1/-local-10009/HashTable-Stage-4/MapJoin-mapfile01--.hashtable
2015-04-06 09:40:59	Uploaded 1 File to: file:/tmp/root/6f95443e-3e38-453b-8a6e-a4f891c4f163/hive_2015-04-06_21-38-52_239_4935191116692585385-1/-local-10009/HashTable-Stage-4/MapJoin-mapfile01--.hashtable (83630525 bytes)
2015-04-06 09:40:59	End of local task; Time Taken: 30.918 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 2 out of 2
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0141, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0141/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0141
Hadoop job information for Stage-4: number of mappers: 4; number of reducers: 1
2015-04-06 21:41:12,183 Stage-4 map = 0%,  reduce = 0%
2015-04-06 21:41:28,164 Stage-4 map = 3%,  reduce = 0%, Cumulative CPU 117.57 sec
2015-04-06 21:41:29,235 Stage-4 map = 25%,  reduce = 0%, Cumulative CPU 131.59 sec
2015-04-06 21:41:40,991 Stage-4 map = 25%,  reduce = 8%, Cumulative CPU 131.92 sec
2015-04-06 21:41:54,072 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 131.59 sec
MapReduce Total cumulative CPU time: 2 minutes 11 seconds 590 msec
Ended Job = job_1428164231378_0141 with errors
Error during job, obtaining debugging information...
Examining task ID: task_1428164231378_0141_m_000002 (and more) from job job_1428164231378_0141
Examining task ID: task_1428164231378_0141_m_000002 (and more) from job job_1428164231378_0141

Task with the most failures(4): 
-----
Task ID:
  task_1428164231378_0141_m_000002

URL:
  http://f01hn02.hadoop:8088/taskdetails.jsp?jobid=job_1428164231378_0141&tipid=task_1428164231378_0141_m_000002
-----
Diagnostic Messages for this Task:
Container [pid=26467,containerID=container_1428164231378_0141_01_000013] is running beyond physical memory limits. Current usage: 2.0 GB of 2 GB physical memory used; 3.8 GB of 4.2 GB virtual memory used. Killing container.
Dump of the process-tree for container_1428164231378_0141_01_000013 :
	|- PID PPID PGRPID SESSID CMD_NAME USER_MODE_TIME(MILLIS) SYSTEM_TIME(MILLIS) VMEM_USAGE(BYTES) RSSMEM_USAGE(PAGES) FULL_CMD_LINE
	|- 26483 26467 26467 26467 (java) 4040 116 4002066432 527278 /usr/jdk64/jdk1.7.0_67/bin/java -server -XX:NewRatio=8 -Djava.net.preferIPv4Stack=true -Dhdp.version=2.2.0.0-2041 -Xmx3072m -Djava.io.tmpdir=/data/4/hadoop/yarn/local/usercache/root/appcache/application_1428164231378_0141/container_1428164231378_0141_01_000013/tmp -Dlog4j.configuration=container-log4j.properties -Dyarn.app.container.log.dir=/data/4/hadoop/yarn/log/application_1428164231378_0141/container_1428164231378_0141_01_000013 -Dyarn.app.container.log.filesize=0 -Dhadoop.root.logger=INFO,CLA org.apache.hadoop.mapred.YarnChild 172.27.1.10 54303 attempt_1428164231378_0141_m_000002_3 13 
	|- 26467 26465 26467 26467 (bash) 0 0 108658688 305 /bin/bash -c /usr/jdk64/jdk1.7.0_67/bin/java -server -XX:NewRatio=8 -Djava.net.preferIPv4Stack=true -Dhdp.version=2.2.0.0-2041 -Xmx3072m -Djava.io.tmpdir=/data/4/hadoop/yarn/local/usercache/root/appcache/application_1428164231378_0141/container_1428164231378_0141_01_000013/tmp -Dlog4j.configuration=container-log4j.properties -Dyarn.app.container.log.dir=/data/4/hadoop/yarn/log/application_1428164231378_0141/container_1428164231378_0141_01_000013 -Dyarn.app.container.log.filesize=0 -Dhadoop.root.logger=INFO,CLA org.apache.hadoop.mapred.YarnChild 172.27.1.10 54303 attempt_1428164231378_0141_m_000002_3 13 1>/data/4/hadoop/yarn/log/application_1428164231378_0141/container_1428164231378_0141_01_000013/stdout 2>/data/4/hadoop/yarn/log/application_1428164231378_0141/container_1428164231378_0141_01_000013/stderr  

Container killed on request. Exit code is 143
Container exited with a non-zero exit code 143


FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask
MapReduce Jobs Launched: 
Stage-Stage-2: Map: 46  Reduce: 179   Cumulative CPU: 1141.73 sec   HDFS Read: 991738418 HDFS Write: 18419 SUCCESS
Stage-Stage-4: Map: 4  Reduce: 1   Cumulative CPU: 131.59 sec   HDFS Read: 19331 HDFS Write: 0 FAIL
Total MapReduce CPU Time Spent: 21 minutes 13 seconds 320 msec
hive> 