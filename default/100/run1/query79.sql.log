15/04/06 21:53:38 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 21:53:38 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 21:53:38 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 21:53:38 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query79.sql;
OK
Time taken: 3.053 seconds
Query ID = root_20150406215353_8db3ceae-5758-400e-8f5c-9fb788ac2c9f
Total jobs = 2
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 21:54:04 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 21:54:04 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 21:54:04 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 21:54:04 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406215353_8db3ceae-5758-400e-8f5c-9fb788ac2c9f.log
2015-04-06 09:54:06	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 09:54:11	Dump the side-table for tag: 1 with group count: 5040 into file: file:/tmp/root/742cdba6-f379-4a9b-bb0b-5875a6160d86/hive_2015-04-06_21-53-45_912_6094287944451509767-1/-local-10011/HashTable-Stage-3/MapJoin-mapfile11--.hashtable
2015-04-06 09:54:11	Uploaded 1 File to: file:/tmp/root/742cdba6-f379-4a9b-bb0b-5875a6160d86/hive_2015-04-06_21-53-45_912_6094287944451509767-1/-local-10011/HashTable-Stage-3/MapJoin-mapfile11--.hashtable (116745 bytes)
2015-04-06 09:54:11	Dump the side-table for tag: 1 with group count: 378 into file: file:/tmp/root/742cdba6-f379-4a9b-bb0b-5875a6160d86/hive_2015-04-06_21-53-45_912_6094287944451509767-1/-local-10011/HashTable-Stage-3/MapJoin-mapfile21--.hashtable
2015-04-06 09:54:11	Uploaded 1 File to: file:/tmp/root/742cdba6-f379-4a9b-bb0b-5875a6160d86/hive_2015-04-06_21-53-45_912_6094287944451509767-1/-local-10011/HashTable-Stage-3/MapJoin-mapfile21--.hashtable (12686 bytes)
2015-04-06 09:54:11	Dump the side-table for tag: 1 with group count: 156 into file: file:/tmp/root/742cdba6-f379-4a9b-bb0b-5875a6160d86/hive_2015-04-06_21-53-45_912_6094287944451509767-1/-local-10011/HashTable-Stage-3/MapJoin-mapfile31--.hashtable
2015-04-06 09:54:11	Uploaded 1 File to: file:/tmp/root/742cdba6-f379-4a9b-bb0b-5875a6160d86/hive_2015-04-06_21-53-45_912_6094287944451509767-1/-local-10011/HashTable-Stage-3/MapJoin-mapfile31--.hashtable (4178 bytes)
2015-04-06 09:54:11	End of local task; Time Taken: 5.188 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 2
Number of reduce tasks not specified. Estimated from input data size: 179
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0152, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0152/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0152
Hadoop job information for Stage-3: number of mappers: 46; number of reducers: 179
2015-04-06 21:54:30,753 Stage-3 map = 0%,  reduce = 0%
2015-04-06 21:54:46,820 Stage-3 map = 1%,  reduce = 0%, Cumulative CPU 124.93 sec
2015-04-06 21:54:50,028 Stage-3 map = 8%,  reduce = 0%, Cumulative CPU 301.8 sec
2015-04-06 21:54:51,103 Stage-3 map = 14%,  reduce = 0%, Cumulative CPU 370.46 sec
2015-04-06 21:54:52,185 Stage-3 map = 15%,  reduce = 0%, Cumulative CPU 373.81 sec
2015-04-06 21:54:53,268 Stage-3 map = 32%,  reduce = 0%, Cumulative CPU 436.69 sec
2015-04-06 21:54:54,342 Stage-3 map = 45%,  reduce = 0%, Cumulative CPU 497.49 sec
2015-04-06 21:54:55,415 Stage-3 map = 56%,  reduce = 0%, Cumulative CPU 513.12 sec
2015-04-06 21:54:56,688 Stage-3 map = 66%,  reduce = 0%, Cumulative CPU 574.07 sec
2015-04-06 21:54:57,742 Stage-3 map = 69%,  reduce = 0%, Cumulative CPU 596.44 sec
2015-04-06 21:54:58,815 Stage-3 map = 72%,  reduce = 0%, Cumulative CPU 608.79 sec
2015-04-06 21:54:59,891 Stage-3 map = 78%,  reduce = 0%, Cumulative CPU 646.24 sec
2015-04-06 21:55:00,964 Stage-3 map = 83%,  reduce = 0%, Cumulative CPU 672.94 sec
2015-04-06 21:55:02,036 Stage-3 map = 86%,  reduce = 0%, Cumulative CPU 685.45 sec
2015-04-06 21:55:03,106 Stage-3 map = 96%,  reduce = 0%, Cumulative CPU 732.98 sec
2015-04-06 21:55:04,188 Stage-3 map = 99%,  reduce = 1%, Cumulative CPU 741.81 sec
2015-04-06 21:55:05,264 Stage-3 map = 100%,  reduce = 3%, Cumulative CPU 749.39 sec
2015-04-06 21:55:06,348 Stage-3 map = 100%,  reduce = 10%, Cumulative CPU 780.41 sec
2015-04-06 21:55:07,433 Stage-3 map = 100%,  reduce = 46%, Cumulative CPU 1052.12 sec
2015-04-06 21:55:08,507 Stage-3 map = 100%,  reduce = 57%, Cumulative CPU 1142.43 sec
2015-04-06 21:55:09,578 Stage-3 map = 100%,  reduce = 64%, Cumulative CPU 1187.26 sec
2015-04-06 21:55:10,650 Stage-3 map = 100%,  reduce = 69%, Cumulative CPU 1215.75 sec
2015-04-06 21:55:11,718 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 1398.2 sec
MapReduce Total cumulative CPU time: 23 minutes 18 seconds 200 msec
Ended Job = job_1428164231378_0152
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 21:55:17 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 21:55:17 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 21:55:17 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 21:55:17 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406215353_8db3ceae-5758-400e-8f5c-9fb788ac2c9f.log
2015-04-06 09:55:18	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 09:55:25	Processing rows:	200000	Hashtable size:	199999	Memory usage:	74053880	percentage:	0.07
2015-04-06 09:55:26	Processing rows:	300000	Hashtable size:	299999	Memory usage:	105742048	percentage:	0.099
2015-04-06 09:55:27	Processing rows:	400000	Hashtable size:	399999	Memory usage:	136761584	percentage:	0.128
2015-04-06 09:55:28	Processing rows:	500000	Hashtable size:	499999	Memory usage:	167615800	percentage:	0.157
2015-04-06 09:55:29	Processing rows:	600000	Hashtable size:	599999	Memory usage:	202760608	percentage:	0.19
2015-04-06 09:55:30	Processing rows:	700000	Hashtable size:	699999	Memory usage:	229352640	percentage:	0.215
2015-04-06 09:55:31	Processing rows:	800000	Hashtable size:	799999	Memory usage:	260133760	percentage:	0.244
2015-04-06 09:55:33	Processing rows:	900000	Hashtable size:	899999	Memory usage:	298233328	percentage:	0.28
2015-04-06 09:55:33	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	346091432	percentage:	0.325
2015-04-06 09:55:34	Processing rows:	1100000	Hashtable size:	1099999	Memory usage:	369813448	percentage:	0.347
2015-04-06 09:55:35	Processing rows:	1200000	Hashtable size:	1199999	Memory usage:	400451592	percentage:	0.376
2015-04-06 09:55:35	Processing rows:	1300000	Hashtable size:	1299999	Memory usage:	431226328	percentage:	0.405
2015-04-06 09:55:37	Processing rows:	1400000	Hashtable size:	1399999	Memory usage:	447061552	percentage:	0.42
2015-04-06 09:55:37	Processing rows:	1500000	Hashtable size:	1499999	Memory usage:	477091416	percentage:	0.448
2015-04-06 09:55:37	Processing rows:	1600000	Hashtable size:	1599999	Memory usage:	507787240	percentage:	0.477
2015-04-06 09:55:39	Processing rows:	1700000	Hashtable size:	1699999	Memory usage:	538689896	percentage:	0.506
2015-04-06 09:55:39	Processing rows:	1800000	Hashtable size:	1799999	Memory usage:	569024952	percentage:	0.534
2015-04-06 09:55:40	Processing rows:	1900000	Hashtable size:	1899999	Memory usage:	599894512	percentage:	0.563
2015-04-06 09:55:42	Processing rows:	2000000	Hashtable size:	1999999	Memory usage:	632538248	percentage:	0.594
2015-04-06 09:55:42	Dump the side-table for tag: 1 with group count: 2000000 into file: file:/tmp/root/742cdba6-f379-4a9b-bb0b-5875a6160d86/hive_2015-04-06_21-53-45_912_6094287944451509767-1/-local-10009/HashTable-Stage-5/MapJoin-mapfile01--.hashtable
2015-04-06 09:55:44	Uploaded 1 File to: file:/tmp/root/742cdba6-f379-4a9b-bb0b-5875a6160d86/hive_2015-04-06_21-53-45_912_6094287944451509767-1/-local-10009/HashTable-Stage-5/MapJoin-mapfile01--.hashtable (71382906 bytes)
2015-04-06 09:55:44	End of local task; Time Taken: 25.845 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 2 out of 2
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0153, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0153/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0153
Hadoop job information for Stage-5: number of mappers: 4; number of reducers: 1
2015-04-06 21:55:55,807 Stage-5 map = 0%,  reduce = 0%
2015-04-06 21:56:44,997 Stage-5 map = 100%,  reduce = 100%
Ended Job = job_1428164231378_0153 with errors
Error during job, obtaining debugging information...
Examining task ID: task_1428164231378_0153_m_000003 (and more) from job job_1428164231378_0153
Examining task ID: task_1428164231378_0153_m_000001 (and more) from job job_1428164231378_0153

Task with the most failures(4): 
-----
Task ID:
  task_1428164231378_0153_m_000001

URL:
  http://f01hn02.hadoop:8088/taskdetails.jsp?jobid=job_1428164231378_0153&tipid=task_1428164231378_0153_m_000001
-----
Diagnostic Messages for this Task:
Container [pid=4171,containerID=container_1428164231378_0153_01_000019] is running beyond physical memory limits. Current usage: 2.0 GB of 2 GB physical memory used; 3.8 GB of 4.2 GB virtual memory used. Killing container.
Dump of the process-tree for container_1428164231378_0153_01_000019 :
	|- PID PPID PGRPID SESSID CMD_NAME USER_MODE_TIME(MILLIS) SYSTEM_TIME(MILLIS) VMEM_USAGE(BYTES) RSSMEM_USAGE(PAGES) FULL_CMD_LINE
	|- 4187 4171 4171 4171 (java) 6911 124 4015759360 527975 /usr/jdk64/jdk1.7.0_67/bin/java -server -XX:NewRatio=8 -Djava.net.preferIPv4Stack=true -Dhdp.version=2.2.0.0-2041 -Xmx3072m -Djava.io.tmpdir=/data/4/hadoop/yarn/local/usercache/root/appcache/application_1428164231378_0153/container_1428164231378_0153_01_000019/tmp -Dlog4j.configuration=container-log4j.properties -Dyarn.app.container.log.dir=/data/8/hadoop/yarn/log/application_1428164231378_0153/container_1428164231378_0153_01_000019 -Dyarn.app.container.log.filesize=0 -Dhadoop.root.logger=INFO,CLA org.apache.hadoop.mapred.YarnChild 172.27.1.4 39319 attempt_1428164231378_0153_m_000001_3 19 
	|- 4171 4168 4171 4171 (bash) 0 0 108658688 305 /bin/bash -c /usr/jdk64/jdk1.7.0_67/bin/java -server -XX:NewRatio=8 -Djava.net.preferIPv4Stack=true -Dhdp.version=2.2.0.0-2041 -Xmx3072m -Djava.io.tmpdir=/data/4/hadoop/yarn/local/usercache/root/appcache/application_1428164231378_0153/container_1428164231378_0153_01_000019/tmp -Dlog4j.configuration=container-log4j.properties -Dyarn.app.container.log.dir=/data/8/hadoop/yarn/log/application_1428164231378_0153/container_1428164231378_0153_01_000019 -Dyarn.app.container.log.filesize=0 -Dhadoop.root.logger=INFO,CLA org.apache.hadoop.mapred.YarnChild 172.27.1.4 39319 attempt_1428164231378_0153_m_000001_3 19 1>/data/8/hadoop/yarn/log/application_1428164231378_0153/container_1428164231378_0153_01_000019/stdout 2>/data/8/hadoop/yarn/log/application_1428164231378_0153/container_1428164231378_0153_01_000019/stderr  

Container killed on request. Exit code is 143
Container exited with a non-zero exit code 143


FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 46  Reduce: 179   Cumulative CPU: 1398.2 sec   HDFS Read: 2433021196 HDFS Write: 70113126 SUCCESS
Stage-Stage-5: Map: 4  Reduce: 1   HDFS Read: 0 HDFS Write: 0 FAIL
Total MapReduce CPU Time Spent: 23 minutes 18 seconds 200 msec
hive> 