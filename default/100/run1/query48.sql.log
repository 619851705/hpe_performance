15/04/06 20:17:33 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 20:17:33 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 20:17:33 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 20:17:33 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query48.sql;
OK
Time taken: 2.677 seconds
Warning: Map Join MAPJOIN[40][bigTable=?] in task 'Stage-5:MAPRED' is a cross product
Warning: Map Join MAPJOIN[41][bigTable=?] in task 'Stage-5:MAPRED' is a cross product
Query ID = root_20150406201717_4a9be0b5-e8f4-4873-8737-599b23f0acaa
Total jobs = 1
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 20:18:00 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 20:18:00 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 20:18:00 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 20:18:00 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406201717_4a9be0b5-e8f4-4873-8737-599b23f0acaa.log
2015-04-06 08:18:02	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 08:18:22	Dump the side-table for tag: 1 with group count: 365 into file: file:/tmp/root/598599a9-4669-4825-bafe-83b8de18db88/hive_2015-04-06_20-17-40_861_2245641339064119606-1/-local-10008/HashTable-Stage-5/MapJoin-mapfile01--.hashtable
2015-04-06 08:18:23	Uploaded 1 File to: file:/tmp/root/598599a9-4669-4825-bafe-83b8de18db88/hive_2015-04-06_20-17-40_861_2245641339064119606-1/-local-10008/HashTable-Stage-5/MapJoin-mapfile01--.hashtable (7963 bytes)
2015-04-06 08:18:23	Dump the side-table for tag: 1 with group count: 1 into file: file:/tmp/root/598599a9-4669-4825-bafe-83b8de18db88/hive_2015-04-06_20-17-40_861_2245641339064119606-1/-local-10008/HashTable-Stage-5/MapJoin-mapfile11--.hashtable
2015-04-06 08:18:23	Uploaded 1 File to: file:/tmp/root/598599a9-4669-4825-bafe-83b8de18db88/hive_2015-04-06_20-17-40_861_2245641339064119606-1/-local-10008/HashTable-Stage-5/MapJoin-mapfile11--.hashtable (25607274 bytes)
2015-04-06 08:18:23	Dump the side-table for tag: 1 with group count: 1 into file: file:/tmp/root/598599a9-4669-4825-bafe-83b8de18db88/hive_2015-04-06_20-17-40_861_2245641339064119606-1/-local-10008/HashTable-Stage-5/MapJoin-mapfile21--.hashtable
2015-04-06 08:18:24	Uploaded 1 File to: file:/tmp/root/598599a9-4669-4825-bafe-83b8de18db88/hive_2015-04-06_20-17-40_861_2245641339064119606-1/-local-10008/HashTable-Stage-5/MapJoin-mapfile21--.hashtable (41570748 bytes)
2015-04-06 08:18:24	Dump the side-table for tag: 1 with group count: 402 into file: file:/tmp/root/598599a9-4669-4825-bafe-83b8de18db88/hive_2015-04-06_20-17-40_861_2245641339064119606-1/-local-10008/HashTable-Stage-5/MapJoin-mapfile31--.hashtable
2015-04-06 08:18:24	Uploaded 1 File to: file:/tmp/root/598599a9-4669-4825-bafe-83b8de18db88/hive_2015-04-06_20-17-40_861_2245641339064119606-1/-local-10008/HashTable-Stage-5/MapJoin-mapfile31--.hashtable (7956 bytes)
2015-04-06 08:18:24	End of local task; Time Taken: 22.814 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 1
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0070, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0070/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0070
Hadoop job information for Stage-5: number of mappers: 46; number of reducers: 1
2015-04-06 20:18:46,851 Stage-5 map = 0%,  reduce = 0%
2015-04-06 20:19:47,313 Stage-5 map = 0%,  reduce = 0%, Cumulative CPU 402.88 sec
2015-04-06 20:20:35,522 Stage-5 map = 11%,  reduce = 0%, Cumulative CPU 1007.9 sec
2015-04-06 20:20:36,636 Stage-5 map = 0%,  reduce = 0%, Cumulative CPU 284.35 sec
2015-04-06 20:20:47,296 Stage-5 map = 100%,  reduce = 100%
MapReduce Total cumulative CPU time: 4 minutes 44 seconds 350 msec
Ended Job = job_1428164231378_0070 with errors
Error during job, obtaining debugging information...
Examining task ID: task_1428164231378_0070_m_000021 (and more) from job job_1428164231378_0070
Examining task ID: task_1428164231378_0070_m_000008 (and more) from job job_1428164231378_0070
Examining task ID: task_1428164231378_0070_m_000009 (and more) from job job_1428164231378_0070
Examining task ID: task_1428164231378_0070_m_000027 (and more) from job job_1428164231378_0070
Examining task ID: task_1428164231378_0070_m_000030 (and more) from job job_1428164231378_0070
Examining task ID: task_1428164231378_0070_m_000021 (and more) from job job_1428164231378_0070
Examining task ID: task_1428164231378_0070_m_000037 (and more) from job job_1428164231378_0070
Examining task ID: task_1428164231378_0070_m_000018 (and more) from job job_1428164231378_0070
Examining task ID: task_1428164231378_0070_m_000015 (and more) from job job_1428164231378_0070
Examining task ID: task_1428164231378_0070_m_000027 (and more) from job job_1428164231378_0070
Examining task ID: task_1428164231378_0070_m_000040 (and more) from job job_1428164231378_0070

Task with the most failures(4): 
-----
Task ID:
  task_1428164231378_0070_m_000029

URL:
  http://f01hn02.hadoop:8088/taskdetails.jsp?jobid=job_1428164231378_0070&tipid=task_1428164231378_0070_m_000029
-----
Diagnostic Messages for this Task:
Container [pid=55329,containerID=container_1428164231378_0070_01_000136] is running beyond physical memory limits. Current usage: 2.0 GB of 2 GB physical memory used; 3.8 GB of 4.2 GB virtual memory used. Killing container.
Dump of the process-tree for container_1428164231378_0070_01_000136 :
	|- PID PPID PGRPID SESSID CMD_NAME USER_MODE_TIME(MILLIS) SYSTEM_TIME(MILLIS) VMEM_USAGE(BYTES) RSSMEM_USAGE(PAGES) FULL_CMD_LINE
	|- 55349 55329 55329 55329 (java) 6448 126 4008161280 535479 /usr/jdk64/jdk1.7.0_67/bin/java -server -XX:NewRatio=8 -Djava.net.preferIPv4Stack=true -Dhdp.version=2.2.0.0-2041 -Xmx3072m -Djava.io.tmpdir=/data/8/hadoop/yarn/local/usercache/root/appcache/application_1428164231378_0070/container_1428164231378_0070_01_000136/tmp -Dlog4j.configuration=container-log4j.properties -Dyarn.app.container.log.dir=/data/1/hadoop/yarn/log/application_1428164231378_0070/container_1428164231378_0070_01_000136 -Dyarn.app.container.log.filesize=0 -Dhadoop.root.logger=INFO,CLA org.apache.hadoop.mapred.YarnChild 172.27.1.3 45457 attempt_1428164231378_0070_m_000029_3 136 
	|- 55329 55327 55329 55329 (bash) 0 0 108658688 306 /bin/bash -c /usr/jdk64/jdk1.7.0_67/bin/java -server -XX:NewRatio=8 -Djava.net.preferIPv4Stack=true -Dhdp.version=2.2.0.0-2041 -Xmx3072m -Djava.io.tmpdir=/data/8/hadoop/yarn/local/usercache/root/appcache/application_1428164231378_0070/container_1428164231378_0070_01_000136/tmp -Dlog4j.configuration=container-log4j.properties -Dyarn.app.container.log.dir=/data/1/hadoop/yarn/log/application_1428164231378_0070/container_1428164231378_0070_01_000136 -Dyarn.app.container.log.filesize=0 -Dhadoop.root.logger=INFO,CLA org.apache.hadoop.mapred.YarnChild 172.27.1.3 45457 attempt_1428164231378_0070_m_000029_3 136 1>/data/1/hadoop/yarn/log/application_1428164231378_0070/container_1428164231378_0070_01_000136/stdout 2>/data/1/hadoop/yarn/log/application_1428164231378_0070/container_1428164231378_0070_01_000136/stderr  

Container killed on request. Exit code is 143
Container exited with a non-zero exit code 143


FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask
MapReduce Jobs Launched: 
Stage-Stage-5: Map: 46  Reduce: 1   Cumulative CPU: 284.35 sec   HDFS Read: 0 HDFS Write: 0 FAIL
Total MapReduce CPU Time Spent: 4 minutes 44 seconds 350 msec
hive> 