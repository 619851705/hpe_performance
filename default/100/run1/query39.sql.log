15/04/06 20:01:28 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 20:01:28 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 20:01:28 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 20:01:28 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query39.sql;
OK
Time taken: 3.07 seconds
Query ID = root_20150406200101_c87cc5d6-da92-42e3-8857-98748e138139
Total jobs = 6
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 20:01:53 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 20:01:53 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 20:01:53 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 20:01:53 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406200101_c87cc5d6-da92-42e3-8857-98748e138139.log
2015-04-06 08:01:54	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 08:02:00	Processing rows:	200000	Hashtable size:	199999	Memory usage:	26500384	percentage:	0.025
2015-04-06 08:02:00	Dump the side-table for tag: 1 with group count: 30 into file: file:/tmp/root/d4ee7d46-f0c4-49ca-a8a9-4d87f9c77072/hive_2015-04-06_20-01-35_925_2400249291899446127-1/-local-10017/HashTable-Stage-3/MapJoin-mapfile21--.hashtable
2015-04-06 08:02:00	Uploaded 1 File to: file:/tmp/root/d4ee7d46-f0c4-49ca-a8a9-4d87f9c77072/hive_2015-04-06_20-01-35_925_2400249291899446127-1/-local-10017/HashTable-Stage-3/MapJoin-mapfile21--.hashtable (893 bytes)
2015-04-06 08:02:00	Dump the side-table for tag: 1 with group count: 15 into file: file:/tmp/root/d4ee7d46-f0c4-49ca-a8a9-4d87f9c77072/hive_2015-04-06_20-01-35_925_2400249291899446127-1/-local-10017/HashTable-Stage-3/MapJoin-mapfile31--.hashtable
2015-04-06 08:02:00	Uploaded 1 File to: file:/tmp/root/d4ee7d46-f0c4-49ca-a8a9-4d87f9c77072/hive_2015-04-06_20-01-35_925_2400249291899446127-1/-local-10017/HashTable-Stage-3/MapJoin-mapfile31--.hashtable (793 bytes)
2015-04-06 08:02:00	Dump the side-table for tag: 1 with group count: 204000 into file: file:/tmp/root/d4ee7d46-f0c4-49ca-a8a9-4d87f9c77072/hive_2015-04-06_20-01-35_925_2400249291899446127-1/-local-10017/HashTable-Stage-3/MapJoin-mapfile41--.hashtable
2015-04-06 08:02:00	Uploaded 1 File to: file:/tmp/root/d4ee7d46-f0c4-49ca-a8a9-4d87f9c77072/hive_2015-04-06_20-01-35_925_2400249291899446127-1/-local-10017/HashTable-Stage-3/MapJoin-mapfile41--.hashtable (4238938 bytes)
2015-04-06 08:02:00	End of local task; Time Taken: 6.06 sec.
Execution completed successfully
MapredLocal task succeeded
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 20:02:06 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 20:02:06 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 20:02:06 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 20:02:06 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406200101_c87cc5d6-da92-42e3-8857-98748e138139.log
2015-04-06 08:02:07	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 08:02:13	Processing rows:	200000	Hashtable size:	199999	Memory usage:	25961608	percentage:	0.024
2015-04-06 08:02:13	Dump the side-table for tag: 1 with group count: 31 into file: file:/tmp/root/d4ee7d46-f0c4-49ca-a8a9-4d87f9c77072/hive_2015-04-06_20-01-35_925_2400249291899446127-1/-local-10019/HashTable-Stage-11/MapJoin-mapfile51--.hashtable
2015-04-06 08:02:14	Uploaded 1 File to: file:/tmp/root/d4ee7d46-f0c4-49ca-a8a9-4d87f9c77072/hive_2015-04-06_20-01-35_925_2400249291899446127-1/-local-10019/HashTable-Stage-11/MapJoin-mapfile51--.hashtable (914 bytes)
2015-04-06 08:02:14	Dump the side-table for tag: 1 with group count: 15 into file: file:/tmp/root/d4ee7d46-f0c4-49ca-a8a9-4d87f9c77072/hive_2015-04-06_20-01-35_925_2400249291899446127-1/-local-10019/HashTable-Stage-11/MapJoin-mapfile61--.hashtable
2015-04-06 08:02:14	Uploaded 1 File to: file:/tmp/root/d4ee7d46-f0c4-49ca-a8a9-4d87f9c77072/hive_2015-04-06_20-01-35_925_2400249291899446127-1/-local-10019/HashTable-Stage-11/MapJoin-mapfile61--.hashtable (793 bytes)
2015-04-06 08:02:14	Dump the side-table for tag: 1 with group count: 204000 into file: file:/tmp/root/d4ee7d46-f0c4-49ca-a8a9-4d87f9c77072/hive_2015-04-06_20-01-35_925_2400249291899446127-1/-local-10019/HashTable-Stage-11/MapJoin-mapfile71--.hashtable
2015-04-06 08:02:14	Uploaded 1 File to: file:/tmp/root/d4ee7d46-f0c4-49ca-a8a9-4d87f9c77072/hive_2015-04-06_20-01-35_925_2400249291899446127-1/-local-10019/HashTable-Stage-11/MapJoin-mapfile71--.hashtable (4238938 bytes)
2015-04-06 08:02:14	End of local task; Time Taken: 6.738 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 6
Number of reduce tasks not specified. Estimated from input data size: 10
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0060, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0060/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0060
Hadoop job information for Stage-3: number of mappers: 5; number of reducers: 10
2015-04-06 20:02:26,546 Stage-3 map = 0%,  reduce = 0%
2015-04-06 20:02:34,453 Stage-3 map = 20%,  reduce = 0%, Cumulative CPU 5.62 sec
2015-04-06 20:02:36,621 Stage-3 map = 23%,  reduce = 0%, Cumulative CPU 41.15 sec
2015-04-06 20:02:39,868 Stage-3 map = 25%,  reduce = 0%, Cumulative CPU 58.77 sec
2015-04-06 20:02:43,107 Stage-3 map = 28%,  reduce = 0%, Cumulative CPU 75.39 sec
2015-04-06 20:02:45,279 Stage-3 map = 28%,  reduce = 7%, Cumulative CPU 78.49 sec
2015-04-06 20:02:46,567 Stage-3 map = 31%,  reduce = 7%, Cumulative CPU 95.82 sec
2015-04-06 20:02:48,702 Stage-3 map = 34%,  reduce = 7%, Cumulative CPU 113.19 sec
2015-04-06 20:02:51,945 Stage-3 map = 35%,  reduce = 7%, Cumulative CPU 131.37 sec
2015-04-06 20:02:55,175 Stage-3 map = 37%,  reduce = 7%, Cumulative CPU 148.69 sec
2015-04-06 20:02:58,633 Stage-3 map = 47%,  reduce = 7%, Cumulative CPU 168.6 sec
2015-04-06 20:03:00,793 Stage-3 map = 47%,  reduce = 13%, Cumulative CPU 173.71 sec
2015-04-06 20:03:01,871 Stage-3 map = 48%,  reduce = 13%, Cumulative CPU 181.77 sec
2015-04-06 20:03:07,264 Stage-3 map = 49%,  reduce = 13%, Cumulative CPU 207.87 sec
2015-04-06 20:03:09,381 Stage-3 map = 46%,  reduce = 13%, Cumulative CPU 157.52 sec
2015-04-06 20:03:11,777 Stage-3 map = 43%,  reduce = 13%, Cumulative CPU 110.74 sec
2015-04-06 20:03:13,929 Stage-3 map = 44%,  reduce = 13%, Cumulative CPU 115.04 sec
2015-04-06 20:03:19,285 Stage-3 map = 45%,  reduce = 13%, Cumulative CPU 135.49 sec
2015-04-06 20:03:22,517 Stage-3 map = 46%,  reduce = 13%, Cumulative CPU 152.91 sec
2015-04-06 20:03:25,956 Stage-3 map = 42%,  reduce = 13%, Cumulative CPU 93.64 sec
2015-04-06 20:03:31,336 Stage-3 map = 43%,  reduce = 13%, Cumulative CPU 111.66 sec
2015-04-06 20:03:35,851 Stage-3 map = 44%,  reduce = 13%, Cumulative CPU 129.42 sec
2015-04-06 20:03:39,088 Stage-3 map = 45%,  reduce = 13%, Cumulative CPU 142.63 sec
2015-04-06 20:03:42,310 Stage-3 map = 46%,  reduce = 13%, Cumulative CPU 159.57 sec
2015-04-06 20:03:45,772 Stage-3 map = 47%,  reduce = 13%, Cumulative CPU 173.9 sec
2015-04-06 20:03:48,964 Stage-3 map = 48%,  reduce = 13%, Cumulative CPU 186.84 sec
2015-04-06 20:03:52,176 Stage-3 map = 49%,  reduce = 13%, Cumulative CPU 200.24 sec
2015-04-06 20:03:56,461 Stage-3 map = 50%,  reduce = 13%, Cumulative CPU 223.11 sec
2015-04-06 20:04:00,746 Stage-3 map = 51%,  reduce = 13%, Cumulative CPU 250.75 sec
2015-04-06 20:04:05,278 Stage-3 map = 52%,  reduce = 13%, Cumulative CPU 266.25 sec
2015-04-06 20:04:09,559 Stage-3 map = 53%,  reduce = 13%, Cumulative CPU 287.76 sec
2015-04-06 20:04:12,774 Stage-3 map = 54%,  reduce = 13%, Cumulative CPU 299.17 sec
2015-04-06 20:04:16,207 Stage-3 map = 55%,  reduce = 13%, Cumulative CPU 318.79 sec
2015-04-06 20:04:20,487 Stage-3 map = 56%,  reduce = 13%, Cumulative CPU 334.59 sec
2015-04-06 20:04:23,693 Stage-3 map = 52%,  reduce = 13%, Cumulative CPU 277.39 sec
2015-04-06 20:04:31,412 Stage-3 map = 53%,  reduce = 13%, Cumulative CPU 297.75 sec
2015-04-06 20:04:35,672 Stage-3 map = 54%,  reduce = 13%, Cumulative CPU 318.54 sec
2015-04-06 20:04:38,877 Stage-3 map = 55%,  reduce = 13%, Cumulative CPU 330.63 sec
2015-04-06 20:04:42,305 Stage-3 map = 56%,  reduce = 13%, Cumulative CPU 346.75 sec
2015-04-06 20:04:45,515 Stage-3 map = 57%,  reduce = 13%, Cumulative CPU 359.01 sec
2015-04-06 20:04:47,653 Stage-3 map = 58%,  reduce = 13%, Cumulative CPU 362.87 sec
2015-04-06 20:04:54,078 Stage-3 map = 59%,  reduce = 13%, Cumulative CPU 391.06 sec
2015-04-06 20:04:58,582 Stage-3 map = 60%,  reduce = 13%, Cumulative CPU 409.81 sec
2015-04-06 20:05:03,928 Stage-3 map = 61%,  reduce = 13%, Cumulative CPU 428.81 sec
2015-04-06 20:05:06,069 Stage-3 map = 62%,  reduce = 13%, Cumulative CPU 436.12 sec
2015-04-06 20:05:09,524 Stage-3 map = 63%,  reduce = 13%, Cumulative CPU 447.68 sec
2015-04-06 20:05:12,735 Stage-3 map = 64%,  reduce = 13%, Cumulative CPU 462.97 sec
2015-04-06 20:05:14,875 Stage-3 map = 79%,  reduce = 13%, Cumulative CPU 467.2 sec
2015-04-06 20:05:15,943 Stage-3 map = 60%,  reduce = 13%, Cumulative CPU 408.96 sec
2015-04-06 20:05:18,078 Stage-3 map = 67%,  reduce = 13%, Cumulative CPU 415.24 sec
2015-04-06 20:05:20,194 Stage-3 map = 67%,  reduce = 15%, Cumulative CPU 418.83 sec
2015-04-06 20:05:21,264 Stage-3 map = 67%,  reduce = 20%, Cumulative CPU 419.19 sec
2015-04-06 20:05:25,728 Stage-3 map = 68%,  reduce = 20%, Cumulative CPU 432.01 sec
2015-04-06 20:05:28,906 Stage-3 map = 69%,  reduce = 20%, Cumulative CPU 443.72 sec
2015-04-06 20:05:34,490 Stage-3 map = 70%,  reduce = 20%, Cumulative CPU 457.03 sec
2015-04-06 20:05:38,768 Stage-3 map = 71%,  reduce = 20%, Cumulative CPU 470.21 sec
2015-04-06 20:05:49,589 Stage-3 map = 72%,  reduce = 20%, Cumulative CPU 497.54 sec
2015-04-06 20:05:55,995 Stage-3 map = 73%,  reduce = 20%, Cumulative CPU 513.06 sec
2015-04-06 20:06:02,606 Stage-3 map = 74%,  reduce = 20%, Cumulative CPU 532.69 sec
2015-04-06 20:06:06,872 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 210.39 sec
MapReduce Total cumulative CPU time: 3 minutes 30 seconds 390 msec
Ended Job = job_1428164231378_0060 with errors
Error during job, obtaining debugging information...
Examining task ID: task_1428164231378_0060_m_000004 (and more) from job job_1428164231378_0060

Task with the most failures(4): 
-----
Task ID:
  task_1428164231378_0060_m_000002

URL:
  http://f01hn02.hadoop:8088/taskdetails.jsp?jobid=job_1428164231378_0060&tipid=task_1428164231378_0060_m_000002
-----
Diagnostic Messages for this Task:
Container [pid=41570,containerID=container_1428164231378_0060_01_000021] is running beyond physical memory limits. Current usage: 2.0 GB of 2 GB physical memory used; 3.8 GB of 4.2 GB virtual memory used. Killing container.
Dump of the process-tree for container_1428164231378_0060_01_000021 :
	|- PID PPID PGRPID SESSID CMD_NAME USER_MODE_TIME(MILLIS) SYSTEM_TIME(MILLIS) VMEM_USAGE(BYTES) RSSMEM_USAGE(PAGES) FULL_CMD_LINE
	|- 41586 41570 41570 41570 (java) 6555 136 4003532800 530864 /usr/jdk64/jdk1.7.0_67/bin/java -server -XX:NewRatio=8 -Djava.net.preferIPv4Stack=true -Dhdp.version=2.2.0.0-2041 -Xmx3072m -Djava.io.tmpdir=/data/3/hadoop/yarn/local/usercache/root/appcache/application_1428164231378_0060/container_1428164231378_0060_01_000021/tmp -Dlog4j.configuration=container-log4j.properties -Dyarn.app.container.log.dir=/data/5/hadoop/yarn/log/application_1428164231378_0060/container_1428164231378_0060_01_000021 -Dyarn.app.container.log.filesize=0 -Dhadoop.root.logger=INFO,CLA org.apache.hadoop.mapred.YarnChild 172.27.1.1 40898 attempt_1428164231378_0060_m_000002_3 21 
	|- 41570 41568 41570 41570 (bash) 0 0 108658688 305 /bin/bash -c /usr/jdk64/jdk1.7.0_67/bin/java -server -XX:NewRatio=8 -Djava.net.preferIPv4Stack=true -Dhdp.version=2.2.0.0-2041 -Xmx3072m -Djava.io.tmpdir=/data/3/hadoop/yarn/local/usercache/root/appcache/application_1428164231378_0060/container_1428164231378_0060_01_000021/tmp -Dlog4j.configuration=container-log4j.properties -Dyarn.app.container.log.dir=/data/5/hadoop/yarn/log/application_1428164231378_0060/container_1428164231378_0060_01_000021 -Dyarn.app.container.log.filesize=0 -Dhadoop.root.logger=INFO,CLA org.apache.hadoop.mapred.YarnChild 172.27.1.1 40898 attempt_1428164231378_0060_m_000002_3 21 1>/data/5/hadoop/yarn/log/application_1428164231378_0060/container_1428164231378_0060_01_000021/stdout 2>/data/5/hadoop/yarn/log/application_1428164231378_0060/container_1428164231378_0060_01_000021/stderr  

Container killed on request. Exit code is 143
Container exited with a non-zero exit code 143


FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 5  Reduce: 10   Cumulative CPU: 210.39 sec   HDFS Read: 223888957 HDFS Write: 0 FAIL
Total MapReduce CPU Time Spent: 3 minutes 30 seconds 390 msec
hive> 