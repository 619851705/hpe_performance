15/04/06 22:21:16 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 22:21:16 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 22:21:16 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 22:21:16 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query90.sql;
OK
Time taken: 2.76 seconds
Warning: Map Join MAPJOIN[253][bigTable=?] in task 'Stage-16:MAPRED' is a cross product
Warning: Map Join MAPJOIN[168][bigTable=?] in task 'Stage-15:MAPRED' is a cross product
Warning: Shuffle Join JOIN[52][tables = [at, pt]] in Stage 'Stage-3:MAPRED' is a cross product
Query ID = root_20150406222121_0c8aca2e-c15a-4419-84c9-866f90c39eb0
Total jobs = 6
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 22:21:45 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 22:21:45 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 22:21:45 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 22:21:45 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406222121_0c8aca2e-c15a-4419-84c9-866f90c39eb0.log
2015-04-06 10:21:46	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 10:21:51	Dump the side-table for tag: 1 with group count: 38 into file: file:/tmp/root/4bf11949-e216-4afd-a224-903a283bf2dd/hive_2015-04-06_22-21-22_895_3342419396526703422-1/-local-10017/HashTable-Stage-9/MapJoin-mapfile21--.hashtable
2015-04-06 10:21:51	Uploaded 1 File to: file:/tmp/root/4bf11949-e216-4afd-a224-903a283bf2dd/hive_2015-04-06_22-21-22_895_3342419396526703422-1/-local-10017/HashTable-Stage-9/MapJoin-mapfile21--.hashtable (1170 bytes)
2015-04-06 10:21:51	Dump the side-table for tag: 1 with group count: 7200 into file: file:/tmp/root/4bf11949-e216-4afd-a224-903a283bf2dd/hive_2015-04-06_22-21-22_895_3342419396526703422-1/-local-10017/HashTable-Stage-9/MapJoin-mapfile31--.hashtable
2015-04-06 10:21:52	Uploaded 1 File to: file:/tmp/root/4bf11949-e216-4afd-a224-903a283bf2dd/hive_2015-04-06_22-21-22_895_3342419396526703422-1/-local-10017/HashTable-Stage-9/MapJoin-mapfile31--.hashtable (159433 bytes)
2015-04-06 10:21:52	Dump the side-table for tag: 1 with group count: 720 into file: file:/tmp/root/4bf11949-e216-4afd-a224-903a283bf2dd/hive_2015-04-06_22-21-22_895_3342419396526703422-1/-local-10017/HashTable-Stage-9/MapJoin-mapfile41--.hashtable
2015-04-06 10:21:52	Uploaded 1 File to: file:/tmp/root/4bf11949-e216-4afd-a224-903a283bf2dd/hive_2015-04-06_22-21-22_895_3342419396526703422-1/-local-10017/HashTable-Stage-9/MapJoin-mapfile41--.hashtable (14730 bytes)
2015-04-06 10:21:52	End of local task; Time Taken: 5.159 sec.
Execution completed successfully
MapredLocal task succeeded
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 22:21:58 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 22:21:58 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 22:21:58 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 22:21:58 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406222121_0c8aca2e-c15a-4419-84c9-866f90c39eb0.log
2015-04-06 10:21:59	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 10:22:04	Dump the side-table for tag: 1 with group count: 38 into file: file:/tmp/root/4bf11949-e216-4afd-a224-903a283bf2dd/hive_2015-04-06_22-21-22_895_3342419396526703422-1/-local-10019/HashTable-Stage-2/MapJoin-mapfile51--.hashtable
2015-04-06 10:22:04	Uploaded 1 File to: file:/tmp/root/4bf11949-e216-4afd-a224-903a283bf2dd/hive_2015-04-06_22-21-22_895_3342419396526703422-1/-local-10019/HashTable-Stage-2/MapJoin-mapfile51--.hashtable (1170 bytes)
2015-04-06 10:22:04	Dump the side-table for tag: 1 with group count: 7200 into file: file:/tmp/root/4bf11949-e216-4afd-a224-903a283bf2dd/hive_2015-04-06_22-21-22_895_3342419396526703422-1/-local-10019/HashTable-Stage-2/MapJoin-mapfile61--.hashtable
2015-04-06 10:22:04	Uploaded 1 File to: file:/tmp/root/4bf11949-e216-4afd-a224-903a283bf2dd/hive_2015-04-06_22-21-22_895_3342419396526703422-1/-local-10019/HashTable-Stage-2/MapJoin-mapfile61--.hashtable (159433 bytes)
2015-04-06 10:22:04	Dump the side-table for tag: 1 with group count: 720 into file: file:/tmp/root/4bf11949-e216-4afd-a224-903a283bf2dd/hive_2015-04-06_22-21-22_895_3342419396526703422-1/-local-10019/HashTable-Stage-2/MapJoin-mapfile71--.hashtable
2015-04-06 10:22:04	Uploaded 1 File to: file:/tmp/root/4bf11949-e216-4afd-a224-903a283bf2dd/hive_2015-04-06_22-21-22_895_3342419396526703422-1/-local-10019/HashTable-Stage-2/MapJoin-mapfile71--.hashtable (14730 bytes)
2015-04-06 10:22:04	End of local task; Time Taken: 5.234 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 6
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0175, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0175/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0175
Hadoop job information for Stage-9: number of mappers: 18; number of reducers: 1
2015-04-06 22:22:23,054 Stage-9 map = 0%,  reduce = 0%
2015-04-06 22:22:33,817 Stage-9 map = 6%,  reduce = 0%, Cumulative CPU 7.79 sec
2015-04-06 22:22:34,889 Stage-9 map = 72%,  reduce = 0%, Cumulative CPU 151.29 sec
2015-04-06 22:22:35,964 Stage-9 map = 100%,  reduce = 0%, Cumulative CPU 166.53 sec
2015-04-06 22:22:39,191 Stage-9 map = 100%,  reduce = 100%, Cumulative CPU 168.06 sec
MapReduce Total cumulative CPU time: 2 minutes 48 seconds 60 msec
Ended Job = job_1428164231378_0175
Launching Job 2 out of 6
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0176, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0176/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0176
Hadoop job information for Stage-2: number of mappers: 18; number of reducers: 1
2015-04-06 22:22:53,116 Stage-2 map = 0%,  reduce = 0%
2015-04-06 22:23:03,750 Stage-2 map = 6%,  reduce = 0%, Cumulative CPU 7.06 sec
2015-04-06 22:23:04,819 Stage-2 map = 93%,  reduce = 0%, Cumulative CPU 161.13 sec
2015-04-06 22:23:05,889 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 162.62 sec
2015-04-06 22:23:09,097 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 164.26 sec
MapReduce Total cumulative CPU time: 2 minutes 44 seconds 260 msec
Ended Job = job_1428164231378_0176
Stage-24 is selected by condition resolver.
Stage-25 is filtered out by condition resolver.
Stage-3 is filtered out by condition resolver.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/06 22:23:16 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/06 22:23:16 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/06 22:23:16 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/06 22:23:16 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150406222121_0c8aca2e-c15a-4419-84c9-866f90c39eb0.log
2015-04-06 10:23:17	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-06 10:23:19	Dump the side-table for tag: 1 with group count: 1 into file: file:/tmp/root/4bf11949-e216-4afd-a224-903a283bf2dd/hive_2015-04-06_22-21-22_895_3342419396526703422-1/-local-10013/HashTable-Stage-15/MapJoin-mapfile01--.hashtable
2015-04-06 10:23:19	Uploaded 1 File to: file:/tmp/root/4bf11949-e216-4afd-a224-903a283bf2dd/hive_2015-04-06_22-21-22_895_3342419396526703422-1/-local-10013/HashTable-Stage-15/MapJoin-mapfile01--.hashtable (280 bytes)
2015-04-06 10:23:19	End of local task; Time Taken: 1.86 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 4 out of 6
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1428164231378_0177, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0177/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0177
Hadoop job information for Stage-15: number of mappers: 1; number of reducers: 0
2015-04-06 22:23:26,109 Stage-15 map = 0%,  reduce = 0%
2015-04-06 22:23:31,433 Stage-15 map = 100%,  reduce = 0%, Cumulative CPU 1.59 sec
MapReduce Total cumulative CPU time: 1 seconds 590 msec
Ended Job = job_1428164231378_0177
Launching Job 5 out of 6
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428164231378_0178, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428164231378_0178/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428164231378_0178
Hadoop job information for Stage-4: number of mappers: 1; number of reducers: 1
2015-04-06 22:23:37,891 Stage-4 map = 0%,  reduce = 0%
2015-04-06 22:23:43,460 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 1.35 sec
2015-04-06 22:23:48,802 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 2.79 sec
MapReduce Total cumulative CPU time: 2 seconds 790 msec
Ended Job = job_1428164231378_0178
MapReduce Jobs Launched: 
Stage-Stage-9: Map: 18  Reduce: 1   Cumulative CPU: 168.06 sec   HDFS Read: 263412345 HDFS Write: 116 SUCCESS
Stage-Stage-2: Map: 18  Reduce: 1   Cumulative CPU: 164.26 sec   HDFS Read: 263412345 HDFS Write: 116 SUCCESS
Stage-Stage-15: Map: 1   Cumulative CPU: 1.59 sec   HDFS Read: 522 HDFS Write: 124 SUCCESS
Stage-Stage-4: Map: 1  Reduce: 1   Cumulative CPU: 2.79 sec   HDFS Read: 530 HDFS Write: 23 SUCCESS
Total MapReduce CPU Time Spent: 5 minutes 36 seconds 700 msec
OK
0.99766763848396501458
Time taken: 146.989 seconds, Fetched: 1 row(s)
hive> 