15/04/07 06:52:30 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 06:52:30 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 06:52:30 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 06:52:30 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query21.sql;
OK
Time taken: 2.995 seconds
Query ID = root_20150407065252_0de92f4a-1f2a-4330-8d88-88a3ed4acd39
Total jobs = 2
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 06:52:53 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 06:52:53 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 06:52:53 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 06:52:53 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407065252_0de92f4a-1f2a-4330-8d88-88a3ed4acd39.log
2015-04-07 06:52:55	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 06:53:00	Dump the side-table for tag: 1 with group count: 60 into file: file:/tmp/root/dd6385de-905b-46ac-b60e-ce651fafadeb/hive_2015-04-07_06-52-38_364_3474997710651086496-1/-local-10008/HashTable-Stage-2/MapJoin-mapfile01--.hashtable
2015-04-07 06:53:00	Uploaded 1 File to: file:/tmp/root/dd6385de-905b-46ac-b60e-ce651fafadeb/hive_2015-04-07_06-52-38_364_3474997710651086496-1/-local-10008/HashTable-Stage-2/MapJoin-mapfile01--.hashtable (2248 bytes)
2015-04-07 06:53:00	Dump the side-table for tag: 1 with group count: 12587 into file: file:/tmp/root/dd6385de-905b-46ac-b60e-ce651fafadeb/hive_2015-04-07_06-52-38_364_3474997710651086496-1/-local-10008/HashTable-Stage-2/MapJoin-mapfile11--.hashtable
2015-04-07 06:53:00	Uploaded 1 File to: file:/tmp/root/dd6385de-905b-46ac-b60e-ce651fafadeb/hive_2015-04-07_06-52-38_364_3474997710651086496-1/-local-10008/HashTable-Stage-2/MapJoin-mapfile11--.hashtable (540018 bytes)
2015-04-07 06:53:00	Dump the side-table for tag: 1 with group count: 15 into file: file:/tmp/root/dd6385de-905b-46ac-b60e-ce651fafadeb/hive_2015-04-07_06-52-38_364_3474997710651086496-1/-local-10008/HashTable-Stage-2/MapJoin-mapfile21--.hashtable
2015-04-07 06:53:01	Uploaded 1 File to: file:/tmp/root/dd6385de-905b-46ac-b60e-ce651fafadeb/hive_2015-04-07_06-52-38_364_3474997710651086496-1/-local-10008/HashTable-Stage-2/MapJoin-mapfile21--.hashtable (793 bytes)
2015-04-07 06:53:01	End of local task; Time Taken: 5.942 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 2
Number of reduce tasks not specified. Estimated from input data size: 10
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0012, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0012/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0012
Hadoop job information for Stage-2: number of mappers: 5; number of reducers: 10
2015-04-07 06:53:12,643 Stage-2 map = 0%,  reduce = 0%
2015-04-07 06:53:21,586 Stage-2 map = 20%,  reduce = 0%, Cumulative CPU 5.6 sec
2015-04-07 06:53:23,763 Stage-2 map = 21%,  reduce = 0%, Cumulative CPU 38.05 sec
2015-04-07 06:53:25,937 Stage-2 map = 24%,  reduce = 0%, Cumulative CPU 51.93 sec
2015-04-07 06:53:29,405 Stage-2 map = 25%,  reduce = 0%, Cumulative CPU 65.67 sec
2015-04-07 06:53:31,589 Stage-2 map = 25%,  reduce = 7%, Cumulative CPU 68.75 sec
2015-04-07 06:53:32,679 Stage-2 map = 28%,  reduce = 7%, Cumulative CPU 82.26 sec
2015-04-07 06:53:35,922 Stage-2 map = 29%,  reduce = 7%, Cumulative CPU 96.86 sec
2015-04-07 06:53:38,088 Stage-2 map = 31%,  reduce = 7%, Cumulative CPU 108.44 sec
2015-04-07 06:53:39,387 Stage-2 map = 32%,  reduce = 7%, Cumulative CPU 112.36 sec
2015-04-07 06:53:41,530 Stage-2 map = 33%,  reduce = 7%, Cumulative CPU 127.51 sec
2015-04-07 06:53:44,774 Stage-2 map = 35%,  reduce = 7%, Cumulative CPU 143.7 sec
2015-04-07 06:53:48,235 Stage-2 map = 37%,  reduce = 7%, Cumulative CPU 158.42 sec
2015-04-07 06:53:50,394 Stage-2 map = 40%,  reduce = 7%, Cumulative CPU 173.23 sec
2015-04-07 06:53:52,549 Stage-2 map = 47%,  reduce = 7%, Cumulative CPU 174.95 sec
2015-04-07 06:53:53,632 Stage-2 map = 48%,  reduce = 13%, Cumulative CPU 185.94 sec
2015-04-07 06:53:56,876 Stage-2 map = 49%,  reduce = 13%, Cumulative CPU 196.59 sec
2015-04-07 06:54:02,436 Stage-2 map = 50%,  reduce = 13%, Cumulative CPU 211.16 sec
2015-04-07 06:54:05,675 Stage-2 map = 51%,  reduce = 13%, Cumulative CPU 231.38 sec
2015-04-07 06:54:09,122 Stage-2 map = 52%,  reduce = 13%, Cumulative CPU 242.17 sec
2015-04-07 06:54:15,581 Stage-2 map = 53%,  reduce = 13%, Cumulative CPU 263.3 sec
2015-04-07 06:54:17,939 Stage-2 map = 54%,  reduce = 13%, Cumulative CPU 273.67 sec
2015-04-07 06:54:21,135 Stage-2 map = 55%,  reduce = 13%, Cumulative CPU 284.56 sec
2015-04-07 06:54:26,710 Stage-2 map = 56%,  reduce = 13%, Cumulative CPU 299.39 sec
2015-04-07 06:54:29,939 Stage-2 map = 57%,  reduce = 13%, Cumulative CPU 311.94 sec
2015-04-07 06:54:33,166 Stage-2 map = 58%,  reduce = 13%, Cumulative CPU 329.49 sec
2015-04-07 06:54:36,615 Stage-2 map = 59%,  reduce = 13%, Cumulative CPU 340.76 sec
2015-04-07 06:54:41,985 Stage-2 map = 60%,  reduce = 13%, Cumulative CPU 355.92 sec
2015-04-07 06:54:45,406 Stage-2 map = 61%,  reduce = 13%, Cumulative CPU 374.43 sec
2015-04-07 06:54:48,630 Stage-2 map = 62%,  reduce = 13%, Cumulative CPU 385.84 sec
2015-04-07 06:54:55,087 Stage-2 map = 63%,  reduce = 13%, Cumulative CPU 411.11 sec
2015-04-07 06:54:57,440 Stage-2 map = 64%,  reduce = 13%, Cumulative CPU 422.75 sec
2015-04-07 06:55:00,657 Stage-2 map = 65%,  reduce = 13%, Cumulative CPU 434.54 sec
2015-04-07 06:55:03,864 Stage-2 map = 66%,  reduce = 13%, Cumulative CPU 446.02 sec
2015-04-07 06:55:07,284 Stage-2 map = 67%,  reduce = 13%, Cumulative CPU 457.37 sec
2015-04-07 06:55:12,644 Stage-2 map = 68%,  reduce = 13%, Cumulative CPU 481.75 sec
2015-04-07 06:55:15,858 Stage-2 map = 69%,  reduce = 13%, Cumulative CPU 494.48 sec
2015-04-07 06:55:19,313 Stage-2 map = 76%,  reduce = 13%, Cumulative CPU 506.92 sec
2015-04-07 06:55:21,459 Stage-2 map = 76%,  reduce = 20%, Cumulative CPU 507.49 sec
2015-04-07 06:55:22,531 Stage-2 map = 77%,  reduce = 20%, Cumulative CPU 514.59 sec
2015-04-07 06:55:27,889 Stage-2 map = 78%,  reduce = 20%, Cumulative CPU 530.65 sec
2015-04-07 06:55:37,744 Stage-2 map = 79%,  reduce = 20%, Cumulative CPU 554.37 sec
2015-04-07 06:55:43,351 Stage-2 map = 80%,  reduce = 20%, Cumulative CPU 570.66 sec
2015-04-07 06:55:49,987 Stage-2 map = 81%,  reduce = 20%, Cumulative CPU 589.88 sec
2015-04-07 06:55:58,560 Stage-2 map = 82%,  reduce = 20%, Cumulative CPU 617.77 sec
2015-04-07 06:56:05,194 Stage-2 map = 83%,  reduce = 20%, Cumulative CPU 632.47 sec
2015-04-07 06:56:09,702 Stage-2 map = 90%,  reduce = 22%, Cumulative CPU 641.52 sec
2015-04-07 06:56:10,775 Stage-2 map = 90%,  reduce = 24%, Cumulative CPU 645.15 sec
2015-04-07 06:56:12,917 Stage-2 map = 90%,  reduce = 27%, Cumulative CPU 645.6 sec
2015-04-07 06:56:20,621 Stage-2 map = 91%,  reduce = 27%, Cumulative CPU 656.56 sec
2015-04-07 06:56:35,848 Stage-2 map = 92%,  reduce = 27%, Cumulative CPU 675.89 sec
2015-04-07 06:56:50,123 Stage-2 map = 93%,  reduce = 27%, Cumulative CPU 695.17 sec
2015-04-07 06:57:02,109 Stage-2 map = 100%,  reduce = 27%, Cumulative CPU 709.21 sec
2015-04-07 06:57:03,180 Stage-2 map = 100%,  reduce = 41%, Cumulative CPU 715.17 sec
2015-04-07 06:57:04,249 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 739.48 sec
MapReduce Total cumulative CPU time: 12 minutes 19 seconds 480 msec
Ended Job = job_1428405026382_0012
Launching Job 2 out of 2
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0013, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0013/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0013
Hadoop job information for Stage-3: number of mappers: 4; number of reducers: 1
2015-04-07 06:57:11,667 Stage-3 map = 0%,  reduce = 0%
2015-04-07 06:57:17,010 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 9.58 sec
2015-04-07 06:57:22,340 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 10.99 sec
MapReduce Total cumulative CPU time: 10 seconds 990 msec
Ended Job = job_1428405026382_0013
MapReduce Jobs Launched: 
Stage-Stage-2: Map: 5  Reduce: 10   Cumulative CPU: 739.48 sec   HDFS Read: 621615629 HDFS Write: 3065279 SUCCESS
Stage-Stage-3: Map: 4  Reduce: 1   Cumulative CPU: 10.99 sec   HDFS Read: 3068469 HDFS Write: 2799 SUCCESS
Total MapReduce CPU Time Spent: 12 minutes 30 seconds 470 msec
OK
	AAAAAAAAAAADCAAA	2262	2398
	AAAAAAAAAABFBAAA	3327	2898
	AAAAAAAAAABPBAAA	2122	2017
	AAAAAAAAAACDAAAA	1315	1752
	AAAAAAAAAAEIBAAA	1834	1522
	AAAAAAAAAAFBBAAA	1751	2538
	AAAAAAAAAAFFBAAA	1933	2420
	AAAAAAAAAAFKBAAA	2387	1838
	AAAAAAAAAAFLAAAA	3110	2731
	AAAAAAAAAAFPAAAA	3229	2220
	AAAAAAAAAAGJBAAA	1678	2154
	AAAAAAAAAAHMAAAA	3283	2641
	AAAAAAAAAAHPBAAA	2044	2966
	AAAAAAAAAAIIAAAA	2113	2691
	AAAAAAAAAAJMBAAA	2422	1848
	AAAAAAAAAALAAAAA	2085	2020
	AAAAAAAAAALADAAA	1968	2006
	AAAAAAAAAALCBAAA	1984	2411
	AAAAAAAAAAMJBAAA	1260	1460
	AAAAAAAAAANCBAAA	2465	2811
	AAAAAAAAAANDAAAA	1802	2159
	AAAAAAAAAANKAAAA	2812	2215
	AAAAAAAAAAOCAAAA	1973	2812
	AAAAAAAAAAOHCAAA	1844	2590
	AAAAAAAAABCFAAAA	2038	1953
	AAAAAAAAABCPBAAA	2859	2638
	AAAAAAAAABDHAAAA	2206	2233
	AAAAAAAAABDHCAAA	1858	2147
	AAAAAAAAABECBAAA	1972	1759
	AAAAAAAAABEECAAA	2206	2686
	AAAAAAAAABENBAAA	1932	2165
	AAAAAAAAABFABAAA	1464	2050
	AAAAAAAAABGMAAAA	2135	2160
	AAAAAAAAABGNAAAA	1697	1883
	AAAAAAAAABHFBAAA	2244	2989
	AAAAAAAAABIHAAAA	1349	1971
	AAAAAAAAABJFCAAA	2449	1891
	AAAAAAAAABJHCAAA	1566	1570
	AAAAAAAAABLFAAAA	1783	1833
	AAAAAAAAABLHBAAA	1991	1621
	AAAAAAAAABLNAAAA	2456	2546
	AAAAAAAAABMBCAAA	2564	2083
	AAAAAAAAABMHCAAA	2169	2395
	AAAAAAAAABMKCAAA	2348	3367
	AAAAAAAAABNIBAAA	2053	2254
	AAAAAAAAABOMBAAA	1798	1810
	AAAAAAAAABONBAAA	2565	2593
	AAAAAAAAABPEAAAA	1532	1834
	AAAAAAAAABPLBAAA	2200	1664
	AAAAAAAAACCDBAAA	2378	2752
	AAAAAAAAACDIBAAA	1388	1893
	AAAAAAAAACDMCAAA	1939	2867
	AAAAAAAAACEHBAAA	2191	3246
	AAAAAAAAACFDBAAA	2406	2547
	AAAAAAAAACGGCAAA	1707	2212
	AAAAAAAAACGLAAAA	2238	3153
	AAAAAAAAACGLBAAA	1819	2446
	AAAAAAAAACGOAAAA	1974	2796
	AAAAAAAAACHABAAA	1893	2466
	AAAAAAAAACHACAAA	2013	2579
	AAAAAAAAACHCAAAA	1189	1575
	AAAAAAAAACIBCAAA	2657	3732
	AAAAAAAAACIDBAAA	1431	1220
	AAAAAAAAACKCAAAA	1010	977
	AAAAAAAAACKMCAAA	1565	1245
	AAAAAAAAACLADAAA	2226	1838
	AAAAAAAAACLDAAAA	1906	1901
	AAAAAAAAACLECAAA	2002	2465
	AAAAAAAAACLGAAAA	2193	3074
	AAAAAAAAACLNAAAA	2501	2079
	AAAAAAAAACNBBAAA	2577	1908
	AAAAAAAAACNDBAAA	1870	1311
	AAAAAAAAACOBAAAA	2407	1929
	AAAAAAAAACPDAAAA	2235	2077
	AAAAAAAAACPLBAAA	1749	2555
	AAAAAAAAADBADAAA	2127	2825
	AAAAAAAAADCBBAAA	2484	3282
	AAAAAAAAADCMAAAA	1876	2564
	AAAAAAAAADCMCAAA	2206	1817
	AAAAAAAAADDACAAA	1384	1954
	AAAAAAAAADDMBAAA	2223	2271
	AAAAAAAAADGACAAA	1687	2151
	AAAAAAAAADHBCAAA	1956	1838
	AAAAAAAAADHIBAAA	2335	1687
	AAAAAAAAADIJAAAA	1243	1260
	AAAAAAAAADJGCAAA	2520	2419
	AAAAAAAAADMOAAAA	1587	2196
	AAAAAAAAADNLBAAA	2314	2503
	AAAAAAAAADPOAAAA	2480	1894
	AAAAAAAAAEAGAAAA	2689	2738
	AAAAAAAAAEBFAAAA	1963	2709
	AAAAAAAAAEBKBAAA	2114	2802
	AAAAAAAAAECGCAAA	2515	2708
	AAAAAAAAAECKBAAA	1940	2831
	AAAAAAAAAECPBAAA	1655	2094
	AAAAAAAAAEEKCAAA	1876	1609
	AAAAAAAAAEGCBAAA	1622	2239
	AAAAAAAAAEGHCAAA	1929	2252
	AAAAAAAAAEGLCAAA	2478	1869
	AAAAAAAAAEHADAAA	3236	3273
Time taken: 285.091 seconds, Fetched: 100 row(s)
hive> 