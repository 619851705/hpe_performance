15/04/07 15:59:57 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 15:59:57 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 15:59:57 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 15:59:57 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query90.sql;
OK
Time taken: 2.883 seconds
Warning: Map Join MAPJOIN[253][bigTable=?] in task 'Stage-16:MAPRED' is a cross product
Warning: Map Join MAPJOIN[168][bigTable=?] in task 'Stage-15:MAPRED' is a cross product
Warning: Shuffle Join JOIN[52][tables = [at, pt]] in Stage 'Stage-3:MAPRED' is a cross product
Query ID = root_20150407160000_3f0b33b8-3545-4a3b-bcc1-fb430c8eba1f
Total jobs = 6
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 16:00:28 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 16:00:28 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 16:00:28 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 16:00:28 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407160000_3f0b33b8-3545-4a3b-bcc1-fb430c8eba1f.log
2015-04-07 04:00:29	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 04:00:34	Dump the side-table for tag: 1 with group count: 38 into file: file:/tmp/root/2093d2a3-3f97-4887-95e0-b55c10550d28/hive_2015-04-07_16-00-04_527_1412228244456590158-1/-local-10017/HashTable-Stage-9/MapJoin-mapfile21--.hashtable
2015-04-07 04:00:34	Uploaded 1 File to: file:/tmp/root/2093d2a3-3f97-4887-95e0-b55c10550d28/hive_2015-04-07_16-00-04_527_1412228244456590158-1/-local-10017/HashTable-Stage-9/MapJoin-mapfile21--.hashtable (1170 bytes)
2015-04-07 04:00:34	Dump the side-table for tag: 1 with group count: 7200 into file: file:/tmp/root/2093d2a3-3f97-4887-95e0-b55c10550d28/hive_2015-04-07_16-00-04_527_1412228244456590158-1/-local-10017/HashTable-Stage-9/MapJoin-mapfile31--.hashtable
2015-04-07 04:00:34	Uploaded 1 File to: file:/tmp/root/2093d2a3-3f97-4887-95e0-b55c10550d28/hive_2015-04-07_16-00-04_527_1412228244456590158-1/-local-10017/HashTable-Stage-9/MapJoin-mapfile31--.hashtable (159433 bytes)
2015-04-07 04:00:34	Dump the side-table for tag: 1 with group count: 720 into file: file:/tmp/root/2093d2a3-3f97-4887-95e0-b55c10550d28/hive_2015-04-07_16-00-04_527_1412228244456590158-1/-local-10017/HashTable-Stage-9/MapJoin-mapfile41--.hashtable
2015-04-07 04:00:34	Uploaded 1 File to: file:/tmp/root/2093d2a3-3f97-4887-95e0-b55c10550d28/hive_2015-04-07_16-00-04_527_1412228244456590158-1/-local-10017/HashTable-Stage-9/MapJoin-mapfile41--.hashtable (14730 bytes)
2015-04-07 04:00:34	End of local task; Time Taken: 4.86 sec.
Execution completed successfully
MapredLocal task succeeded
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 16:00:41 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 16:00:41 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 16:00:41 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 16:00:41 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407160000_3f0b33b8-3545-4a3b-bcc1-fb430c8eba1f.log
2015-04-07 04:00:42	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 04:00:46	Dump the side-table for tag: 1 with group count: 38 into file: file:/tmp/root/2093d2a3-3f97-4887-95e0-b55c10550d28/hive_2015-04-07_16-00-04_527_1412228244456590158-1/-local-10019/HashTable-Stage-2/MapJoin-mapfile51--.hashtable
2015-04-07 04:00:47	Uploaded 1 File to: file:/tmp/root/2093d2a3-3f97-4887-95e0-b55c10550d28/hive_2015-04-07_16-00-04_527_1412228244456590158-1/-local-10019/HashTable-Stage-2/MapJoin-mapfile51--.hashtable (1170 bytes)
2015-04-07 04:00:47	Dump the side-table for tag: 1 with group count: 7200 into file: file:/tmp/root/2093d2a3-3f97-4887-95e0-b55c10550d28/hive_2015-04-07_16-00-04_527_1412228244456590158-1/-local-10019/HashTable-Stage-2/MapJoin-mapfile61--.hashtable
2015-04-07 04:00:47	Uploaded 1 File to: file:/tmp/root/2093d2a3-3f97-4887-95e0-b55c10550d28/hive_2015-04-07_16-00-04_527_1412228244456590158-1/-local-10019/HashTable-Stage-2/MapJoin-mapfile61--.hashtable (159433 bytes)
2015-04-07 04:00:47	Dump the side-table for tag: 1 with group count: 720 into file: file:/tmp/root/2093d2a3-3f97-4887-95e0-b55c10550d28/hive_2015-04-07_16-00-04_527_1412228244456590158-1/-local-10019/HashTable-Stage-2/MapJoin-mapfile71--.hashtable
2015-04-07 04:00:47	Uploaded 1 File to: file:/tmp/root/2093d2a3-3f97-4887-95e0-b55c10550d28/hive_2015-04-07_16-00-04_527_1412228244456590158-1/-local-10019/HashTable-Stage-2/MapJoin-mapfile71--.hashtable (14730 bytes)
2015-04-07 04:00:47	End of local task; Time Taken: 5.018 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 6
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0179, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0179/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0179
Hadoop job information for Stage-9: number of mappers: 18; number of reducers: 1
2015-04-07 16:01:05,616 Stage-9 map = 0%,  reduce = 0%
2015-04-07 16:01:13,437 Stage-9 map = 6%,  reduce = 0%, Cumulative CPU 5.86 sec
2015-04-07 16:01:14,508 Stage-9 map = 11%,  reduce = 0%, Cumulative CPU 12.39 sec
2015-04-07 16:01:15,580 Stage-9 map = 65%,  reduce = 0%, Cumulative CPU 88.14 sec
2015-04-07 16:01:16,656 Stage-9 map = 100%,  reduce = 0%, Cumulative CPU 137.45 sec
2015-04-07 16:01:18,817 Stage-9 map = 100%,  reduce = 100%, Cumulative CPU 139.22 sec
MapReduce Total cumulative CPU time: 2 minutes 19 seconds 220 msec
Ended Job = job_1428405026382_0179
Launching Job 2 out of 6
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0180, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0180/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0180
Hadoop job information for Stage-2: number of mappers: 18; number of reducers: 1
2015-04-07 16:01:32,739 Stage-2 map = 0%,  reduce = 0%
2015-04-07 16:01:41,266 Stage-2 map = 6%,  reduce = 0%, Cumulative CPU 5.78 sec
2015-04-07 16:01:42,339 Stage-2 map = 50%,  reduce = 0%, Cumulative CPU 64.97 sec
2015-04-07 16:01:43,410 Stage-2 map = 100%,  reduce = 0%, Cumulative CPU 139.94 sec
2015-04-07 16:01:46,628 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 141.55 sec
MapReduce Total cumulative CPU time: 2 minutes 21 seconds 550 msec
Ended Job = job_1428405026382_0180
Stage-24 is selected by condition resolver.
Stage-25 is filtered out by condition resolver.
Stage-3 is filtered out by condition resolver.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 16:01:53 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 16:01:53 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 16:01:53 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 16:01:53 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407160000_3f0b33b8-3545-4a3b-bcc1-fb430c8eba1f.log
2015-04-07 04:01:53	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 04:01:55	Dump the side-table for tag: 1 with group count: 1 into file: file:/tmp/root/2093d2a3-3f97-4887-95e0-b55c10550d28/hive_2015-04-07_16-00-04_527_1412228244456590158-1/-local-10013/HashTable-Stage-15/MapJoin-mapfile01--.hashtable
2015-04-07 04:01:56	Uploaded 1 File to: file:/tmp/root/2093d2a3-3f97-4887-95e0-b55c10550d28/hive_2015-04-07_16-00-04_527_1412228244456590158-1/-local-10013/HashTable-Stage-15/MapJoin-mapfile01--.hashtable (280 bytes)
2015-04-07 04:01:56	End of local task; Time Taken: 2.185 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 4 out of 6
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1428405026382_0181, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0181/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0181
Hadoop job information for Stage-15: number of mappers: 1; number of reducers: 0
2015-04-07 16:02:02,553 Stage-15 map = 0%,  reduce = 0%
2015-04-07 16:02:07,888 Stage-15 map = 100%,  reduce = 0%, Cumulative CPU 1.59 sec
MapReduce Total cumulative CPU time: 1 seconds 590 msec
Ended Job = job_1428405026382_0181
Launching Job 5 out of 6
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0182, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0182/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0182
Hadoop job information for Stage-4: number of mappers: 1; number of reducers: 1
2015-04-07 16:02:14,571 Stage-4 map = 0%,  reduce = 0%
2015-04-07 16:02:19,876 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 1.19 sec
2015-04-07 16:02:25,222 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 2.69 sec
MapReduce Total cumulative CPU time: 2 seconds 690 msec
Ended Job = job_1428405026382_0182
MapReduce Jobs Launched: 
Stage-Stage-9: Map: 18  Reduce: 1   Cumulative CPU: 139.22 sec   HDFS Read: 263412345 HDFS Write: 116 SUCCESS
Stage-Stage-2: Map: 18  Reduce: 1   Cumulative CPU: 141.55 sec   HDFS Read: 263412345 HDFS Write: 116 SUCCESS
Stage-Stage-15: Map: 1   Cumulative CPU: 1.59 sec   HDFS Read: 522 HDFS Write: 124 SUCCESS
Stage-Stage-4: Map: 1  Reduce: 1   Cumulative CPU: 2.69 sec   HDFS Read: 530 HDFS Write: 23 SUCCESS
Total MapReduce CPU Time Spent: 4 minutes 45 seconds 50 msec
OK
0.99766763848396501458
Time taken: 141.805 seconds, Fetched: 1 row(s)
hive> 