15/04/07 08:58:01 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 08:58:01 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 08:58:01 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 08:58:01 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query54.sql;
OK
Time taken: 2.832 seconds
Query ID = root_20150407085858_9185e26e-3325-4f26-a423-f1561fa40313
Total jobs = 8
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 08:58:41 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 08:58:41 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 08:58:41 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 08:58:41 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407085858_9185e26e-3325-4f26-a423-f1561fa40313.log
2015-04-07 08:58:43	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 08:58:47	Dump the side-table for tag: 1 with group count: 0 into file: file:/tmp/root/adaa481b-9efc-4fa5-a710-f1a33ffb8836/hive_2015-04-07_08-58-08_934_9198894784462901742-1/-local-10022/HashTable-Stage-25/MapJoin-mapfile71--.hashtable
2015-04-07 08:58:47	Uploaded 1 File to: file:/tmp/root/adaa481b-9efc-4fa5-a710-f1a33ffb8836/hive_2015-04-07_08-58-08_934_9198894784462901742-1/-local-10022/HashTable-Stage-25/MapJoin-mapfile71--.hashtable (260 bytes)
2015-04-07 08:58:47	End of local task; Time Taken: 4.461 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 8
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1428405026382_0085, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0085/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0085
Hadoop job information for Stage-25: number of mappers: 51; number of reducers: 0
2015-04-07 08:59:12,769 Stage-25 map = 0%,  reduce = 0%
2015-04-07 08:59:20,309 Stage-25 map = 2%,  reduce = 0%, Cumulative CPU 5.16 sec
2015-04-07 08:59:21,384 Stage-25 map = 4%,  reduce = 0%, Cumulative CPU 11.45 sec
2015-04-07 08:59:22,455 Stage-25 map = 6%,  reduce = 0%, Cumulative CPU 18.95 sec
2015-04-07 08:59:23,535 Stage-25 map = 81%,  reduce = 0%, Cumulative CPU 417.17 sec
2015-04-07 08:59:24,589 Stage-25 map = 90%,  reduce = 0%, Cumulative CPU 461.64 sec
2015-04-07 08:59:25,657 Stage-25 map = 100%,  reduce = 0%, Cumulative CPU 504.56 sec
MapReduce Total cumulative CPU time: 8 minutes 24 seconds 560 msec
Ended Job = job_1428405026382_0085
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 08:59:31 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 08:59:31 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 08:59:31 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 08:59:31 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407085858_9185e26e-3325-4f26-a423-f1561fa40313.log
2015-04-07 08:59:33	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 08:59:38	Processing rows:	200000	Hashtable size:	199999	Memory usage:	57349176	percentage:	0.054
2015-04-07 08:59:39	Processing rows:	300000	Hashtable size:	299999	Memory usage:	81047368	percentage:	0.076
2015-04-07 08:59:40	Processing rows:	400000	Hashtable size:	399999	Memory usage:	103866704	percentage:	0.097
2015-04-07 08:59:41	Processing rows:	500000	Hashtable size:	499999	Memory usage:	126726296	percentage:	0.119
2015-04-07 08:59:41	Processing rows:	600000	Hashtable size:	599999	Memory usage:	153705464	percentage:	0.144
2015-04-07 08:59:42	Processing rows:	700000	Hashtable size:	699999	Memory usage:	172499440	percentage:	0.162
2015-04-07 08:59:43	Processing rows:	800000	Hashtable size:	799999	Memory usage:	195262272	percentage:	0.183
2015-04-07 08:59:43	Processing rows:	900000	Hashtable size:	899999	Memory usage:	226283248	percentage:	0.212
2015-04-07 08:59:44	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	257204760	percentage:	0.241
2015-04-07 08:59:46	Processing rows:	1100000	Hashtable size:	1099999	Memory usage:	278910496	percentage:	0.262
2015-04-07 08:59:46	Processing rows:	1200000	Hashtable size:	1199999	Memory usage:	301878280	percentage:	0.283
2015-04-07 08:59:46	Processing rows:	1300000	Hashtable size:	1299999	Memory usage:	324655440	percentage:	0.305
2015-04-07 08:59:48	Processing rows:	1400000	Hashtable size:	1399999	Memory usage:	333551736	percentage:	0.313
2015-04-07 08:59:48	Processing rows:	1500000	Hashtable size:	1499999	Memory usage:	356104816	percentage:	0.334
2015-04-07 08:59:48	Processing rows:	1600000	Hashtable size:	1599999	Memory usage:	378551616	percentage:	0.355
2015-04-07 08:59:49	Processing rows:	1700000	Hashtable size:	1699999	Memory usage:	401075440	percentage:	0.376
2015-04-07 08:59:50	Processing rows:	1800000	Hashtable size:	1799999	Memory usage:	423263048	percentage:	0.397
2015-04-07 08:59:50	Processing rows:	1900000	Hashtable size:	1899999	Memory usage:	446338432	percentage:	0.419
2015-04-07 08:59:52	Processing rows:	2000000	Hashtable size:	1999999	Memory usage:	468581160	percentage:	0.44
2015-04-07 08:59:52	Dump the side-table for tag: 1 with group count: 2000000 into file: file:/tmp/root/adaa481b-9efc-4fa5-a710-f1a33ffb8836/hive_2015-04-07_08-58-08_934_9198894784462901742-1/-local-10020/HashTable-Stage-9/MapJoin-mapfile51--.hashtable
2015-04-07 08:59:54	Uploaded 1 File to: file:/tmp/root/adaa481b-9efc-4fa5-a710-f1a33ffb8836/hive_2015-04-07_08-58-08_934_9198894784462901742-1/-local-10020/HashTable-Stage-9/MapJoin-mapfile51--.hashtable (52055848 bytes)
2015-04-07 08:59:54	Dump the side-table for tag: 1 with group count: 31 into file: file:/tmp/root/adaa481b-9efc-4fa5-a710-f1a33ffb8836/hive_2015-04-07_08-58-08_934_9198894784462901742-1/-local-10020/HashTable-Stage-9/MapJoin-mapfile61--.hashtable
2015-04-07 08:59:54	Uploaded 1 File to: file:/tmp/root/adaa481b-9efc-4fa5-a710-f1a33ffb8836/hive_2015-04-07_08-58-08_934_9198894784462901742-1/-local-10020/HashTable-Stage-9/MapJoin-mapfile61--.hashtable (914 bytes)
2015-04-07 08:59:54	End of local task; Time Taken: 21.127 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 2 out of 8
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0086, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0086/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0086
Hadoop job information for Stage-9: number of mappers: 4; number of reducers: 1
2015-04-07 09:00:03,550 Stage-9 map = 0%,  reduce = 0%
2015-04-07 09:00:09,931 Stage-9 map = 100%,  reduce = 0%, Cumulative CPU 8.35 sec
2015-04-07 09:00:16,324 Stage-9 map = 100%,  reduce = 100%, Cumulative CPU 9.8 sec
MapReduce Total cumulative CPU time: 9 seconds 800 msec
Ended Job = job_1428405026382_0086
Stage-27 is filtered out by condition resolver.
Stage-28 is selected by condition resolver.
Stage-7 is filtered out by condition resolver.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 09:00:22 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 09:00:22 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 09:00:22 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 09:00:22 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407085858_9185e26e-3325-4f26-a423-f1561fa40313.log
2015-04-07 09:00:23	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 09:00:25	Dump the side-table for tag: 0 with group count: 0 into file: file:/tmp/root/adaa481b-9efc-4fa5-a710-f1a33ffb8836/hive_2015-04-07_08-58-08_934_9198894784462901742-1/-local-10018/HashTable-Stage-21/MapJoin-mapfile40--.hashtable
2015-04-07 09:00:25	Uploaded 1 File to: file:/tmp/root/adaa481b-9efc-4fa5-a710-f1a33ffb8836/hive_2015-04-07_08-58-08_934_9198894784462901742-1/-local-10018/HashTable-Stage-21/MapJoin-mapfile40--.hashtable (260 bytes)
2015-04-07 09:00:25	End of local task; Time Taken: 2.162 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 4 out of 8
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1428405026382_0087, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0087/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0087
Hadoop job information for Stage-21: number of mappers: 46; number of reducers: 0
2015-04-07 09:00:38,299 Stage-21 map = 0%,  reduce = 0%
2015-04-07 09:00:47,836 Stage-21 map = 4%,  reduce = 0%, Cumulative CPU 14.44 sec
2015-04-07 09:00:48,875 Stage-21 map = 95%,  reduce = 0%, Cumulative CPU 374.25 sec
2015-04-07 09:00:49,936 Stage-21 map = 100%,  reduce = 0%, Cumulative CPU 401.01 sec
MapReduce Total cumulative CPU time: 6 minutes 41 seconds 10 msec
Ended Job = job_1428405026382_0087
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 09:00:56 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 09:00:56 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 09:00:56 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 09:00:56 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407085858_9185e26e-3325-4f26-a423-f1561fa40313.log
2015-04-07 09:00:57	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 09:01:04	Processing rows:	200000	Hashtable size:	199999	Memory usage:	74269976	percentage:	0.07
2015-04-07 09:01:05	Processing rows:	300000	Hashtable size:	299999	Memory usage:	108070352	percentage:	0.101
2015-04-07 09:01:06	Processing rows:	400000	Hashtable size:	399999	Memory usage:	137442176	percentage:	0.129
2015-04-07 09:01:07	Processing rows:	500000	Hashtable size:	499999	Memory usage:	173830240	percentage:	0.163
2015-04-07 09:01:08	Processing rows:	600000	Hashtable size:	599999	Memory usage:	205011608	percentage:	0.192
2015-04-07 09:01:09	Processing rows:	700000	Hashtable size:	699999	Memory usage:	236803192	percentage:	0.222
2015-04-07 09:01:10	Processing rows:	800000	Hashtable size:	799999	Memory usage:	268337632	percentage:	0.252
2015-04-07 09:01:11	Processing rows:	900000	Hashtable size:	899999	Memory usage:	295955392	percentage:	0.278
2015-04-07 09:01:11	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	328237088	percentage:	0.308
2015-04-07 09:01:12	Dump the side-table for tag: 1 with group count: 91 into file: file:/tmp/root/adaa481b-9efc-4fa5-a710-f1a33ffb8836/hive_2015-04-07_08-58-08_934_9198894784462901742-1/-local-10014/HashTable-Stage-4/MapJoin-mapfile01--.hashtable
2015-04-07 09:01:12	Uploaded 1 File to: file:/tmp/root/adaa481b-9efc-4fa5-a710-f1a33ffb8836/hive_2015-04-07_08-58-08_934_9198894784462901742-1/-local-10014/HashTable-Stage-4/MapJoin-mapfile01--.hashtable (2545 bytes)
2015-04-07 09:01:12	Dump the side-table for tag: 1 with group count: 13 into file: file:/tmp/root/adaa481b-9efc-4fa5-a710-f1a33ffb8836/hive_2015-04-07_08-58-08_934_9198894784462901742-1/-local-10014/HashTable-Stage-4/MapJoin-mapfile11--.hashtable
2015-04-07 09:01:12	Uploaded 1 File to: file:/tmp/root/adaa481b-9efc-4fa5-a710-f1a33ffb8836/hive_2015-04-07_08-58-08_934_9198894784462901742-1/-local-10014/HashTable-Stage-4/MapJoin-mapfile11--.hashtable (2234 bytes)
2015-04-07 09:01:12	Dump the side-table for tag: 1 with group count: 1000000 into file: file:/tmp/root/adaa481b-9efc-4fa5-a710-f1a33ffb8836/hive_2015-04-07_08-58-08_934_9198894784462901742-1/-local-10014/HashTable-Stage-4/MapJoin-mapfile21--.hashtable
2015-04-07 09:01:14	Uploaded 1 File to: file:/tmp/root/adaa481b-9efc-4fa5-a710-f1a33ffb8836/hive_2015-04-07_08-58-08_934_9198894784462901742-1/-local-10014/HashTable-Stage-4/MapJoin-mapfile21--.hashtable (39606821 bytes)
2015-04-07 09:01:14	End of local task; Time Taken: 16.633 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 5 out of 8
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0088, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0088/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0088
Hadoop job information for Stage-4: number of mappers: 4; number of reducers: 1
2015-04-07 09:01:22,034 Stage-4 map = 0%,  reduce = 0%
2015-04-07 09:01:28,389 Stage-4 map = 100%,  reduce = 0%, Cumulative CPU 8.08 sec
2015-04-07 09:01:35,058 Stage-4 map = 100%,  reduce = 100%, Cumulative CPU 10.21 sec
MapReduce Total cumulative CPU time: 10 seconds 210 msec
Ended Job = job_1428405026382_0088
Launching Job 6 out of 8
Number of reduce tasks not specified. Estimated from input data size: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0089, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0089/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0089
Hadoop job information for Stage-5: number of mappers: 1; number of reducers: 1
2015-04-07 09:01:41,156 Stage-5 map = 0%,  reduce = 0%
2015-04-07 09:01:45,459 Stage-5 map = 100%,  reduce = 0%, Cumulative CPU 1.15 sec
2015-04-07 09:01:51,798 Stage-5 map = 100%,  reduce = 100%, Cumulative CPU 2.89 sec
MapReduce Total cumulative CPU time: 2 seconds 890 msec
Ended Job = job_1428405026382_0089
Launching Job 7 out of 8
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0090, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0090/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0090
Hadoop job information for Stage-6: number of mappers: 1; number of reducers: 1
2015-04-07 09:01:57,887 Stage-6 map = 0%,  reduce = 0%
2015-04-07 09:02:03,181 Stage-6 map = 100%,  reduce = 0%, Cumulative CPU 1.33 sec
2015-04-07 09:02:08,487 Stage-6 map = 100%,  reduce = 100%, Cumulative CPU 2.34 sec
MapReduce Total cumulative CPU time: 2 seconds 340 msec
Ended Job = job_1428405026382_0090
MapReduce Jobs Launched: 
Stage-Stage-25: Map: 51   Cumulative CPU: 504.56 sec   HDFS Read: 729636974 HDFS Write: 4896 SUCCESS
Stage-Stage-9: Map: 4  Reduce: 1   Cumulative CPU: 9.8 sec   HDFS Read: 18787 HDFS Write: 96 SUCCESS
Stage-Stage-21: Map: 46   Cumulative CPU: 401.01 sec   HDFS Read: 1162161005 HDFS Write: 4416 SUCCESS
Stage-Stage-4: Map: 4  Reduce: 1   Cumulative CPU: 10.21 sec   HDFS Read: 17002 HDFS Write: 96 SUCCESS
Stage-Stage-5: Map: 1  Reduce: 1   Cumulative CPU: 2.89 sec   HDFS Read: 502 HDFS Write: 96 SUCCESS
Stage-Stage-6: Map: 1  Reduce: 1   Cumulative CPU: 2.34 sec   HDFS Read: 502 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 15 minutes 30 seconds 810 msec
OK
Time taken: 240.656 seconds
hive> 