15/04/07 15:06:16 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 15:06:16 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 15:06:16 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 15:06:16 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query68.sql;
OK
Time taken: 2.69 seconds
Query ID = root_20150407150606_33e5f76f-0df5-43ef-aeed-48491675e3c4
Total jobs = 2
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 15:06:44 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 15:06:44 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 15:06:44 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 15:06:44 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407150606_33e5f76f-0df5-43ef-aeed-48491675e3c4.log
2015-04-07 03:06:45	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 03:06:52	Processing rows:	200000	Hashtable size:	199999	Memory usage:	64992232	percentage:	0.061
2015-04-07 03:06:53	Processing rows:	300000	Hashtable size:	299999	Memory usage:	92246392	percentage:	0.087
2015-04-07 03:06:54	Processing rows:	400000	Hashtable size:	399999	Memory usage:	118619608	percentage:	0.111
2015-04-07 03:06:55	Processing rows:	500000	Hashtable size:	499999	Memory usage:	149055816	percentage:	0.14
2015-04-07 03:06:56	Processing rows:	600000	Hashtable size:	599999	Memory usage:	171493176	percentage:	0.161
2015-04-07 03:06:56	Processing rows:	700000	Hashtable size:	699999	Memory usage:	197935824	percentage:	0.186
2015-04-07 03:06:57	Processing rows:	800000	Hashtable size:	799999	Memory usage:	224354968	percentage:	0.211
2015-04-07 03:06:58	Processing rows:	900000	Hashtable size:	899999	Memory usage:	250401800	percentage:	0.235
2015-04-07 03:06:58	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	276079112	percentage:	0.259
2015-04-07 03:06:58	Dump the side-table for tag: 1 with group count: 1000000 into file: file:/tmp/root/da4a88ce-40b4-4300-a9d9-fe342aadca0a/hive_2015-04-07_15-06-23_589_5011701797639024576-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile21--.hashtable
2015-04-07 03:07:00	Uploaded 1 File to: file:/tmp/root/da4a88ce-40b4-4300-a9d9-fe342aadca0a/hive_2015-04-07_15-06-23_589_5011701797639024576-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile21--.hashtable (31770711 bytes)
2015-04-07 03:07:00	Dump the side-table for tag: 1 with group count: 1800 into file: file:/tmp/root/da4a88ce-40b4-4300-a9d9-fe342aadca0a/hive_2015-04-07_15-06-23_589_5011701797639024576-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile31--.hashtable
2015-04-07 03:07:00	Uploaded 1 File to: file:/tmp/root/da4a88ce-40b4-4300-a9d9-fe342aadca0a/hive_2015-04-07_15-06-23_589_5011701797639024576-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile31--.hashtable (41863 bytes)
2015-04-07 03:07:00	Dump the side-table for tag: 1 with group count: 0 into file: file:/tmp/root/da4a88ce-40b4-4300-a9d9-fe342aadca0a/hive_2015-04-07_15-06-23_589_5011701797639024576-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile41--.hashtable
2015-04-07 03:07:00	Uploaded 1 File to: file:/tmp/root/da4a88ce-40b4-4300-a9d9-fe342aadca0a/hive_2015-04-07_15-06-23_589_5011701797639024576-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile41--.hashtable (260 bytes)
2015-04-07 03:07:00	Dump the side-table for tag: 1 with group count: 72 into file: file:/tmp/root/da4a88ce-40b4-4300-a9d9-fe342aadca0a/hive_2015-04-07_15-06-23_589_5011701797639024576-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile51--.hashtable
2015-04-07 03:07:00	Uploaded 1 File to: file:/tmp/root/da4a88ce-40b4-4300-a9d9-fe342aadca0a/hive_2015-04-07_15-06-23_589_5011701797639024576-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile51--.hashtable (2140 bytes)
2015-04-07 03:07:00	End of local task; Time Taken: 14.459 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 2
Number of reduce tasks not specified. Estimated from input data size: 179
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0130, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0130/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0130
Hadoop job information for Stage-3: number of mappers: 46; number of reducers: 179
2015-04-07 15:07:21,629 Stage-3 map = 0%,  reduce = 0%
2015-04-07 15:07:31,591 Stage-3 map = 11%,  reduce = 0%, Cumulative CPU 139.17 sec
2015-04-07 15:07:32,670 Stage-3 map = 32%,  reduce = 0%, Cumulative CPU 518.63 sec
2015-04-07 15:07:33,755 Stage-3 map = 38%,  reduce = 0%, Cumulative CPU 526.61 sec
2015-04-07 15:07:34,828 Stage-3 map = 71%,  reduce = 0%, Cumulative CPU 573.84 sec
2015-04-07 15:07:35,883 Stage-3 map = 94%,  reduce = 0%, Cumulative CPU 624.52 sec
2015-04-07 15:07:36,959 Stage-3 map = 99%,  reduce = 0%, Cumulative CPU 628.09 sec
2015-04-07 15:07:38,034 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 629.27 sec
2015-04-07 15:07:39,126 Stage-3 map = 100%,  reduce = 3%, Cumulative CPU 640.37 sec
2015-04-07 15:07:40,200 Stage-3 map = 100%,  reduce = 16%, Cumulative CPU 681.71 sec
2015-04-07 15:07:41,254 Stage-3 map = 100%,  reduce = 24%, Cumulative CPU 709.89 sec
2015-04-07 15:07:42,331 Stage-3 map = 100%,  reduce = 30%, Cumulative CPU 728.26 sec
2015-04-07 15:07:43,409 Stage-3 map = 100%,  reduce = 40%, Cumulative CPU 764.43 sec
2015-04-07 15:07:44,487 Stage-3 map = 100%,  reduce = 49%, Cumulative CPU 795.0 sec
2015-04-07 15:07:45,562 Stage-3 map = 100%,  reduce = 58%, Cumulative CPU 824.72 sec
2015-04-07 15:07:46,636 Stage-3 map = 100%,  reduce = 67%, Cumulative CPU 855.09 sec
2015-04-07 15:07:47,713 Stage-3 map = 100%,  reduce = 79%, Cumulative CPU 894.45 sec
2015-04-07 15:07:48,763 Stage-3 map = 100%,  reduce = 91%, Cumulative CPU 934.83 sec
2015-04-07 15:07:49,795 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 963.56 sec
MapReduce Total cumulative CPU time: 16 minutes 3 seconds 560 msec
Ended Job = job_1428405026382_0130
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 15:07:56 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 15:07:56 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 15:07:56 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 15:07:56 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407150606_33e5f76f-0df5-43ef-aeed-48491675e3c4.log
2015-04-07 03:07:57	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 03:08:04	Processing rows:	200000	Hashtable size:	199999	Memory usage:	80945208	percentage:	0.076
2015-04-07 03:08:05	Processing rows:	300000	Hashtable size:	299999	Memory usage:	116283104	percentage:	0.109
2015-04-07 03:08:06	Processing rows:	400000	Hashtable size:	399999	Memory usage:	149404952	percentage:	0.14
2015-04-07 03:08:07	Processing rows:	500000	Hashtable size:	499999	Memory usage:	180509600	percentage:	0.169
2015-04-07 03:08:08	Processing rows:	600000	Hashtable size:	599999	Memory usage:	221862976	percentage:	0.208
2015-04-07 03:08:09	Processing rows:	700000	Hashtable size:	699999	Memory usage:	255278072	percentage:	0.24
2015-04-07 03:08:09	Processing rows:	800000	Hashtable size:	799999	Memory usage:	288278192	percentage:	0.271
2015-04-07 03:08:11	Processing rows:	900000	Hashtable size:	899999	Memory usage:	329755560	percentage:	0.309
2015-04-07 03:08:11	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	379528112	percentage:	0.356
2015-04-07 03:08:13	Processing rows:	1100000	Hashtable size:	1099999	Memory usage:	384388896	percentage:	0.361
2015-04-07 03:08:13	Processing rows:	1200000	Hashtable size:	1199999	Memory usage:	417835120	percentage:	0.392
2015-04-07 03:08:15	Processing rows:	1300000	Hashtable size:	1299999	Memory usage:	451281416	percentage:	0.424
2015-04-07 03:08:15	Processing rows:	1400000	Hashtable size:	1399999	Memory usage:	484709568	percentage:	0.455
2015-04-07 03:08:15	Processing rows:	1500000	Hashtable size:	1499999	Memory usage:	517910120	percentage:	0.486
2015-04-07 03:08:17	Processing rows:	1600000	Hashtable size:	1599999	Memory usage:	550548608	percentage:	0.517
2015-04-07 03:08:17	Processing rows:	1700000	Hashtable size:	1699999	Memory usage:	583723104	percentage:	0.548
2015-04-07 03:08:17	Processing rows:	1800000	Hashtable size:	1799999	Memory usage:	616710936	percentage:	0.579
2015-04-07 03:08:20	Processing rows:	1900000	Hashtable size:	1899999	Memory usage:	653639568	percentage:	0.613
2015-04-07 03:08:20	Processing rows:	2000000	Hashtable size:	1999999	Memory usage:	685632968	percentage:	0.643
2015-04-07 03:08:20	Processing rows:	200000	Hashtable size:	199999	Memory usage:	744193728	percentage:	0.698
2015-04-07 03:08:23	Processing rows:	300000	Hashtable size:	299999	Memory usage:	756638688	percentage:	0.71
2015-04-07 03:08:24	Processing rows:	400000	Hashtable size:	399999	Memory usage:	785111568	percentage:	0.737
2015-04-07 03:08:24	Processing rows:	500000	Hashtable size:	499999	Memory usage:	811499448	percentage:	0.762
2015-04-07 03:08:24	Processing rows:	600000	Hashtable size:	599999	Memory usage:	839573848	percentage:	0.788
2015-04-07 03:08:24	Processing rows:	700000	Hashtable size:	699999	Memory usage:	863224784	percentage:	0.81
2015-04-07 03:08:24	Processing rows:	800000	Hashtable size:	799999	Memory usage:	892085248	percentage:	0.837
2015-04-07 03:08:27	Processing rows:	900000	Hashtable size:	899999	Memory usage:	915776280	percentage:	0.859
2015-04-07 03:08:27	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	944142560	percentage:	0.886
2015-04-07 03:08:27	Dump the side-table for tag: 1 with group count: 1000000 into file: file:/tmp/root/da4a88ce-40b4-4300-a9d9-fe342aadca0a/hive_2015-04-07_15-06-23_589_5011701797639024576-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile01--.hashtable
2015-04-07 03:08:34	Uploaded 1 File to: file:/tmp/root/da4a88ce-40b4-4300-a9d9-fe342aadca0a/hive_2015-04-07_15-06-23_589_5011701797639024576-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile01--.hashtable (31770711 bytes)
2015-04-07 03:08:34	Dump the side-table for tag: 1 with group count: 2000000 into file: file:/tmp/root/da4a88ce-40b4-4300-a9d9-fe342aadca0a/hive_2015-04-07_15-06-23_589_5011701797639024576-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile11--.hashtable
2015-04-07 03:08:39	Uploaded 1 File to: file:/tmp/root/da4a88ce-40b4-4300-a9d9-fe342aadca0a/hive_2015-04-07_15-06-23_589_5011701797639024576-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile11--.hashtable (79289890 bytes)
2015-04-07 03:08:39	End of local task; Time Taken: 42.134 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 2 out of 2
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0131, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0131/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0131
Hadoop job information for Stage-6: number of mappers: 4; number of reducers: 1
2015-04-07 15:08:53,932 Stage-6 map = 0%,  reduce = 0%
2015-04-07 15:08:59,567 Stage-6 map = 100%,  reduce = 0%, Cumulative CPU 7.88 sec
2015-04-07 15:09:04,916 Stage-6 map = 100%,  reduce = 100%, Cumulative CPU 9.04 sec
MapReduce Total cumulative CPU time: 9 seconds 40 msec
Ended Job = job_1428405026382_0131
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 46  Reduce: 179   Cumulative CPU: 963.56 sec   HDFS Read: 3766219469 HDFS Write: 17184 SUCCESS
Stage-Stage-6: Map: 4  Reduce: 1   Cumulative CPU: 9.04 sec   HDFS Read: 64483 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 16 minutes 12 seconds 600 msec
OK
Time taken: 162.586 seconds
hive> 