15/04/07 16:02:29 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 16:02:29 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 16:02:29 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 16:02:29 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query91.sql;
OK
Time taken: 2.974 seconds
Query ID = root_20150407160202_02699abc-a1a8-44c6-bec9-adbaba8032f4
Total jobs = 2
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 16:03:00 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 16:03:00 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 16:03:00 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 16:03:00 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407160202_02699abc-a1a8-44c6-bec9-adbaba8032f4.log
2015-04-07 04:03:01	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 04:03:13	Processing rows:	200000	Hashtable size:	199999	Memory usage:	118675424	percentage:	0.111
2015-04-07 04:03:14	Processing rows:	300000	Hashtable size:	299999	Memory usage:	144522408	percentage:	0.136
2015-04-07 04:03:14	Processing rows:	400000	Hashtable size:	399999	Memory usage:	171780592	percentage:	0.161
2015-04-07 04:03:15	Processing rows:	500000	Hashtable size:	499999	Memory usage:	202415136	percentage:	0.19
2015-04-07 04:03:17	Processing rows:	600000	Hashtable size:	599999	Memory usage:	228942224	percentage:	0.215
2015-04-07 04:03:18	Processing rows:	700000	Hashtable size:	699999	Memory usage:	255386584	percentage:	0.24
2015-04-07 04:03:18	Processing rows:	800000	Hashtable size:	799999	Memory usage:	290319944	percentage:	0.272
2015-04-07 04:03:19	Processing rows:	900000	Hashtable size:	899999	Memory usage:	318030264	percentage:	0.298
2015-04-07 04:03:21	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	352752568	percentage:	0.331
2015-04-07 04:03:21	Processing rows:	1100000	Hashtable size:	1099999	Memory usage:	379418504	percentage:	0.356
2015-04-07 04:03:21	Processing rows:	1200000	Hashtable size:	1199999	Memory usage:	406121736	percentage:	0.381
2015-04-07 04:03:23	Processing rows:	1300000	Hashtable size:	1299999	Memory usage:	433238568	percentage:	0.407
2015-04-07 04:03:23	Processing rows:	1400000	Hashtable size:	1399999	Memory usage:	459818408	percentage:	0.432
2015-04-07 04:03:23	Processing rows:	1500000	Hashtable size:	1499999	Memory usage:	486033968	percentage:	0.456
2015-04-07 04:03:25	Processing rows:	1600000	Hashtable size:	1599999	Memory usage:	512565896	percentage:	0.481
2015-04-07 04:03:25	Processing rows:	1700000	Hashtable size:	1699999	Memory usage:	538500160	percentage:	0.505
2015-04-07 04:03:25	Processing rows:	1800000	Hashtable size:	1799999	Memory usage:	566410672	percentage:	0.532
2015-04-07 04:03:28	Dump the side-table for tag: 1 with group count: 1200 into file: file:/tmp/root/1c1d3f05-f182-466d-8e78-121ece5b0b46/hive_2015-04-07_16-02-37_195_1754129626257878979-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile01--.hashtable
2015-04-07 04:03:28	Uploaded 1 File to: file:/tmp/root/1c1d3f05-f182-466d-8e78-121ece5b0b46/hive_2015-04-07_16-02-37_195_1754129626257878979-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile01--.hashtable (32736 bytes)
2015-04-07 04:03:28	Dump the side-table for tag: 1 with group count: 109760 into file: file:/tmp/root/1c1d3f05-f182-466d-8e78-121ece5b0b46/hive_2015-04-07_16-02-37_195_1754129626257878979-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile11--.hashtable
2015-04-07 04:03:28	Uploaded 1 File to: file:/tmp/root/1c1d3f05-f182-466d-8e78-121ece5b0b46/hive_2015-04-07_16-02-37_195_1754129626257878979-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile11--.hashtable (3967134 bytes)
2015-04-07 04:03:28	Dump the side-table for tag: 1 with group count: 108673 into file: file:/tmp/root/1c1d3f05-f182-466d-8e78-121ece5b0b46/hive_2015-04-07_16-02-37_195_1754129626257878979-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile21--.hashtable
2015-04-07 04:03:28	Uploaded 1 File to: file:/tmp/root/1c1d3f05-f182-466d-8e78-121ece5b0b46/hive_2015-04-07_16-02-37_195_1754129626257878979-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile21--.hashtable (2286241 bytes)
2015-04-07 04:03:28	Dump the side-table for tag: 1 with group count: 1895253 into file: file:/tmp/root/1c1d3f05-f182-466d-8e78-121ece5b0b46/hive_2015-04-07_16-02-37_195_1754129626257878979-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile31--.hashtable
2015-04-07 04:03:30	Uploaded 1 File to: file:/tmp/root/1c1d3f05-f182-466d-8e78-121ece5b0b46/hive_2015-04-07_16-02-37_195_1754129626257878979-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile31--.hashtable (62495429 bytes)
2015-04-07 04:03:30	Dump the side-table for tag: 1 with group count: 30 into file: file:/tmp/root/1c1d3f05-f182-466d-8e78-121ece5b0b46/hive_2015-04-07_16-02-37_195_1754129626257878979-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile41--.hashtable
2015-04-07 04:03:30	Uploaded 1 File to: file:/tmp/root/1c1d3f05-f182-466d-8e78-121ece5b0b46/hive_2015-04-07_16-02-37_195_1754129626257878979-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile41--.hashtable (893 bytes)
2015-04-07 04:03:30	Dump the side-table for tag: 0 with group count: 30 into file: file:/tmp/root/1c1d3f05-f182-466d-8e78-121ece5b0b46/hive_2015-04-07_16-02-37_195_1754129626257878979-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile50--.hashtable
2015-04-07 04:03:30	Uploaded 1 File to: file:/tmp/root/1c1d3f05-f182-466d-8e78-121ece5b0b46/hive_2015-04-07_16-02-37_195_1754129626257878979-1/-local-10011/HashTable-Stage-2/MapJoin-mapfile50--.hashtable (2177 bytes)
2015-04-07 04:03:30	End of local task; Time Taken: 29.04 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 2
Number of reduce tasks not specified. Estimated from input data size: 14
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0183, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0183/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0183
Hadoop job information for Stage-2: number of mappers: 6; number of reducers: 14
2015-04-07 16:03:55,845 Stage-2 map = 0%,  reduce = 0%
2015-04-07 16:04:06,871 Stage-2 map = 2%,  reduce = 0%, Cumulative CPU 35.43 sec
2015-04-07 16:04:09,020 Stage-2 map = 4%,  reduce = 0%, Cumulative CPU 39.86 sec
2015-04-07 16:04:10,098 Stage-2 map = 11%,  reduce = 0%, Cumulative CPU 41.44 sec
2015-04-07 16:04:11,172 Stage-2 map = 19%,  reduce = 0%, Cumulative CPU 42.26 sec
2015-04-07 16:04:12,248 Stage-2 map = 21%,  reduce = 0%, Cumulative CPU 382.11 sec
2015-04-07 16:04:13,319 Stage-2 map = 38%,  reduce = 0%, Cumulative CPU 384.14 sec
2015-04-07 16:04:15,467 Stage-2 map = 42%,  reduce = 0%, Cumulative CPU 393.21 sec
2015-04-07 16:04:18,655 Stage-2 map = 59%,  reduce = 0%, Cumulative CPU 422.85 sec
2015-04-07 16:04:19,723 Stage-2 map = 67%,  reduce = 0%, Cumulative CPU 424.62 sec
2015-04-07 16:04:21,862 Stage-2 map = 70%,  reduce = 1%, Cumulative CPU 427.47 sec
2015-04-07 16:04:22,965 Stage-2 map = 71%,  reduce = 17%, Cumulative CPU 509.4 sec
2015-04-07 16:04:24,039 Stage-2 map = 74%,  reduce = 17%, Cumulative CPU 586.29 sec
2015-04-07 16:04:26,192 Stage-2 map = 76%,  reduce = 17%, Cumulative CPU 589.69 sec
2015-04-07 16:04:27,274 Stage-2 map = 86%,  reduce = 17%, Cumulative CPU 593.95 sec
2015-04-07 16:04:28,350 Stage-2 map = 100%,  reduce = 24%, Cumulative CPU 597.39 sec
2015-04-07 16:04:29,424 Stage-2 map = 100%,  reduce = 95%, Cumulative CPU 617.61 sec
2015-04-07 16:04:30,494 Stage-2 map = 100%,  reduce = 100%, Cumulative CPU 620.34 sec
MapReduce Total cumulative CPU time: 10 minutes 20 seconds 340 msec
Ended Job = job_1428405026382_0183
Launching Job 2 out of 2
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0184, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0184/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0184
Hadoop job information for Stage-3: number of mappers: 4; number of reducers: 1
2015-04-07 16:04:37,019 Stage-3 map = 0%,  reduce = 0%
2015-04-07 16:04:42,358 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 5.87 sec
2015-04-07 16:04:47,959 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 7.29 sec
MapReduce Total cumulative CPU time: 7 seconds 290 msec
Ended Job = job_1428405026382_0184
MapReduce Jobs Launched: 
Stage-Stage-2: Map: 6  Reduce: 14   Cumulative CPU: 620.34 sec   HDFS Read: 131732244 HDFS Write: 3432 SUCCESS
Stage-Stage-3: Map: 4  Reduce: 1   Cumulative CPU: 7.29 sec   HDFS Read: 7666 HDFS Write: 1890 SUCCESS
Total MapReduce CPU Time Spent: 10 minutes 27 seconds 630 msec
OK
AAAAAAAANAAAAAAA	NY Metro_1	Jack Little	7855.39981842041
AAAAAAAAHAAAAAAA	Pacific Northwest	Alden Snyder	6767.329971313477
AAAAAAAAHAAAAAAA	Pacific Northwest	Alden Snyder	6572.490020751953
AAAAAAAAIAAAAAAA	California	Wayne Ray	6025.429931640625
AAAAAAAAEAAAAAAA	North Midwest	Larry Mccray	5987.970069885254
AAAAAAAAMBAAAAAA	North Midwest_2	Ryan Burchett	5767.310035705566
AAAAAAAAEBAAAAAA	California_1	Jason Brito	5570.1199951171875
AAAAAAAAKAAAAAAA	Hawaii/Alaska	Gregory Altman	5471.040021896362
AAAAAAAAKBAAAAAA	Mid Atlantic_2	Rene Sampson	5245.130058288574
AAAAAAAAABAAAAAA	North Midwest_1	Timothy Bourgeois	4529.91007232666
AAAAAAAAJBAAAAAA	NY Metro_2	Richard James	4405.230239868164
AAAAAAAAMBAAAAAA	North Midwest_2	Ryan Burchett	3546.740062713623
AAAAAAAAGBAAAAAA	Hawaii/Alaska_1	Travis Wilson	3399.6799697875977
AAAAAAAABAAAAAAA	NY Metro	Bob Belcher	3100.0900802612305
AAAAAAAAJBAAAAAA	NY Metro_2	Richard James	2990.529962539673
AAAAAAAAOAAAAAAA	Mid Atlantic_1	Clyde Scott	2960.1500396728516
AAAAAAAABAAAAAAA	NY Metro	Bob Belcher	2767.569938659668
AAAAAAAAKBAAAAAA	Mid Atlantic_2	Rene Sampson	2725.0199184417725
AAAAAAAAGBAAAAAA	Hawaii/Alaska_1	Travis Wilson	2489.5599670410156
AAAAAAAAKAAAAAAA	Hawaii/Alaska	Gregory Altman	2408.1999855041504
AAAAAAAAIAAAAAAA	California	Wayne Ray	2211.1100273132324
AAAAAAAAOAAAAAAA	Mid Atlantic_1	Clyde Scott	2138.8200035095215
AAAAAAAAEBAAAAAA	California_1	Jason Brito	1848.2300491333008
AAAAAAAADBAAAAAA	Pacific Northwest_1	Roderick Walls	1629.4699974060059
AAAAAAAAEAAAAAAA	North Midwest	Larry Mccray	1506.4100341796875
AAAAAAAACAAAAAAA	Mid Atlantic	Felipe Perkins	1327.3400268554688
AAAAAAAAABAAAAAA	North Midwest_1	Timothy Bourgeois	1235.280029296875
AAAAAAAANAAAAAAA	NY Metro_1	Jack Little	1106.9600067138672
AAAAAAAACAAAAAAA	Mid Atlantic	Felipe Perkins	452.1000099182129
AAAAAAAADBAAAAAA	Pacific Northwest_1	Roderick Walls	75.44000148773193
Time taken: 131.875 seconds, Fetched: 30 row(s)
hive> 