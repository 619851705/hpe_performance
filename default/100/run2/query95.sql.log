15/04/07 16:32:51 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 16:32:51 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 16:32:51 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 16:32:51 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query95.sql;
OK
Time taken: 3.154 seconds
Query ID = root_20150407163232_31629272-0648-4436-a18c-a33ab960a2dc
Total jobs = 7
Stage-7 is selected by condition resolver.
Stage-10 is selected by condition resolver.
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 16:33:33 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 16:33:33 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 16:33:33 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 16:33:33 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407163232_31629272-0648-4436-a18c-a33ab960a2dc.log
2015-04-07 04:33:35	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 04:33:40	Dump the side-table for tag: 1 with group count: 61 into file: file:/tmp/root/27b606c1-b31a-4cd1-abfb-de03cddc56cc/hive_2015-04-07_16-32-59_305_4619004710532974024-1/-local-10013/HashTable-Stage-16/MapJoin-mapfile11--.hashtable
2015-04-07 04:33:40	Uploaded 1 File to: file:/tmp/root/27b606c1-b31a-4cd1-abfb-de03cddc56cc/hive_2015-04-07_16-32-59_305_4619004710532974024-1/-local-10013/HashTable-Stage-16/MapJoin-mapfile11--.hashtable (1549 bytes)
2015-04-07 04:33:40	Dump the side-table for tag: 1 with group count: 2 into file: file:/tmp/root/27b606c1-b31a-4cd1-abfb-de03cddc56cc/hive_2015-04-07_16-32-59_305_4619004710532974024-1/-local-10013/HashTable-Stage-16/MapJoin-mapfile21--.hashtable
2015-04-07 04:33:40	Uploaded 1 File to: file:/tmp/root/27b606c1-b31a-4cd1-abfb-de03cddc56cc/hive_2015-04-07_16-32-59_305_4619004710532974024-1/-local-10013/HashTable-Stage-16/MapJoin-mapfile21--.hashtable (296 bytes)
2015-04-07 04:33:40	Dump the side-table for tag: 1 with group count: 49289 into file: file:/tmp/root/27b606c1-b31a-4cd1-abfb-de03cddc56cc/hive_2015-04-07_16-32-59_305_4619004710532974024-1/-local-10013/HashTable-Stage-16/MapJoin-mapfile31--.hashtable
2015-04-07 04:33:41	Uploaded 1 File to: file:/tmp/root/27b606c1-b31a-4cd1-abfb-de03cddc56cc/hive_2015-04-07_16-32-59_305_4619004710532974024-1/-local-10013/HashTable-Stage-16/MapJoin-mapfile31--.hashtable (1037163 bytes)
2015-04-07 04:33:41	End of local task; Time Taken: 5.951 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 7
Number of reduce tasks not specified. Estimated from input data size: 68
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0197, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0197/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0197
Hadoop job information for Stage-7: number of mappers: 18; number of reducers: 68
2015-04-07 16:33:58,057 Stage-7 map = 0%,  reduce = 0%
2015-04-07 16:34:08,845 Stage-7 map = 23%,  reduce = 0%, Cumulative CPU 141.55 sec
2015-04-07 16:34:10,989 Stage-7 map = 25%,  reduce = 0%, Cumulative CPU 144.53 sec
2015-04-07 16:34:12,050 Stage-7 map = 45%,  reduce = 0%, Cumulative CPU 199.62 sec
2015-04-07 16:34:14,188 Stage-7 map = 47%,  reduce = 0%, Cumulative CPU 206.3 sec
2015-04-07 16:34:15,261 Stage-7 map = 65%,  reduce = 0%, Cumulative CPU 258.35 sec
2015-04-07 16:34:18,435 Stage-7 map = 67%,  reduce = 0%, Cumulative CPU 316.02 sec
2015-04-07 16:34:20,568 Stage-7 map = 69%,  reduce = 0%, Cumulative CPU 341.07 sec
2015-04-07 16:34:25,904 Stage-7 map = 74%,  reduce = 0%, Cumulative CPU 434.38 sec
2015-04-07 16:34:26,970 Stage-7 map = 81%,  reduce = 0%, Cumulative CPU 477.76 sec
2015-04-07 16:34:28,036 Stage-7 map = 83%,  reduce = 0%, Cumulative CPU 478.12 sec
2015-04-07 16:34:29,104 Stage-7 map = 85%,  reduce = 0%, Cumulative CPU 480.8 sec
2015-04-07 16:34:30,170 Stage-7 map = 94%,  reduce = 0%, Cumulative CPU 506.47 sec
2015-04-07 16:34:31,250 Stage-7 map = 100%,  reduce = 5%, Cumulative CPU 515.11 sec
2015-04-07 16:34:32,323 Stage-7 map = 100%,  reduce = 13%, Cumulative CPU 526.73 sec
2015-04-07 16:34:33,396 Stage-7 map = 100%,  reduce = 23%, Cumulative CPU 555.56 sec
2015-04-07 16:34:34,469 Stage-7 map = 100%,  reduce = 44%, Cumulative CPU 669.11 sec
2015-04-07 16:34:35,538 Stage-7 map = 100%,  reduce = 59%, Cumulative CPU 791.96 sec
2015-04-07 16:34:36,606 Stage-7 map = 100%,  reduce = 69%, Cumulative CPU 919.56 sec
2015-04-07 16:34:37,675 Stage-7 map = 100%,  reduce = 74%, Cumulative CPU 1047.19 sec
2015-04-07 16:34:38,746 Stage-7 map = 100%,  reduce = 77%, Cumulative CPU 1135.86 sec
2015-04-07 16:34:39,815 Stage-7 map = 100%,  reduce = 81%, Cumulative CPU 1229.15 sec
2015-04-07 16:34:40,883 Stage-7 map = 100%,  reduce = 84%, Cumulative CPU 1320.56 sec
2015-04-07 16:34:41,950 Stage-7 map = 100%,  reduce = 88%, Cumulative CPU 1396.89 sec
2015-04-07 16:34:43,017 Stage-7 map = 100%,  reduce = 92%, Cumulative CPU 1482.91 sec
2015-04-07 16:34:44,088 Stage-7 map = 100%,  reduce = 95%, Cumulative CPU 1571.3 sec
2015-04-07 16:34:45,141 Stage-7 map = 100%,  reduce = 98%, Cumulative CPU 1647.33 sec
2015-04-07 16:34:46,178 Stage-7 map = 100%,  reduce = 100%, Cumulative CPU 1699.45 sec
MapReduce Total cumulative CPU time: 28 minutes 19 seconds 450 msec
Ended Job = job_1428405026382_0197
Launching Job 2 out of 7
Number of reduce tasks not specified. Estimated from input data size: 68
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0198, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0198/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0198
Hadoop job information for Stage-10: number of mappers: 18; number of reducers: 68
2015-04-07 16:35:01,684 Stage-10 map = 0%,  reduce = 0%
2015-04-07 16:35:12,359 Stage-10 map = 24%,  reduce = 0%, Cumulative CPU 147.4 sec
2015-04-07 16:35:14,493 Stage-10 map = 28%,  reduce = 0%, Cumulative CPU 157.65 sec
2015-04-07 16:35:15,561 Stage-10 map = 46%,  reduce = 0%, Cumulative CPU 208.05 sec
2015-04-07 16:35:17,691 Stage-10 map = 51%,  reduce = 0%, Cumulative CPU 228.59 sec
2015-04-07 16:35:18,755 Stage-10 map = 65%,  reduce = 0%, Cumulative CPU 269.21 sec
2015-04-07 16:35:21,927 Stage-10 map = 67%,  reduce = 0%, Cumulative CPU 327.18 sec
2015-04-07 16:35:22,992 Stage-10 map = 69%,  reduce = 0%, Cumulative CPU 329.24 sec
2015-04-07 16:35:28,301 Stage-10 map = 74%,  reduce = 0%, Cumulative CPU 442.97 sec
2015-04-07 16:35:30,432 Stage-10 map = 81%,  reduce = 0%, Cumulative CPU 462.57 sec
2015-04-07 16:35:31,503 Stage-10 map = 87%,  reduce = 0%, Cumulative CPU 488.08 sec
2015-04-07 16:35:32,564 Stage-10 map = 89%,  reduce = 0%, Cumulative CPU 490.24 sec
2015-04-07 16:35:33,627 Stage-10 map = 93%,  reduce = 3%, Cumulative CPU 497.01 sec
2015-04-07 16:35:34,690 Stage-10 map = 100%,  reduce = 6%, Cumulative CPU 518.99 sec
2015-04-07 16:35:35,759 Stage-10 map = 100%,  reduce = 10%, Cumulative CPU 522.82 sec
2015-04-07 16:35:36,829 Stage-10 map = 100%,  reduce = 21%, Cumulative CPU 548.65 sec
2015-04-07 16:35:37,895 Stage-10 map = 100%,  reduce = 38%, Cumulative CPU 599.84 sec
2015-04-07 16:35:38,965 Stage-10 map = 100%,  reduce = 60%, Cumulative CPU 707.76 sec
2015-04-07 16:35:40,031 Stage-10 map = 100%,  reduce = 73%, Cumulative CPU 841.85 sec
2015-04-07 16:35:41,096 Stage-10 map = 100%,  reduce = 80%, Cumulative CPU 941.11 sec
2015-04-07 16:35:42,173 Stage-10 map = 100%,  reduce = 88%, Cumulative CPU 1042.27 sec
2015-04-07 16:35:43,242 Stage-10 map = 100%,  reduce = 96%, Cumulative CPU 1188.34 sec
2015-04-07 16:35:44,301 Stage-10 map = 100%,  reduce = 100%, Cumulative CPU 1293.37 sec
MapReduce Total cumulative CPU time: 21 minutes 33 seconds 370 msec
Ended Job = job_1428405026382_0198
Launching Job 3 out of 7
Number of reduce tasks is set to 0 since there's no reduce operator
Starting Job = job_1428405026382_0199, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0199/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0199
Hadoop job information for Stage-16: number of mappers: 18; number of reducers: 0
2015-04-07 16:35:57,789 Stage-16 map = 0%,  reduce = 0%
2015-04-07 16:36:06,266 Stage-16 map = 6%,  reduce = 0%, Cumulative CPU 6.64 sec
2015-04-07 16:36:08,391 Stage-16 map = 71%,  reduce = 0%, Cumulative CPU 80.97 sec
2015-04-07 16:36:09,452 Stage-16 map = 100%,  reduce = 0%, Cumulative CPU 155.4 sec
MapReduce Total cumulative CPU time: 2 minutes 35 seconds 400 msec
Ended Job = job_1428405026382_0199
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 16:36:17 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 16:36:17 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 16:36:17 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 16:36:17 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407163232_31629272-0648-4436-a18c-a33ab960a2dc.log
2015-04-07 04:36:18	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 04:36:27	Processing rows:	200000	Hashtable size:	199999	Memory usage:	38386120	percentage:	0.036
2015-04-07 04:36:29	Processing rows:	300000	Hashtable size:	299999	Memory usage:	50026888	percentage:	0.047
2015-04-07 04:36:31	Processing rows:	400000	Hashtable size:	399999	Memory usage:	59901424	percentage:	0.056
2015-04-07 04:36:31	Processing rows:	500000	Hashtable size:	499999	Memory usage:	69318920	percentage:	0.065
2015-04-07 04:36:31	Processing rows:	600000	Hashtable size:	599999	Memory usage:	79746944	percentage:	0.075
2015-04-07 04:36:33	Processing rows:	700000	Hashtable size:	699999	Memory usage:	95668400	percentage:	0.09
2015-04-07 04:36:36	Processing rows:	800000	Hashtable size:	799999	Memory usage:	113034808	percentage:	0.106
2015-04-07 04:36:39	Processing rows:	900000	Hashtable size:	899999	Memory usage:	118092440	percentage:	0.111
2015-04-07 04:36:41	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	127717056	percentage:	0.12
2015-04-07 04:36:43	Processing rows:	1100000	Hashtable size:	1099999	Memory usage:	141943544	percentage:	0.133
2015-04-07 04:36:45	Processing rows:	1200000	Hashtable size:	1199999	Memory usage:	161710176	percentage:	0.152
2015-04-07 04:36:47	Processing rows:	1300000	Hashtable size:	1299999	Memory usage:	167584896	percentage:	0.157
2015-04-07 04:36:49	Processing rows:	1400000	Hashtable size:	1399999	Memory usage:	181708416	percentage:	0.171
2015-04-07 04:36:51	Processing rows:	1500000	Hashtable size:	1499999	Memory usage:	195714568	percentage:	0.184
2015-04-07 04:36:54	Processing rows:	1600000	Hashtable size:	1599999	Memory usage:	217241248	percentage:	0.204
2015-04-07 04:36:56	Processing rows:	1700000	Hashtable size:	1699999	Memory usage:	228972816	percentage:	0.215
2015-04-07 04:36:58	Processing rows:	1800000	Hashtable size:	1799999	Memory usage:	250037584	percentage:	0.235
2015-04-07 04:37:00	Processing rows:	1900000	Hashtable size:	1899999	Memory usage:	265167248	percentage:	0.249
2015-04-07 04:37:03	Processing rows:	2000000	Hashtable size:	1999999	Memory usage:	281059328	percentage:	0.264
2015-04-07 04:37:05	Processing rows:	2100000	Hashtable size:	2099999	Memory usage:	295313744	percentage:	0.277
2015-04-07 04:37:07	Processing rows:	2200000	Hashtable size:	2199999	Memory usage:	306799712	percentage:	0.288
2015-04-07 04:37:08	Processing rows:	2300000	Hashtable size:	2299999	Memory usage:	328454784	percentage:	0.308
2015-04-07 04:37:12	Processing rows:	2400000	Hashtable size:	2399999	Memory usage:	339377088	percentage:	0.319
2015-04-07 04:37:14	Processing rows:	2500000	Hashtable size:	2499999	Memory usage:	352835208	percentage:	0.331
2015-04-07 04:37:16	Processing rows:	2600000	Hashtable size:	2599999	Memory usage:	368448296	percentage:	0.346
2015-04-07 04:37:20	Processing rows:	2700000	Hashtable size:	2699999	Memory usage:	382695992	percentage:	0.359
2015-04-07 04:37:21	Processing rows:	2800000	Hashtable size:	2799999	Memory usage:	398934832	percentage:	0.374
2015-04-07 04:37:24	Processing rows:	2900000	Hashtable size:	2899999	Memory usage:	414645632	percentage:	0.389
2015-04-07 04:37:26	Processing rows:	3000000	Hashtable size:	2999999	Memory usage:	436113072	percentage:	0.409
2015-04-07 04:37:31	Processing rows:	3100000	Hashtable size:	3099999	Memory usage:	435463080	percentage:	0.409
2015-04-07 04:37:33	Processing rows:	3200000	Hashtable size:	3199999	Memory usage:	489567096	percentage:	0.459
2015-04-07 04:37:36	Processing rows:	3300000	Hashtable size:	3299999	Memory usage:	518455488	percentage:	0.487
2015-04-07 04:37:40	Processing rows:	3400000	Hashtable size:	3399999	Memory usage:	523928520	percentage:	0.492
2015-04-07 04:37:42	Processing rows:	3500000	Hashtable size:	3499999	Memory usage:	553875320	percentage:	0.52
2015-04-07 04:37:44	Processing rows:	3600000	Hashtable size:	3599999	Memory usage:	553920712	percentage:	0.52
2015-04-07 04:37:46	Processing rows:	3700000	Hashtable size:	3699999	Memory usage:	573670616	percentage:	0.538
2015-04-07 04:37:48	Processing rows:	3800000	Hashtable size:	3799999	Memory usage:	605410712	percentage:	0.568
Execution failed with exit status: 3
Obtaining error information

Task failed!
Task ID:
  Stage-28

Logs:

/tmp/root/hive.log
FAILED: Execution Error, return code 3 from org.apache.hadoop.hive.ql.exec.mr.MapredLocalTask
MapReduce Jobs Launched: 
Stage-Stage-7: Map: 18  Reduce: 68   Cumulative CPU: 1699.61 sec   HDFS Read: 134856970 HDFS Write: 16452427184 SUCCESS
Stage-Stage-10: Map: 18  Reduce: 68   Cumulative CPU: 1293.37 sec   HDFS Read: 134856970 HDFS Write: 127190451 SUCCESS
Stage-Stage-16: Map: 18   Cumulative CPU: 155.4 sec   HDFS Read: 761335741 HDFS Write: 168458 SUCCESS
Total MapReduce CPU Time Spent: 52 minutes 28 seconds 380 msec
hive> 