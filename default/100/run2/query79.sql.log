15/04/07 15:34:33 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 15:34:33 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 15:34:33 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 15:34:33 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query79.sql;
OK
Time taken: 3.003 seconds
Query ID = root_20150407153434_b830e493-909d-417d-9d09-7a9c81528453
Total jobs = 2
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 15:35:00 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 15:35:00 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 15:35:00 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 15:35:00 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407153434_b830e493-909d-417d-9d09-7a9c81528453.log
2015-04-07 03:35:01	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 03:35:06	Dump the side-table for tag: 1 with group count: 5040 into file: file:/tmp/root/9862f4d1-d1d1-4265-9eda-56cb1c3eda31/hive_2015-04-07_15-34-41_152_6858081360383944184-1/-local-10011/HashTable-Stage-3/MapJoin-mapfile11--.hashtable
2015-04-07 03:35:06	Uploaded 1 File to: file:/tmp/root/9862f4d1-d1d1-4265-9eda-56cb1c3eda31/hive_2015-04-07_15-34-41_152_6858081360383944184-1/-local-10011/HashTable-Stage-3/MapJoin-mapfile11--.hashtable (116745 bytes)
2015-04-07 03:35:06	Dump the side-table for tag: 1 with group count: 378 into file: file:/tmp/root/9862f4d1-d1d1-4265-9eda-56cb1c3eda31/hive_2015-04-07_15-34-41_152_6858081360383944184-1/-local-10011/HashTable-Stage-3/MapJoin-mapfile21--.hashtable
2015-04-07 03:35:06	Uploaded 1 File to: file:/tmp/root/9862f4d1-d1d1-4265-9eda-56cb1c3eda31/hive_2015-04-07_15-34-41_152_6858081360383944184-1/-local-10011/HashTable-Stage-3/MapJoin-mapfile21--.hashtable (12686 bytes)
2015-04-07 03:35:06	Dump the side-table for tag: 1 with group count: 156 into file: file:/tmp/root/9862f4d1-d1d1-4265-9eda-56cb1c3eda31/hive_2015-04-07_15-34-41_152_6858081360383944184-1/-local-10011/HashTable-Stage-3/MapJoin-mapfile31--.hashtable
2015-04-07 03:35:06	Uploaded 1 File to: file:/tmp/root/9862f4d1-d1d1-4265-9eda-56cb1c3eda31/hive_2015-04-07_15-34-41_152_6858081360383944184-1/-local-10011/HashTable-Stage-3/MapJoin-mapfile31--.hashtable (4178 bytes)
2015-04-07 03:35:06	End of local task; Time Taken: 5.054 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 2
Number of reduce tasks not specified. Estimated from input data size: 179
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0156, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0156/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0156
Hadoop job information for Stage-3: number of mappers: 46; number of reducers: 179
2015-04-07 15:35:25,948 Stage-3 map = 0%,  reduce = 0%
2015-04-07 15:35:34,882 Stage-3 map = 2%,  reduce = 0%, Cumulative CPU 6.03 sec
2015-04-07 15:35:35,959 Stage-3 map = 14%,  reduce = 0%, Cumulative CPU 53.23 sec
2015-04-07 15:35:37,036 Stage-3 map = 62%,  reduce = 0%, Cumulative CPU 392.78 sec
2015-04-07 15:35:39,190 Stage-3 map = 71%,  reduce = 0%, Cumulative CPU 415.33 sec
2015-04-07 15:35:40,271 Stage-3 map = 89%,  reduce = 0%, Cumulative CPU 485.4 sec
2015-04-07 15:35:41,314 Stage-3 map = 97%,  reduce = 0%, Cumulative CPU 500.85 sec
2015-04-07 15:35:42,403 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 509.49 sec
2015-04-07 15:35:44,538 Stage-3 map = 100%,  reduce = 6%, Cumulative CPU 542.55 sec
2015-04-07 15:35:45,604 Stage-3 map = 100%,  reduce = 29%, Cumulative CPU 687.89 sec
2015-04-07 15:35:46,668 Stage-3 map = 100%,  reduce = 36%, Cumulative CPU 731.25 sec
2015-04-07 15:35:47,716 Stage-3 map = 100%,  reduce = 42%, Cumulative CPU 765.26 sec
2015-04-07 15:35:48,769 Stage-3 map = 100%,  reduce = 51%, Cumulative CPU 823.05 sec
2015-04-07 15:35:49,815 Stage-3 map = 100%,  reduce = 72%, Cumulative CPU 953.44 sec
2015-04-07 15:35:50,883 Stage-3 map = 100%,  reduce = 83%, Cumulative CPU 1018.95 sec
2015-04-07 15:35:51,956 Stage-3 map = 100%,  reduce = 97%, Cumulative CPU 1095.09 sec
2015-04-07 15:35:53,027 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 1110.25 sec
MapReduce Total cumulative CPU time: 18 minutes 30 seconds 250 msec
Ended Job = job_1428405026382_0156
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 15:35:59 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 15:35:59 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 15:35:59 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 15:35:59 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407153434_b830e493-909d-417d-9d09-7a9c81528453.log
2015-04-07 03:36:00	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 03:36:06	Processing rows:	200000	Hashtable size:	199999	Memory usage:	74024728	percentage:	0.069
2015-04-07 03:36:08	Processing rows:	300000	Hashtable size:	299999	Memory usage:	105857776	percentage:	0.099
2015-04-07 03:36:08	Processing rows:	400000	Hashtable size:	399999	Memory usage:	136623336	percentage:	0.128
2015-04-07 03:36:09	Processing rows:	500000	Hashtable size:	499999	Memory usage:	167671344	percentage:	0.157
2015-04-07 03:36:10	Processing rows:	600000	Hashtable size:	599999	Memory usage:	202534352	percentage:	0.19
2015-04-07 03:36:11	Processing rows:	700000	Hashtable size:	699999	Memory usage:	229250432	percentage:	0.215
2015-04-07 03:36:12	Processing rows:	800000	Hashtable size:	799999	Memory usage:	260067840	percentage:	0.244
2015-04-07 03:36:14	Processing rows:	900000	Hashtable size:	899999	Memory usage:	298244072	percentage:	0.28
2015-04-07 03:36:14	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	346420120	percentage:	0.325
2015-04-07 03:36:15	Processing rows:	1100000	Hashtable size:	1099999	Memory usage:	372536888	percentage:	0.35
2015-04-07 03:36:16	Processing rows:	1200000	Hashtable size:	1199999	Memory usage:	403438032	percentage:	0.379
2015-04-07 03:36:16	Processing rows:	1300000	Hashtable size:	1299999	Memory usage:	434410504	percentage:	0.408
2015-04-07 03:36:18	Processing rows:	1400000	Hashtable size:	1399999	Memory usage:	446933568	percentage:	0.419
2015-04-07 03:36:18	Processing rows:	1500000	Hashtable size:	1499999	Memory usage:	477713640	percentage:	0.448
2015-04-07 03:36:18	Processing rows:	1600000	Hashtable size:	1599999	Memory usage:	507811576	percentage:	0.477
2015-04-07 03:36:20	Processing rows:	1700000	Hashtable size:	1699999	Memory usage:	538852104	percentage:	0.506
2015-04-07 03:36:20	Processing rows:	1800000	Hashtable size:	1799999	Memory usage:	569166856	percentage:	0.534
2015-04-07 03:36:21	Processing rows:	1900000	Hashtable size:	1899999	Memory usage:	599989392	percentage:	0.563
2015-04-07 03:36:23	Processing rows:	2000000	Hashtable size:	1999999	Memory usage:	631149312	percentage:	0.592
2015-04-07 03:36:23	Dump the side-table for tag: 1 with group count: 2000000 into file: file:/tmp/root/9862f4d1-d1d1-4265-9eda-56cb1c3eda31/hive_2015-04-07_15-34-41_152_6858081360383944184-1/-local-10009/HashTable-Stage-5/MapJoin-mapfile01--.hashtable
2015-04-07 03:36:25	Uploaded 1 File to: file:/tmp/root/9862f4d1-d1d1-4265-9eda-56cb1c3eda31/hive_2015-04-07_15-34-41_152_6858081360383944184-1/-local-10009/HashTable-Stage-5/MapJoin-mapfile01--.hashtable (71382906 bytes)
2015-04-07 03:36:25	End of local task; Time Taken: 24.756 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 2 out of 2
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0157, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0157/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0157
Hadoop job information for Stage-5: number of mappers: 4; number of reducers: 1
2015-04-07 15:36:37,478 Stage-5 map = 0%,  reduce = 0%
2015-04-07 15:36:54,744 Stage-5 map = 29%,  reduce = 0%, Cumulative CPU 178.45 sec
2015-04-07 15:36:55,817 Stage-5 map = 64%,  reduce = 0%, Cumulative CPU 373.69 sec
2015-04-07 15:36:56,887 Stage-5 map = 79%,  reduce = 0%, Cumulative CPU 374.74 sec
2015-04-07 15:36:57,958 Stage-5 map = 88%,  reduce = 0%, Cumulative CPU 388.76 sec
2015-04-07 15:37:00,117 Stage-5 map = 100%,  reduce = 0%, Cumulative CPU 404.23 sec
2015-04-07 15:37:01,192 Stage-5 map = 100%,  reduce = 100%, Cumulative CPU 406.11 sec
MapReduce Total cumulative CPU time: 6 minutes 46 seconds 110 msec
Ended Job = job_1428405026382_0157
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 46  Reduce: 179   Cumulative CPU: 1110.25 sec   HDFS Read: 2433021196 HDFS Write: 70113126 SUCCESS
Stage-Stage-5: Map: 4  Reduce: 1   Cumulative CPU: 406.11 sec   HDFS Read: 70160425 HDFS Write: 4627 SUCCESS
Total MapReduce CPU Time Spent: 25 minutes 16 seconds 360 msec
OK
			2153002	NULL	NULL
			11391215	NULL	NULL
			7240236	NULL	NULL
			21240657	203.17999267578125	-23092.459991455078
			14967548	7381.819961547852	-22784.11985397339
			1055689	4952.260040283203	-21863.08999633789
			22797904	391.3799934387207	-21455.17028617859
			15743643	6636.759979248047	-21451.14033126831
			20417943	572.9700164794922	-19803.210039138794
			23933009	6094.219909667969	-18662.490352630615
			1439863	7778.539764404297	-17798.510299682617
			5514766	624.3699951171875	-17211.37009048462
			18146822	0.0	-17128.01987171173
			13229617	3412.510009765625	-17117.469636917114
			6286784	2341.1399536132812	-16450.430324554443
			9630143	360.24000549316406	-16221.870002388954
			22590970	0.0	-15816.879760742188
			15644660	998.5599899291992	-15618.589818954468
			8123077	3795.4700622558594	-15486.409912109375
			22755435	2931.5600814819336	-15420.540054321289
			2047774	6011.6201171875	-15213.079888820648
			2201049	2055.0699615478516	-15158.5498046875
			21134147	3924.2800788879395	-15090.260070800781
			10271259	1961.2600402832031	-14463.570042610168
			5095835	1838.8700256347656	-14387.060028076172
			22217328	0.0	-14198.98987197876
			6161445	3604.199951171875	-14122.150024414062
			20086630	1112.2799987792969	-13977.390033245087
			19522117	0.0	-13650.160064697266
			19205573	233.72999572753906	-13526.859848022461
			18097818	7185.089935302734	-13312.749954223633
			21697524	10156.4799118042	-13232.420099258423
			3500728	71.76000213623047	-13178.259997844696
			7176728	3773.080114364624	-12959.959866523743
			11099729	3472.3299560546875	-12959.880163192749
			22478272	2015.4999809265137	-12695.690311431885
			16497597	3630.720099925995	-12594.700258255005
			5311316	3236.580078125	-12381.870063781738
			2665880	6951.639717102051	-12147.120040893555
			19283314	71.06999969482422	-11859.439956665039
			2566108	3111.9899682998657	-11789.459945678711
			4987779	109.75	-11627.929952979088
			20315109	1292.1900358200073	-11611.88011932373
			27400	3746.449951171875	-11322.689947128296
			8715452	213.3299961090088	-11313.609916687012
			23568999	1467.8399658203125	-11276.569948196411
			19398426	0.0	-11242.560188293457
			5693440	2100.570053100586	-11093.970031261444
			1356297	109.40999984741211	-10998.79010772705
			4548960	0.0	-10991.549865722656
			17061430	499.70999908447266	-10797.410217285156
			821887	684.6399993896484	-10727.219875335693
			21835874	447.05999755859375	-10689.050228118896
			10454982	2167.589986562729	-10561.790096282959
			12489437	0.0	-10464.349998474121
			5621390	696.5199947357178	-10375.919692993164
			13487015	2285.1699829101562	-10358.300168037415
			3257158	9942.409943580627	-9878.8098487854
			10662884	739.8699951171875	-9663.52001953125
			10782588	127.13000312447548	-9259.74034500122
			6602361	0.0	-9255.41967868805
			21888983	316.2299995422363	-8994.239828109741
			6877888	3988.8399963378906	-8934.81997871399
			12505002	5223.56005859375	-8909.899570465088
			10652568	89.68999862670898	-8839.529739379883
			7398921	2428.619975566864	-8681.9700050354
			10239169	4001.2600059509277	-8676.069702148438
			13917794	0.0	-8518.410095214844
			8221818	1165.3200225830078	-8466.519933700562
			10807873	794.7899780273438	-8317.589916229248
			12138875	0.0	-8297.720297813416
			2153002	1135.1199412345886	-8296.880250930786
			18401756	6715.9599609375	-8203.330163955688
			23928632	119.31000137329102	-8084.889883041382
			5494263	374.6600036621094	-8077.850009918213
			22301846	3214.960006713867	-7974.369923114777
			2783010	53.190001487731934	-7961.519950866699
			8570698	0.0	-7956.270004272461
			12471016	676.0999794006348	-7501.6500816345215
			294515	8168.150146484375	-7323.039794921875
			8397971	4858.97998046875	-7282.880012512207
			11728895	1922.9200057983398	-7083.410053253174
			23210434	378.5299987792969	-7057.160049438477
			1072500	0.0	-7001.840121507645
			16242949	2115.0400390625	-6868.109945297241
			4567206	2102.1000366210938	-6791.239974975586
			11391215	4312.8998947143555	-6725.040004730225
			9705316	809.6400146484375	-6638.380068778992
			9002601	10.579999923706055	-6601.429950714111
			16209361	7390.250213623047	-6548.310256958008
			6954433	11702.229797363281	-6365.750350952148
			23318915	3892.5101261138916	-6295.579971313477
			18552505	0.0	-6288.429805755615
			17903837	159.77999877929688	-6242.440048217773
			20733932	202.02000427246094	-6240.380186080933
			23008972	2660.02001953125	-6205.9501304626465
			17335404	802.1199951171875	-5929.269835472107
			2259390	2186.209976196289	-5840.930034637451
			22361408	567.0599822998047	-5804.910102844238
			6388472	1058.6899909973145	-5794.829883575439
Time taken: 141.305 seconds, Fetched: 100 row(s)
hive> 