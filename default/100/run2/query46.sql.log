15/04/07 08:20:27 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 08:20:27 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 08:20:27 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 08:20:27 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query46.sql;
OK
Time taken: 2.944 seconds
Query ID = root_20150407082020_c4c6af99-b4eb-43ef-a1fe-8cc7b7d285f4
Total jobs = 2
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 08:20:54 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 08:20:54 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 08:20:54 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 08:20:54 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407082020_c4c6af99-b4eb-43ef-a1fe-8cc7b7d285f4.log
2015-04-07 08:20:55	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 08:21:02	Processing rows:	200000	Hashtable size:	199999	Memory usage:	64038536	percentage:	0.06
2015-04-07 08:21:03	Processing rows:	300000	Hashtable size:	299999	Memory usage:	92989864	percentage:	0.087
2015-04-07 08:21:04	Processing rows:	400000	Hashtable size:	399999	Memory usage:	117228976	percentage:	0.11
2015-04-07 08:21:04	Processing rows:	500000	Hashtable size:	499999	Memory usage:	147580264	percentage:	0.139
2015-04-07 08:21:05	Processing rows:	600000	Hashtable size:	599999	Memory usage:	174364712	percentage:	0.164
2015-04-07 08:21:06	Processing rows:	700000	Hashtable size:	699999	Memory usage:	200982928	percentage:	0.189
2015-04-07 08:21:06	Processing rows:	800000	Hashtable size:	799999	Memory usage:	227205352	percentage:	0.213
2015-04-07 08:21:08	Processing rows:	900000	Hashtable size:	899999	Memory usage:	249752136	percentage:	0.234
2015-04-07 08:21:09	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	275416192	percentage:	0.258
2015-04-07 08:21:09	Dump the side-table for tag: 1 with group count: 1000000 into file: file:/tmp/root/8a5d5aad-1b8d-48c2-8c60-dd60dc95c062/hive_2015-04-07_08-20-34_732_9107191908706684448-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile21--.hashtable
2015-04-07 08:21:10	Uploaded 1 File to: file:/tmp/root/8a5d5aad-1b8d-48c2-8c60-dd60dc95c062/hive_2015-04-07_08-20-34_732_9107191908706684448-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile21--.hashtable (31770711 bytes)
2015-04-07 08:21:10	Dump the side-table for tag: 1 with group count: 1800 into file: file:/tmp/root/8a5d5aad-1b8d-48c2-8c60-dd60dc95c062/hive_2015-04-07_08-20-34_732_9107191908706684448-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile31--.hashtable
2015-04-07 08:21:10	Uploaded 1 File to: file:/tmp/root/8a5d5aad-1b8d-48c2-8c60-dd60dc95c062/hive_2015-04-07_08-20-34_732_9107191908706684448-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile31--.hashtable (41863 bytes)
2015-04-07 08:21:10	Dump the side-table for tag: 1 with group count: 0 into file: file:/tmp/root/8a5d5aad-1b8d-48c2-8c60-dd60dc95c062/hive_2015-04-07_08-20-34_732_9107191908706684448-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile41--.hashtable
2015-04-07 08:21:10	Uploaded 1 File to: file:/tmp/root/8a5d5aad-1b8d-48c2-8c60-dd60dc95c062/hive_2015-04-07_08-20-34_732_9107191908706684448-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile41--.hashtable (260 bytes)
2015-04-07 08:21:10	Dump the side-table for tag: 1 with group count: 314 into file: file:/tmp/root/8a5d5aad-1b8d-48c2-8c60-dd60dc95c062/hive_2015-04-07_08-20-34_732_9107191908706684448-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile51--.hashtable
2015-04-07 08:21:10	Uploaded 1 File to: file:/tmp/root/8a5d5aad-1b8d-48c2-8c60-dd60dc95c062/hive_2015-04-07_08-20-34_732_9107191908706684448-1/-local-10013/HashTable-Stage-3/MapJoin-mapfile51--.hashtable (8462 bytes)
2015-04-07 08:21:10	End of local task; Time Taken: 14.775 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 1 out of 2
Number of reduce tasks not specified. Estimated from input data size: 179
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0070, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0070/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0070
Hadoop job information for Stage-3: number of mappers: 46; number of reducers: 179
2015-04-07 08:21:31,536 Stage-3 map = 0%,  reduce = 0%
2015-04-07 08:21:41,308 Stage-3 map = 5%,  reduce = 0%, Cumulative CPU 21.78 sec
2015-04-07 08:21:42,394 Stage-3 map = 43%,  reduce = 0%, Cumulative CPU 550.5 sec
2015-04-07 08:21:43,473 Stage-3 map = 55%,  reduce = 0%, Cumulative CPU 562.97 sec
2015-04-07 08:21:44,551 Stage-3 map = 68%,  reduce = 0%, Cumulative CPU 589.74 sec
2015-04-07 08:21:45,604 Stage-3 map = 96%,  reduce = 0%, Cumulative CPU 659.33 sec
2015-04-07 08:21:46,654 Stage-3 map = 100%,  reduce = 0%, Cumulative CPU 664.38 sec
2015-04-07 08:21:47,716 Stage-3 map = 100%,  reduce = 1%, Cumulative CPU 666.05 sec
2015-04-07 08:21:48,791 Stage-3 map = 100%,  reduce = 17%, Cumulative CPU 721.9 sec
2015-04-07 08:21:49,845 Stage-3 map = 100%,  reduce = 28%, Cumulative CPU 758.68 sec
2015-04-07 08:21:50,910 Stage-3 map = 100%,  reduce = 35%, Cumulative CPU 779.96 sec
2015-04-07 08:21:51,988 Stage-3 map = 100%,  reduce = 41%, Cumulative CPU 800.09 sec
2015-04-07 08:21:53,065 Stage-3 map = 100%,  reduce = 53%, Cumulative CPU 840.2 sec
2015-04-07 08:21:54,141 Stage-3 map = 100%,  reduce = 66%, Cumulative CPU 883.38 sec
2015-04-07 08:21:55,219 Stage-3 map = 100%,  reduce = 78%, Cumulative CPU 918.93 sec
2015-04-07 08:21:56,298 Stage-3 map = 100%,  reduce = 95%, Cumulative CPU 975.69 sec
2015-04-07 08:21:57,368 Stage-3 map = 100%,  reduce = 100%, Cumulative CPU 991.06 sec
MapReduce Total cumulative CPU time: 16 minutes 31 seconds 60 msec
Ended Job = job_1428405026382_0070
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 08:22:04 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 08:22:04 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 08:22:04 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 08:22:04 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407082020_c4c6af99-b4eb-43ef-a1fe-8cc7b7d285f4.log
2015-04-07 08:22:05	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 08:22:11	Processing rows:	200000	Hashtable size:	199999	Memory usage:	82246360	percentage:	0.077
2015-04-07 08:22:13	Processing rows:	300000	Hashtable size:	299999	Memory usage:	118210552	percentage:	0.111
2015-04-07 08:22:14	Processing rows:	400000	Hashtable size:	399999	Memory usage:	151305208	percentage:	0.142
2015-04-07 08:22:15	Processing rows:	500000	Hashtable size:	499999	Memory usage:	184569096	percentage:	0.173
2015-04-07 08:22:16	Processing rows:	600000	Hashtable size:	599999	Memory usage:	216312960	percentage:	0.203
2015-04-07 08:22:17	Processing rows:	700000	Hashtable size:	699999	Memory usage:	248507656	percentage:	0.233
2015-04-07 08:22:17	Processing rows:	800000	Hashtable size:	799999	Memory usage:	281538328	percentage:	0.264
2015-04-07 08:22:19	Processing rows:	900000	Hashtable size:	899999	Memory usage:	323352160	percentage:	0.303
2015-04-07 08:22:20	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	369555768	percentage:	0.347
2015-04-07 08:22:20	Processing rows:	1100000	Hashtable size:	1099999	Memory usage:	402973096	percentage:	0.378
2015-04-07 08:22:20	Processing rows:	1200000	Hashtable size:	1199999	Memory usage:	436256432	percentage:	0.409
2015-04-07 08:22:22	Processing rows:	1300000	Hashtable size:	1299999	Memory usage:	450609696	percentage:	0.423
2015-04-07 08:22:23	Processing rows:	1400000	Hashtable size:	1399999	Memory usage:	483864768	percentage:	0.454
2015-04-07 08:22:23	Processing rows:	1500000	Hashtable size:	1499999	Memory usage:	516798848	percentage:	0.485
2015-04-07 08:22:25	Processing rows:	1600000	Hashtable size:	1599999	Memory usage:	550232776	percentage:	0.516
2015-04-07 08:22:25	Processing rows:	1700000	Hashtable size:	1699999	Memory usage:	582918784	percentage:	0.547
2015-04-07 08:22:26	Processing rows:	1800000	Hashtable size:	1799999	Memory usage:	615726296	percentage:	0.578
2015-04-07 08:22:28	Processing rows:	1900000	Hashtable size:	1899999	Memory usage:	653276320	percentage:	0.613
2015-04-07 08:22:28	Processing rows:	2000000	Hashtable size:	1999999	Memory usage:	683316136	percentage:	0.641
2015-04-07 08:22:29	Processing rows:	200000	Hashtable size:	199999	Memory usage:	743349528	percentage:	0.698
2015-04-07 08:22:31	Processing rows:	300000	Hashtable size:	299999	Memory usage:	770076928	percentage:	0.723
2015-04-07 08:22:31	Processing rows:	400000	Hashtable size:	399999	Memory usage:	797928552	percentage:	0.749
2015-04-07 08:22:32	Processing rows:	500000	Hashtable size:	499999	Memory usage:	823470992	percentage:	0.773
2015-04-07 08:22:32	Processing rows:	600000	Hashtable size:	599999	Memory usage:	851866136	percentage:	0.80
2015-04-07 08:22:32	Processing rows:	700000	Hashtable size:	699999	Memory usage:	875225624	percentage:	0.821
2015-04-07 08:22:32	Processing rows:	800000	Hashtable size:	799999	Memory usage:	903717472	percentage:	0.848
2015-04-07 08:22:36	Processing rows:	900000	Hashtable size:	899999	Memory usage:	914517824	percentage:	0.858
2015-04-07 08:22:36	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	943634008	percentage:	0.886
2015-04-07 08:22:36	Dump the side-table for tag: 1 with group count: 1000000 into file: file:/tmp/root/8a5d5aad-1b8d-48c2-8c60-dd60dc95c062/hive_2015-04-07_08-20-34_732_9107191908706684448-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile01--.hashtable
2015-04-07 08:22:42	Uploaded 1 File to: file:/tmp/root/8a5d5aad-1b8d-48c2-8c60-dd60dc95c062/hive_2015-04-07_08-20-34_732_9107191908706684448-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile01--.hashtable (31770711 bytes)
2015-04-07 08:22:42	Dump the side-table for tag: 1 with group count: 2000000 into file: file:/tmp/root/8a5d5aad-1b8d-48c2-8c60-dd60dc95c062/hive_2015-04-07_08-20-34_732_9107191908706684448-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile11--.hashtable
2015-04-07 08:22:46	Uploaded 1 File to: file:/tmp/root/8a5d5aad-1b8d-48c2-8c60-dd60dc95c062/hive_2015-04-07_08-20-34_732_9107191908706684448-1/-local-10011/HashTable-Stage-6/MapJoin-mapfile11--.hashtable (79289890 bytes)
2015-04-07 08:22:46	End of local task; Time Taken: 41.549 sec.
Execution completed successfully
MapredLocal task succeeded
Launching Job 2 out of 2
Number of reduce tasks determined at compile time: 1
In order to change the average load for a reducer (in bytes):
  set hive.exec.reducers.bytes.per.reducer=<number>
In order to limit the maximum number of reducers:
  set hive.exec.reducers.max=<number>
In order to set a constant number of reducers:
  set mapreduce.job.reduces=<number>
Starting Job = job_1428405026382_0071, Tracking URL = http://f01hn02.hadoop:8088/proxy/application_1428405026382_0071/
Kill Command = /usr/hdp/2.2.0.0-2041/hadoop/bin/hadoop job  -kill job_1428405026382_0071
Hadoop job information for Stage-6: number of mappers: 4; number of reducers: 1
2015-04-07 08:23:00,581 Stage-6 map = 0%,  reduce = 0%
2015-04-07 08:23:07,218 Stage-6 map = 100%,  reduce = 0%, Cumulative CPU 7.86 sec
2015-04-07 08:23:11,505 Stage-6 map = 100%,  reduce = 100%, Cumulative CPU 8.99 sec
MapReduce Total cumulative CPU time: 8 seconds 990 msec
Ended Job = job_1428405026382_0071
MapReduce Jobs Launched: 
Stage-Stage-3: Map: 46  Reduce: 179   Cumulative CPU: 991.06 sec   HDFS Read: 2433021196 HDFS Write: 17184 SUCCESS
Stage-Stage-6: Map: 4  Reduce: 1   Cumulative CPU: 8.99 sec   HDFS Read: 64483 HDFS Write: 0 SUCCESS
Total MapReduce CPU Time Spent: 16 minutes 40 seconds 50 msec
OK
Time taken: 157.883 seconds
hive> 