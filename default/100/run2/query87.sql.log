15/04/07 15:48:15 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 15:48:15 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 15:48:15 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 15:48:15 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist

Logging initialized using configuration in file:/etc/hive/conf/hive-log4j.properties
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
hive> use tpcds_bin_partitioned_orc_100; source query87.sql;
OK
Time taken: 2.617 seconds
Query ID = root_20150407154848_3e9c89db-2f5e-432a-b6c5-49a6a2fa5020
Total jobs = 6
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hadoop/lib/slf4j-log4j12-1.7.5.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/hdp/2.2.0.0-2041/hive/lib/hive-jdbc-0.14.0.2.2.0.0-2041-standalone.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]
15/04/07 15:48:51 WARN conf.HiveConf: HiveConf of name hive.optimize.mapjoin.mapreduce does not exist
15/04/07 15:48:51 WARN conf.HiveConf: HiveConf of name hive.heapsize does not exist
15/04/07 15:48:51 WARN conf.HiveConf: HiveConf of name hive.server2.enable.impersonation does not exist
15/04/07 15:48:51 WARN conf.HiveConf: HiveConf of name hive.auto.convert.sortmerge.join.noconditionaltask does not exist
Execution log at: /tmp/root/root_20150407154848_3e9c89db-2f5e-432a-b6c5-49a6a2fa5020.log
2015-04-07 03:48:52	Starting to launch local task to process map join;	maximum memory = 1065484288
2015-04-07 03:48:59	Processing rows:	200000	Hashtable size:	199999	Memory usage:	74881184	percentage:	0.07
2015-04-07 03:49:00	Processing rows:	300000	Hashtable size:	299999	Memory usage:	107847656	percentage:	0.101
2015-04-07 03:49:01	Processing rows:	400000	Hashtable size:	399999	Memory usage:	135997824	percentage:	0.128
2015-04-07 03:49:02	Processing rows:	500000	Hashtable size:	499999	Memory usage:	166831208	percentage:	0.157
2015-04-07 03:49:03	Processing rows:	600000	Hashtable size:	599999	Memory usage:	201687640	percentage:	0.189
2015-04-07 03:49:04	Processing rows:	700000	Hashtable size:	699999	Memory usage:	232662824	percentage:	0.218
2015-04-07 03:49:05	Processing rows:	800000	Hashtable size:	799999	Memory usage:	260252704	percentage:	0.244
2015-04-07 03:49:06	Processing rows:	900000	Hashtable size:	899999	Memory usage:	299377120	percentage:	0.281
2015-04-07 03:49:07	Processing rows:	1000000	Hashtable size:	999999	Memory usage:	346123256	percentage:	0.325
2015-04-07 03:49:07	Processing rows:	1100000	Hashtable size:	1099999	Memory usage:	377198944	percentage:	0.354
2015-04-07 03:49:09	Processing rows:	1200000	Hashtable size:	1199999	Memory usage:	394098128	percentage:	0.37
2015-04-07 03:49:09	Processing rows:	1300000	Hashtable size:	1299999	Memory usage:	424944456	percentage:	0.399
2015-04-07 03:49:11	Processing rows:	1400000	Hashtable size:	1399999	Memory usage:	456396824	percentage:	0.428
2015-04-07 03:49:11	Processing rows:	1500000	Hashtable size:	1499999	Memory usage:	486775872	percentage:	0.457
2015-04-07 03:49:11	Processing rows:	1600000	Hashtable size:	1599999	Memory usage:	517413312	percentage:	0.486
2015-04-07 03:49:14	Processing rows:	1700000	Hashtable size:	1699999	Memory usage:	537995832	percentage:	0.505
2015-04-07 03:49:14	Processing rows:	1800000	Hashtable size:	1799999	Memory usage:	571047040	percentage:	0.536
2015-04-07 03:49:14	Processing rows:	1900000	Hashtable size:	1899999	Memory usage:	604454456	percentage:	0.567
Execution failed with exit status: 3
Obtaining error information

Task failed!
Task ID:
  Stage-27

Logs:

/tmp/root/hive.log
FAILED: Execution Error, return code 3 from org.apache.hadoop.hive.ql.exec.mr.MapredLocalTask
hive> 