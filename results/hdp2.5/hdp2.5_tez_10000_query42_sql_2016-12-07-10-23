START hdp2.5_tez_10000_query42_sql_2016-12-07-10-23:  Wed Dec 7 10:24:02 CST 2016
beeline --outputformat=csv2 -u jdbc:hiv2:// -i sample-queries-tpcds/testbench.settings-4g-container-tez --database tpcds_bin_partitioned_orc_10000 -f sample-queries-tpcds/query42.sql
Connecting to jdbc:hive2://h01hn02:10000/tpcds_bin_partitioned_orc_10000
Connected to: Apache Hive (version 1.2.1000.2.5.1.0-43)
Driver: Hive JDBC (version 1.2.1000.2.5.1.0-43)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script sample-queries-tpch/testbench.settings-4g-container
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> --set ambari.hive.db.schema.name=hive;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set fs.file.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set fs.hdfs.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.auto.convert.join=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> --set hive.auto.convert.sortmerge.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.auto.convert.sortmerge.join=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.compactor.abortedtxn.threshold=1000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.compactor.check.interval=300;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.compactor.delta.num.threshold=10;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.compactor.delta.pct.threshold=0.1f;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.compactor.initiator.on=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.compactor.worker.threads=0;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.compactor.worker.timeout=86400;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.compute.query.using.stats=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.enforce.bucketing=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.enforce.sorting=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.enforce.sortmergebucketmapjoin=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.execution.engine=mr;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.limit.pushdown.memory.usage=0.04;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.map.aggr=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.mapjoin.bucket.cache.size=10000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.mapred.reduce.tasks.speculative.execution=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.metastore.cache.pinobjtypes=Table,Database,Type,FieldSchema,Order;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.metastore.client.socket.timeout=60;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.metastore.execute.setugi=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.metastore.warehouse.dir=/apps/hive/warehouse;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.optimize.bucketmapjoin.sortedmerge=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.optimize.bucketmapjoin=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.optimize.index.filter=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> --set hive.optimize.mapjoin.mapreduce=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.optimize.reducededuplication.min.reducer=4;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.optimize.reducededuplication=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.orc.splits.include.file.footer=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.security.authorization.enabled=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.security.metastore.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvi der;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> --set hive.semantic.analyzer.factory.impl=org.apache.hivealog.cli.HCatSemanticAnalyzerFactory;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.server2.enable.doAs=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.server2.tez.default.queues=default;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.server2.tez.initialize.default.sessions=false;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.server2.tez.sessions.per.default.queue=1;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.stats.autogather=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.tez.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.txn.max.open.batch=1000;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.txn.timeout=300;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.vectorized.execution.enabled=true;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.vectorized.groupby.checkinterval=1024;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.vectorized.groupby.flush.percent=1;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.vectorized.groupby.maxentries=1024;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- These values need to be tuned appropriately to your cluster. These examples are for reference.
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.tez.container.size=4096;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.tez.java.opts=-Xmx3800m;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=1252698795;
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> select  dt.d_year
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  ,item.i_category_id
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  ,item.i_category
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  ,sum(ss_ext_sales_price) as s
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  from date_dim dt
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  ,store_sales
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  ,item
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  where dt.d_date_sk = store_sales.ss_sold_date_sk
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  and store_sales.ss_item_sk = item.i_item_sk
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  and item.i_manager_id = 1  
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  and dt.d_moy=12
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  and dt.d_year=1998
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  group by dt.d_year
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  ,item.i_category_id
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  ,item.i_category
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  order by       s desc,dt.d_year
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  ,item.i_category_id
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti>  ,item.i_category
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> limit 100 ;
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: select  dt.d_year
 ,item.i_category_id...100(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : 

INFO  : Status: Running (Executing on YARN cluster with App id application_1478933081481_0360)

INFO  : Map 1: -/-	Map 4: -/-	Map 5: -/-	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: -/-	Map 4: 0/1	Map 5: 0/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: -/-	Map 4: 0/1	Map 5: 0(+1)/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: -/-	Map 4: 0(+1)/1	Map 5: 0(+1)/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: -/-	Map 4: 0(+1)/1	Map 5: 0(+3)/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: -/-	Map 4: 0(+1)/1	Map 5: 0(+4)/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: -/-	Map 4: 0(+1)/1	Map 5: 0(+3)/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: -/-	Map 4: 1/1	Map 5: 3(+1)/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 0(+4)/230	Map 4: 1/1	Map 5: 3(+1)/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 0(+5)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 0(+7)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 0(+10)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 0(+29)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 0(+36)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 0(+58)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 0(+82)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 0(+101)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 0(+149)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 0(+184)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 0(+204)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 0(+208)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 0(+217)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 1(+222)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 1(+224)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 1(+226)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 2(+225)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 2(+226)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 2(+228)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 4(+226)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 5(+225)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 8(+222)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 11(+219)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 13(+217)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 14(+215)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 16(+214)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 18(+212)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 19(+211)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 20(+210)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 20(+210)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 21(+209)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 23(+207)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 25(+205)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 27(+203)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 29(+201)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 31(+199)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 32(+198)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 37(+193)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 46(+184)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 51(+179)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 57(+173)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 58(+172)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 63(+167)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 66(+164)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 71(+159)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 75(+155)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 80(+150)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 88(+142)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 98(+132)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 108(+122)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 118(+112)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 129(+101)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 146(+84)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 161(+69)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/2	Reducer 3: 0/1	
INFO  : Map 1: 181(+49)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0/1	Reducer 3: 0/1	
INFO  : Map 1: 202(+28)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0(+1)/1	Reducer 3: 0/1	
INFO  : Map 1: 212(+18)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0(+1)/1	Reducer 3: 0/1	
INFO  : Map 1: 215(+15)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0(+1)/1	Reducer 3: 0/1	
INFO  : Map 1: 219(+11)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0(+1)/1	Reducer 3: 0/1	
INFO  : Map 1: 222(+8)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0(+1)/1	Reducer 3: 0/1	
INFO  : Map 1: 223(+7)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0(+1)/1	Reducer 3: 0/1	
INFO  : Map 1: 224(+6)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0(+1)/1	Reducer 3: 0/1	
INFO  : Map 1: 226(+4)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0(+1)/1	Reducer 3: 0/1	
INFO  : Map 1: 228(+2)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0(+1)/1	Reducer 3: 0/1	
INFO  : Map 1: 229(+1)/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0(+1)/1	Reducer 3: 0/1	
INFO  : Map 1: 230/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 0(+1)/1	Reducer 3: 0/1	
INFO  : Map 1: 230/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 1/1	Reducer 3: 0(+1)/1	
INFO  : Map 1: 230/230	Map 4: 1/1	Map 5: 4/4	Reducer 2: 1/1	Reducer 3: 1/1	
+------------+---------------------+------------------+-----------------------+--+
| dt.d_year  | item.i_category_id  | item.i_category  |           s           |
+------------+---------------------+------------------+-----------------------+--+
| 1998       | 10                  | Electronics      | 3.328911891409192E9   |
| 1998       | 2                   | Men              | 3.2402761585810995E9  |
| 1998       | 1                   | Women            | 3.238712830963427E9   |
| 1998       | 3                   | Children         | 3.2216046200129285E9  |
| 1998       | 8                   | Sports           | 3.2016045483906994E9  |
| 1998       | 7                   | Home             | 3.182820545935787E9   |
| 1998       | 4                   | Shoes            | 3.1312244370722933E9  |
| 1998       | 6                   | Jewelry          | 3.101517975000849E9   |
| 1998       | 9                   | Books            | 3.058270689738417E9   |
| 1998       | 5                   | Music            | 2.6645460919766383E9  |
| 1998       | NULL                |                  | 1.5285101042918563E7  |
| 1998       | 9                   |                  | 8729109.845192581     |
| 1998       | 7                   |                  | 8107097.69760102      |
+------------+---------------------+------------------+-----------------------+--+
13 rows selected (31.999 seconds)
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10000/tpcds_bin_parti> 
Closing: 0: jdbc:hive2://h01hn02:10000/tpcds_bin_partitioned_orc_10000
STOP hdp2.5_tez_10000_query42_sql_2016-12-07-10-23:  Wed Dec 7 10:24:36 CST 2016

 South Results Number of Nodes:  9
 Avg CPU Busy:   Peak Cpu Avg:  91.040 Count > 90% Busy:  0
 Avg Disk Busy:   Peak Disk Avg:  3.894 Count > 90% busy 0
 Avg Disk Reads per sec:   Avg Write per sec: 
 Avg Net TX:    Peak TX Avg: 
 Avg Net RX:    Peak RX Avg: 
 Mem Utilized: 
South CSV
| 91.040 | 0 | | 3.894 | 0 | | | | | | |
