START hdp2.5_10000_query83_sql_2016-12-01-09-10:  Thu Dec 1 09:10:58 CST 2016
beeline --outputformat=csv2 -u jdbc:hiv2:// -i sample-queries-tpcds/testbench.settings-4g-container-tez --database tpcds_bin_partitioned_orc_10000 -f sample-queries-tpcds/query83.sql
Connecting to jdbc:hive2://h01hn02:10500/tpcds_bin_partitioned_orc_10000
Connected to: Apache Hive (version 2.1.0.2.5.1.0-43)
Driver: Hive JDBC (version 1.2.1000.2.5.1.0-43)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script sample-queries-tpch/testbench.settings-4g-container
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set ambari.hive.db.schema.name=hive;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set fs.file.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set fs.hdfs.impl.disable.cache=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.auto.convert.sortmerge.join.noconditionaltask=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.sortmerge.join=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.compactor.abortedtxn.threshold=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.compactor.check.interval=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.compactor.delta.num.threshold=10;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.compactor.delta.pct.threshold=0.1f;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.compactor.initiator.on=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.compactor.worker.threads=0;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.compactor.worker.timeout=86400;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.compute.query.using.stats=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.enforce.bucketing=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.enforce.sorting=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.enforce.sortmergebucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.execution.engine=mr;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.limit.pushdown.memory.usage=0.04;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.map.aggr=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.mapjoin.bucket.cache.size=10000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.mapred.reduce.tasks.speculative.execution=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.metastore.cache.pinobjtypes=Table,Database,Type,FieldSchema,Order;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.metastore.client.socket.timeout=60;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.metastore.execute.setugi=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.metastore.warehouse.dir=/apps/hive/warehouse;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.optimize.bucketmapjoin.sortedmerge=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.optimize.bucketmapjoin=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.optimize.index.filter=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.optimize.mapjoin.mapreduce=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.optimize.reducededuplication.min.reducer=4;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.optimize.reducededuplication=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.orc.splits.include.file.footer=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.security.authorization.enabled=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.security.metastore.authorization.manager=org.apache.hadoop.hive.ql.security.authorization.Storag eBasedAuthorizationProvider;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> --set hive.semantic.analyzer.factory.impl=org.apache.hivealog.cli.HCatSemanticAnalyzerFactory;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.server2.enable.doAs=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.server2.tez.default.queues=default;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.server2.tez.initialize.default.sessions=false;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.server2.tez.sessions.per.default.queue=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.stats.autogather=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.tez.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.txn.manager=org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.txn.max.open.batch=1000;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.txn.timeout=300;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.vectorized.execution.enabled=true;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.vectorized.groupby.checkinterval=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.vectorized.groupby.flush.percent=1;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.vectorized.groupby.maxentries=1024;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- These values need to be tuned appropriately to your cluster. These examples are for reference.
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.tez.container.size=4096;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.tez.java.opts=-Xmx3800m;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> -- set hive.auto.convert.join.noconditionaltask.size=1252698795;
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti> with sr_items as
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  (select i_item_id item_id,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         sum(sr_return_quantity) sr_item_qty
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from store_returns,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>       item,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>       date_dim a
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where sr_item_sk = i_item_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and   a.d_date    in 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         (select d_date
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         from date_dim b
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         where b.d_week_seq in 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>                 (select c.d_week_seq
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>                 from date_dim c
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           where c.d_date in ('1998-01-02','1998-10-15','1998-11-10')))
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and   sr_returned_date_sk   = d_date_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  group by i_item_id),
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  cr_items as
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  (select i_item_id item_id,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         sum(cr_return_quantity) cr_item_qty
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from catalog_returns,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>       item,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>       date_dim
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where cr_item_sk = i_item_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and   d_date    in 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         (select d_date
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         from date_dim
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         where d_week_seq in 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>                 (select d_week_seq
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>                 from date_dim
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>           where d_date in ('1998-01-02','1998-10-15','1998-11-10')))
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and   cr_returned_date_sk   = d_date_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  group by i_item_id),
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  wr_items as
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  (select i_item_id item_id,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         sum(wr_return_quantity) wr_item_qty
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from web_returns,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>       item,
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>       date_dim
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where wr_item_sk = i_item_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and   d_date    in 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         (select d_date
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         from date_dim
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>         where d_week_seq in 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>                 (select d_week_seq
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>                 from date_dim
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>                 where d_date in ('1998-01-02','1998-10-15','1998-11-10')))
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  and   wr_returned_date_sk   = d_date_sk
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  group by i_item_id)
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>   select  sr_items.item_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>        ,sr_item_qty
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>        ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>        ,cr_item_qty
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>        ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>        ,wr_item_qty
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>        ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>        ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  from sr_items
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      ,cr_items
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>      ,wr_items
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  where sr_items.item_id=cr_items.item_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>    and sr_items.item_id=wr_items.item_id 
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  order by sr_items.item_id
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>          ,sr_item_qty
0: jdbc:hive2://h01hn02:10500/tpcds_bin_parti>  limit 100;
Error: Error while compiling statement: FAILED: SemanticException [Error 10249]: Line 11:27 Unsupported SubQuery Expression 'd_week_seq': Nested SubQuery expressions are not supported. (state=42000,code=10249)

Closing: 0: jdbc:hive2://h01hn02:10500/tpcds_bin_partitioned_orc_10000
STOP hdp2.5_10000_query83_sql_2016-12-01-09-10:  Thu Dec 1 09:11:00 CST 2016

 South Results Number of Nodes:  9
 Avg CPU Busy:   Peak Cpu Avg:  100.000 Count > 90% Busy:  0
 Avg Disk Busy:   Peak Disk Avg:  0 Count > 90% busy 0
 Avg Disk Reads per sec:   Avg Write per sec: 
 Avg Net TX:    Peak TX Avg: 
 Avg Net RX:    Peak RX Avg: 
 Mem Utilized: 
South CSV
| 100.000 | 0 | | 0 | 0 | | | | | | |
