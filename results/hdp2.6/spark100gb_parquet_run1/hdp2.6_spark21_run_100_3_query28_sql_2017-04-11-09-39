START hdp2.6_spark21_run_100_3_query28_sql_2017-04-11-09-39:  Tue Apr 11 09:39:47 CDT 2017
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
17/04/11 09:39:47 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/11 09:39:47 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/11 09:39:47 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
Connected to: Spark SQL (version 2.1.0.2.6.0.3-8)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  *
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> from (select avg(ss_list_price) B1_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B1_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B1_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 0 and 5
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 11 and 11+10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              or ss_coupon_amt between 460 and 460+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              or ss_wholesale_cost between 14 and 14+20)) B1,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B2_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B2_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B2_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 6 and 10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 91 and 91+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 1430 and 1430+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 32 and 32+20)) B2,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B3_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B3_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B3_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 11 and 15
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 66 and 66+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 920 and 920+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 4 and 4+20)) B3,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B4_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B4_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B4_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 16 and 20
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 142 and 142+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 3054 and 3054+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 80 and 80+20)) B4,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B5_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B5_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B5_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 21 and 25
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 135 and 135+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 14180 and 14180+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 38 and 38+20)) B5,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B6_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B6_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B6_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 26 and 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 28 and 28+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 2513 and 2513+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 42 and 42+20)) B6
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> limit 100;
Error: org.apache.spark.sql.AnalysisException: Detected cartesian product for INNER join between logical plans
Join Inner
:- Join Inner
:  :- Join Inner
:  :  :- Join Inner
:  :  :  :- Aggregate [avg(cast(ss_list_price#43072 as double)) AS B1_LP#43042, count(ss_list_price#43072) AS B1_CNT#43043L, count(distinct ss_list_price#43072) AS B1_CNTD#43044L]
:  :  :  :  +- Project [ss_list_price#43072]
:  :  :  :     +- Filter (isnotnull(ss_quantity#43070) && (((ss_quantity#43070 >= 0) && (ss_quantity#43070 <= 5)) && ((((ss_list_price#43072 >= 11.0) && (ss_list_price#43072 <= 21.0)) || ((ss_coupon_amt#43079 >= 460.0) && (ss_coupon_amt#43079 <= 1460.0))) || ((ss_wholesale_cost#43071 >= 14.0) && (ss_wholesale_cost#43071 <= 34.0)))))
:  :  :  :        +- Relation[ss_sold_time_sk#43061,ss_item_sk#43062,ss_customer_sk#43063,ss_cdemo_sk#43064,ss_hdemo_sk#43065,ss_addr_sk#43066,ss_store_sk#43067,ss_promo_sk#43068,ss_ticket_number#43069,ss_quantity#43070,ss_wholesale_cost#43071,ss_list_price#43072,ss_sales_price#43073,ss_ext_discount_amt#43074,ss_ext_sales_price#43075,ss_ext_wholesale_cost#43076,ss_ext_list_price#43077,ss_ext_tax#43078,ss_coupon_amt#43079,ss_net_paid#43080,ss_net_paid_inc_tax#43081,ss_net_profit#43082,ss_sold_date_sk#43060] parquet
:  :  :  +- Aggregate [avg(cast(ss_list_price#43095 as double)) AS B2_LP#43045, count(ss_list_price#43095) AS B2_CNT#43046L, count(distinct ss_list_price#43095) AS B2_CNTD#43047L]
:  :  :     +- Project [ss_list_price#43095]
:  :  :        +- Filter (isnotnull(ss_quantity#43093) && (((ss_quantity#43093 >= 6) && (ss_quantity#43093 <= 10)) && ((((ss_list_price#43095 >= 91.0) && (ss_list_price#43095 <= 101.0)) || ((ss_coupon_amt#43102 >= 1430.0) && (ss_coupon_amt#43102 <= 2430.0))) || ((ss_wholesale_cost#43094 >= 32.0) && (ss_wholesale_cost#43094 <= 52.0)))))
:  :  :           +- Relation[ss_sold_time_sk#43084,ss_item_sk#43085,ss_customer_sk#43086,ss_cdemo_sk#43087,ss_hdemo_sk#43088,ss_addr_sk#43089,ss_store_sk#43090,ss_promo_sk#43091,ss_ticket_number#43092,ss_quantity#43093,ss_wholesale_cost#43094,ss_list_price#43095,ss_sales_price#43096,ss_ext_discount_amt#43097,ss_ext_sales_price#43098,ss_ext_wholesale_cost#43099,ss_ext_list_price#43100,ss_ext_tax#43101,ss_coupon_amt#43102,ss_net_paid#43103,ss_net_paid_inc_tax#43104,ss_net_profit#43105,ss_sold_date_sk#43083] parquet
:  :  +- Aggregate [avg(cast(ss_list_price#43118 as double)) AS B3_LP#43048, count(ss_list_price#43118) AS B3_CNT#43049L, count(distinct ss_list_price#43118) AS B3_CNTD#43050L]
:  :     +- Project [ss_list_price#43118]
:  :        +- Filter (isnotnull(ss_quantity#43116) && (((ss_quantity#43116 >= 11) && (ss_quantity#43116 <= 15)) && ((((ss_list_price#43118 >= 66.0) && (ss_list_price#43118 <= 76.0)) || ((ss_coupon_amt#43125 >= 920.0) && (ss_coupon_amt#43125 <= 1920.0))) || ((ss_wholesale_cost#43117 >= 4.0) && (ss_wholesale_cost#43117 <= 24.0)))))
:  :           +- Relation[ss_sold_time_sk#43107,ss_item_sk#43108,ss_customer_sk#43109,ss_cdemo_sk#43110,ss_hdemo_sk#43111,ss_addr_sk#43112,ss_store_sk#43113,ss_promo_sk#43114,ss_ticket_number#43115,ss_quantity#43116,ss_wholesale_cost#43117,ss_list_price#43118,ss_sales_price#43119,ss_ext_discount_amt#43120,ss_ext_sales_price#43121,ss_ext_wholesale_cost#43122,ss_ext_list_price#43123,ss_ext_tax#43124,ss_coupon_amt#43125,ss_net_paid#43126,ss_net_paid_inc_tax#43127,ss_net_profit#43128,ss_sold_date_sk#43106] parquet
:  +- Aggregate [avg(cast(ss_list_price#43141 as double)) AS B4_LP#43051, count(ss_list_price#43141) AS B4_CNT#43052L, count(distinct ss_list_price#43141) AS B4_CNTD#43053L]
:     +- Project [ss_list_price#43141]
:        +- Filter (isnotnull(ss_quantity#43139) && (((ss_quantity#43139 >= 16) && (ss_quantity#43139 <= 20)) && ((((ss_list_price#43141 >= 142.0) && (ss_list_price#43141 <= 152.0)) || ((ss_coupon_amt#43148 >= 3054.0) && (ss_coupon_amt#43148 <= 4054.0))) || ((ss_wholesale_cost#43140 >= 80.0) && (ss_wholesale_cost#43140 <= 100.0)))))
:           +- Relation[ss_sold_time_sk#43130,ss_item_sk#43131,ss_customer_sk#43132,ss_cdemo_sk#43133,ss_hdemo_sk#43134,ss_addr_sk#43135,ss_store_sk#43136,ss_promo_sk#43137,ss_ticket_number#43138,ss_quantity#43139,ss_wholesale_cost#43140,ss_list_price#43141,ss_sales_price#43142,ss_ext_discount_amt#43143,ss_ext_sales_price#43144,ss_ext_wholesale_cost#43145,ss_ext_list_price#43146,ss_ext_tax#43147,ss_coupon_amt#43148,ss_net_paid#43149,ss_net_paid_inc_tax#43150,ss_net_profit#43151,ss_sold_date_sk#43129] parquet
+- Aggregate [avg(cast(ss_list_price#43164 as double)) AS B5_LP#43054, count(ss_list_price#43164) AS B5_CNT#43055L, count(distinct ss_list_price#43164) AS B5_CNTD#43056L]
   +- Project [ss_list_price#43164]
      +- Filter (isnotnull(ss_quantity#43162) && (((ss_quantity#43162 >= 21) && (ss_quantity#43162 <= 25)) && ((((ss_list_price#43164 >= 135.0) && (ss_list_price#43164 <= 145.0)) || ((ss_coupon_amt#43171 >= 14180.0) && (ss_coupon_amt#43171 <= 15180.0))) || ((ss_wholesale_cost#43163 >= 38.0) && (ss_wholesale_cost#43163 <= 58.0)))))
         +- Relation[ss_sold_time_sk#43153,ss_item_sk#43154,ss_customer_sk#43155,ss_cdemo_sk#43156,ss_hdemo_sk#43157,ss_addr_sk#43158,ss_store_sk#43159,ss_promo_sk#43160,ss_ticket_number#43161,ss_quantity#43162,ss_wholesale_cost#43163,ss_list_price#43164,ss_sales_price#43165,ss_ext_discount_amt#43166,ss_ext_sales_price#43167,ss_ext_wholesale_cost#43168,ss_ext_list_price#43169,ss_ext_tax#43170,ss_coupon_amt#43171,ss_net_paid#43172,ss_net_paid_inc_tax#43173,ss_net_profit#43174,ss_sold_date_sk#43152] parquet
and
Aggregate [avg(cast(ss_list_price#43187 as double)) AS B6_LP#43057, count(ss_list_price#43187) AS B6_CNT#43058L, count(distinct ss_list_price#43187) AS B6_CNTD#43059L]
+- Project [ss_list_price#43187]
   +- Filter (isnotnull(ss_quantity#43185) && (((ss_quantity#43185 >= 26) && (ss_quantity#43185 <= 30)) && ((((ss_list_price#43187 >= 28.0) && (ss_list_price#43187 <= 38.0)) || ((ss_coupon_amt#43194 >= 2513.0) && (ss_coupon_amt#43194 <= 3513.0))) || ((ss_wholesale_cost#43186 >= 42.0) && (ss_wholesale_cost#43186 <= 62.0)))))
      +- Relation[ss_sold_time_sk#43176,ss_item_sk#43177,ss_customer_sk#43178,ss_cdemo_sk#43179,ss_hdemo_sk#43180,ss_addr_sk#43181,ss_store_sk#43182,ss_promo_sk#43183,ss_ticket_number#43184,ss_quantity#43185,ss_wholesale_cost#43186,ss_list_price#43187,ss_sales_price#43188,ss_ext_discount_amt#43189,ss_ext_sales_price#43190,ss_ext_wholesale_cost#43191,ss_ext_list_price#43192,ss_ext_tax#43193,ss_coupon_amt#43194,ss_net_paid#43195,ss_net_paid_inc_tax#43196,ss_net_profit#43197,ss_sold_date_sk#43175] parquet
Join condition is missing or trivial.
Use the CROSS JOIN syntax to allow cartesian products between these relations.; (state=,code=0)

Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
STOP hdp2.6_spark21_run_100_3_query28_sql_2017-04-11-09-39:  Tue Apr 11 09:39:48 CDT 2017
