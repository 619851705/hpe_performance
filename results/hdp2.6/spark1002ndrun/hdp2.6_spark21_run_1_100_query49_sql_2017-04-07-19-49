START hdp2.6_spark21_run_1_100_query49_sql_2017-04-07-19-49:  Fri Apr 7 19:49:02 CDT 2017
 /usr/hdp/current/spark2-client/bin/beeline -u "jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_$SF" -n hive --incremental=true  -i settings/spark.settings -f sample-queries-tpcds/$1
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
17/04/07 19:49:02 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/07 19:49:02 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/07 19:49:02 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
17/04/07 19:49:02 INFO HiveConnection: Could not open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
17/04/07 19:49:02 INFO HiveConnection: Transport Used for JDBC connection: null
Error: Could not open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100: java.net.ConnectException: Connection refused (Connection refused) (state=08S01,code=0)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)> select  
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  'web' as channel
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,web.item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,web.return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,web.return_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,web.currency_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  from (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  select 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>   item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,currency_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,rank() over (order by return_ratio) as return_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,rank() over (order by currency_ratio) as currency_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  from
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  (select ws.ws_item_sk as item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  cast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  cast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  from 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>   web_sales ws left outer join web_returns wr 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  on (ws.ws_order_number = wr.wr_order_number and 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ws.ws_item_sk = wr.wr_item_sk)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                  ,date_dim
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  where 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  wr.wr_return_amt > 10000 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  and ws.ws_net_profit > 1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                          and ws.ws_net_paid > 0
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                          and ws.ws_quantity > 0
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                          and ws.ws_sold_date_sk = date_dim.d_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                          and d_year = 2000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                          and d_moy = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  group by ws.ws_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ) in_web
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ) web
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  where 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  web.return_rank <= 10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  web.currency_rank <= 10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  )
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  union all
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  select 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  'catalog' as channel
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,catalog.item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,catalog.return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,catalog.return_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,catalog.currency_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  from (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  select 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>   item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,currency_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,rank() over (order by return_ratio) as return_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,rank() over (order by currency_ratio) as currency_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  from
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  (select 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  cs.cs_item_sk as item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  cast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  cast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  from 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  catalog_sales cs left outer join catalog_returns cr
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  on (cs.cs_order_number = cr.cr_order_number and 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  cs.cs_item_sk = cr.cr_item_sk)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                 ,date_dim
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  where 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  cr.cr_return_amount > 10000 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  and cs.cs_net_profit > 1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                          and cs.cs_net_paid > 0
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                          and cs.cs_quantity > 0
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                          and cs_sold_date_sk = d_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                          and d_year = 2000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                          and d_moy = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                  group by cs.cs_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ) in_cat
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ) catalog
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  where 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  catalog.return_rank <= 10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  catalog.currency_rank <=10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  )
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  union all
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  select 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  'store' as channel
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,store.item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,store.return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,store.return_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,store.currency_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  from (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  select 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>   item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,currency_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,rank() over (order by return_ratio) as return_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,rank() over (order by currency_ratio) as currency_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  from
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  (select sts.ss_item_sk as item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0))  as decimal(15,4) )) as return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as de cimal(15,4) )) as currency_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  from 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  store_sales sts left outer join store_returns sr
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                 ,date_dim
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  where 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  sr.sr_return_amt > 10000 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  and sts.ss_net_profit > 1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                          and sts.ss_net_paid > 0 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                          and sts.ss_quantity > 0
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                          and ss_sold_date_sk = d_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                          and d_year = 2000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                          and d_moy = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  group by sts.ss_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ) in_store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ) store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  where  (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  store.return_rank <= 10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  or 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  store.currency_rank <= 10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  )
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  order by 1,4,5
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  limit 100;
17/04/07 19:49:02 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/07 19:49:02 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/07 19:49:02 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
17/04/07 19:49:02 INFO HiveConnection: Could not open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
17/04/07 19:49:02 INFO HiveConnection: Transport Used for JDBC connection: null
No current connection

17/04/07 19:49:02 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/07 19:49:02 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/07 19:49:02 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
17/04/07 19:49:02 INFO HiveConnection: Could not open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
17/04/07 19:49:02 INFO HiveConnection: Transport Used for JDBC connection: null
Error: Could not open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100: java.net.ConnectException: Connection refused (Connection refused) (state=08S01,code=0)
STOP hdp2.6_spark21_run_1_100_query49_sql_2017-04-07-19-49:  Fri Apr 7 19:49:02 CDT 2017
