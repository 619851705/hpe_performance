START hdp2.6_spark21_run_1_100_query88_sql_2017-04-08-19-07:  Sat Apr 8 19:07:03 CDT 2017
 /usr/hdp/current/spark2-client/bin/beeline -u "jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_$SF" -n hive --incremental=true  -i settings/spark.settings -f sample-queries-tpcds/$1
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
17/04/08 19:07:04 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/08 19:07:04 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/08 19:07:04 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
Connected to: Spark SQL (version 2.1.0.2.6.0.0-598)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  *
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> from
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h8_30_to_9
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk   
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s1,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h9_to_9_30 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 9 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s2,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h9_30_to_10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 9
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s3,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h10_to_10_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s4,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h10_30_to_11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s5,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h11_to_11_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s6,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h11_30_to_12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s7,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h12_to_12_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> ;
Error: org.apache.spark.sql.AnalysisException: Detected cartesian product for INNER join between logical plans
Join Inner
:- Join Inner
:  :- Join Inner
:  :  :- Join Inner
:  :  :  :- Join Inner
:  :  :  :  :- Join Inner
:  :  :  :  :  :- Aggregate [count(1) AS h8_30_to_9#70982L]
:  :  :  :  :  :  +- Project
:  :  :  :  :  :     +- Join Inner, (ss_store_sk#70997 = s_store_sk#71028)
:  :  :  :  :  :        :- Project [ss_store_sk#70997]
:  :  :  :  :  :        :  +- Join Inner, (ss_sold_time_sk#70991 = t_time_sk#71018)
:  :  :  :  :  :        :     :- Project [ss_sold_time_sk#70991, ss_store_sk#70997]
:  :  :  :  :  :        :     :  +- Join Inner, (ss_hdemo_sk#70995 = hd_demo_sk#71013)
:  :  :  :  :  :        :     :     :- Project [ss_sold_time_sk#70991, ss_hdemo_sk#70995, ss_store_sk#70997]
:  :  :  :  :  :        :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#70995) && isnotnull(ss_sold_time_sk#70991)) && isnotnull(ss_store_sk#70997))
:  :  :  :  :  :        :     :     :     +- Relation[ss_sold_time_sk#70991,ss_item_sk#70992,ss_customer_sk#70993,ss_cdemo_sk#70994,ss_hdemo_sk#70995,ss_addr_sk#70996,ss_store_sk#70997,ss_promo_sk#70998,ss_ticket_number#70999,ss_quantity#71000,ss_wholesale_cost#71001,ss_list_price#71002,ss_sales_price#71003,ss_ext_discount_amt#71004,ss_ext_sales_price#71005,ss_ext_wholesale_cost#71006,ss_ext_list_price#71007,ss_ext_tax#71008,ss_coupon_amt#71009,ss_net_paid#71010,ss_net_paid_inc_tax#71011,ss_net_profit#71012,ss_sold_date_sk#70990] parquet
:  :  :  :  :  :        :     :     +- Project [hd_demo_sk#71013]
:  :  :  :  :  :        :     :        +- Filter (((((hd_dep_count#71016 = 3) && (hd_vehicle_count#71017 <= 5)) || ((hd_dep_count#71016 = 0) && (hd_vehicle_count#71017 <= 2))) || ((hd_dep_count#71016 = 1) && (hd_vehicle_count#71017 <= 3))) && isnotnull(hd_demo_sk#71013))
:  :  :  :  :  :        :     :           +- InMemoryRelation [hd_demo_sk#71013, hd_income_band_sk#71014, hd_buy_potential#71015, hd_dep_count#71016, hd_vehicle_count#71017], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:  :  :  :  :  :        :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:  :  :  :  :  :        :     +- Project [t_time_sk#71018]
:  :  :  :  :  :        :        +- Filter (((isnotnull(t_hour#71021) && isnotnull(t_minute#71022)) && ((t_hour#71021 = 8) && (t_minute#71022 >= 30))) && isnotnull(t_time_sk#71018))
:  :  :  :  :  :        :           +- InMemoryRelation [t_time_sk#71018, t_time_id#71019, t_time#71020, t_hour#71021, t_minute#71022, t_second#71023, t_am_pm#71024, t_shift#71025, t_sub_shift#71026, t_meal_time#71027], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:  :  :  :  :  :        :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:  :  :  :  :  :        +- Project [s_store_sk#71028]
:  :  :  :  :  :           +- Filter ((isnotnull(s_store_name#71033) && (s_store_name#71033 = ese)) && isnotnull(s_store_sk#71028))
:  :  :  :  :  :              +- InMemoryRelation [s_store_sk#71028, s_store_id#71029, s_rec_start_date#71030, s_rec_end_date#71031, s_closed_date_sk#71032, s_store_name#71033, s_number_employees#71034, s_floor_space#71035, s_hours#71036, s_manager#71037, s_market_id#71038, s_geography_class#71039, s_market_desc#71040, s_market_manager#71041, s_division_id#71042, s_division_name#71043, s_company_id#71044, s_company_name#71045, s_street_number#71046, s_street_name#71047, s_street_type#71048, s_suite_number#71049, s_city#71050, s_county#71051, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:  :  :  :  :  :                    +- *FileScan parquet tpcds_bin_partitioned_parquet_100.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
:  :  :  :  :  +- Aggregate [count(1) AS h9_to_9_30#70983L]
:  :  :  :  :     +- Project
:  :  :  :  :        +- Join Inner, (ss_store_sk#71064 = s_store_sk#71095)
:  :  :  :  :           :- Project [ss_store_sk#71064]
:  :  :  :  :           :  +- Join Inner, (ss_sold_time_sk#71058 = t_time_sk#71085)
:  :  :  :  :           :     :- Project [ss_sold_time_sk#71058, ss_store_sk#71064]
:  :  :  :  :           :     :  +- Join Inner, (ss_hdemo_sk#71062 = hd_demo_sk#71080)
:  :  :  :  :           :     :     :- Project [ss_sold_time_sk#71058, ss_hdemo_sk#71062, ss_store_sk#71064]
:  :  :  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#71062) && isnotnull(ss_sold_time_sk#71058)) && isnotnull(ss_store_sk#71064))
:  :  :  :  :           :     :     :     +- Relation[ss_sold_time_sk#71058,ss_item_sk#71059,ss_customer_sk#71060,ss_cdemo_sk#71061,ss_hdemo_sk#71062,ss_addr_sk#71063,ss_store_sk#71064,ss_promo_sk#71065,ss_ticket_number#71066,ss_quantity#71067,ss_wholesale_cost#71068,ss_list_price#71069,ss_sales_price#71070,ss_ext_discount_amt#71071,ss_ext_sales_price#71072,ss_ext_wholesale_cost#71073,ss_ext_list_price#71074,ss_ext_tax#71075,ss_coupon_amt#71076,ss_net_paid#71077,ss_net_paid_inc_tax#71078,ss_net_profit#71079,ss_sold_date_sk#71057] parquet
:  :  :  :  :           :     :     +- Project [hd_demo_sk#71080]
:  :  :  :  :           :     :        +- Filter (((((hd_dep_count#71083 = 3) && (hd_vehicle_count#71084 <= 5)) || ((hd_dep_count#71083 = 0) && (hd_vehicle_count#71084 <= 2))) || ((hd_dep_count#71083 = 1) && (hd_vehicle_count#71084 <= 3))) && isnotnull(hd_demo_sk#71080))
:  :  :  :  :           :     :           +- InMemoryRelation [hd_demo_sk#71080, hd_income_band_sk#71081, hd_buy_potential#71082, hd_dep_count#71083, hd_vehicle_count#71084], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:  :  :  :  :           :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:  :  :  :  :           :     +- Project [t_time_sk#71085]
:  :  :  :  :           :        +- Filter (((isnotnull(t_hour#71088) && isnotnull(t_minute#71089)) && ((t_hour#71088 = 9) && (t_minute#71089 < 30))) && isnotnull(t_time_sk#71085))
:  :  :  :  :           :           +- InMemoryRelation [t_time_sk#71085, t_time_id#71086, t_time#71087, t_hour#71088, t_minute#71089, t_second#71090, t_am_pm#71091, t_shift#71092, t_sub_shift#71093, t_meal_time#71094], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:  :  :  :  :           :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:  :  :  :  :           +- Project [s_store_sk#71095]
:  :  :  :  :              +- Filter ((isnotnull(s_store_name#71100) && (s_store_name#71100 = ese)) && isnotnull(s_store_sk#71095))
:  :  :  :  :                 +- InMemoryRelation [s_store_sk#71095, s_store_id#71096, s_rec_start_date#71097, s_rec_end_date#71098, s_closed_date_sk#71099, s_store_name#71100, s_number_employees#71101, s_floor_space#71102, s_hours#71103, s_manager#71104, s_market_id#71105, s_geography_class#71106, s_market_desc#71107, s_market_manager#71108, s_division_id#71109, s_division_name#71110, s_company_id#71111, s_company_name#71112, s_street_number#71113, s_street_name#71114, s_street_type#71115, s_suite_number#71116, s_city#71117, s_county#71118, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:  :  :  :  :                       +- *FileScan parquet tpcds_bin_partitioned_parquet_100.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
:  :  :  :  +- Aggregate [count(1) AS h9_30_to_10#70984L]
:  :  :  :     +- Project
:  :  :  :        +- Join Inner, (ss_store_sk#71131 = s_store_sk#71162)
:  :  :  :           :- Project [ss_store_sk#71131]
:  :  :  :           :  +- Join Inner, (ss_sold_time_sk#71125 = t_time_sk#71152)
:  :  :  :           :     :- Project [ss_sold_time_sk#71125, ss_store_sk#71131]
:  :  :  :           :     :  +- Join Inner, (ss_hdemo_sk#71129 = hd_demo_sk#71147)
:  :  :  :           :     :     :- Project [ss_sold_time_sk#71125, ss_hdemo_sk#71129, ss_store_sk#71131]
:  :  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#71129) && isnotnull(ss_sold_time_sk#71125)) && isnotnull(ss_store_sk#71131))
:  :  :  :           :     :     :     +- Relation[ss_sold_time_sk#71125,ss_item_sk#71126,ss_customer_sk#71127,ss_cdemo_sk#71128,ss_hdemo_sk#71129,ss_addr_sk#71130,ss_store_sk#71131,ss_promo_sk#71132,ss_ticket_number#71133,ss_quantity#71134,ss_wholesale_cost#71135,ss_list_price#71136,ss_sales_price#71137,ss_ext_discount_amt#71138,ss_ext_sales_price#71139,ss_ext_wholesale_cost#71140,ss_ext_list_price#71141,ss_ext_tax#71142,ss_coupon_amt#71143,ss_net_paid#71144,ss_net_paid_inc_tax#71145,ss_net_profit#71146,ss_sold_date_sk#71124] parquet
:  :  :  :           :     :     +- Project [hd_demo_sk#71147]
:  :  :  :           :     :        +- Filter (((((hd_dep_count#71150 = 3) && (hd_vehicle_count#71151 <= 5)) || ((hd_dep_count#71150 = 0) && (hd_vehicle_count#71151 <= 2))) || ((hd_dep_count#71150 = 1) && (hd_vehicle_count#71151 <= 3))) && isnotnull(hd_demo_sk#71147))
:  :  :  :           :     :           +- InMemoryRelation [hd_demo_sk#71147, hd_income_band_sk#71148, hd_buy_potential#71149, hd_dep_count#71150, hd_vehicle_count#71151], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:  :  :  :           :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:  :  :  :           :     +- Project [t_time_sk#71152]
:  :  :  :           :        +- Filter (((isnotnull(t_hour#71155) && isnotnull(t_minute#71156)) && ((t_hour#71155 = 9) && (t_minute#71156 >= 30))) && isnotnull(t_time_sk#71152))
:  :  :  :           :           +- InMemoryRelation [t_time_sk#71152, t_time_id#71153, t_time#71154, t_hour#71155, t_minute#71156, t_second#71157, t_am_pm#71158, t_shift#71159, t_sub_shift#71160, t_meal_time#71161], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:  :  :  :           :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:  :  :  :           +- Project [s_store_sk#71162]
:  :  :  :              +- Filter ((isnotnull(s_store_name#71167) && (s_store_name#71167 = ese)) && isnotnull(s_store_sk#71162))
:  :  :  :                 +- InMemoryRelation [s_store_sk#71162, s_store_id#71163, s_rec_start_date#71164, s_rec_end_date#71165, s_closed_date_sk#71166, s_store_name#71167, s_number_employees#71168, s_floor_space#71169, s_hours#71170, s_manager#71171, s_market_id#71172, s_geography_class#71173, s_market_desc#71174, s_market_manager#71175, s_division_id#71176, s_division_name#71177, s_company_id#71178, s_company_name#71179, s_street_number#71180, s_street_name#71181, s_street_type#71182, s_suite_number#71183, s_city#71184, s_county#71185, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:  :  :  :                       +- *FileScan parquet tpcds_bin_partitioned_parquet_100.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
:  :  :  +- Aggregate [count(1) AS h10_to_10_30#70985L]
:  :  :     +- Project
:  :  :        +- Join Inner, (ss_store_sk#71198 = s_store_sk#71229)
:  :  :           :- Project [ss_store_sk#71198]
:  :  :           :  +- Join Inner, (ss_sold_time_sk#71192 = t_time_sk#71219)
:  :  :           :     :- Project [ss_sold_time_sk#71192, ss_store_sk#71198]
:  :  :           :     :  +- Join Inner, (ss_hdemo_sk#71196 = hd_demo_sk#71214)
:  :  :           :     :     :- Project [ss_sold_time_sk#71192, ss_hdemo_sk#71196, ss_store_sk#71198]
:  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#71196) && isnotnull(ss_sold_time_sk#71192)) && isnotnull(ss_store_sk#71198))
:  :  :           :     :     :     +- Relation[ss_sold_time_sk#71192,ss_item_sk#71193,ss_customer_sk#71194,ss_cdemo_sk#71195,ss_hdemo_sk#71196,ss_addr_sk#71197,ss_store_sk#71198,ss_promo_sk#71199,ss_ticket_number#71200,ss_quantity#71201,ss_wholesale_cost#71202,ss_list_price#71203,ss_sales_price#71204,ss_ext_discount_amt#71205,ss_ext_sales_price#71206,ss_ext_wholesale_cost#71207,ss_ext_list_price#71208,ss_ext_tax#71209,ss_coupon_amt#71210,ss_net_paid#71211,ss_net_paid_inc_tax#71212,ss_net_profit#71213,ss_sold_date_sk#71191] parquet
:  :  :           :     :     +- Project [hd_demo_sk#71214]
:  :  :           :     :        +- Filter (((((hd_dep_count#71217 = 3) && (hd_vehicle_count#71218 <= 5)) || ((hd_dep_count#71217 = 0) && (hd_vehicle_count#71218 <= 2))) || ((hd_dep_count#71217 = 1) && (hd_vehicle_count#71218 <= 3))) && isnotnull(hd_demo_sk#71214))
:  :  :           :     :           +- InMemoryRelation [hd_demo_sk#71214, hd_income_band_sk#71215, hd_buy_potential#71216, hd_dep_count#71217, hd_vehicle_count#71218], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:  :  :           :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:  :  :           :     +- Project [t_time_sk#71219]
:  :  :           :        +- Filter (((isnotnull(t_hour#71222) && isnotnull(t_minute#71223)) && ((t_hour#71222 = 10) && (t_minute#71223 < 30))) && isnotnull(t_time_sk#71219))
:  :  :           :           +- InMemoryRelation [t_time_sk#71219, t_time_id#71220, t_time#71221, t_hour#71222, t_minute#71223, t_second#71224, t_am_pm#71225, t_shift#71226, t_sub_shift#71227, t_meal_time#71228], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:  :  :           :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:  :  :           +- Project [s_store_sk#71229]
:  :  :              +- Filter ((isnotnull(s_store_name#71234) && (s_store_name#71234 = ese)) && isnotnull(s_store_sk#71229))
:  :  :                 +- InMemoryRelation [s_store_sk#71229, s_store_id#71230, s_rec_start_date#71231, s_rec_end_date#71232, s_closed_date_sk#71233, s_store_name#71234, s_number_employees#71235, s_floor_space#71236, s_hours#71237, s_manager#71238, s_market_id#71239, s_geography_class#71240, s_market_desc#71241, s_market_manager#71242, s_division_id#71243, s_division_name#71244, s_company_id#71245, s_company_name#71246, s_street_number#71247, s_street_name#71248, s_street_type#71249, s_suite_number#71250, s_city#71251, s_county#71252, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:  :  :                       +- *FileScan parquet tpcds_bin_partitioned_parquet_100.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
:  :  +- Aggregate [count(1) AS h10_30_to_11#70986L]
:  :     +- Project
:  :        +- Join Inner, (ss_store_sk#71265 = s_store_sk#71296)
:  :           :- Project [ss_store_sk#71265]
:  :           :  +- Join Inner, (ss_sold_time_sk#71259 = t_time_sk#71286)
:  :           :     :- Project [ss_sold_time_sk#71259, ss_store_sk#71265]
:  :           :     :  +- Join Inner, (ss_hdemo_sk#71263 = hd_demo_sk#71281)
:  :           :     :     :- Project [ss_sold_time_sk#71259, ss_hdemo_sk#71263, ss_store_sk#71265]
:  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#71263) && isnotnull(ss_sold_time_sk#71259)) && isnotnull(ss_store_sk#71265))
:  :           :     :     :     +- Relation[ss_sold_time_sk#71259,ss_item_sk#71260,ss_customer_sk#71261,ss_cdemo_sk#71262,ss_hdemo_sk#71263,ss_addr_sk#71264,ss_store_sk#71265,ss_promo_sk#71266,ss_ticket_number#71267,ss_quantity#71268,ss_wholesale_cost#71269,ss_list_price#71270,ss_sales_price#71271,ss_ext_discount_amt#71272,ss_ext_sales_price#71273,ss_ext_wholesale_cost#71274,ss_ext_list_price#71275,ss_ext_tax#71276,ss_coupon_amt#71277,ss_net_paid#71278,ss_net_paid_inc_tax#71279,ss_net_profit#71280,ss_sold_date_sk#71258] parquet
:  :           :     :     +- Project [hd_demo_sk#71281]
:  :           :     :        +- Filter (((((hd_dep_count#71284 = 3) && (hd_vehicle_count#71285 <= 5)) || ((hd_dep_count#71284 = 0) && (hd_vehicle_count#71285 <= 2))) || ((hd_dep_count#71284 = 1) && (hd_vehicle_count#71285 <= 3))) && isnotnull(hd_demo_sk#71281))
:  :           :     :           +- InMemoryRelation [hd_demo_sk#71281, hd_income_band_sk#71282, hd_buy_potential#71283, hd_dep_count#71284, hd_vehicle_count#71285], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:  :           :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:  :           :     +- Project [t_time_sk#71286]
:  :           :        +- Filter (((isnotnull(t_hour#71289) && isnotnull(t_minute#71290)) && ((t_hour#71289 = 10) && (t_minute#71290 >= 30))) && isnotnull(t_time_sk#71286))
:  :           :           +- InMemoryRelation [t_time_sk#71286, t_time_id#71287, t_time#71288, t_hour#71289, t_minute#71290, t_second#71291, t_am_pm#71292, t_shift#71293, t_sub_shift#71294, t_meal_time#71295], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:  :           :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:  :           +- Project [s_store_sk#71296]
:  :              +- Filter ((isnotnull(s_store_name#71301) && (s_store_name#71301 = ese)) && isnotnull(s_store_sk#71296))
:  :                 +- InMemoryRelation [s_store_sk#71296, s_store_id#71297, s_rec_start_date#71298, s_rec_end_date#71299, s_closed_date_sk#71300, s_store_name#71301, s_number_employees#71302, s_floor_space#71303, s_hours#71304, s_manager#71305, s_market_id#71306, s_geography_class#71307, s_market_desc#71308, s_market_manager#71309, s_division_id#71310, s_division_name#71311, s_company_id#71312, s_company_name#71313, s_street_number#71314, s_street_name#71315, s_street_type#71316, s_suite_number#71317, s_city#71318, s_county#71319, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:  :                       +- *FileScan parquet tpcds_bin_partitioned_parquet_100.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
:  +- Aggregate [count(1) AS h11_to_11_30#70987L]
:     +- Project
:        +- Join Inner, (ss_store_sk#71332 = s_store_sk#71363)
:           :- Project [ss_store_sk#71332]
:           :  +- Join Inner, (ss_sold_time_sk#71326 = t_time_sk#71353)
:           :     :- Project [ss_sold_time_sk#71326, ss_store_sk#71332]
:           :     :  +- Join Inner, (ss_hdemo_sk#71330 = hd_demo_sk#71348)
:           :     :     :- Project [ss_sold_time_sk#71326, ss_hdemo_sk#71330, ss_store_sk#71332]
:           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#71330) && isnotnull(ss_sold_time_sk#71326)) && isnotnull(ss_store_sk#71332))
:           :     :     :     +- Relation[ss_sold_time_sk#71326,ss_item_sk#71327,ss_customer_sk#71328,ss_cdemo_sk#71329,ss_hdemo_sk#71330,ss_addr_sk#71331,ss_store_sk#71332,ss_promo_sk#71333,ss_ticket_number#71334,ss_quantity#71335,ss_wholesale_cost#71336,ss_list_price#71337,ss_sales_price#71338,ss_ext_discount_amt#71339,ss_ext_sales_price#71340,ss_ext_wholesale_cost#71341,ss_ext_list_price#71342,ss_ext_tax#71343,ss_coupon_amt#71344,ss_net_paid#71345,ss_net_paid_inc_tax#71346,ss_net_profit#71347,ss_sold_date_sk#71325] parquet
:           :     :     +- Project [hd_demo_sk#71348]
:           :     :        +- Filter (((((hd_dep_count#71351 = 3) && (hd_vehicle_count#71352 <= 5)) || ((hd_dep_count#71351 = 0) && (hd_vehicle_count#71352 <= 2))) || ((hd_dep_count#71351 = 1) && (hd_vehicle_count#71352 <= 3))) && isnotnull(hd_demo_sk#71348))
:           :     :           +- InMemoryRelation [hd_demo_sk#71348, hd_income_band_sk#71349, hd_buy_potential#71350, hd_dep_count#71351, hd_vehicle_count#71352], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:           :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:           :     +- Project [t_time_sk#71353]
:           :        +- Filter (((isnotnull(t_hour#71356) && isnotnull(t_minute#71357)) && ((t_hour#71356 = 11) && (t_minute#71357 < 30))) && isnotnull(t_time_sk#71353))
:           :           +- InMemoryRelation [t_time_sk#71353, t_time_id#71354, t_time#71355, t_hour#71356, t_minute#71357, t_second#71358, t_am_pm#71359, t_shift#71360, t_sub_shift#71361, t_meal_time#71362], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:           :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:           +- Project [s_store_sk#71363]
:              +- Filter ((isnotnull(s_store_name#71368) && (s_store_name#71368 = ese)) && isnotnull(s_store_sk#71363))
:                 +- InMemoryRelation [s_store_sk#71363, s_store_id#71364, s_rec_start_date#71365, s_rec_end_date#71366, s_closed_date_sk#71367, s_store_name#71368, s_number_employees#71369, s_floor_space#71370, s_hours#71371, s_manager#71372, s_market_id#71373, s_geography_class#71374, s_market_desc#71375, s_market_manager#71376, s_division_id#71377, s_division_name#71378, s_company_id#71379, s_company_name#71380, s_street_number#71381, s_street_name#71382, s_street_type#71383, s_suite_number#71384, s_city#71385, s_county#71386, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:                       +- *FileScan parquet tpcds_bin_partitioned_parquet_100.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
+- Aggregate [count(1) AS h11_30_to_12#70988L]
   +- Project
      +- Join Inner, (ss_store_sk#71399 = s_store_sk#71430)
         :- Project [ss_store_sk#71399]
         :  +- Join Inner, (ss_sold_time_sk#71393 = t_time_sk#71420)
         :     :- Project [ss_sold_time_sk#71393, ss_store_sk#71399]
         :     :  +- Join Inner, (ss_hdemo_sk#71397 = hd_demo_sk#71415)
         :     :     :- Project [ss_sold_time_sk#71393, ss_hdemo_sk#71397, ss_store_sk#71399]
         :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#71397) && isnotnull(ss_sold_time_sk#71393)) && isnotnull(ss_store_sk#71399))
         :     :     :     +- Relation[ss_sold_time_sk#71393,ss_item_sk#71394,ss_customer_sk#71395,ss_cdemo_sk#71396,ss_hdemo_sk#71397,ss_addr_sk#71398,ss_store_sk#71399,ss_promo_sk#71400,ss_ticket_number#71401,ss_quantity#71402,ss_wholesale_cost#71403,ss_list_price#71404,ss_sales_price#71405,ss_ext_discount_amt#71406,ss_ext_sales_price#71407,ss_ext_wholesale_cost#71408,ss_ext_list_price#71409,ss_ext_tax#71410,ss_coupon_amt#71411,ss_net_paid#71412,ss_net_paid_inc_tax#71413,ss_net_profit#71414,ss_sold_date_sk#71392] parquet
         :     :     +- Project [hd_demo_sk#71415]
         :     :        +- Filter (((((hd_dep_count#71418 = 3) && (hd_vehicle_count#71419 <= 5)) || ((hd_dep_count#71418 = 0) && (hd_vehicle_count#71419 <= 2))) || ((hd_dep_count#71418 = 1) && (hd_vehicle_count#71419 <= 3))) && isnotnull(hd_demo_sk#71415))
         :     :           +- InMemoryRelation [hd_demo_sk#71415, hd_income_band_sk#71416, hd_buy_potential#71417, hd_dep_count#71418, hd_vehicle_count#71419], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
         :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
         :     +- Project [t_time_sk#71420]
         :        +- Filter (((isnotnull(t_hour#71423) && isnotnull(t_minute#71424)) && ((t_hour#71423 = 11) && (t_minute#71424 >= 30))) && isnotnull(t_time_sk#71420))
         :           +- InMemoryRelation [t_time_sk#71420, t_time_id#71421, t_time#71422, t_hour#71423, t_minute#71424, t_second#71425, t_am_pm#71426, t_shift#71427, t_sub_shift#71428, t_meal_time#71429], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
         :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
         +- Project [s_store_sk#71430]
            +- Filter ((isnotnull(s_store_name#71435) && (s_store_name#71435 = ese)) && isnotnull(s_store_sk#71430))
               +- InMemoryRelation [s_store_sk#71430, s_store_id#71431, s_rec_start_date#71432, s_rec_end_date#71433, s_closed_date_sk#71434, s_store_name#71435, s_number_employees#71436, s_floor_space#71437, s_hours#71438, s_manager#71439, s_market_id#71440, s_geography_class#71441, s_market_desc#71442, s_market_manager#71443, s_division_id#71444, s_division_name#71445, s_company_id#71446, s_company_name#71447, s_street_number#71448, s_street_name#71449, s_street_type#71450, s_suite_number#71451, s_city#71452, s_county#71453, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
                     +- *FileScan parquet tpcds_bin_partitioned_parquet_100.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
and
Aggregate [count(1) AS h12_to_12_30#70989L]
+- Project
   +- Join Inner, (ss_store_sk#71466 = s_store_sk#71497)
      :- Project [ss_store_sk#71466]
      :  +- Join Inner, (ss_sold_time_sk#71460 = t_time_sk#71487)
      :     :- Project [ss_sold_time_sk#71460, ss_store_sk#71466]
      :     :  +- Join Inner, (ss_hdemo_sk#71464 = hd_demo_sk#71482)
      :     :     :- Project [ss_sold_time_sk#71460, ss_hdemo_sk#71464, ss_store_sk#71466]
      :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#71464) && isnotnull(ss_sold_time_sk#71460)) && isnotnull(ss_store_sk#71466))
      :     :     :     +- Relation[ss_sold_time_sk#71460,ss_item_sk#71461,ss_customer_sk#71462,ss_cdemo_sk#71463,ss_hdemo_sk#71464,ss_addr_sk#71465,ss_store_sk#71466,ss_promo_sk#71467,ss_ticket_number#71468,ss_quantity#71469,ss_wholesale_cost#71470,ss_list_price#71471,ss_sales_price#71472,ss_ext_discount_amt#71473,ss_ext_sales_price#71474,ss_ext_wholesale_cost#71475,ss_ext_list_price#71476,ss_ext_tax#71477,ss_coupon_amt#71478,ss_net_paid#71479,ss_net_paid_inc_tax#71480,ss_net_profit#71481,ss_sold_date_sk#71459] parquet
      :     :     +- Project [hd_demo_sk#71482]
      :     :        +- Filter (((((hd_dep_count#71485 = 3) && (hd_vehicle_count#71486 <= 5)) || ((hd_dep_count#71485 = 0) && (hd_vehicle_count#71486 <= 2))) || ((hd_dep_count#71485 = 1) && (hd_vehicle_count#71486 <= 3))) && isnotnull(hd_demo_sk#71482))
      :     :           +- InMemoryRelation [hd_demo_sk#71482, hd_income_band_sk#71483, hd_buy_potential#71484, hd_dep_count#71485, hd_vehicle_count#71486], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
      :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
      :     +- Project [t_time_sk#71487]
      :        +- Filter (((isnotnull(t_hour#71490) && isnotnull(t_minute#71491)) && ((t_hour#71490 = 12) && (t_minute#71491 < 30))) && isnotnull(t_time_sk#71487))
      :           +- InMemoryRelation [t_time_sk#71487, t_time_id#71488, t_time#71489, t_hour#71490, t_minute#71491, t_second#71492, t_am_pm#71493, t_shift#71494, t_sub_shift#71495, t_meal_time#71496], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
      :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_100.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
      +- Project [s_store_sk#71497]
         +- Filter ((isnotnull(s_store_name#71502) && (s_store_name#71502 = ese)) && isnotnull(s_store_sk#71497))
            +- InMemoryRelation [s_store_sk#71497, s_store_id#71498, s_rec_start_date#71499, s_rec_end_date#71500, s_closed_date_sk#71501, s_store_name#71502, s_number_employees#71503, s_floor_space#71504, s_hours#71505, s_manager#71506, s_market_id#71507, s_geography_class#71508, s_market_desc#71509, s_market_manager#71510, s_division_id#71511, s_division_name#71512, s_company_id#71513, s_company_name#71514, s_street_number#71515, s_street_name#71516, s_street_type#71517, s_suite_number#71518, s_city#71519, s_county#71520, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
                  +- *FileScan parquet tpcds_bin_partitioned_parquet_100.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
Join condition is missing or trivial.
Use the CROSS JOIN syntax to allow cartesian products between these relations.; (state=,code=0)

Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
STOP hdp2.6_spark21_run_1_100_query88_sql_2017-04-08-19-07:  Sat Apr 8 19:07:08 CDT 2017
