START hdp2.6_spark21_run_1_100_query28_sql_2017-04-06-16-45:  Thu Apr 6 16:45:17 CDT 2017
 /usr/hdp/current/spark2-client/bin/beeline -u "jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_$SF" -n hive --incremental=true  -i settings/spark.settings -f sample-queries-tpcds/$1
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
17/04/06 16:45:17 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/06 16:45:17 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/06 16:45:17 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
Connected to: Spark SQL (version 2.1.0.2.6.0.0-598)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  *
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> from (select avg(ss_list_price) B1_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B1_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B1_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 0 and 5
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 11 and 11+10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              or ss_coupon_amt between 460 and 460+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              or ss_wholesale_cost between 14 and 14+20)) B1,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B2_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B2_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B2_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 6 and 10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 91 and 91+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 1430 and 1430+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 32 and 32+20)) B2,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B3_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B3_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B3_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 11 and 15
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 66 and 66+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 920 and 920+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 4 and 4+20)) B3,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B4_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B4_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B4_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 16 and 20
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 142 and 142+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 3054 and 3054+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 80 and 80+20)) B4,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B5_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B5_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B5_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 21 and 25
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 135 and 135+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 14180 and 14180+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 38 and 38+20)) B5,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B6_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B6_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B6_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 26 and 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 28 and 28+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 2513 and 2513+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 42 and 42+20)) B6
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> limit 100;
Error: org.apache.spark.sql.AnalysisException: Detected cartesian product for INNER join between logical plans
Join Inner
:- Join Inner
:  :- Join Inner
:  :  :- Join Inner
:  :  :  :- Aggregate [avg(cast(ss_list_price#17362 as double)) AS B1_LP#17332, count(ss_list_price#17362) AS B1_CNT#17333L, count(distinct ss_list_price#17362) AS B1_CNTD#17334L]
:  :  :  :  +- Project [ss_list_price#17362]
:  :  :  :     +- Filter (isnotnull(ss_quantity#17360) && (((ss_quantity#17360 >= 0) && (ss_quantity#17360 <= 5)) && ((((ss_list_price#17362 >= 11.0) && (ss_list_price#17362 <= 21.0)) || ((ss_coupon_amt#17369 >= 460.0) && (ss_coupon_amt#17369 <= 1460.0))) || ((ss_wholesale_cost#17361 >= 14.0) && (ss_wholesale_cost#17361 <= 34.0)))))
:  :  :  :        +- Relation[ss_sold_time_sk#17351,ss_item_sk#17352,ss_customer_sk#17353,ss_cdemo_sk#17354,ss_hdemo_sk#17355,ss_addr_sk#17356,ss_store_sk#17357,ss_promo_sk#17358,ss_ticket_number#17359,ss_quantity#17360,ss_wholesale_cost#17361,ss_list_price#17362,ss_sales_price#17363,ss_ext_discount_amt#17364,ss_ext_sales_price#17365,ss_ext_wholesale_cost#17366,ss_ext_list_price#17367,ss_ext_tax#17368,ss_coupon_amt#17369,ss_net_paid#17370,ss_net_paid_inc_tax#17371,ss_net_profit#17372,ss_sold_date_sk#17350] parquet
:  :  :  +- Aggregate [avg(cast(ss_list_price#17385 as double)) AS B2_LP#17335, count(ss_list_price#17385) AS B2_CNT#17336L, count(distinct ss_list_price#17385) AS B2_CNTD#17337L]
:  :  :     +- Project [ss_list_price#17385]
:  :  :        +- Filter (isnotnull(ss_quantity#17383) && (((ss_quantity#17383 >= 6) && (ss_quantity#17383 <= 10)) && ((((ss_list_price#17385 >= 91.0) && (ss_list_price#17385 <= 101.0)) || ((ss_coupon_amt#17392 >= 1430.0) && (ss_coupon_amt#17392 <= 2430.0))) || ((ss_wholesale_cost#17384 >= 32.0) && (ss_wholesale_cost#17384 <= 52.0)))))
:  :  :           +- Relation[ss_sold_time_sk#17374,ss_item_sk#17375,ss_customer_sk#17376,ss_cdemo_sk#17377,ss_hdemo_sk#17378,ss_addr_sk#17379,ss_store_sk#17380,ss_promo_sk#17381,ss_ticket_number#17382,ss_quantity#17383,ss_wholesale_cost#17384,ss_list_price#17385,ss_sales_price#17386,ss_ext_discount_amt#17387,ss_ext_sales_price#17388,ss_ext_wholesale_cost#17389,ss_ext_list_price#17390,ss_ext_tax#17391,ss_coupon_amt#17392,ss_net_paid#17393,ss_net_paid_inc_tax#17394,ss_net_profit#17395,ss_sold_date_sk#17373] parquet
:  :  +- Aggregate [avg(cast(ss_list_price#17408 as double)) AS B3_LP#17338, count(ss_list_price#17408) AS B3_CNT#17339L, count(distinct ss_list_price#17408) AS B3_CNTD#17340L]
:  :     +- Project [ss_list_price#17408]
:  :        +- Filter (isnotnull(ss_quantity#17406) && (((ss_quantity#17406 >= 11) && (ss_quantity#17406 <= 15)) && ((((ss_list_price#17408 >= 66.0) && (ss_list_price#17408 <= 76.0)) || ((ss_coupon_amt#17415 >= 920.0) && (ss_coupon_amt#17415 <= 1920.0))) || ((ss_wholesale_cost#17407 >= 4.0) && (ss_wholesale_cost#17407 <= 24.0)))))
:  :           +- Relation[ss_sold_time_sk#17397,ss_item_sk#17398,ss_customer_sk#17399,ss_cdemo_sk#17400,ss_hdemo_sk#17401,ss_addr_sk#17402,ss_store_sk#17403,ss_promo_sk#17404,ss_ticket_number#17405,ss_quantity#17406,ss_wholesale_cost#17407,ss_list_price#17408,ss_sales_price#17409,ss_ext_discount_amt#17410,ss_ext_sales_price#17411,ss_ext_wholesale_cost#17412,ss_ext_list_price#17413,ss_ext_tax#17414,ss_coupon_amt#17415,ss_net_paid#17416,ss_net_paid_inc_tax#17417,ss_net_profit#17418,ss_sold_date_sk#17396] parquet
:  +- Aggregate [avg(cast(ss_list_price#17431 as double)) AS B4_LP#17341, count(ss_list_price#17431) AS B4_CNT#17342L, count(distinct ss_list_price#17431) AS B4_CNTD#17343L]
:     +- Project [ss_list_price#17431]
:        +- Filter (isnotnull(ss_quantity#17429) && (((ss_quantity#17429 >= 16) && (ss_quantity#17429 <= 20)) && ((((ss_list_price#17431 >= 142.0) && (ss_list_price#17431 <= 152.0)) || ((ss_coupon_amt#17438 >= 3054.0) && (ss_coupon_amt#17438 <= 4054.0))) || ((ss_wholesale_cost#17430 >= 80.0) && (ss_wholesale_cost#17430 <= 100.0)))))
:           +- Relation[ss_sold_time_sk#17420,ss_item_sk#17421,ss_customer_sk#17422,ss_cdemo_sk#17423,ss_hdemo_sk#17424,ss_addr_sk#17425,ss_store_sk#17426,ss_promo_sk#17427,ss_ticket_number#17428,ss_quantity#17429,ss_wholesale_cost#17430,ss_list_price#17431,ss_sales_price#17432,ss_ext_discount_amt#17433,ss_ext_sales_price#17434,ss_ext_wholesale_cost#17435,ss_ext_list_price#17436,ss_ext_tax#17437,ss_coupon_amt#17438,ss_net_paid#17439,ss_net_paid_inc_tax#17440,ss_net_profit#17441,ss_sold_date_sk#17419] parquet
+- Aggregate [avg(cast(ss_list_price#17454 as double)) AS B5_LP#17344, count(ss_list_price#17454) AS B5_CNT#17345L, count(distinct ss_list_price#17454) AS B5_CNTD#17346L]
   +- Project [ss_list_price#17454]
      +- Filter (isnotnull(ss_quantity#17452) && (((ss_quantity#17452 >= 21) && (ss_quantity#17452 <= 25)) && ((((ss_list_price#17454 >= 135.0) && (ss_list_price#17454 <= 145.0)) || ((ss_coupon_amt#17461 >= 14180.0) && (ss_coupon_amt#17461 <= 15180.0))) || ((ss_wholesale_cost#17453 >= 38.0) && (ss_wholesale_cost#17453 <= 58.0)))))
         +- Relation[ss_sold_time_sk#17443,ss_item_sk#17444,ss_customer_sk#17445,ss_cdemo_sk#17446,ss_hdemo_sk#17447,ss_addr_sk#17448,ss_store_sk#17449,ss_promo_sk#17450,ss_ticket_number#17451,ss_quantity#17452,ss_wholesale_cost#17453,ss_list_price#17454,ss_sales_price#17455,ss_ext_discount_amt#17456,ss_ext_sales_price#17457,ss_ext_wholesale_cost#17458,ss_ext_list_price#17459,ss_ext_tax#17460,ss_coupon_amt#17461,ss_net_paid#17462,ss_net_paid_inc_tax#17463,ss_net_profit#17464,ss_sold_date_sk#17442] parquet
and
Aggregate [avg(cast(ss_list_price#17477 as double)) AS B6_LP#17347, count(ss_list_price#17477) AS B6_CNT#17348L, count(distinct ss_list_price#17477) AS B6_CNTD#17349L]
+- Project [ss_list_price#17477]
   +- Filter (isnotnull(ss_quantity#17475) && (((ss_quantity#17475 >= 26) && (ss_quantity#17475 <= 30)) && ((((ss_list_price#17477 >= 28.0) && (ss_list_price#17477 <= 38.0)) || ((ss_coupon_amt#17484 >= 2513.0) && (ss_coupon_amt#17484 <= 3513.0))) || ((ss_wholesale_cost#17476 >= 42.0) && (ss_wholesale_cost#17476 <= 62.0)))))
      +- Relation[ss_sold_time_sk#17466,ss_item_sk#17467,ss_customer_sk#17468,ss_cdemo_sk#17469,ss_hdemo_sk#17470,ss_addr_sk#17471,ss_store_sk#17472,ss_promo_sk#17473,ss_ticket_number#17474,ss_quantity#17475,ss_wholesale_cost#17476,ss_list_price#17477,ss_sales_price#17478,ss_ext_discount_amt#17479,ss_ext_sales_price#17480,ss_ext_wholesale_cost#17481,ss_ext_list_price#17482,ss_ext_tax#17483,ss_coupon_amt#17484,ss_net_paid#17485,ss_net_paid_inc_tax#17486,ss_net_profit#17487,ss_sold_date_sk#17465] parquet
Join condition is missing or trivial.
Use the CROSS JOIN syntax to allow cartesian products between these relations.; (state=,code=0)

Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
STOP hdp2.6_spark21_run_1_100_query28_sql_2017-04-06-16-45:  Thu Apr 6 16:45:18 CDT 2017
