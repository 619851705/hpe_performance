START hdp2.6_spark21_run_1_100_query75_sql_2017-04-06-18-40:  Thu Apr 6 18:40:58 CDT 2017
 /usr/hdp/current/spark2-client/bin/beeline -u "jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_$SF" -n hive --incremental=true  -i settings/spark.settings -f sample-queries-tpcds/$1
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
17/04/06 18:40:59 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/06 18:40:59 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/06 18:40:59 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
Connected to: Spark SQL (version 2.1.0.2.6.0.0-598)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> WITH all_sales AS (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  SELECT d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,SUM(sales_cnt) AS sales_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,SUM(sales_amt) AS sales_amt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  FROM (SELECT d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           JOIN date_dim ON d_date_sk=cs_sold_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                                                     AND cs_item_sk=cr_item_sk)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        WHERE i_category='Sports'
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        UNION ALL
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        SELECT d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        FROM store_sales JOIN item ON i_item_sk=ss_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                         JOIN date_dim ON d_date_sk=ss_sold_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                                                 AND ss_item_sk=sr_item_sk)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        WHERE i_category='Sports'
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        UNION ALL
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        SELECT d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        FROM web_sales JOIN item ON i_item_sk=ws_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                       JOIN date_dim ON d_date_sk=ws_sold_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                                             AND ws_item_sk=wr_item_sk)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        WHERE i_category='Sports') sales_detail
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  SELECT  prev_yr.d_year AS prev_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.d_year AS year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,prev_yr.sales_cnt AS prev_yr_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.sales_cnt AS curr_yr_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  FROM all_sales curr_yr, all_sales prev_yr
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>    AND curr_yr.i_class_id=prev_yr.i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>    AND curr_yr.i_category_id=prev_yr.i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>    AND curr_yr.d_year=2002
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>    AND prev_yr.d_year=2002-1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ORDER BY sales_cnt_diff
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  limit 100;
+-------------+-------------+-------------+-------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+--+
|  prev_year  |    year     | i_brand_id  | i_class_id  | i_category_id | i_manufact_id |   prev_yr_cnt   |   curr_yr_cnt   | sales_cnt_diff  | sales_amt_diff  |
+-------------+-------------+-------------+-------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+--+
| 2001        | 2002        | 8009008     | 9           | 8             | 101           | 138639          | 87288           | -51351          | -2388602.9348149896 |
| 2001        | 2002        | 8009008     | 9           | 8             | 77            | 92686           | 42504           | -50182          | -2186091.7016147263 |
| 2001        | 2002        | 8003006     | 3           | 8             | 317           | 89141           | 39206           | -49935          | -2035237.9059622884 |
| 2001        | 2002        | 8003002     | 3           | 8             | 397           | 92556           | 42843           | -49713          | -2125809.3665495813 |
| 2001        | 2002        | 8014002     | 14          | 8             | 254           | 134209          | 85088           | -49121          | -2247843.1796934605 |
| 2001        | 2002        | 8016002     | 16          | 8             | 287           | 92294           | 43261           | -49033          | -2245193.094391793 |
| 2001        | 2002        | 8004004     | 4           | 8             | 99            | 92919           | 43929           | -48990          | -2056767.1891765594 |
| 2001        | 2002        | 8001004     | 6           | 8             | 402           | 93560           | 44848           | -48712          | -2116532.162918955 |
| 2001        | 2002        | 8009008     | 9           | 8             | 291           | 94700           | 46016           | -48684          | -1905151.7372945547 |
| 2001        | 2002        | 8011008     | 11          | 8             | 133           | 93845           | 45288           | -48557          | -2104777.176050607 |
| 2001        | 2002        | 1002001     | 2           | 8             | 288           | 93290           | 45023           | -48267          | -2178444.0031469166 |
| 2001        | 2002        | 8005010     | 5           | 8             | 70            | 92935           | 44821           | -48114          | -2024306.0078527927 |
| 2001        | 2002        | 8015004     | 15          | 8             | 139           | 90487           | 42667           | -47820          | -2092452.1121341586 |
| 2001        | 2002        | 8003006     | 3           | 8             | 273           | 94720           | 47030           | -47690          | -2155845.6619381756 |
| 2001        | 2002        | 8006004     | 6           | 8             | 14            | 91207           | 43613           | -47594          | -2070347.343950361 |
| 2001        | 2002        | 8002004     | 2           | 8             | 333           | 90928           | 43817           | -47111          | -2321192.5111332983 |
| 2001        | 2002        | 2001001     | 1           | 8             | 194           | 92676           | 45588           | -47088          | -2033611.8382706419 |
| 2001        | 2002        | 2002001     | 2           | 8             | 656           | 91510           | 44499           | -47011          | -1963005.0963507593 |
| 2001        | 2002        | 3003001     | 3           | 8             | 174           | 93907           | 46905           | -47002          | -1856543.9424538165 |
| 2001        | 2002        | 8009010     | 9           | 8             | 70            | 88428           | 41657           | -46771          | -2198551.3151012063 |
| 2001        | 2002        | 8010008     | 10          | 8             | 229           | 91146           | 44497           | -46649          | -1880171.3302242756 |
| 2001        | 2002        | 8010002     | 10          | 8             | 227           | 94522           | 47890           | -46632          | -1927561.1312807202 |
| 2001        | 2002        | 4003001     | 3           | 8             | 487           | 93717           | 47173           | -46544          | -2128043.9642062187 |
| 2001        | 2002        | 8014008     | 14          | 8             | 177           | 89213           | 42687           | -46526          | -1970198.2834160328 |
| 2001        | 2002        | 8004004     | 4           | 8             | 645           | 92711           | 46435           | -46276          | -1936753.5467080325 |
| 2001        | 2002        | 8010010     | 10          | 8             | 17            | 135681          | 89471           | -46210          | -2013702.0624320358 |
| 2001        | 2002        | 8012004     | 12          | 8             | 170           | 91770           | 45641           | -46129          | -2019610.7364265323 |
| 2001        | 2002        | 8012002     | 12          | 8             | 122           | 88673           | 42625           | -46048          | -2150945.6627129316 |
| 2001        | 2002        | 8003010     | 3           | 8             | 253           | 92600           | 46606           | -45994          | -2038110.0394826233 |
| 2001        | 2002        | 5001001     | 1           | 8             | 186           | 91825           | 45891           | -45934          | -1759722.5742392838 |
| 2001        | 2002        | 8006002     | 6           | 8             | 309           | 94936           | 49021           | -45915          | -1876853.4663971066 |
| 2001        | 2002        | 8011004     | 11          | 8             | 26            | 91154           | 45254           | -45900          | -1913453.009767741 |
| 2001        | 2002        | 8001010     | 1           | 8             | 247           | 92331           | 46526           | -45805          | -2062335.9385684133 |
| 2001        | 2002        | 8008006     | 8           | 8             | 312           | 134832          | 89194           | -45638          | -1898766.636822641 |
| 2001        | 2002        | 8009008     | 9           | 8             | 129           | 90169           | 44546           | -45623          | -1960023.7510350347 |
| 2001        | 2002        | 8009008     | 9           | 8             | 175           | 94371           | 48877           | -45494          | -2020451.8750123978 |
| 2001        | 2002        | 8015004     | 15          | 8             | 119           | 92122           | 46691           | -45431          | -2124909.600485619 |
| 2001        | 2002        | 8014006     | 14          | 8             | 204           | 92978           | 47579           | -45399          | -1886888.587399006 |
| 2001        | 2002        | 8014002     | 14          | 8             | 257           | 89436           | 44141           | -45295          | -1867947.9857723862 |
| 2001        | 2002        | 5004001     | 4           | 8             | 595           | 91414           | 46192           | -45222          | -1991698.7214148045 |
| 2001        | 2002        | 8002002     | 2           | 8             | 120           | 93623           | 48475           | -45148          | -1929509.671339631 |
| 2001        | 2002        | 3003001     | 3           | 8             | 171           | 91532           | 46448           | -45084          | -1929300.6287893057 |
| 2001        | 2002        | 8010006     | 10          | 8             | 183           | 91677           | 46743           | -44934          | -1970621.996031046 |
| 2001        | 2002        | 8001008     | 1           | 8             | 199           | 88570           | 43746           | -44824          | -2050584.3433452845 |
| 2001        | 2002        | 8013008     | 13          | 8             | 64            | 88598           | 43785           | -44813          | -2095656.8894535303 |
| 2001        | 2002        | 8001010     | 1           | 8             | 312           | 90009           | 45196           | -44813          | -1728670.437245652 |
| 2001        | 2002        | 8008006     | 8           | 8             | 362           | 87788           | 43200           | -44588          | -1916529.4755766392 |
| 2001        | 2002        | 8007004     | 7           | 8             | 157           | 90768           | 46285           | -44483          | -1932789.1829633713 |
| 2001        | 2002        | 8015010     | 15          | 8             | 173           | 90358           | 45876           | -44482          | -2006510.9996979237 |
| 2001        | 2002        | 8003008     | 3           | 8             | 160           | 90060           | 45699           | -44361          | -1820964.1517966986 |
| 2001        | 2002        | 8012008     | 12          | 8             | 297           | 88407           | 44066           | -44341          | -2095697.4742791653 |
| 2001        | 2002        | 8015004     | 15          | 8             | 254           | 89077           | 44756           | -44321          | -2098275.8368956447 |
| 2001        | 2002        | 8013006     | 13          | 8             | 65            | 89299           | 45080           | -44219          | -1765562.9594051838 |
| 2001        | 2002        | 8012004     | 12          | 8             | 58            | 89246           | 45048           | -44198          | -1782510.365979638 |
| 2001        | 2002        | 8016010     | 16          | 8             | 278           | 90804           | 46862           | -43942          | -2064487.051991269 |
| 2001        | 2002        | 8005006     | 5           | 8             | 256           | 90143           | 46298           | -43845          | -2119740.278059602 |
| 2001        | 2002        | 8007010     | 7           | 8             | 774           | 88741           | 45009           | -43732          | -1818897.3823248744 |
| 2001        | 2002        | 5001001     | 1           | 8             | 482           | 88966           | 45496           | -43470          | -1788794.842299223 |
| 2001        | 2002        | 8003002     | 3           | 8             | 541           | 89340           | 45892           | -43448          | -1823429.9361931086 |
| 2001        | 2002        | 8010002     | 10          | 8             | 115           | 90140           | 46745           | -43395          | -2101263.7648150623 |
| 2001        | 2002        | 8009006     | 9           | 8             | 229           | 89753           | 46769           | -42984          | -1692009.6157585382 |
| 2001        | 2002        | 8006002     | 6           | 8             | 176           | 89528           | 46545           | -42983          | -1739410.6397662163 |
| 2001        | 2002        | 2003001     | 3           | 8             | 589           | 89331           | 46783           | -42548          | -1741928.5155578256 |
| 2001        | 2002        | 3003001     | 3           | 8             | 494           | 90516           | 47976           | -42540          | -1866409.945310481 |
| 2001        | 2002        | 8016010     | 16          | 8             | 188           | 89329           | 46853           | -42476          | -1887202.345342636 |
| 2001        | 2002        | 8005004     | 5           | 8             | 4             | 87314           | 44867           | -42447          | -1866269.9218399227 |
| 2001        | 2002        | 8002010     | 2           | 8             | 117           | 90022           | 48024           | -41998          | -1698886.574481085 |
| 2001        | 2002        | 1001001     | 1           | 8             | 495           | 89403           | 47555           | -41848          | -1595876.4292502925 |
| 2001        | 2002        | 8008002     | 8           | 8             | 288           | 87585           | 45823           | -41762          | -1814846.0338113308 |
| 2001        | 2002        | 8006008     | 6           | 8             | 219           | 88217           | 46486           | -41731          | -1966947.0618058443 |
| 2001        | 2002        | 8003010     | 3           | 8             | 529           | 89406           | 47688           | -41718          | -1681087.5014226735 |
| 2001        | 2002        | 8005006     | 5           | 8             | 207           | 89356           | 47742           | -41614          | -1598953.4720959961 |
| 2001        | 2002        | 8010004     | 10          | 8             | 146           | 89135           | 47587           | -41548          | -2013968.411527723 |
| 2001        | 2002        | 8013002     | 4           | 8             | 84            | 87360           | 45935           | -41425          | -1667534.471519798 |
| 2001        | 2002        | 4001001     | 1           | 8             | 198           | 88313           | 47271           | -41042          | -1827604.723528564 |
| 2001        | 2002        | 8009006     | 9           | 8             | 143           | 130080          | 89436           | -40644          | -1934306.506948471 |
| 2001        | 2002        | 8004004     | 4           | 8             | 886           | 85232           | 44618           | -40614          | -1866329.9902900755 |
| 2001        | 2002        | 8004010     | 4           | 8             | 370           | 88634           | 48030           | -40604          | -1979509.9572054744 |
| 2001        | 2002        | 8015008     | 15          | 8             | 317           | 87712           | 47316           | -40396          | -1688524.1972429715 |
| 2001        | 2002        | 8001004     | 1           | 8             | 243           | 94178           | 83532           | -10646          | -634575.9319829941 |
| 2001        | 2002        | 8015010     | 15          | 8             | 135           | 48827           | 39907           | -8920           | -201705.13936789334 |
| 2001        | 2002        | 1003001     | 9           | 8             | 221           | 50129           | 41487           | -8642           | -474114.710731864 |
| 2001        | 2002        | 8001010     | 1           | 8             | 576           | 48945           | 40575           | -8370           | -483502.01960366964 |
| 2001        | 2002        | 8012004     | 12          | 8             | 428           | 47268           | 39169           | -8099           | -376942.54812657833 |
| 2001        | 2002        | 8001008     | 1           | 8             | 92            | 49768           | 41957           | -7811           | -292865.4580618143 |
| 2001        | 2002        | 8006008     | 6           | 8             | 37            | 49476           | 41670           | -7806           | -341880.6285247803 |
| 2001        | 2002        | 8003006     | 3           | 8             | 186           | 48628           | 40945           | -7683           | -231846.31820231676 |
| 2001        | 2002        | 5002001     | 2           | 8             | 357           | 48609           | 40940           | -7669           | -432690.856380105 |
| 2001        | 2002        | 7005007     | 5           | 8             | 152           | 48888           | 41497           | -7391           | -331226.3460034132 |
| 2001        | 2002        | 3003001     | 10          | 8             | 209           | 48970           | 41816           | -7154           | -374125.5960124135 |
| 2001        | 2002        | 8005010     | 5           | 8             | 102           | 46237           | 39212           | -7025           | -458881.1275045872 |
| 2001        | 2002        | 8002004     | 2           | 8             | 854           | 48624           | 41604           | -7020           | -136412.67077291012 |
| 2001        | 2002        | 8013008     | 13          | 8             | 256           | 49655           | 42660           | -6995           | -325355.6434724331 |
| 2001        | 2002        | 8002006     | 2           | 8             | 213           | 46983           | 40046           | -6937           | -366208.0690668225 |
| 2001        | 2002        | 8014002     | 14          | 8             | 531           | 49268           | 42379           | -6889           | -344180.1412292123 |
| 2001        | 2002        | 8007002     | 4           | 8             | 54            | 51354           | 44543           | -6811           | -169639.20998573303 |
| 2001        | 2002        | 8009004     | 9           | 8             | 666           | 49764           | 42962           | -6802           | -329313.9199461341 |
| 2001        | 2002        | 8002002     | 2           | 8             | 515           | 48624           | 41881           | -6743           | -129942.58277702332 |
| 2001        | 2002        | 8006006     | 6           | 8             | 743           | 49589           | 42864           | -6725           | -223406.85304526985 |
| 2001        | 2002        | 8010010     | 10          | 8             | 553           | 49695           | 42973           | -6722           | -462301.9340009093 |
+-------------+-------------+-------------+-------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+--+
100 rows selected (71.266 seconds)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
STOP hdp2.6_spark21_run_1_100_query75_sql_2017-04-06-18-40:  Thu Apr 6 18:42:10 CDT 2017
