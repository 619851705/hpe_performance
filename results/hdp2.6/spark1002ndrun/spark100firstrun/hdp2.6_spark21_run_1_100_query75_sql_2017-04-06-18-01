START hdp2.6_spark21_run_1_100_query75_sql_2017-04-06-18-01:  Thu Apr 6 18:01:13 CDT 2017
 /usr/hdp/current/spark2-client/bin/beeline -u "jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_$SF" -n hive --incremental=true  -i settings/spark.settings -f sample-queries-tpcds/$1
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
17/04/06 18:01:14 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/06 18:01:14 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/06 18:01:14 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
17/04/06 18:01:51 ERROR HiveConnection: Error opening session
org.apache.thrift.transport.TTransportException
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:132)
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)
	at org.apache.thrift.transport.TSaslTransport.readFrame(TSaslTransport.java:460)
	at org.apache.thrift.transport.TSaslTransport.read(TSaslTransport.java:435)
	at org.apache.thrift.transport.TSaslClientTransport.read(TSaslClientTransport.java:37)
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:429)
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:318)
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:219)
	at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:77)
	at org.apache.hive.service.cli.thrift.TCLIService$Client.recv_OpenSession(TCLIService.java:156)
	at org.apache.hive.service.cli.thrift.TCLIService$Client.OpenSession(TCLIService.java:143)
	at org.apache.hive.jdbc.HiveConnection.openSession(HiveConnection.java:583)
	at org.apache.hive.jdbc.HiveConnection.<init>(HiveConnection.java:192)
	at org.apache.hive.jdbc.HiveDriver.connect(HiveDriver.java:105)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.hive.beeline.DatabaseConnection.connect(DatabaseConnection.java:142)
	at org.apache.hive.beeline.DatabaseConnection.getConnection(DatabaseConnection.java:207)
	at org.apache.hive.beeline.Commands.connect(Commands.java:1149)
	at org.apache.hive.beeline.Commands.connect(Commands.java:1070)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.hive.beeline.ReflectiveCommandHandler.execute(ReflectiveCommandHandler.java:52)
	at org.apache.hive.beeline.BeeLine.dispatch(BeeLine.java:970)
	at org.apache.hive.beeline.BeeLine.initArgs(BeeLine.java:707)
	at org.apache.hive.beeline.BeeLine.begin(BeeLine.java:757)
	at org.apache.hive.beeline.BeeLine.mainWithInputRedirection(BeeLine.java:484)
	at org.apache.hive.beeline.BeeLine.main(BeeLine.java:467)
Error: Could not establish connection to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100: null (state=08S01,code=0)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)> WITH all_sales AS (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  SELECT d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        ,i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        ,i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        ,i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        ,i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        ,SUM(sales_cnt) AS sales_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        ,SUM(sales_amt) AS sales_amt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  FROM (SELECT d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                           JOIN date_dim ON d_date_sk=cs_sold_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                                                     AND cs_item_sk=cr_item_sk)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        WHERE i_category='Sports'
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        UNION ALL
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        SELECT d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        FROM store_sales JOIN item ON i_item_sk=ss_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                         JOIN date_dim ON d_date_sk=ss_sold_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                                                 AND ss_item_sk=sr_item_sk)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        WHERE i_category='Sports'
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        UNION ALL
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        SELECT d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        FROM web_sales JOIN item ON i_item_sk=ws_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                       JOIN date_dim ON d_date_sk=ws_sold_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                                             AND ws_item_sk=wr_item_sk)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>        WHERE i_category='Sports') sales_detail
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  SELECT  prev_yr.d_year AS prev_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                           ,curr_yr.d_year AS year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                           ,curr_yr.i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                           ,curr_yr.i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                           ,curr_yr.i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                           ,curr_yr.i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                           ,prev_yr.sales_cnt AS prev_yr_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                           ,curr_yr.sales_cnt AS curr_yr_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  FROM all_sales curr_yr, all_sales prev_yr
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>    AND curr_yr.i_class_id=prev_yr.i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>    AND curr_yr.i_category_id=prev_yr.i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>    AND curr_yr.d_year=2002
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>    AND prev_yr.d_year=2002-1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  ORDER BY sales_cnt_diff
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi (closed)>  limit 100;
17/04/06 18:01:51 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/06 18:01:51 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/06 18:01:51 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
17/04/06 18:03:55 ERROR HiveConnection: Error opening session
org.apache.thrift.transport.TTransportException
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:132)
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)
	at org.apache.thrift.transport.TSaslTransport.readLength(TSaslTransport.java:376)
	at org.apache.thrift.transport.TSaslTransport.readFrame(TSaslTransport.java:453)
	at org.apache.thrift.transport.TSaslTransport.read(TSaslTransport.java:435)
	at org.apache.thrift.transport.TSaslClientTransport.read(TSaslClientTransport.java:37)
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:429)
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:318)
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:219)
	at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:77)
	at org.apache.hive.service.cli.thrift.TCLIService$Client.recv_OpenSession(TCLIService.java:156)
	at org.apache.hive.service.cli.thrift.TCLIService$Client.OpenSession(TCLIService.java:143)
	at org.apache.hive.jdbc.HiveConnection.openSession(HiveConnection.java:583)
	at org.apache.hive.jdbc.HiveConnection.<init>(HiveConnection.java:192)
	at org.apache.hive.jdbc.HiveDriver.connect(HiveDriver.java:105)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.hive.beeline.DatabaseConnection.connect(DatabaseConnection.java:142)
	at org.apache.hive.beeline.DatabaseConnection.getConnection(DatabaseConnection.java:207)
	at org.apache.hive.beeline.BeeLine.assertConnection(BeeLine.java:1171)
	at org.apache.hive.beeline.Commands.execute(Commands.java:794)
	at org.apache.hive.beeline.Commands.sql(Commands.java:713)
	at org.apache.hive.beeline.BeeLine.dispatch(BeeLine.java:973)
	at org.apache.hive.beeline.BeeLine.execute(BeeLine.java:813)
	at org.apache.hive.beeline.BeeLine.executeFile(BeeLine.java:794)
	at org.apache.hive.beeline.BeeLine.begin(BeeLine.java:763)
	at org.apache.hive.beeline.BeeLine.mainWithInputRedirection(BeeLine.java:484)
	at org.apache.hive.beeline.BeeLine.main(BeeLine.java:467)
No current connection

17/04/06 18:03:55 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/06 18:03:55 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/06 18:03:55 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100
17/04/06 18:06:28 ERROR HiveConnection: Error opening session
org.apache.thrift.transport.TTransportException
	at org.apache.thrift.transport.TIOStreamTransport.read(TIOStreamTransport.java:132)
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)
	at org.apache.thrift.transport.TSaslTransport.readFrame(TSaslTransport.java:460)
	at org.apache.thrift.transport.TSaslTransport.read(TSaslTransport.java:435)
	at org.apache.thrift.transport.TSaslClientTransport.read(TSaslClientTransport.java:37)
	at org.apache.thrift.transport.TTransport.readAll(TTransport.java:86)
	at org.apache.thrift.protocol.TBinaryProtocol.readAll(TBinaryProtocol.java:429)
	at org.apache.thrift.protocol.TBinaryProtocol.readI32(TBinaryProtocol.java:318)
	at org.apache.thrift.protocol.TBinaryProtocol.readMessageBegin(TBinaryProtocol.java:219)
	at org.apache.thrift.TServiceClient.receiveBase(TServiceClient.java:77)
	at org.apache.hive.service.cli.thrift.TCLIService$Client.recv_OpenSession(TCLIService.java:156)
	at org.apache.hive.service.cli.thrift.TCLIService$Client.OpenSession(TCLIService.java:143)
	at org.apache.hive.jdbc.HiveConnection.openSession(HiveConnection.java:583)
	at org.apache.hive.jdbc.HiveConnection.<init>(HiveConnection.java:192)
	at org.apache.hive.jdbc.HiveDriver.connect(HiveDriver.java:105)
	at java.sql.DriverManager.getConnection(DriverManager.java:664)
	at java.sql.DriverManager.getConnection(DriverManager.java:208)
	at org.apache.hive.beeline.DatabaseConnection.connect(DatabaseConnection.java:142)
	at org.apache.hive.beeline.DatabaseConnection.getConnection(DatabaseConnection.java:207)
	at org.apache.hive.beeline.Commands.close(Commands.java:987)
	at org.apache.hive.beeline.Commands.closeall(Commands.java:969)
	at org.apache.hive.beeline.BeeLine.close(BeeLine.java:826)
	at org.apache.hive.beeline.BeeLine.begin(BeeLine.java:773)
	at org.apache.hive.beeline.BeeLine.mainWithInputRedirection(BeeLine.java:484)
	at org.apache.hive.beeline.BeeLine.main(BeeLine.java:467)
Error: Could not establish connection to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_100: null (state=08S01,code=0)
STOP hdp2.6_spark21_run_1_100_query75_sql_2017-04-06-18-01:  Thu Apr 6 18:06:28 CDT 2017
