START hdp2.6_hivetez_run_orc_1000_2_query75_sql_2017-04-12-09-46:  Wed Apr 12 09:46:18 CDT 2017
beeline -u "jdbc:hive2://h01mgt.hadoop:2181,h01hn01.hadoop:2181,h01hn02.hadoop:2181/tpcds_bin_partitioned_${FILETYPE}_${SF};serviceDiscoveryMode=zooKeeper;zooKeeperNamespace=hiveserver2" -n hive --incremental=true -i settings/${SETTINGS}.settings -f sample-queries-tpcds/$1
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.container.max.java.heap.fraction=0.8;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set hive.log.level=WARN;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.tez.exec.print.summary=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> #set hive.tez.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.tez.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.enforce.bucketing=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.enforce.sorting=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.tez.container.size=8192; 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.am.resource.memory.mb=8192;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.task.resource.memory.mb=8192; 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.runtime.io.sort.mb=3277; 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.auto.convert.join.noconditionaltask=true; 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.auto.convert.join.noconditionaltask.size=2834678415; 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.runtime.unordered.output.buffer.size-mb=819; 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> #set tez.grouping.min-size=1073741824; 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> #set tez.grouping.max-size=2147483648; 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.parallel=true; 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.parallel.thread.number=16; 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.tez.auto.reducer.parallelism=true; 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.reducers.bytes.per.reducer=268435456; 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.optimize.reducededuplication.min.reducer = 1 ;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set tez.queue.name=llap;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.dynamic.partition.mode=nonstrict;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.max.dynamic.partitions.pernode=100000;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.max.dynamic.partitions=100000;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.max.created.files=1000000;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.parallel=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set hive.exec.reducers.max=2000;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.stats.autogather=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.optimize.sort.dynamic.partition=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.stats.autogather=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.execution.engine=tez;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.cbo.enable=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.compute.query.using.stats=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.stats.fetch.column.stats=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.stats.fetch.partition.stats=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.vectorized.execution.enabled=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.vectorized.execution.reduce.enabled = true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.vectorized.execution.reduce.groupby.enabled = true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set mapred.job.reduce.input.buffer.percent=0.0;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set mapreduce.input.fileinputformat.split.minsize=1073741824;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set mapreduce.input.fileinputformat.split.maxsize=2147483648;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set mapreduce.input.fileinputformat.split.minsize.per.node=1073741824;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set mapreduce.input.fileinputformat.split.minsize.per.rack=1073741824;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set hive.tez.java.opts=-XX:+PrintGCDetails -verbose:gc -XX:+PrintGCTimeStamps -XX:+U seNUMA -XX:+UseG1GC -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/tmp/;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.runtime.empty.partitions.info-via-events.enabled=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.runtime.report.partition.stats=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set mapred.map.tasks=6;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.limit.pushdown.memory.usage=0.04;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.map.aggr=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.mapjoin.bucket.cache.size=10000;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.mapred.reduce.tasks.speculative.execution=false;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.metastore.cache.pinobjtypes=Table,Database,Type,FieldSchema,Order;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.metastore.client.socket.timeout=60;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.metastore.execute.setugi=true;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> WITH all_sales AS (
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>  SELECT d_year
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        ,i_brand_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        ,i_class_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        ,i_category_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        ,i_manufact_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        ,SUM(sales_cnt) AS sales_cnt
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        ,SUM(sales_amt) AS sales_amt
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>  FROM (SELECT d_year
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,i_brand_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,i_class_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,i_category_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,i_manufact_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                           JOIN date_dim ON d_date_sk=cs_sold_date_sk
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_numbe r 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                                                     AND cs_item_sk=cr_item_sk)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        WHERE i_category='Sports'
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        UNION ALL
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        SELECT d_year
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,i_brand_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,i_class_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,i_category_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,i_manufact_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        FROM store_sales JOIN item ON i_item_sk=ss_item_sk
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                         JOIN date_dim ON d_date_sk=ss_sold_date_sk
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number  
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                                                 AND ss_item_sk=sr_item_sk)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        WHERE i_category='Sports'
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        UNION ALL
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        SELECT d_year
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,i_brand_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,i_class_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,i_category_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,i_manufact_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        FROM web_sales JOIN item ON i_item_sk=ws_item_sk
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                       JOIN date_dim ON d_date_sk=ws_sold_date_sk
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                                             AND ws_item_sk=wr_item_sk)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>        WHERE i_category='Sports') sales_detail
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>  SELECT  prev_yr.d_year AS prev_year
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                           ,curr_yr.d_year AS year
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                           ,curr_yr.i_brand_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                           ,curr_yr.i_class_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                           ,curr_yr.i_category_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                           ,curr_yr.i_manufact_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                           ,prev_yr.sales_cnt AS prev_yr_cnt
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                           ,curr_yr.sales_cnt AS curr_yr_cnt
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>  FROM all_sales curr_yr, all_sales prev_yr
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>    AND curr_yr.i_class_id=prev_yr.i_class_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>    AND curr_yr.i_category_id=prev_yr.i_category_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>    AND curr_yr.d_year=2002
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>    AND prev_yr.d_year=2002-1
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2 ))<0.9
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>  ORDER BY sales_cnt_diff
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>  limit 100;
