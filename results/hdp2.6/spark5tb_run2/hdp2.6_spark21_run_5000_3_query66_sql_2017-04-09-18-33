START hdp2.6_spark21_run_5000_3_query66_sql_2017-04-09-18-33:  Sun Apr 9 18:33:40 CDT 2017
 /usr/hdp/current/spark2-client/bin/beeline -u "jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_$SF" -n hive --incremental=true  -i settings/spark.settings -f sample-queries-tpcds/$1
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_5000
17/04/09 18:33:40 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/09 18:33:40 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/09 18:33:40 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_5000
Connected to: Spark SQL (version 2.1.0.2.6.0.0-598)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select   
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          w_warehouse_name
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_warehouse_sq_ft
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_city
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_county
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_state
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_country
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         ,ship_carriers
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         ,year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(jan_sales) as jan_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(feb_sales) as feb_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(mar_sales) as mar_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(apr_sales) as apr_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(may_sales) as may_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(jun_sales) as jun_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(jul_sales) as jul_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(aug_sales) as aug_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(sep_sales) as sep_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(oct_sales) as oct_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(nov_sales) as nov_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(dec_sales) as dec_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(jan_sales/w_warehouse_sq_ft) as jan_sales_per_sq_foot
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(feb_sales/w_warehouse_sq_ft) as feb_sales_per_sq_foot
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(mar_sales/w_warehouse_sq_ft) as mar_sales_per_sq_foot
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(apr_sales/w_warehouse_sq_ft) as apr_sales_per_sq_foot
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(may_sales/w_warehouse_sq_ft) as may_sales_per_sq_foot
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(jun_sales/w_warehouse_sq_ft) as jun_sales_per_sq_foot
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(jul_sales/w_warehouse_sq_ft) as jul_sales_per_sq_foot
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(aug_sales/w_warehouse_sq_ft) as aug_sales_per_sq_foot
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(sep_sales/w_warehouse_sq_ft) as sep_sales_per_sq_foot
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(oct_sales/w_warehouse_sq_ft) as oct_sales_per_sq_foot
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(nov_sales/w_warehouse_sq_ft) as nov_sales_per_sq_foot
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(dec_sales/w_warehouse_sq_ft) as dec_sales_per_sq_foot
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(jan_net) as jan_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(feb_net) as feb_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(mar_net) as mar_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(apr_net) as apr_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(may_net) as may_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(jun_net) as jun_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(jul_net) as jul_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(aug_net) as aug_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(sep_net) as sep_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(oct_net) as oct_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(nov_net) as nov_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(dec_net) as dec_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>     select 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  w_warehouse_name
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_warehouse_sq_ft
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_city
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_county
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_state
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_country
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,concat('DIAMOND', ',', 'AIRBORNE') as ship_carriers
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         ,d_year as year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 1 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_sales_price* ws_quantity else 0 end) as jan_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 2 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_sales_price* ws_quantity else 0 end) as feb_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 3 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_sales_price* ws_quantity else 0 end) as mar_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 4 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_sales_price* ws_quantity else 0 end) as apr_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 5 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_sales_price* ws_quantity else 0 end) as may_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 6 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_sales_price* ws_quantity else 0 end) as jun_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 7 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_sales_price* ws_quantity else 0 end) as jul_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 8 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_sales_price* ws_quantity else 0 end) as aug_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 9 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_sales_price* ws_quantity else 0 end) as sep_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_sales_price* ws_quantity else 0 end) as oct_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_sales_price* ws_quantity else 0 end) as nov_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_sales_price* ws_quantity else 0 end) as dec_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 1 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_net_paid_inc_tax * ws_quantity else 0 end) as jan_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 2
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_net_paid_inc_tax * ws_quantity else 0 end) as feb_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 3 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_net_paid_inc_tax * ws_quantity else 0 end) as mar_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 4 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_net_paid_inc_tax * ws_quantity else 0 end) as apr_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 5 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_net_paid_inc_tax * ws_quantity else 0 end) as may_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 6 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_net_paid_inc_tax * ws_quantity else 0 end) as jun_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 7 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_net_paid_inc_tax * ws_quantity else 0 end) as jul_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 8 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_net_paid_inc_tax * ws_quantity else 0 end) as aug_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 9 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_net_paid_inc_tax * ws_quantity else 0 end) as sep_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_net_paid_inc_tax * ws_quantity else 0 end) as oct_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_net_paid_inc_tax * ws_quantity else 0 end) as nov_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then ws_net_paid_inc_tax * ws_quantity else 0 end) as dec_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      from
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           web_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          ,warehouse
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          ,date_dim
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          ,time_dim
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>    ,ship_mode
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      where
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             web_sales.ws_warehouse_sk =  warehouse.w_warehouse_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and web_sales.ws_sold_date_sk = date_dim.d_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and web_sales.ws_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  and web_sales.ws_ship_mode_sk = ship_mode.sm_ship_mode_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and d_year = 2002
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  and t_time between 49530 and 49530+28800 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  and sm_carrier in ('DIAMOND','AIRBORNE')
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      group by 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         w_warehouse_name
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_warehouse_sq_ft
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_city
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_county
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_state
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_country
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  union all
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>     select 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  w_warehouse_name
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_warehouse_sq_ft
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_city
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_county
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_state
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_country
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         ,concat('DIAMOND', ',', 'AIRBORNE') as ship_carriers
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,d_year as year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 1 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_ext_sales_price* cs_quantity else 0 end) as jan_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 2 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_ext_sales_price* cs_quantity else 0 end) as feb_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 3 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_ext_sales_price* cs_quantity else 0 end) as mar_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 4 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_ext_sales_price* cs_quantity else 0 end) as apr_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 5 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_ext_sales_price* cs_quantity else 0 end) as may_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 6 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_ext_sales_price* cs_quantity else 0 end) as jun_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 7 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_ext_sales_price* cs_quantity else 0 end) as jul_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 8 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_ext_sales_price* cs_quantity else 0 end) as aug_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 9 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_ext_sales_price* cs_quantity else 0 end) as sep_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_ext_sales_price* cs_quantity else 0 end) as oct_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_ext_sales_price* cs_quantity else 0 end) as nov_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_ext_sales_price* cs_quantity else 0 end) as dec_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 1 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jan_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 2 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as feb_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 3 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as mar_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 4 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as apr_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 5 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as may_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 6 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jun_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 7 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as jul_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 8 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as aug_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 9 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as sep_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as oct_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as nov_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,sum(case when d_moy = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  then cs_net_paid_inc_ship_tax * cs_quantity else 0 end) as dec_net
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      from
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           catalog_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          ,warehouse
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          ,date_dim
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          ,time_dim
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   ,ship_mode
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      where
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             catalog_sales.cs_warehouse_sk =  warehouse.w_warehouse_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and catalog_sales.cs_sold_date_sk = date_dim.d_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and catalog_sales.cs_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  and catalog_sales.cs_ship_mode_sk = ship_mode.sm_ship_mode_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and d_year = 2002
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  and t_time between 49530 AND 49530+28800 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  and sm_carrier in ('DIAMOND','AIRBORNE')
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      group by 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         w_warehouse_name
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_warehouse_sq_ft
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_city
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_county
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_state
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_country
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ) x
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  group by 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         w_warehouse_name
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_warehouse_sq_ft
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_city
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_county
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_state
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,w_country
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,ship_carriers
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  order by w_warehouse_name
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  limit 100;
+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+--+
| w_warehouse_name | w_warehouse_sq_ft |     w_city      |    w_county     |     w_state     |    w_country    |  ship_carriers  |    year     |    jan_sales    |    feb_sales    |    mar_sales    |    apr_sales    |    may_sales    |    jun_sales    |    jul_sales    |    aug_sales    |    sep_sales    |    oct_sales    |    nov_sales    |    dec_sales    | jan_sales_per_sq_foot | feb_sales_per_sq_foot | mar_sales_per_sq_foot | apr_sales_per_sq_foot | may_sales_per_sq_foot | jun_sales_per_sq_foot | jul_sales_per_sq_foot | aug_sales_per_sq_foot | sep_sales_per_sq_foot | oct_sales_per_sq_foot | nov_sales_per_sq_foot | dec_sales_per_sq_foot |     jan_net     |     feb_net     |     mar_net     |     apr_net     |     may_net     |     jun_net     |     jul_net     |     aug_net     |     sep_net     |     oct_net     |     nov_net     |     dec_net     |
+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+--+
|                 | NULL            | Midway          | Fairfield County | SC              | United States   | DIAMOND,AIRBORNE | 2002        | 1.0879562720442218E11 | 9.778449636962016E10 | 1.048627998583261E11 | 1.0486569374738045E11 | 1.0871983299206033E11 | 1.0523108806563567E11 | 1.087587733347059E11 | 2.4269691737845056E11 | 2.3850289823631207E11 | 2.4682678934574976E11 | 3.577803137231121E11 | 3.7417462145627313E11 | NULL            | NULL            | NULL            | NULL            | NULL            | NULL            | NULL            | NULL            | NULL            | NULL            | NULL            | NULL            | 2.1614875286518408E11 | 1.8565242401619128E11 | 1.9935364942671368E11 | 1.9934469654477863E11 | 2.0638035558532114E11 | 1.9972024894528644E11 | 2.0679678555045367E11 | 4.5868789147305554E11 | 4.532149074834522E11 | 4.691921715490376E11 | 6.7823446997356E11 | 7.113468069598483E11 |
| Bad cards must make. | 621234          | Five Points     | Richland County | OH              | United States   | DIAMOND,AIRBORNE | 2002        | 1.0814053517111812E11 | 9.780937071796962E10 | 1.050892735975704E11 | 1.0517971017937558E11 | 1.0807560957338087E11 | 1.0503954327899356E11 | 1.0832526992861534E11 | 2.4206304470196176E11 | 2.3925808636189185E11 | 2.4618636656240332E11 | 3.5778107167795746E11 | 3.734467771571921E11 | 174073.7550924742 | 157443.68582204066 | 169162.14115384928 | 169307.7168657472 | 173969.2443964446 | 169082.09028963896 | 174371.122521651 | 389648.7389646442 | 385133.5991943324 | 396286.0477089202 | 575919.9781048002 | 601137.0548894492 | 2.151691760999698E11 | 1.8611182763605338E11 | 2.0005866383913916E11 | 2.0002228600659918E11 | 2.0581109138662793E11 | 1.9944841616082623E11 | 2.05878880488797E11 | 4.579473408505556E11 | 4.543308839622127E11 | 4.684827744426911E11 | 6.77748343310227E11 | 7.105768848467731E11 |
| Conventional childr | 977787          | Pleasant Hill   | Williamson County | TN              | United States   | DIAMOND,AIRBORNE | 2002        | 1.0899786390124228E11 | 9.763495902838791E10 | 1.0489925801935062E11 | 1.0490746560396619E11 | 1.0824959489095367E11 | 1.0479639381129022E11 | 1.0871687394930946E11 | 2.4194220427477417E11 | 2.385896628065813E11 | 2.4669152112598227E11 | 3.577510430317963E11 | 3.7364113758198206E11 | 111474.03667797003 | 99852.99357466187 | 107282.32019790672 | 107290.71423936519 | 110708.76877167897 | 107177.11915917293 | 111186.66330121945 | 247438.5569400843 | 244009.85368651996 | 252295.76699831587 | 365878.2976576661 | 382129.3774431262 | 2.163647626030455E11 | 1.8575348397004382E11 | 1.993269533541977E11 | 1.9954442371248087E11 | 2.0575211702796582E11 | 1.9936138104732748E11 | 2.0670732774926245E11 | 4.5848821236265967E11 | 4.538229146632752E11 | 4.691989822400863E11 | 6.782242530187631E11 | 7.096769066065905E11 |
| Doors canno     | 294242          | Five Points     | Ziebach County  | SD              | United States   | DIAMOND,AIRBORNE | 2002        | 1.0898201456148668E11 | 9.741694213793259E10 | 1.0520447584059492E11 | 1.0512429665379198E11 | 1.082536095643341E11 | 1.0485334752989696E11 | 1.084100905718941E11 | 2.4271710326305142E11 | 2.393359192653121E11 | 2.4659241767494983E11 | 3.5784178222942426E11 | 3.7398835247497687E11 | 370382.25189295434 | 331077.62364969176 | 357544.04823442927 | 357271.55420977285 | 367906.7215568617 | 356350.71651870554 | 368438.53213305416 | 824889.3878611871 | 813398.2207343347 | 838059.8883740248 | 1216147.872259651 | 1271023.0098863414 | 2.1635168101316122E11 | 1.855445072091679E11 | 1.9982442145068536E11 | 1.9974511736431857E11 | 2.0593244603451367E11 | 1.9911531647227396E11 | 2.0620712565377844E11 | 4.592824453630373E11 | 4.541779347451926E11 | 4.686739420594188E11 | 6.783566706166086E11 | 7.107151135885908E11 |
| Important issues liv | 138504          | Fairview        | Ziebach County  | SD              | United States   | DIAMOND,AIRBORNE | 2002        | 1.0845134880454645E11 | 9.76114797390103E10 | 1.0502688267174298E11 | 1.0472181378752335E11 | 1.0831621309623558E11 | 1.0488453769514752E11 | 1.0857600065054694E11 | 2.423016246957957E11 | 2.3903681676540726E11 | 2.4659656588475787E11 | 3.581607713979553E11 | 3.734849908168899E11 | 783019.6153507945 | 704755.6730420082 | 758294.9421803196 | 756092.342369342 | 782043.9344440275 | 757267.2102982407 | 783919.6026869038 | 1749419.6896536972 | 1725847.7499957203 | 1780429.1997686557 | 2585923.665727743 | 2696564.6538503575 | 2.1557347487280383E11 | 1.858074127816564E11 | 1.9954052316093155E11 | 1.9914956712397476E11 | 2.0629142429129272E11 | 1.9928986951795734E11 | 2.062806187754735E11 | 4.58045723669089E11 | 4.547264602451046E11 | 4.6934198783713043E11 | 6.786592554888074E11 | 7.10247775508415E11 |
+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+-----------------+--+
5 rows selected (57.024 seconds)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_5000
STOP hdp2.6_spark21_run_5000_3_query66_sql_2017-04-09-18-33:  Sun Apr 9 18:34:38 CDT 2017
