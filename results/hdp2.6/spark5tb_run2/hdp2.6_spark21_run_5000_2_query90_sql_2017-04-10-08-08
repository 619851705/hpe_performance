START hdp2.6_spark21_run_5000_2_query90_sql_2017-04-10-08-08:  Mon Apr 10 08:08:33 CDT 2017
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_orc_5000
17/04/10 08:08:34 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/10 08:08:34 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/10 08:08:34 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_orc_5000
Connected to: Spark SQL (version 2.1.0.2.6.0.0-598)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from ( select count(*) amc
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        from web_sales, household_demographics , time_dim, web_page
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        where ws_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_web_page_sk = web_page.wp_web_page_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and time_dim.t_hour between 6 and 6+1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and household_demographics.hd_dep_count = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and web_page.wp_char_count between 5000 and 5200) at,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       ( select count(*) pmc
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        from web_sales, household_demographics , time_dim, web_page
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        where ws_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_web_page_sk = web_page.wp_web_page_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and time_dim.t_hour between 14 and 14+1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and household_demographics.hd_dep_count = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and web_page.wp_char_count between 5000 and 5200) pt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  order by am_pm_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  limit 100;
Error: org.apache.spark.sql.AnalysisException: Detected cartesian product for INNER join between logical plans
Aggregate [count(1) AS amc#133683L]
+- Project
   +- Join Inner, (ws_web_page_sk#133698 = wp_web_page_sk#133735)
      :- Project [ws_web_page_sk#133698]
      :  +- Join Inner, (ws_sold_time_sk#133687 = t_time_sk#133725)
      :     :- Project [ws_sold_time_sk#133687, ws_web_page_sk#133698]
      :     :  +- Join Inner, (ws_ship_hdemo_sk#133696 = hd_demo_sk#133720)
      :     :     :- Project [ws_sold_time_sk#133687, ws_ship_hdemo_sk#133696, ws_web_page_sk#133698]
      :     :     :  +- Filter ((isnotnull(ws_ship_hdemo_sk#133696) && isnotnull(ws_sold_time_sk#133687)) && isnotnull(ws_web_page_sk#133698))
      :     :     :     +- MetastoreRelation tpcds_bin_partitioned_orc_5000, web_sales
      :     :     +- Project [hd_demo_sk#133720]
      :     :        +- Filter ((isnotnull(hd_dep_count#133723) && (hd_dep_count#133723 = 8)) && isnotnull(hd_demo_sk#133720))
      :     :           +- InMemoryRelation [hd_demo_sk#133720, hd_income_band_sk#133721, hd_buy_potential#133722, hd_dep_count#133723, hd_vehicle_count#133724], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
      :     :                 +- HiveTableScan [hd_demo_sk#1361, hd_income_band_sk#1362, hd_buy_potential#1363, hd_dep_count#1364, hd_vehicle_count#1365], MetastoreRelation tpcds_bin_partitioned_orc_5000, household_demographics
      :     +- Project [t_time_sk#133725]
      :        +- Filter ((isnotnull(t_hour#133728) && ((t_hour#133728 >= 6) && (t_hour#133728 <= 7))) && isnotnull(t_time_sk#133725))
      :           +- InMemoryRelation [t_time_sk#133725, t_time_id#133726, t_time#133727, t_hour#133728, t_minute#133729, t_second#133730, t_am_pm#133731, t_shift#133732, t_sub_shift#133733, t_meal_time#133734], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
      :                 +- HiveTableScan [t_time_sk#432, t_time_id#433, t_time#434, t_hour#435, t_minute#436, t_second#437, t_am_pm#438, t_shift#439, t_sub_shift#440, t_meal_time#441], MetastoreRelation tpcds_bin_partitioned_orc_5000, time_dim
      +- Project [wp_web_page_sk#133735]
         +- Filter ((isnotnull(wp_char_count#133745) && ((wp_char_count#133745 >= 5000) && (wp_char_count#133745 <= 5200))) && isnotnull(wp_web_page_sk#133735))
            +- InMemoryRelation [wp_web_page_sk#133735, wp_web_page_id#133736, wp_rec_start_date#133737, wp_rec_end_date#133738, wp_creation_date_sk#133739, wp_access_date_sk#133740, wp_autogen_flag#133741, wp_customer_sk#133742, wp_url#133743, wp_type#133744, wp_char_count#133745, wp_link_count#133746, wp_image_count#133747, wp_max_ad_count#133748], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `web_page`
                  +- HiveTableScan [wp_web_page_sk#3305, wp_web_page_id#3306, wp_rec_start_date#3307, wp_rec_end_date#3308, wp_creation_date_sk#3309, wp_access_date_sk#3310, wp_autogen_flag#3311, wp_customer_sk#3312, wp_url#3313, wp_type#3314, wp_char_count#3315, wp_link_count#3316, wp_image_count#3317, wp_max_ad_count#3318], MetastoreRelation tpcds_bin_partitioned_orc_5000, web_page
and
Aggregate [count(1) AS pmc#133684L]
+- Project
   +- Join Inner, (ws_web_page_sk#133761 = wp_web_page_sk#133798)
      :- Project [ws_web_page_sk#133761]
      :  +- Join Inner, (ws_sold_time_sk#133750 = t_time_sk#133788)
      :     :- Project [ws_sold_time_sk#133750, ws_web_page_sk#133761]
      :     :  +- Join Inner, (ws_ship_hdemo_sk#133759 = hd_demo_sk#133783)
      :     :     :- Project [ws_sold_time_sk#133750, ws_ship_hdemo_sk#133759, ws_web_page_sk#133761]
      :     :     :  +- Filter ((isnotnull(ws_ship_hdemo_sk#133759) && isnotnull(ws_sold_time_sk#133750)) && isnotnull(ws_web_page_sk#133761))
      :     :     :     +- MetastoreRelation tpcds_bin_partitioned_orc_5000, web_sales
      :     :     +- Project [hd_demo_sk#133783]
      :     :        +- Filter ((isnotnull(hd_dep_count#133786) && (hd_dep_count#133786 = 8)) && isnotnull(hd_demo_sk#133783))
      :     :           +- InMemoryRelation [hd_demo_sk#133783, hd_income_band_sk#133784, hd_buy_potential#133785, hd_dep_count#133786, hd_vehicle_count#133787], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
      :     :                 +- HiveTableScan [hd_demo_sk#1361, hd_income_band_sk#1362, hd_buy_potential#1363, hd_dep_count#1364, hd_vehicle_count#1365], MetastoreRelation tpcds_bin_partitioned_orc_5000, household_demographics
      :     +- Project [t_time_sk#133788]
      :        +- Filter ((isnotnull(t_hour#133791) && ((t_hour#133791 >= 14) && (t_hour#133791 <= 15))) && isnotnull(t_time_sk#133788))
      :           +- InMemoryRelation [t_time_sk#133788, t_time_id#133789, t_time#133790, t_hour#133791, t_minute#133792, t_second#133793, t_am_pm#133794, t_shift#133795, t_sub_shift#133796, t_meal_time#133797], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
      :                 +- HiveTableScan [t_time_sk#432, t_time_id#433, t_time#434, t_hour#435, t_minute#436, t_second#437, t_am_pm#438, t_shift#439, t_sub_shift#440, t_meal_time#441], MetastoreRelation tpcds_bin_partitioned_orc_5000, time_dim
      +- Project [wp_web_page_sk#133798]
         +- Filter ((isnotnull(wp_char_count#133808) && ((wp_char_count#133808 >= 5000) && (wp_char_count#133808 <= 5200))) && isnotnull(wp_web_page_sk#133798))
            +- InMemoryRelation [wp_web_page_sk#133798, wp_web_page_id#133799, wp_rec_start_date#133800, wp_rec_end_date#133801, wp_creation_date_sk#133802, wp_access_date_sk#133803, wp_autogen_flag#133804, wp_customer_sk#133805, wp_url#133806, wp_type#133807, wp_char_count#133808, wp_link_count#133809, wp_image_count#133810, wp_max_ad_count#133811], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `web_page`
                  +- HiveTableScan [wp_web_page_sk#3305, wp_web_page_id#3306, wp_rec_start_date#3307, wp_rec_end_date#3308, wp_creation_date_sk#3309, wp_access_date_sk#3310, wp_autogen_flag#3311, wp_customer_sk#3312, wp_url#3313, wp_type#3314, wp_char_count#3315, wp_link_count#3316, wp_image_count#3317, wp_max_ad_count#3318], MetastoreRelation tpcds_bin_partitioned_orc_5000, web_page
Join condition is missing or trivial.
Use the CROSS JOIN syntax to allow cartesian products between these relations.; (state=,code=0)

Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_orc_5000
STOP hdp2.6_spark21_run_5000_2_query90_sql_2017-04-10-08-08:  Mon Apr 10 08:08:35 CDT 2017
