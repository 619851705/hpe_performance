START hdp2.6_spark21_run_5000_1_query90_sql_2017-04-09-20-21:  Sun Apr 9 20:21:13 CDT 2017
 /usr/hdp/current/spark2-client/bin/beeline -u "jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_$SF" -n hive --incremental=true  -i settings/spark.settings -f sample-queries-tpcds/$1
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_5000
17/04/09 20:21:13 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/09 20:21:13 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/09 20:21:13 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_5000
Connected to: Spark SQL (version 2.1.0.2.6.0.0-598)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from ( select count(*) amc
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        from web_sales, household_demographics , time_dim, web_page
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        where ws_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_web_page_sk = web_page.wp_web_page_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and time_dim.t_hour between 6 and 6+1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and household_demographics.hd_dep_count = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and web_page.wp_char_count between 5000 and 5200) at,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       ( select count(*) pmc
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        from web_sales, household_demographics , time_dim, web_page
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        where ws_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_web_page_sk = web_page.wp_web_page_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and time_dim.t_hour between 14 and 14+1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and household_demographics.hd_dep_count = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and web_page.wp_char_count between 5000 and 5200) pt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  order by am_pm_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  limit 100;
Error: org.apache.spark.sql.AnalysisException: Detected cartesian product for INNER join between logical plans
Aggregate [count(1) AS amc#85539L]
+- Project
   +- Join Inner, (ws_web_page_sk#85554 = wp_web_page_sk#85591)
      :- Project [ws_web_page_sk#85554]
      :  +- Join Inner, (ws_sold_time_sk#85543 = t_time_sk#85581)
      :     :- Project [ws_sold_time_sk#85543, ws_web_page_sk#85554]
      :     :  +- Join Inner, (ws_ship_hdemo_sk#85552 = hd_demo_sk#85576)
      :     :     :- Project [ws_sold_time_sk#85543, ws_ship_hdemo_sk#85552, ws_web_page_sk#85554]
      :     :     :  +- Filter ((isnotnull(ws_ship_hdemo_sk#85552) && isnotnull(ws_sold_time_sk#85543)) && isnotnull(ws_web_page_sk#85554))
      :     :     :     +- Relation[ws_sold_time_sk#85543,ws_ship_date_sk#85544,ws_item_sk#85545,ws_bill_customer_sk#85546,ws_bill_cdemo_sk#85547,ws_bill_hdemo_sk#85548,ws_bill_addr_sk#85549,ws_ship_customer_sk#85550,ws_ship_cdemo_sk#85551,ws_ship_hdemo_sk#85552,ws_ship_addr_sk#85553,ws_web_page_sk#85554,ws_web_site_sk#85555,ws_ship_mode_sk#85556,ws_warehouse_sk#85557,ws_promo_sk#85558,ws_order_number#85559,ws_quantity#85560,ws_wholesale_cost#85561,ws_list_price#85562,ws_sales_price#85563,ws_ext_discount_amt#85564,ws_ext_sales_price#85565,ws_ext_wholesale_cost#85566,... 10 more fields] parquet
      :     :     +- Project [hd_demo_sk#85576]
      :     :        +- Filter ((isnotnull(hd_dep_count#85579) && (hd_dep_count#85579 = 8)) && isnotnull(hd_demo_sk#85576))
      :     :           +- InMemoryRelation [hd_demo_sk#85576, hd_income_band_sk#85577, hd_buy_potential#85578, hd_dep_count#85579, hd_vehicle_count#85580], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
      :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_5000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_50..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
      :     +- Project [t_time_sk#85581]
      :        +- Filter ((isnotnull(t_hour#85584) && ((t_hour#85584 >= 6) && (t_hour#85584 <= 7))) && isnotnull(t_time_sk#85581))
      :           +- InMemoryRelation [t_time_sk#85581, t_time_id#85582, t_time#85583, t_hour#85584, t_minute#85585, t_second#85586, t_am_pm#85587, t_shift#85588, t_sub_shift#85589, t_meal_time#85590], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
      :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_5000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_50..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
      +- Project [wp_web_page_sk#85591]
         +- Filter ((isnotnull(wp_char_count#85601) && ((wp_char_count#85601 >= 5000) && (wp_char_count#85601 <= 5200))) && isnotnull(wp_web_page_sk#85591))
            +- InMemoryRelation [wp_web_page_sk#85591, wp_web_page_id#85592, wp_rec_start_date#85593, wp_rec_end_date#85594, wp_creation_date_sk#85595, wp_access_date_sk#85596, wp_autogen_flag#85597, wp_customer_sk#85598, wp_url#85599, wp_type#85600, wp_char_count#85601, wp_link_count#85602, wp_image_count#85603, wp_max_ad_count#85604], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `web_page`
                  +- *FileScan parquet tpcds_bin_partitioned_parquet_5000.web_page[wp_web_page_sk#3935,wp_web_page_id#3936,wp_rec_start_date#3937,wp_rec_end_date#3938,wp_creation_date_sk#3939,wp_access_date_sk#3940,wp_autogen_flag#3941,wp_customer_sk#3942,wp_url#3943,wp_type#3944,wp_char_count#3945,wp_link_count#3946,wp_image_count#3947,wp_max_ad_count#3948] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_50..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<wp_web_page_sk:int,wp_web_page_id:string,wp_rec_start_date:string,wp_rec_end_date:string,w...
and
Aggregate [count(1) AS pmc#85540L]
+- Project
   +- Join Inner, (ws_web_page_sk#85617 = wp_web_page_sk#85654)
      :- Project [ws_web_page_sk#85617]
      :  +- Join Inner, (ws_sold_time_sk#85606 = t_time_sk#85644)
      :     :- Project [ws_sold_time_sk#85606, ws_web_page_sk#85617]
      :     :  +- Join Inner, (ws_ship_hdemo_sk#85615 = hd_demo_sk#85639)
      :     :     :- Project [ws_sold_time_sk#85606, ws_ship_hdemo_sk#85615, ws_web_page_sk#85617]
      :     :     :  +- Filter ((isnotnull(ws_ship_hdemo_sk#85615) && isnotnull(ws_sold_time_sk#85606)) && isnotnull(ws_web_page_sk#85617))
      :     :     :     +- Relation[ws_sold_time_sk#85606,ws_ship_date_sk#85607,ws_item_sk#85608,ws_bill_customer_sk#85609,ws_bill_cdemo_sk#85610,ws_bill_hdemo_sk#85611,ws_bill_addr_sk#85612,ws_ship_customer_sk#85613,ws_ship_cdemo_sk#85614,ws_ship_hdemo_sk#85615,ws_ship_addr_sk#85616,ws_web_page_sk#85617,ws_web_site_sk#85618,ws_ship_mode_sk#85619,ws_warehouse_sk#85620,ws_promo_sk#85621,ws_order_number#85622,ws_quantity#85623,ws_wholesale_cost#85624,ws_list_price#85625,ws_sales_price#85626,ws_ext_discount_amt#85627,ws_ext_sales_price#85628,ws_ext_wholesale_cost#85629,... 10 more fields] parquet
      :     :     +- Project [hd_demo_sk#85639]
      :     :        +- Filter ((isnotnull(hd_dep_count#85642) && (hd_dep_count#85642 = 8)) && isnotnull(hd_demo_sk#85639))
      :     :           +- InMemoryRelation [hd_demo_sk#85639, hd_income_band_sk#85640, hd_buy_potential#85641, hd_dep_count#85642, hd_vehicle_count#85643], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
      :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_5000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_50..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
      :     +- Project [t_time_sk#85644]
      :        +- Filter ((isnotnull(t_hour#85647) && ((t_hour#85647 >= 14) && (t_hour#85647 <= 15))) && isnotnull(t_time_sk#85644))
      :           +- InMemoryRelation [t_time_sk#85644, t_time_id#85645, t_time#85646, t_hour#85647, t_minute#85648, t_second#85649, t_am_pm#85650, t_shift#85651, t_sub_shift#85652, t_meal_time#85653], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
      :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_5000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_50..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
      +- Project [wp_web_page_sk#85654]
         +- Filter ((isnotnull(wp_char_count#85664) && ((wp_char_count#85664 >= 5000) && (wp_char_count#85664 <= 5200))) && isnotnull(wp_web_page_sk#85654))
            +- InMemoryRelation [wp_web_page_sk#85654, wp_web_page_id#85655, wp_rec_start_date#85656, wp_rec_end_date#85657, wp_creation_date_sk#85658, wp_access_date_sk#85659, wp_autogen_flag#85660, wp_customer_sk#85661, wp_url#85662, wp_type#85663, wp_char_count#85664, wp_link_count#85665, wp_image_count#85666, wp_max_ad_count#85667], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `web_page`
                  +- *FileScan parquet tpcds_bin_partitioned_parquet_5000.web_page[wp_web_page_sk#3935,wp_web_page_id#3936,wp_rec_start_date#3937,wp_rec_end_date#3938,wp_creation_date_sk#3939,wp_access_date_sk#3940,wp_autogen_flag#3941,wp_customer_sk#3942,wp_url#3943,wp_type#3944,wp_char_count#3945,wp_link_count#3946,wp_image_count#3947,wp_max_ad_count#3948] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_50..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<wp_web_page_sk:int,wp_web_page_id:string,wp_rec_start_date:string,wp_rec_end_date:string,w...
Join condition is missing or trivial.
Use the CROSS JOIN syntax to allow cartesian products between these relations.; (state=,code=0)

Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_5000
STOP hdp2.6_spark21_run_5000_1_query90_sql_2017-04-09-20-21:  Sun Apr 9 20:21:14 CDT 2017
