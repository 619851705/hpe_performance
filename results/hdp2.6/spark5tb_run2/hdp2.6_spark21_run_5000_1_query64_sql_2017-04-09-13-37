START hdp2.6_spark21_run_5000_1_query64_sql_2017-04-09-13-37:  Sun Apr 9 13:37:51 CDT 2017
 /usr/hdp/current/spark2-client/bin/beeline -u "jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_$SF" -n hive --incremental=true  -i settings/spark.settings -f sample-queries-tpcds/$1
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_5000
17/04/09 13:37:51 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/09 13:37:51 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/09 13:37:51 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_5000
Connected to: Spark SQL (version 2.1.0.2.6.0.0-598)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select cs1.product_name ,cs1.store_name ,cs1.store_zip ,cs1.b_street_number ,cs1.b_streen_name ,cs1.b_city
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      ,cs1.b_zip ,cs1.c_street_number ,cs1.c_street_name ,cs1.c_city ,cs1.c_zip ,cs1.syear ,cs1.cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      ,cs1.s1 ,cs1.s2 ,cs1.s3
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      ,cs2.s1 ,cs2.s2 ,cs2.s3 ,cs2.syear ,cs2.cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> from
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> (select i_product_name as product_name ,i_item_sk as item_sk ,s_store_name as store_name
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      ,s_zip as store_zip ,ad1.ca_street_number as b_street_number ,ad1.ca_street_name as b_streen_name
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      ,ad1.ca_city as b_city ,ad1.ca_zip as b_zip ,ad2.ca_street_number as c_street_number
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      ,ad2.ca_street_name as c_street_name ,ad2.ca_city as c_city ,ad2.ca_zip as c_zip
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year as s2year ,count(*) as cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      ,sum(ss_wholesale_cost) as s1 ,sum(ss_list_price) as s2 ,sum(ss_coupon_amt) as s3
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   FROM   store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN store_returns ON store_sales.ss_item_sk = store_returns.sr_item_sk and store_sales.ss_ticket_number  = store_returns.sr_ticket_number
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN date_dim d1 ON store_sales.ss_sold_date_sk = d1.d_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN date_dim d2 ON customer.c_first_sales_date_sk = d2.d_date_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN date_dim d3 ON customer.c_first_shipto_date_sk = d3.d_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN store ON store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN customer_demographics cd1 ON store_sales.ss_cdemo_sk= cd1.cd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN customer_demographics cd2 ON customer.c_current_cdemo_sk = cd2.cd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN household_demographics hd1 ON store_sales.ss_hdemo_sk = hd1.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN household_demographics hd2 ON customer.c_current_hdemo_sk = hd2.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN customer_address ad1 ON store_sales.ss_addr_sk = ad1.ca_address_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN customer_address ad2 ON customer.c_current_addr_sk = ad2.ca_address_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN income_band ib1 ON hd1.hd_income_band_sk = ib1.ib_income_band_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN income_band ib2 ON hd2.hd_income_band_sk = ib2.ib_income_band_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN item ON store_sales.ss_item_sk = item.i_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select cs_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   from catalog_sales JOIN catalog_returns
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   ON catalog_sales.cs_item_sk = catalog_returns.cr_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>     and catalog_sales.cs_order_number = catalog_returns.cr_order_number
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   group by cs_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)) cs_ui
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> ON store_sales.ss_item_sk = cs_ui.cs_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   WHERE  
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          cd1.cd_marital_status <> cd2.cd_marital_status and
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          i_color in ('maroon','burnished','dim','steel','navajo','chocolate') and
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          i_current_price between 35 and 35 + 10 and
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          i_current_price between 35 + 1 and 35 + 15
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> group by i_product_name ,i_item_sk ,s_store_name ,s_zip ,ad1.ca_street_number
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,ad1.ca_street_name ,ad1.ca_city ,ad1.ca_zip ,ad2.ca_street_number
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,ad2.ca_street_name ,ad2.ca_city ,ad2.ca_zip ,d1.d_year ,d2.d_year ,d3.d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> ) cs1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> JOIN
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> (select i_product_name as product_name ,i_item_sk as item_sk ,s_store_name as store_name
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      ,s_zip as store_zip ,ad1.ca_street_number as b_street_number ,ad1.ca_street_name as b_streen_name
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      ,ad1.ca_city as b_city ,ad1.ca_zip as b_zip ,ad2.ca_street_number as c_street_number
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      ,ad2.ca_street_name as c_street_name ,ad2.ca_city as c_city ,ad2.ca_zip as c_zip
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      ,d1.d_year as syear ,d2.d_year as fsyear ,d3.d_year as s2year ,count(*) as cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      ,sum(ss_wholesale_cost) as s1 ,sum(ss_list_price) as s2 ,sum(ss_coupon_amt) as s3
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   FROM   store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN store_returns ON store_sales.ss_item_sk = store_returns.sr_item_sk and store_sales.ss_ticket_number  = store_returns.sr_ticket_number
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN customer ON store_sales.ss_customer_sk = customer.c_customer_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN date_dim d1 ON store_sales.ss_sold_date_sk = d1.d_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN date_dim d2 ON customer.c_first_sales_date_sk = d2.d_date_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN date_dim d3 ON customer.c_first_shipto_date_sk = d3.d_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN store ON store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN customer_demographics cd1 ON store_sales.ss_cdemo_sk= cd1.cd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN customer_demographics cd2 ON customer.c_current_cdemo_sk = cd2.cd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN promotion ON store_sales.ss_promo_sk = promotion.p_promo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN household_demographics hd1 ON store_sales.ss_hdemo_sk = hd1.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN household_demographics hd2 ON customer.c_current_hdemo_sk = hd2.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN customer_address ad1 ON store_sales.ss_addr_sk = ad1.ca_address_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN customer_address ad2 ON customer.c_current_addr_sk = ad2.ca_address_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN income_band ib1 ON hd1.hd_income_band_sk = ib1.ib_income_band_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN income_band ib2 ON hd2.hd_income_band_sk = ib2.ib_income_band_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN item ON store_sales.ss_item_sk = item.i_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         JOIN
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select cs_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   from catalog_sales JOIN catalog_returns
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   ON catalog_sales.cs_item_sk = catalog_returns.cr_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>     and catalog_sales.cs_order_number = catalog_returns.cr_order_number
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   group by cs_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)) cs_ui
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> ON store_sales.ss_item_sk = cs_ui.cs_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   WHERE  
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          cd1.cd_marital_status <> cd2.cd_marital_status and
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          i_color in ('maroon','burnished','dim','steel','navajo','chocolate') and
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          i_current_price between 35 and 35 + 10 and
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          i_current_price between 35 + 1 and 35 + 15
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> group by i_product_name ,i_item_sk ,s_store_name ,s_zip ,ad1.ca_street_number
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,ad1.ca_street_name ,ad1.ca_city ,ad1.ca_zip ,ad2.ca_street_number
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,ad2.ca_street_name ,ad2.ca_city ,ad2.ca_zip ,d1.d_year ,d2.d_year ,d3.d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> ) cs2
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> ON cs1.item_sk=cs2.item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> where 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      cs1.syear = 2000 and
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      cs2.syear = 2000 + 1 and
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      cs2.cnt <= cs1.cnt and
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      cs1.store_name = cs2.store_name and
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      cs1.store_zip = cs2.store_zip
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> order by cs1.product_name ,cs1.store_name ,cs2.cnt;
STOP hdp2.6_spark21_run_5000_1_query64_sql_2017-04-09-13-37:  Sun Apr 9 18:21:52 CDT 2017
