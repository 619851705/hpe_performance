START hdp2.6_spark21_run_1000_1_query28_sql_2017-04-10-21-59:  Mon Apr 10 21:59:44 CDT 2017
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_orc_1000
17/04/10 21:59:44 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/10 21:59:44 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/10 21:59:44 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_orc_1000
Connected to: Spark SQL (version 2.1.0.2.6.0.3-8)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  *
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> from (select avg(ss_list_price) B1_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B1_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B1_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 0 and 5
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 11 and 11+10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              or ss_coupon_amt between 460 and 460+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              or ss_wholesale_cost between 14 and 14+20)) B1,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B2_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B2_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B2_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 6 and 10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 91 and 91+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 1430 and 1430+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 32 and 32+20)) B2,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B3_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B3_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B3_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 11 and 15
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 66 and 66+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 920 and 920+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 4 and 4+20)) B3,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B4_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B4_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B4_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 16 and 20
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 142 and 142+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 3054 and 3054+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 80 and 80+20)) B4,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B5_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B5_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B5_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 21 and 25
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 135 and 135+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 14180 and 14180+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 38 and 38+20)) B5,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B6_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B6_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B6_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 26 and 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 28 and 28+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 2513 and 2513+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 42 and 42+20)) B6
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> limit 100;
Error: org.apache.spark.sql.AnalysisException: Detected cartesian product for INNER join between logical plans
Join Inner
:- Join Inner
:  :- Join Inner
:  :  :- Join Inner
:  :  :  :- Aggregate [avg(cast(ss_list_price#28243 as double)) AS B1_LP#28213, count(ss_list_price#28243) AS B1_CNT#28214L, count(distinct ss_list_price#28243) AS B1_CNTD#28215L]
:  :  :  :  +- Project [ss_list_price#28243]
:  :  :  :     +- Filter (isnotnull(ss_quantity#28241) && (((ss_quantity#28241 >= 0) && (ss_quantity#28241 <= 5)) && ((((ss_list_price#28243 >= 11.0) && (ss_list_price#28243 <= 21.0)) || ((ss_coupon_amt#28250 >= 460.0) && (ss_coupon_amt#28250 <= 1460.0))) || ((ss_wholesale_cost#28242 >= 14.0) && (ss_wholesale_cost#28242 <= 34.0)))))
:  :  :  :        +- MetastoreRelation tpcds_bin_partitioned_orc_1000, store_sales
:  :  :  +- Aggregate [avg(cast(ss_list_price#28266 as double)) AS B2_LP#28216, count(ss_list_price#28266) AS B2_CNT#28217L, count(distinct ss_list_price#28266) AS B2_CNTD#28218L]
:  :  :     +- Project [ss_list_price#28266]
:  :  :        +- Filter (isnotnull(ss_quantity#28264) && (((ss_quantity#28264 >= 6) && (ss_quantity#28264 <= 10)) && ((((ss_list_price#28266 >= 91.0) && (ss_list_price#28266 <= 101.0)) || ((ss_coupon_amt#28273 >= 1430.0) && (ss_coupon_amt#28273 <= 2430.0))) || ((ss_wholesale_cost#28265 >= 32.0) && (ss_wholesale_cost#28265 <= 52.0)))))
:  :  :           +- MetastoreRelation tpcds_bin_partitioned_orc_1000, store_sales
:  :  +- Aggregate [avg(cast(ss_list_price#28289 as double)) AS B3_LP#28219, count(ss_list_price#28289) AS B3_CNT#28220L, count(distinct ss_list_price#28289) AS B3_CNTD#28221L]
:  :     +- Project [ss_list_price#28289]
:  :        +- Filter (isnotnull(ss_quantity#28287) && (((ss_quantity#28287 >= 11) && (ss_quantity#28287 <= 15)) && ((((ss_list_price#28289 >= 66.0) && (ss_list_price#28289 <= 76.0)) || ((ss_coupon_amt#28296 >= 920.0) && (ss_coupon_amt#28296 <= 1920.0))) || ((ss_wholesale_cost#28288 >= 4.0) && (ss_wholesale_cost#28288 <= 24.0)))))
:  :           +- MetastoreRelation tpcds_bin_partitioned_orc_1000, store_sales
:  +- Aggregate [avg(cast(ss_list_price#28312 as double)) AS B4_LP#28222, count(ss_list_price#28312) AS B4_CNT#28223L, count(distinct ss_list_price#28312) AS B4_CNTD#28224L]
:     +- Project [ss_list_price#28312]
:        +- Filter (isnotnull(ss_quantity#28310) && (((ss_quantity#28310 >= 16) && (ss_quantity#28310 <= 20)) && ((((ss_list_price#28312 >= 142.0) && (ss_list_price#28312 <= 152.0)) || ((ss_coupon_amt#28319 >= 3054.0) && (ss_coupon_amt#28319 <= 4054.0))) || ((ss_wholesale_cost#28311 >= 80.0) && (ss_wholesale_cost#28311 <= 100.0)))))
:           +- MetastoreRelation tpcds_bin_partitioned_orc_1000, store_sales
+- Aggregate [avg(cast(ss_list_price#28335 as double)) AS B5_LP#28225, count(ss_list_price#28335) AS B5_CNT#28226L, count(distinct ss_list_price#28335) AS B5_CNTD#28227L]
   +- Project [ss_list_price#28335]
      +- Filter (isnotnull(ss_quantity#28333) && (((ss_quantity#28333 >= 21) && (ss_quantity#28333 <= 25)) && ((((ss_list_price#28335 >= 135.0) && (ss_list_price#28335 <= 145.0)) || ((ss_coupon_amt#28342 >= 14180.0) && (ss_coupon_amt#28342 <= 15180.0))) || ((ss_wholesale_cost#28334 >= 38.0) && (ss_wholesale_cost#28334 <= 58.0)))))
         +- MetastoreRelation tpcds_bin_partitioned_orc_1000, store_sales
and
Aggregate [avg(cast(ss_list_price#28358 as double)) AS B6_LP#28228, count(ss_list_price#28358) AS B6_CNT#28229L, count(distinct ss_list_price#28358) AS B6_CNTD#28230L]
+- Project [ss_list_price#28358]
   +- Filter (isnotnull(ss_quantity#28356) && (((ss_quantity#28356 >= 26) && (ss_quantity#28356 <= 30)) && ((((ss_list_price#28358 >= 28.0) && (ss_list_price#28358 <= 38.0)) || ((ss_coupon_amt#28365 >= 2513.0) && (ss_coupon_amt#28365 <= 3513.0))) || ((ss_wholesale_cost#28357 >= 42.0) && (ss_wholesale_cost#28357 <= 62.0)))))
      +- MetastoreRelation tpcds_bin_partitioned_orc_1000, store_sales
Join condition is missing or trivial.
Use the CROSS JOIN syntax to allow cartesian products between these relations.; (state=,code=0)

Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_orc_1000
STOP hdp2.6_spark21_run_1000_1_query28_sql_2017-04-10-21-59:  Mon Apr 10 21:59:45 CDT 2017
