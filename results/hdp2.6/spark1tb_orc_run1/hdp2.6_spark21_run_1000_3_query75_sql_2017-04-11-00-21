START hdp2.6_spark21_run_1000_3_query75_sql_2017-04-11-00-21:  Tue Apr 11 00:21:09 CDT 2017
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_orc_1000
17/04/11 00:21:10 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/11 00:21:10 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/11 00:21:10 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_orc_1000
Connected to: Spark SQL (version 2.1.0.2.6.0.3-8)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> WITH all_sales AS (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  SELECT d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,SUM(sales_cnt) AS sales_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        ,SUM(sales_amt) AS sales_amt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  FROM (SELECT d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           JOIN date_dim ON d_date_sk=cs_sold_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                                                     AND cs_item_sk=cr_item_sk)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        WHERE i_category='Sports'
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        UNION ALL
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        SELECT d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        FROM store_sales JOIN item ON i_item_sk=ss_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                         JOIN date_dim ON d_date_sk=ss_sold_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                         LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                                                 AND ss_item_sk=sr_item_sk)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        WHERE i_category='Sports'
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        UNION ALL
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        SELECT d_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        FROM web_sales JOIN item ON i_item_sk=ws_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                       JOIN date_dim ON d_date_sk=ws_sold_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                       LEFT JOIN web_returns ON (ws_order_number=wr_order_number 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                                             AND ws_item_sk=wr_item_sk)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        WHERE i_category='Sports') sales_detail
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  SELECT  prev_yr.d_year AS prev_year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.d_year AS year
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,prev_yr.sales_cnt AS prev_yr_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.sales_cnt AS curr_yr_cnt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                           ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  FROM all_sales curr_yr, all_sales prev_yr
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  WHERE curr_yr.i_brand_id=prev_yr.i_brand_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>    AND curr_yr.i_class_id=prev_yr.i_class_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>    AND curr_yr.i_category_id=prev_yr.i_category_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>    AND curr_yr.i_manufact_id=prev_yr.i_manufact_id
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>    AND curr_yr.d_year=2002
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>    AND prev_yr.d_year=2002-1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>    AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ORDER BY sales_cnt_diff
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  limit 100;
+-------------+-------------+-------------+-------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+--+
|  prev_year  |    year     | i_brand_id  | i_class_id  | i_category_id | i_manufact_id |   prev_yr_cnt   |   curr_yr_cnt   | sales_cnt_diff  | sales_amt_diff  |
+-------------+-------------+-------------+-------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+--+
| 2001        | 2002        | 8014002     | 14          | 8             | 290           | 933684          | 307217          | -626467         | -2.6905057673580028E7 |
| 2001        | 2002        | 8002010     | 2           | 8             | 35            | 630304          | 301742          | -328562         | -1.4465123269447595E7 |
| 2001        | 2002        | 8003010     | 3           | 8             | 253           | 936208          | 609469          | -326739         | -1.3973939759031296E7 |
| 2001        | 2002        | 8011004     | 11          | 8             | 196           | 942536          | 615804          | -326732         | -1.4418587867908478E7 |
| 2001        | 2002        | 8014002     | 14          | 8             | 115           | 626037          | 302912          | -323125         | -1.3687983357133359E7 |
| 2001        | 2002        | 8002006     | 2           | 8             | 313           | 625440          | 302669          | -322771         | -1.4468096271846686E7 |
| 2001        | 2002        | 8015006     | 4           | 8             | 94            | 624936          | 302867          | -322069         | -1.3238234985027418E7 |
| 2001        | 2002        | 8006004     | 6           | 8             | 14            | 632817          | 311057          | -321760         | -1.448995633457379E7 |
| 2001        | 2002        | 8010004     | 10          | 8             | 424           | 626034          | 304539          | -321495         | -1.4096826970369384E7 |
| 2001        | 2002        | 8015010     | 15          | 8             | 114           | 629476          | 308648          | -320828         | -1.367715337144731E7 |
| 2001        | 2002        | 8016006     | 16          | 8             | 279           | 630474          | 309885          | -320589         | -1.3541478191975668E7 |
| 2001        | 2002        | 8005008     | 5           | 8             | 140           | 621356          | 301428          | -319928         | -1.3875103335977167E7 |
| 2001        | 2002        | 8015004     | 15          | 8             | 139           | 627642          | 308081          | -319561         | -1.4299576942394577E7 |
| 2001        | 2002        | 8006008     | 6           | 8             | 219           | 621833          | 302480          | -319353         | -1.4275636017882481E7 |
| 2001        | 2002        | 8014006     | 14          | 8             | 204           | 623832          | 304694          | -319138         | -1.3934762776891738E7 |
| 2001        | 2002        | 8006006     | 6           | 8             | 279           | 627855          | 309397          | -318458         | -1.4341709642263975E7 |
| 2001        | 2002        | 4004001     | 4           | 8             | 207           | 619577          | 301134          | -318443         | -1.4689558286376163E7 |
| 2001        | 2002        | 8008006     | 8           | 8             | 362           | 621918          | 303545          | -318373         | -1.364312894326768E7 |
| 2001        | 2002        | 8007008     | 7           | 8             | 360           | 626331          | 308066          | -318265         | -1.4672042378423601E7 |
| 2001        | 2002        | 8016006     | 16          | 8             | 166           | 622981          | 304971          | -318010         | -1.3631893719967186E7 |
| 2001        | 2002        | 8002002     | 2           | 8             | 17            | 620392          | 303061          | -317331         | -1.4125606292580001E7 |
| 2001        | 2002        | 2001001     | 1           | 8             | 515           | 628450          | 311190          | -317260         | -1.3803471675593734E7 |
| 2001        | 2002        | 3003001     | 3           | 8             | 171           | 623371          | 306256          | -317115         | -1.3375476986888498E7 |
| 2001        | 2002        | 8004004     | 4           | 8             | 609           | 619704          | 302762          | -316942         | -1.3659859848457165E7 |
| 2001        | 2002        | 8003008     | 3           | 8             | 160           | 625013          | 309286          | -315727         | -1.3907816112104163E7 |
| 2001        | 2002        | 2001001     | 1           | 8             | 146           | 620713          | 305100          | -315613         | -1.396954746025671E7 |
| 2001        | 2002        | 8011006     | 11          | 8             | 149           | 620906          | 305336          | -315570         | -1.351261336628306E7 |
| 2001        | 2002        | 8016004     | 16          | 8             | 253           | 934525          | 619040          | -315485         | -1.3986483798372298E7 |
| 2001        | 2002        | 8011006     | 11          | 8             | 29            | 620017          | 304666          | -315351         | -1.3537921806538656E7 |
| 2001        | 2002        | 8005006     | 5           | 8             | 256           | 622167          | 306957          | -315210         | -1.313811128450169E7 |
| 2001        | 2002        | 4003001     | 3           | 8             | 487           | 622037          | 307318          | -314719         | -1.3536772489285141E7 |
| 2001        | 2002        | 8007004     | 7           | 8             | 143           | 619240          | 304679          | -314561         | -1.3660178723113932E7 |
| 2001        | 2002        | 5001001     | 1           | 8             | 482           | 622856          | 308329          | -314527         | -1.3502270470232017E7 |
| 2001        | 2002        | 8007004     | 7           | 8             | 157           | 623333          | 308807          | -314526         | -1.383885618341877E7 |
| 2001        | 2002        | 8003002     | 3           | 8             | 75            | 617025          | 303184          | -313841         | -1.3807816008869186E7 |
| 2001        | 2002        | 8004004     | 4           | 8             | 645           | 621351          | 307555          | -313796         | -1.3699328379799895E7 |
| 2001        | 2002        | 8004006     | 4           | 8             | 254           | 612391          | 298810          | -313581         | -1.367841537995255E7 |
| 2001        | 2002        | 2001001     | 1           | 8             | 194           | 623067          | 309495          | -313572         | -1.3141773348246261E7 |
| 2001        | 2002        | 8010006     | 10          | 8             | 469           | 617820          | 304257          | -313563         | -1.3751408457104884E7 |
| 2001        | 2002        | 8005008     | 5           | 8             | 162           | 618279          | 304860          | -313419         | -1.4523558773401096E7 |
| 2001        | 2002        | 1002001     | 2           | 8             | 94            | 620586          | 307433          | -313153         | -1.3160324115846008E7 |
| 2001        | 2002        | 8004004     | 4           | 8             | 155           | 619731          | 306775          | -312956         | -1.3889228558770835E7 |
| 2001        | 2002        | 8010004     | 10          | 8             | 232           | 621904          | 309290          | -312614         | -1.3911629917211652E7 |
| 2001        | 2002        | 8005004     | 5           | 8             | 206           | 614351          | 301769          | -312582         | -1.2849916866992805E7 |
| 2001        | 2002        | 8008006     | 8           | 8             | 278           | 622005          | 309441          | -312564         | -1.3704802186780311E7 |
| 2001        | 2002        | 8004008     | 4           | 8             | 106           | 621889          | 309423          | -312466         | -1.304583901964765E7 |
| 2001        | 2002        | 6015001     | 15          | 8             | 246           | 621665          | 309338          | -312327         | -1.280962356953144E7 |
| 2001        | 2002        | 8003006     | 3           | 8             | 278           | 618771          | 306530          | -312241         | -1.3322214847313479E7 |
| 2001        | 2002        | 8005006     | 5           | 8             | 207           | 616775          | 304552          | -312223         | -1.3752361202133149E7 |
| 2001        | 2002        | 8002010     | 2           | 8             | 117           | 615325          | 303113          | -312212         | -1.3942206618138656E7 |
| 2001        | 2002        | 8015010     | 15          | 8             | 173           | 614882          | 302874          | -312008         | -1.3683451382404037E7 |
| 2001        | 2002        | 8008002     | 8           | 8             | 288           | 622211          | 310221          | -311990         | -1.3408581302818142E7 |
| 2001        | 2002        | 2003001     | 3           | 8             | 589           | 623224          | 311349          | -311875         | -1.3368272739891067E7 |
| 2001        | 2002        | 8002002     | 2           | 8             | 224           | 619685          | 307941          | -311744         | -1.3777087612228759E7 |
| 2001        | 2002        | 4002001     | 2           | 8             | 60            | 619706          | 308373          | -311333         | -1.3713022440193951E7 |
| 2001        | 2002        | 8004004     | 4           | 8             | 226           | 621303          | 310118          | -311185         | -1.3260538582502559E7 |
| 2001        | 2002        | 8002004     | 2           | 8             | 333           | 619430          | 308365          | -311065         | -1.3591367340605065E7 |
| 2001        | 2002        | 8013010     | 13          | 8             | 597           | 619809          | 308847          | -310962         | -1.3657440093891501E7 |
| 2001        | 2002        | 8008002     | 8           | 8             | 373           | 620670          | 309710          | -310960         | -1.3760030329856649E7 |
| 2001        | 2002        | 8012008     | 12          | 8             | 297           | 618625          | 308105          | -310520         | -1.340382644136259E7 |
| 2001        | 2002        | 8007010     | 7           | 8             | 46            | 622787          | 312288          | -310499         | -1.3277237174816936E7 |
| 2001        | 2002        | 8011008     | 11          | 8             | 133           | 616852          | 306441          | -310411         | -1.3258659221617214E7 |
| 2001        | 2002        | 8003010     | 3           | 8             | 529           | 618272          | 307926          | -310346         | -1.3276454924203709E7 |
| 2001        | 2002        | 8004006     | 4           | 8             | 78            | 921156          | 610813          | -310343         | -1.2846452515126266E7 |
| 2001        | 2002        | 8015004     | 15          | 8             | 254           | 624371          | 314059          | -310312         | -1.3058127454163358E7 |
| 2001        | 2002        | 1002001     | 2           | 8             | 288           | 622933          | 312993          | -309940         | -1.317818535278108E7 |
| 2001        | 2002        | 3003001     | 3           | 8             | 174           | 620392          | 310521          | -309871         | -1.3053199387364805E7 |
| 2001        | 2002        | 8002010     | 2           | 8             | 60            | 617284          | 307715          | -309569         | -1.32762535943629E7 |
| 2001        | 2002        | 8004004     | 4           | 8             | 886           | 623383          | 314090          | -309293         | -1.325091833060357E7 |
| 2001        | 2002        | 5004001     | 4           | 8             | 595           | 625957          | 316948          | -309009         | -1.3360776598463014E7 |
| 2001        | 2002        | 8008010     | 8           | 8             | 183           | 621093          | 312205          | -308888         | -1.3461748295385182E7 |
| 2001        | 2002        | 2002001     | 2           | 8             | 656           | 616993          | 308175          | -308818         | -1.3177694848156765E7 |
| 2001        | 2002        | 8016010     | 16          | 8             | 188           | 614920          | 306113          | -308807         | -1.3343045708160862E7 |
| 2001        | 2002        | 8003002     | 3           | 8             | 541           | 619772          | 311014          | -308758         | -1.331861500703333E7 |
| 2001        | 2002        | 3001001     | 1           | 8             | 187           | 621700          | 313145          | -308555         | -1.3415716353810608E7 |
| 2001        | 2002        | 8010004     | 10          | 8             | 146           | 611025          | 302475          | -308550         | -1.3668409757843263E7 |
| 2001        | 2002        | 5003001     | 3           | 8             | 139           | 609259          | 300865          | -308394         | -1.3106685332295202E7 |
| 2001        | 2002        | 4001001     | 1           | 8             | 198           | 617817          | 309657          | -308160         | -1.3289263566333957E7 |
| 2001        | 2002        | 8014002     | 14          | 8             | 254           | 926967          | 618872          | -308095         | -1.3363640565280214E7 |
| 2001        | 2002        | 8010002     | 10          | 8             | 227           | 615229          | 307204          | -308025         | -1.3748985370391466E7 |
| 2001        | 2002        | 8009008     | 9           | 8             | 291           | 624331          | 316396          | -307935         | -1.349804727105309E7 |
| 2001        | 2002        | 8009010     | 9           | 8             | 70            | 615149          | 307369          | -307780         | -1.3715200699281096E7 |
| 2001        | 2002        | 8009008     | 9           | 8             | 77            | 618600          | 310846          | -307754         | -1.3618795853408873E7 |
| 2001        | 2002        | 8015006     | 15          | 8             | 173           | 621220          | 313797          | -307423         | -1.3127561034279048E7 |
| 2001        | 2002        | 8008006     | 8           | 8             | 49            | 619143          | 311780          | -307363         | -1.3527733692620106E7 |
| 2001        | 2002        | 8001002     | 1           | 8             | 551           | 617720          | 310393          | -307327         | -1.3817436788412645E7 |
| 2001        | 2002        | 8010002     | 10          | 8             | 572           | 614301          | 306994          | -307307         | -1.3057112421300791E7 |
| 2001        | 2002        | 8011004     | 11          | 8             | 107           | 618131          | 310826          | -307305         | -1.347409612899381E7 |
| 2001        | 2002        | 8016010     | 16          | 8             | 229           | 616249          | 309106          | -307143         | -1.3805891534435023E7 |
| 2001        | 2002        | 8003002     | 3           | 8             | 397           | 619585          | 312506          | -307079         | -1.353044786231631E7 |
| 2001        | 2002        | 8012010     | 12          | 8             | 259           | 621088          | 314156          | -306932         | -1.3095335207709214E7 |
| 2001        | 2002        | 8015008     | 15          | 8             | 317           | 617973          | 311136          | -306837         | -1.2723084372523129E7 |
| 2001        | 2002        | 8015004     | 15          | 8             | 119           | 611892          | 305127          | -306765         | -1.3629452214987066E7 |
| 2001        | 2002        | 8010002     | 10          | 8             | 223           | 613634          | 306907          | -306727         | -1.3708676046696477E7 |
| 2001        | 2002        | 8011010     | 11          | 8             | 122           | 612950          | 306306          | -306644         | -1.305623949651745E7 |
| 2001        | 2002        | 8008008     | 8           | 8             | 387           | 618574          | 311931          | -306643         | -1.3588171957586423E7 |
| 2001        | 2002        | 8001008     | 1           | 8             | 97            | 611246          | 304711          | -306535         | -1.2665132088514682E7 |
| 2001        | 2002        | 8005010     | 5           | 8             | 70            | 615146          | 308820          | -306326         | -1.2952840248927072E7 |
| 2001        | 2002        | 8003010     | 3           | 8             | 88            | 617708          | 311421          | -306287         | -1.3293133084353946E7 |
| 2001        | 2002        | 8007004     | 7           | 8             | 476           | 612801          | 307039          | -305762         | -1.328955847076194E7 |
+-------------+-------------+-------------+-------------+---------------+---------------+-----------------+-----------------+-----------------+-----------------+--+
100 rows selected (127.72 seconds)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_orc_1000
STOP hdp2.6_spark21_run_1000_3_query75_sql_2017-04-11-00-21:  Tue Apr 11 00:23:18 CDT 2017
