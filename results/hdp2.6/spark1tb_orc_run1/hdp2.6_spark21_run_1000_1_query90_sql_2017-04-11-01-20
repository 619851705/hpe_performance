START hdp2.6_spark21_run_1000_1_query90_sql_2017-04-11-01-20:  Tue Apr 11 01:20:48 CDT 2017
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_orc_1000
17/04/11 01:20:49 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/11 01:20:49 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/11 01:20:49 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_orc_1000
Connected to: Spark SQL (version 2.1.0.2.6.0.3-8)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from ( select count(*) amc
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        from web_sales, household_demographics , time_dim, web_page
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        where ws_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_web_page_sk = web_page.wp_web_page_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and time_dim.t_hour between 6 and 6+1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and household_demographics.hd_dep_count = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and web_page.wp_char_count between 5000 and 5200) at,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       ( select count(*) pmc
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        from web_sales, household_demographics , time_dim, web_page
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        where ws_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_web_page_sk = web_page.wp_web_page_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and time_dim.t_hour between 14 and 14+1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and household_demographics.hd_dep_count = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and web_page.wp_char_count between 5000 and 5200) pt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  order by am_pm_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  limit 100;
Error: org.apache.spark.sql.AnalysisException: Detected cartesian product for INNER join between logical plans
Aggregate [count(1) AS amc#137566L]
+- Project
   +- Join Inner, (ws_web_page_sk#137581 = wp_web_page_sk#137618)
      :- Project [ws_web_page_sk#137581]
      :  +- Join Inner, (ws_sold_time_sk#137570 = t_time_sk#137608)
      :     :- Project [ws_sold_time_sk#137570, ws_web_page_sk#137581]
      :     :  +- Join Inner, (ws_ship_hdemo_sk#137579 = hd_demo_sk#137603)
      :     :     :- Project [ws_sold_time_sk#137570, ws_ship_hdemo_sk#137579, ws_web_page_sk#137581]
      :     :     :  +- Filter ((isnotnull(ws_ship_hdemo_sk#137579) && isnotnull(ws_sold_time_sk#137570)) && isnotnull(ws_web_page_sk#137581))
      :     :     :     +- MetastoreRelation tpcds_bin_partitioned_orc_1000, web_sales
      :     :     +- Project [hd_demo_sk#137603]
      :     :        +- Filter ((isnotnull(hd_dep_count#137606) && (hd_dep_count#137606 = 8)) && isnotnull(hd_demo_sk#137603))
      :     :           +- InMemoryRelation [hd_demo_sk#137603, hd_income_band_sk#137604, hd_buy_potential#137605, hd_dep_count#137606, hd_vehicle_count#137607], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
      :     :                 +- HiveTableScan [hd_demo_sk#1362, hd_income_band_sk#1363, hd_buy_potential#1364, hd_dep_count#1365, hd_vehicle_count#1366], MetastoreRelation tpcds_bin_partitioned_orc_1000, household_demographics
      :     +- Project [t_time_sk#137608]
      :        +- Filter ((isnotnull(t_hour#137611) && ((t_hour#137611 >= 6) && (t_hour#137611 <= 7))) && isnotnull(t_time_sk#137608))
      :           +- InMemoryRelation [t_time_sk#137608, t_time_id#137609, t_time#137610, t_hour#137611, t_minute#137612, t_second#137613, t_am_pm#137614, t_shift#137615, t_sub_shift#137616, t_meal_time#137617], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
      :                 +- HiveTableScan [t_time_sk#433, t_time_id#434, t_time#435, t_hour#436, t_minute#437, t_second#438, t_am_pm#439, t_shift#440, t_sub_shift#441, t_meal_time#442], MetastoreRelation tpcds_bin_partitioned_orc_1000, time_dim
      +- Project [wp_web_page_sk#137618]
         +- Filter ((isnotnull(wp_char_count#137628) && ((wp_char_count#137628 >= 5000) && (wp_char_count#137628 <= 5200))) && isnotnull(wp_web_page_sk#137618))
            +- InMemoryRelation [wp_web_page_sk#137618, wp_web_page_id#137619, wp_rec_start_date#137620, wp_rec_end_date#137621, wp_creation_date_sk#137622, wp_access_date_sk#137623, wp_autogen_flag#137624, wp_customer_sk#137625, wp_url#137626, wp_type#137627, wp_char_count#137628, wp_link_count#137629, wp_image_count#137630, wp_max_ad_count#137631], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `web_page`
                  +- HiveTableScan [wp_web_page_sk#3306, wp_web_page_id#3307, wp_rec_start_date#3308, wp_rec_end_date#3309, wp_creation_date_sk#3310, wp_access_date_sk#3311, wp_autogen_flag#3312, wp_customer_sk#3313, wp_url#3314, wp_type#3315, wp_char_count#3316, wp_link_count#3317, wp_image_count#3318, wp_max_ad_count#3319], MetastoreRelation tpcds_bin_partitioned_orc_1000, web_page
and
Aggregate [count(1) AS pmc#137567L]
+- Project
   +- Join Inner, (ws_web_page_sk#137644 = wp_web_page_sk#137681)
      :- Project [ws_web_page_sk#137644]
      :  +- Join Inner, (ws_sold_time_sk#137633 = t_time_sk#137671)
      :     :- Project [ws_sold_time_sk#137633, ws_web_page_sk#137644]
      :     :  +- Join Inner, (ws_ship_hdemo_sk#137642 = hd_demo_sk#137666)
      :     :     :- Project [ws_sold_time_sk#137633, ws_ship_hdemo_sk#137642, ws_web_page_sk#137644]
      :     :     :  +- Filter ((isnotnull(ws_ship_hdemo_sk#137642) && isnotnull(ws_sold_time_sk#137633)) && isnotnull(ws_web_page_sk#137644))
      :     :     :     +- MetastoreRelation tpcds_bin_partitioned_orc_1000, web_sales
      :     :     +- Project [hd_demo_sk#137666]
      :     :        +- Filter ((isnotnull(hd_dep_count#137669) && (hd_dep_count#137669 = 8)) && isnotnull(hd_demo_sk#137666))
      :     :           +- InMemoryRelation [hd_demo_sk#137666, hd_income_band_sk#137667, hd_buy_potential#137668, hd_dep_count#137669, hd_vehicle_count#137670], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
      :     :                 +- HiveTableScan [hd_demo_sk#1362, hd_income_band_sk#1363, hd_buy_potential#1364, hd_dep_count#1365, hd_vehicle_count#1366], MetastoreRelation tpcds_bin_partitioned_orc_1000, household_demographics
      :     +- Project [t_time_sk#137671]
      :        +- Filter ((isnotnull(t_hour#137674) && ((t_hour#137674 >= 14) && (t_hour#137674 <= 15))) && isnotnull(t_time_sk#137671))
      :           +- InMemoryRelation [t_time_sk#137671, t_time_id#137672, t_time#137673, t_hour#137674, t_minute#137675, t_second#137676, t_am_pm#137677, t_shift#137678, t_sub_shift#137679, t_meal_time#137680], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
      :                 +- HiveTableScan [t_time_sk#433, t_time_id#434, t_time#435, t_hour#436, t_minute#437, t_second#438, t_am_pm#439, t_shift#440, t_sub_shift#441, t_meal_time#442], MetastoreRelation tpcds_bin_partitioned_orc_1000, time_dim
      +- Project [wp_web_page_sk#137681]
         +- Filter ((isnotnull(wp_char_count#137691) && ((wp_char_count#137691 >= 5000) && (wp_char_count#137691 <= 5200))) && isnotnull(wp_web_page_sk#137681))
            +- InMemoryRelation [wp_web_page_sk#137681, wp_web_page_id#137682, wp_rec_start_date#137683, wp_rec_end_date#137684, wp_creation_date_sk#137685, wp_access_date_sk#137686, wp_autogen_flag#137687, wp_customer_sk#137688, wp_url#137689, wp_type#137690, wp_char_count#137691, wp_link_count#137692, wp_image_count#137693, wp_max_ad_count#137694], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `web_page`
                  +- HiveTableScan [wp_web_page_sk#3306, wp_web_page_id#3307, wp_rec_start_date#3308, wp_rec_end_date#3309, wp_creation_date_sk#3310, wp_access_date_sk#3311, wp_autogen_flag#3312, wp_customer_sk#3313, wp_url#3314, wp_type#3315, wp_char_count#3316, wp_link_count#3317, wp_image_count#3318, wp_max_ad_count#3319], MetastoreRelation tpcds_bin_partitioned_orc_1000, web_page
Join condition is missing or trivial.
Use the CROSS JOIN syntax to allow cartesian products between these relations.; (state=,code=0)

Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_orc_1000
STOP hdp2.6_spark21_run_1000_1_query90_sql_2017-04-11-01-20:  Tue Apr 11 01:20:50 CDT 2017
