START hdp2.6_spark21_run_1000_2_query88_sql_2017-04-08-21-34:  Sat Apr 8 21:34:05 CDT 2017
 /usr/hdp/current/spark2-client/bin/beeline -u "jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_$SF" -n hive --incremental=true  -i settings/spark.settings -f sample-queries-tpcds/$1
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
17/04/08 21:34:06 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/08 21:34:06 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/08 21:34:06 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
Connected to: Spark SQL (version 2.1.0.2.6.0.0-598)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  *
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> from
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h8_30_to_9
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk   
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s1,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h9_to_9_30 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 9 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s2,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h9_30_to_10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 9
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s3,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h10_to_10_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s4,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h10_30_to_11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s5,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h11_to_11_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s6,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h11_30_to_12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s7,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h12_to_12_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> ;
Error: org.apache.spark.sql.AnalysisException: Detected cartesian product for INNER join between logical plans
Join Inner
:- Join Inner
:  :- Join Inner
:  :  :- Join Inner
:  :  :  :- Join Inner
:  :  :  :  :- Join Inner
:  :  :  :  :  :- Aggregate [count(1) AS h8_30_to_9#112408L]
:  :  :  :  :  :  +- Project
:  :  :  :  :  :     +- Join Inner, (ss_store_sk#112423 = s_store_sk#112454)
:  :  :  :  :  :        :- Project [ss_store_sk#112423]
:  :  :  :  :  :        :  +- Join Inner, (ss_sold_time_sk#112417 = t_time_sk#112444)
:  :  :  :  :  :        :     :- Project [ss_sold_time_sk#112417, ss_store_sk#112423]
:  :  :  :  :  :        :     :  +- Join Inner, (ss_hdemo_sk#112421 = hd_demo_sk#112439)
:  :  :  :  :  :        :     :     :- Project [ss_sold_time_sk#112417, ss_hdemo_sk#112421, ss_store_sk#112423]
:  :  :  :  :  :        :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#112421) && isnotnull(ss_sold_time_sk#112417)) && isnotnull(ss_store_sk#112423))
:  :  :  :  :  :        :     :     :     +- Relation[ss_sold_time_sk#112417,ss_item_sk#112418,ss_customer_sk#112419,ss_cdemo_sk#112420,ss_hdemo_sk#112421,ss_addr_sk#112422,ss_store_sk#112423,ss_promo_sk#112424,ss_ticket_number#112425,ss_quantity#112426,ss_wholesale_cost#112427,ss_list_price#112428,ss_sales_price#112429,ss_ext_discount_amt#112430,ss_ext_sales_price#112431,ss_ext_wholesale_cost#112432,ss_ext_list_price#112433,ss_ext_tax#112434,ss_coupon_amt#112435,ss_net_paid#112436,ss_net_paid_inc_tax#112437,ss_net_profit#112438,ss_sold_date_sk#112416] parquet
:  :  :  :  :  :        :     :     +- Project [hd_demo_sk#112439]
:  :  :  :  :  :        :     :        +- Filter (((((hd_dep_count#112442 = 3) && (hd_vehicle_count#112443 <= 5)) || ((hd_dep_count#112442 = 0) && (hd_vehicle_count#112443 <= 2))) || ((hd_dep_count#112442 = 1) && (hd_vehicle_count#112443 <= 3))) && isnotnull(hd_demo_sk#112439))
:  :  :  :  :  :        :     :           +- Relation[hd_demo_sk#112439,hd_income_band_sk#112440,hd_buy_potential#112441,hd_dep_count#112442,hd_vehicle_count#112443] parquet
:  :  :  :  :  :        :     +- Project [t_time_sk#112444]
:  :  :  :  :  :        :        +- Filter (((isnotnull(t_hour#112447) && isnotnull(t_minute#112448)) && ((t_hour#112447 = 8) && (t_minute#112448 >= 30))) && isnotnull(t_time_sk#112444))
:  :  :  :  :  :        :           +- Relation[t_time_sk#112444,t_time_id#112445,t_time#112446,t_hour#112447,t_minute#112448,t_second#112449,t_am_pm#112450,t_shift#112451,t_sub_shift#112452,t_meal_time#112453] parquet
:  :  :  :  :  :        +- Project [s_store_sk#112454]
:  :  :  :  :  :           +- Filter ((isnotnull(s_store_name#112459) && (s_store_name#112459 = ese)) && isnotnull(s_store_sk#112454))
:  :  :  :  :  :              +- Relation[s_store_sk#112454,s_store_id#112455,s_rec_start_date#112456,s_rec_end_date#112457,s_closed_date_sk#112458,s_store_name#112459,s_number_employees#112460,s_floor_space#112461,s_hours#112462,s_manager#112463,s_market_id#112464,s_geography_class#112465,s_market_desc#112466,s_market_manager#112467,s_division_id#112468,s_division_name#112469,s_company_id#112470,s_company_name#112471,s_street_number#112472,s_street_name#112473,s_street_type#112474,s_suite_number#112475,s_city#112476,s_county#112477,... 5 more fields] parquet
:  :  :  :  :  +- Aggregate [count(1) AS h9_to_9_30#112409L]
:  :  :  :  :     +- Project
:  :  :  :  :        +- Join Inner, (ss_store_sk#112490 = s_store_sk#112521)
:  :  :  :  :           :- Project [ss_store_sk#112490]
:  :  :  :  :           :  +- Join Inner, (ss_sold_time_sk#112484 = t_time_sk#112511)
:  :  :  :  :           :     :- Project [ss_sold_time_sk#112484, ss_store_sk#112490]
:  :  :  :  :           :     :  +- Join Inner, (ss_hdemo_sk#112488 = hd_demo_sk#112506)
:  :  :  :  :           :     :     :- Project [ss_sold_time_sk#112484, ss_hdemo_sk#112488, ss_store_sk#112490]
:  :  :  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#112488) && isnotnull(ss_sold_time_sk#112484)) && isnotnull(ss_store_sk#112490))
:  :  :  :  :           :     :     :     +- Relation[ss_sold_time_sk#112484,ss_item_sk#112485,ss_customer_sk#112486,ss_cdemo_sk#112487,ss_hdemo_sk#112488,ss_addr_sk#112489,ss_store_sk#112490,ss_promo_sk#112491,ss_ticket_number#112492,ss_quantity#112493,ss_wholesale_cost#112494,ss_list_price#112495,ss_sales_price#112496,ss_ext_discount_amt#112497,ss_ext_sales_price#112498,ss_ext_wholesale_cost#112499,ss_ext_list_price#112500,ss_ext_tax#112501,ss_coupon_amt#112502,ss_net_paid#112503,ss_net_paid_inc_tax#112504,ss_net_profit#112505,ss_sold_date_sk#112483] parquet
:  :  :  :  :           :     :     +- Project [hd_demo_sk#112506]
:  :  :  :  :           :     :        +- Filter (((((hd_dep_count#112509 = 3) && (hd_vehicle_count#112510 <= 5)) || ((hd_dep_count#112509 = 0) && (hd_vehicle_count#112510 <= 2))) || ((hd_dep_count#112509 = 1) && (hd_vehicle_count#112510 <= 3))) && isnotnull(hd_demo_sk#112506))
:  :  :  :  :           :     :           +- Relation[hd_demo_sk#112506,hd_income_band_sk#112507,hd_buy_potential#112508,hd_dep_count#112509,hd_vehicle_count#112510] parquet
:  :  :  :  :           :     +- Project [t_time_sk#112511]
:  :  :  :  :           :        +- Filter (((isnotnull(t_hour#112514) && isnotnull(t_minute#112515)) && ((t_hour#112514 = 9) && (t_minute#112515 < 30))) && isnotnull(t_time_sk#112511))
:  :  :  :  :           :           +- Relation[t_time_sk#112511,t_time_id#112512,t_time#112513,t_hour#112514,t_minute#112515,t_second#112516,t_am_pm#112517,t_shift#112518,t_sub_shift#112519,t_meal_time#112520] parquet
:  :  :  :  :           +- Project [s_store_sk#112521]
:  :  :  :  :              +- Filter ((isnotnull(s_store_name#112526) && (s_store_name#112526 = ese)) && isnotnull(s_store_sk#112521))
:  :  :  :  :                 +- Relation[s_store_sk#112521,s_store_id#112522,s_rec_start_date#112523,s_rec_end_date#112524,s_closed_date_sk#112525,s_store_name#112526,s_number_employees#112527,s_floor_space#112528,s_hours#112529,s_manager#112530,s_market_id#112531,s_geography_class#112532,s_market_desc#112533,s_market_manager#112534,s_division_id#112535,s_division_name#112536,s_company_id#112537,s_company_name#112538,s_street_number#112539,s_street_name#112540,s_street_type#112541,s_suite_number#112542,s_city#112543,s_county#112544,... 5 more fields] parquet
:  :  :  :  +- Aggregate [count(1) AS h9_30_to_10#112410L]
:  :  :  :     +- Project
:  :  :  :        +- Join Inner, (ss_store_sk#112557 = s_store_sk#112588)
:  :  :  :           :- Project [ss_store_sk#112557]
:  :  :  :           :  +- Join Inner, (ss_sold_time_sk#112551 = t_time_sk#112578)
:  :  :  :           :     :- Project [ss_sold_time_sk#112551, ss_store_sk#112557]
:  :  :  :           :     :  +- Join Inner, (ss_hdemo_sk#112555 = hd_demo_sk#112573)
:  :  :  :           :     :     :- Project [ss_sold_time_sk#112551, ss_hdemo_sk#112555, ss_store_sk#112557]
:  :  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#112555) && isnotnull(ss_sold_time_sk#112551)) && isnotnull(ss_store_sk#112557))
:  :  :  :           :     :     :     +- Relation[ss_sold_time_sk#112551,ss_item_sk#112552,ss_customer_sk#112553,ss_cdemo_sk#112554,ss_hdemo_sk#112555,ss_addr_sk#112556,ss_store_sk#112557,ss_promo_sk#112558,ss_ticket_number#112559,ss_quantity#112560,ss_wholesale_cost#112561,ss_list_price#112562,ss_sales_price#112563,ss_ext_discount_amt#112564,ss_ext_sales_price#112565,ss_ext_wholesale_cost#112566,ss_ext_list_price#112567,ss_ext_tax#112568,ss_coupon_amt#112569,ss_net_paid#112570,ss_net_paid_inc_tax#112571,ss_net_profit#112572,ss_sold_date_sk#112550] parquet
:  :  :  :           :     :     +- Project [hd_demo_sk#112573]
:  :  :  :           :     :        +- Filter (((((hd_dep_count#112576 = 3) && (hd_vehicle_count#112577 <= 5)) || ((hd_dep_count#112576 = 0) && (hd_vehicle_count#112577 <= 2))) || ((hd_dep_count#112576 = 1) && (hd_vehicle_count#112577 <= 3))) && isnotnull(hd_demo_sk#112573))
:  :  :  :           :     :           +- Relation[hd_demo_sk#112573,hd_income_band_sk#112574,hd_buy_potential#112575,hd_dep_count#112576,hd_vehicle_count#112577] parquet
:  :  :  :           :     +- Project [t_time_sk#112578]
:  :  :  :           :        +- Filter (((isnotnull(t_hour#112581) && isnotnull(t_minute#112582)) && ((t_hour#112581 = 9) && (t_minute#112582 >= 30))) && isnotnull(t_time_sk#112578))
:  :  :  :           :           +- Relation[t_time_sk#112578,t_time_id#112579,t_time#112580,t_hour#112581,t_minute#112582,t_second#112583,t_am_pm#112584,t_shift#112585,t_sub_shift#112586,t_meal_time#112587] parquet
:  :  :  :           +- Project [s_store_sk#112588]
:  :  :  :              +- Filter ((isnotnull(s_store_name#112593) && (s_store_name#112593 = ese)) && isnotnull(s_store_sk#112588))
:  :  :  :                 +- Relation[s_store_sk#112588,s_store_id#112589,s_rec_start_date#112590,s_rec_end_date#112591,s_closed_date_sk#112592,s_store_name#112593,s_number_employees#112594,s_floor_space#112595,s_hours#112596,s_manager#112597,s_market_id#112598,s_geography_class#112599,s_market_desc#112600,s_market_manager#112601,s_division_id#112602,s_division_name#112603,s_company_id#112604,s_company_name#112605,s_street_number#112606,s_street_name#112607,s_street_type#112608,s_suite_number#112609,s_city#112610,s_county#112611,... 5 more fields] parquet
:  :  :  +- Aggregate [count(1) AS h10_to_10_30#112411L]
:  :  :     +- Project
:  :  :        +- Join Inner, (ss_store_sk#112624 = s_store_sk#112655)
:  :  :           :- Project [ss_store_sk#112624]
:  :  :           :  +- Join Inner, (ss_sold_time_sk#112618 = t_time_sk#112645)
:  :  :           :     :- Project [ss_sold_time_sk#112618, ss_store_sk#112624]
:  :  :           :     :  +- Join Inner, (ss_hdemo_sk#112622 = hd_demo_sk#112640)
:  :  :           :     :     :- Project [ss_sold_time_sk#112618, ss_hdemo_sk#112622, ss_store_sk#112624]
:  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#112622) && isnotnull(ss_sold_time_sk#112618)) && isnotnull(ss_store_sk#112624))
:  :  :           :     :     :     +- Relation[ss_sold_time_sk#112618,ss_item_sk#112619,ss_customer_sk#112620,ss_cdemo_sk#112621,ss_hdemo_sk#112622,ss_addr_sk#112623,ss_store_sk#112624,ss_promo_sk#112625,ss_ticket_number#112626,ss_quantity#112627,ss_wholesale_cost#112628,ss_list_price#112629,ss_sales_price#112630,ss_ext_discount_amt#112631,ss_ext_sales_price#112632,ss_ext_wholesale_cost#112633,ss_ext_list_price#112634,ss_ext_tax#112635,ss_coupon_amt#112636,ss_net_paid#112637,ss_net_paid_inc_tax#112638,ss_net_profit#112639,ss_sold_date_sk#112617] parquet
:  :  :           :     :     +- Project [hd_demo_sk#112640]
:  :  :           :     :        +- Filter (((((hd_dep_count#112643 = 3) && (hd_vehicle_count#112644 <= 5)) || ((hd_dep_count#112643 = 0) && (hd_vehicle_count#112644 <= 2))) || ((hd_dep_count#112643 = 1) && (hd_vehicle_count#112644 <= 3))) && isnotnull(hd_demo_sk#112640))
:  :  :           :     :           +- Relation[hd_demo_sk#112640,hd_income_band_sk#112641,hd_buy_potential#112642,hd_dep_count#112643,hd_vehicle_count#112644] parquet
:  :  :           :     +- Project [t_time_sk#112645]
:  :  :           :        +- Filter (((isnotnull(t_hour#112648) && isnotnull(t_minute#112649)) && ((t_hour#112648 = 10) && (t_minute#112649 < 30))) && isnotnull(t_time_sk#112645))
:  :  :           :           +- Relation[t_time_sk#112645,t_time_id#112646,t_time#112647,t_hour#112648,t_minute#112649,t_second#112650,t_am_pm#112651,t_shift#112652,t_sub_shift#112653,t_meal_time#112654] parquet
:  :  :           +- Project [s_store_sk#112655]
:  :  :              +- Filter ((isnotnull(s_store_name#112660) && (s_store_name#112660 = ese)) && isnotnull(s_store_sk#112655))
:  :  :                 +- Relation[s_store_sk#112655,s_store_id#112656,s_rec_start_date#112657,s_rec_end_date#112658,s_closed_date_sk#112659,s_store_name#112660,s_number_employees#112661,s_floor_space#112662,s_hours#112663,s_manager#112664,s_market_id#112665,s_geography_class#112666,s_market_desc#112667,s_market_manager#112668,s_division_id#112669,s_division_name#112670,s_company_id#112671,s_company_name#112672,s_street_number#112673,s_street_name#112674,s_street_type#112675,s_suite_number#112676,s_city#112677,s_county#112678,... 5 more fields] parquet
:  :  +- Aggregate [count(1) AS h10_30_to_11#112412L]
:  :     +- Project
:  :        +- Join Inner, (ss_store_sk#112691 = s_store_sk#112722)
:  :           :- Project [ss_store_sk#112691]
:  :           :  +- Join Inner, (ss_sold_time_sk#112685 = t_time_sk#112712)
:  :           :     :- Project [ss_sold_time_sk#112685, ss_store_sk#112691]
:  :           :     :  +- Join Inner, (ss_hdemo_sk#112689 = hd_demo_sk#112707)
:  :           :     :     :- Project [ss_sold_time_sk#112685, ss_hdemo_sk#112689, ss_store_sk#112691]
:  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#112689) && isnotnull(ss_sold_time_sk#112685)) && isnotnull(ss_store_sk#112691))
:  :           :     :     :     +- Relation[ss_sold_time_sk#112685,ss_item_sk#112686,ss_customer_sk#112687,ss_cdemo_sk#112688,ss_hdemo_sk#112689,ss_addr_sk#112690,ss_store_sk#112691,ss_promo_sk#112692,ss_ticket_number#112693,ss_quantity#112694,ss_wholesale_cost#112695,ss_list_price#112696,ss_sales_price#112697,ss_ext_discount_amt#112698,ss_ext_sales_price#112699,ss_ext_wholesale_cost#112700,ss_ext_list_price#112701,ss_ext_tax#112702,ss_coupon_amt#112703,ss_net_paid#112704,ss_net_paid_inc_tax#112705,ss_net_profit#112706,ss_sold_date_sk#112684] parquet
:  :           :     :     +- Project [hd_demo_sk#112707]
:  :           :     :        +- Filter (((((hd_dep_count#112710 = 3) && (hd_vehicle_count#112711 <= 5)) || ((hd_dep_count#112710 = 0) && (hd_vehicle_count#112711 <= 2))) || ((hd_dep_count#112710 = 1) && (hd_vehicle_count#112711 <= 3))) && isnotnull(hd_demo_sk#112707))
:  :           :     :           +- Relation[hd_demo_sk#112707,hd_income_band_sk#112708,hd_buy_potential#112709,hd_dep_count#112710,hd_vehicle_count#112711] parquet
:  :           :     +- Project [t_time_sk#112712]
:  :           :        +- Filter (((isnotnull(t_hour#112715) && isnotnull(t_minute#112716)) && ((t_hour#112715 = 10) && (t_minute#112716 >= 30))) && isnotnull(t_time_sk#112712))
:  :           :           +- Relation[t_time_sk#112712,t_time_id#112713,t_time#112714,t_hour#112715,t_minute#112716,t_second#112717,t_am_pm#112718,t_shift#112719,t_sub_shift#112720,t_meal_time#112721] parquet
:  :           +- Project [s_store_sk#112722]
:  :              +- Filter ((isnotnull(s_store_name#112727) && (s_store_name#112727 = ese)) && isnotnull(s_store_sk#112722))
:  :                 +- Relation[s_store_sk#112722,s_store_id#112723,s_rec_start_date#112724,s_rec_end_date#112725,s_closed_date_sk#112726,s_store_name#112727,s_number_employees#112728,s_floor_space#112729,s_hours#112730,s_manager#112731,s_market_id#112732,s_geography_class#112733,s_market_desc#112734,s_market_manager#112735,s_division_id#112736,s_division_name#112737,s_company_id#112738,s_company_name#112739,s_street_number#112740,s_street_name#112741,s_street_type#112742,s_suite_number#112743,s_city#112744,s_county#112745,... 5 more fields] parquet
:  +- Aggregate [count(1) AS h11_to_11_30#112413L]
:     +- Project
:        +- Join Inner, (ss_store_sk#112758 = s_store_sk#112789)
:           :- Project [ss_store_sk#112758]
:           :  +- Join Inner, (ss_sold_time_sk#112752 = t_time_sk#112779)
:           :     :- Project [ss_sold_time_sk#112752, ss_store_sk#112758]
:           :     :  +- Join Inner, (ss_hdemo_sk#112756 = hd_demo_sk#112774)
:           :     :     :- Project [ss_sold_time_sk#112752, ss_hdemo_sk#112756, ss_store_sk#112758]
:           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#112756) && isnotnull(ss_sold_time_sk#112752)) && isnotnull(ss_store_sk#112758))
:           :     :     :     +- Relation[ss_sold_time_sk#112752,ss_item_sk#112753,ss_customer_sk#112754,ss_cdemo_sk#112755,ss_hdemo_sk#112756,ss_addr_sk#112757,ss_store_sk#112758,ss_promo_sk#112759,ss_ticket_number#112760,ss_quantity#112761,ss_wholesale_cost#112762,ss_list_price#112763,ss_sales_price#112764,ss_ext_discount_amt#112765,ss_ext_sales_price#112766,ss_ext_wholesale_cost#112767,ss_ext_list_price#112768,ss_ext_tax#112769,ss_coupon_amt#112770,ss_net_paid#112771,ss_net_paid_inc_tax#112772,ss_net_profit#112773,ss_sold_date_sk#112751] parquet
:           :     :     +- Project [hd_demo_sk#112774]
:           :     :        +- Filter (((((hd_dep_count#112777 = 3) && (hd_vehicle_count#112778 <= 5)) || ((hd_dep_count#112777 = 0) && (hd_vehicle_count#112778 <= 2))) || ((hd_dep_count#112777 = 1) && (hd_vehicle_count#112778 <= 3))) && isnotnull(hd_demo_sk#112774))
:           :     :           +- Relation[hd_demo_sk#112774,hd_income_band_sk#112775,hd_buy_potential#112776,hd_dep_count#112777,hd_vehicle_count#112778] parquet
:           :     +- Project [t_time_sk#112779]
:           :        +- Filter (((isnotnull(t_hour#112782) && isnotnull(t_minute#112783)) && ((t_hour#112782 = 11) && (t_minute#112783 < 30))) && isnotnull(t_time_sk#112779))
:           :           +- Relation[t_time_sk#112779,t_time_id#112780,t_time#112781,t_hour#112782,t_minute#112783,t_second#112784,t_am_pm#112785,t_shift#112786,t_sub_shift#112787,t_meal_time#112788] parquet
:           +- Project [s_store_sk#112789]
:              +- Filter ((isnotnull(s_store_name#112794) && (s_store_name#112794 = ese)) && isnotnull(s_store_sk#112789))
:                 +- Relation[s_store_sk#112789,s_store_id#112790,s_rec_start_date#112791,s_rec_end_date#112792,s_closed_date_sk#112793,s_store_name#112794,s_number_employees#112795,s_floor_space#112796,s_hours#112797,s_manager#112798,s_market_id#112799,s_geography_class#112800,s_market_desc#112801,s_market_manager#112802,s_division_id#112803,s_division_name#112804,s_company_id#112805,s_company_name#112806,s_street_number#112807,s_street_name#112808,s_street_type#112809,s_suite_number#112810,s_city#112811,s_county#112812,... 5 more fields] parquet
+- Aggregate [count(1) AS h11_30_to_12#112414L]
   +- Project
      +- Join Inner, (ss_store_sk#112825 = s_store_sk#112856)
         :- Project [ss_store_sk#112825]
         :  +- Join Inner, (ss_sold_time_sk#112819 = t_time_sk#112846)
         :     :- Project [ss_sold_time_sk#112819, ss_store_sk#112825]
         :     :  +- Join Inner, (ss_hdemo_sk#112823 = hd_demo_sk#112841)
         :     :     :- Project [ss_sold_time_sk#112819, ss_hdemo_sk#112823, ss_store_sk#112825]
         :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#112823) && isnotnull(ss_sold_time_sk#112819)) && isnotnull(ss_store_sk#112825))
         :     :     :     +- Relation[ss_sold_time_sk#112819,ss_item_sk#112820,ss_customer_sk#112821,ss_cdemo_sk#112822,ss_hdemo_sk#112823,ss_addr_sk#112824,ss_store_sk#112825,ss_promo_sk#112826,ss_ticket_number#112827,ss_quantity#112828,ss_wholesale_cost#112829,ss_list_price#112830,ss_sales_price#112831,ss_ext_discount_amt#112832,ss_ext_sales_price#112833,ss_ext_wholesale_cost#112834,ss_ext_list_price#112835,ss_ext_tax#112836,ss_coupon_amt#112837,ss_net_paid#112838,ss_net_paid_inc_tax#112839,ss_net_profit#112840,ss_sold_date_sk#112818] parquet
         :     :     +- Project [hd_demo_sk#112841]
         :     :        +- Filter (((((hd_dep_count#112844 = 3) && (hd_vehicle_count#112845 <= 5)) || ((hd_dep_count#112844 = 0) && (hd_vehicle_count#112845 <= 2))) || ((hd_dep_count#112844 = 1) && (hd_vehicle_count#112845 <= 3))) && isnotnull(hd_demo_sk#112841))
         :     :           +- Relation[hd_demo_sk#112841,hd_income_band_sk#112842,hd_buy_potential#112843,hd_dep_count#112844,hd_vehicle_count#112845] parquet
         :     +- Project [t_time_sk#112846]
         :        +- Filter (((isnotnull(t_hour#112849) && isnotnull(t_minute#112850)) && ((t_hour#112849 = 11) && (t_minute#112850 >= 30))) && isnotnull(t_time_sk#112846))
         :           +- Relation[t_time_sk#112846,t_time_id#112847,t_time#112848,t_hour#112849,t_minute#112850,t_second#112851,t_am_pm#112852,t_shift#112853,t_sub_shift#112854,t_meal_time#112855] parquet
         +- Project [s_store_sk#112856]
            +- Filter ((isnotnull(s_store_name#112861) && (s_store_name#112861 = ese)) && isnotnull(s_store_sk#112856))
               +- Relation[s_store_sk#112856,s_store_id#112857,s_rec_start_date#112858,s_rec_end_date#112859,s_closed_date_sk#112860,s_store_name#112861,s_number_employees#112862,s_floor_space#112863,s_hours#112864,s_manager#112865,s_market_id#112866,s_geography_class#112867,s_market_desc#112868,s_market_manager#112869,s_division_id#112870,s_division_name#112871,s_company_id#112872,s_company_name#112873,s_street_number#112874,s_street_name#112875,s_street_type#112876,s_suite_number#112877,s_city#112878,s_county#112879,... 5 more fields] parquet
and
Aggregate [count(1) AS h12_to_12_30#112415L]
+- Project
   +- Join Inner, (ss_store_sk#112892 = s_store_sk#112923)
      :- Project [ss_store_sk#112892]
      :  +- Join Inner, (ss_sold_time_sk#112886 = t_time_sk#112913)
      :     :- Project [ss_sold_time_sk#112886, ss_store_sk#112892]
      :     :  +- Join Inner, (ss_hdemo_sk#112890 = hd_demo_sk#112908)
      :     :     :- Project [ss_sold_time_sk#112886, ss_hdemo_sk#112890, ss_store_sk#112892]
      :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#112890) && isnotnull(ss_sold_time_sk#112886)) && isnotnull(ss_store_sk#112892))
      :     :     :     +- Relation[ss_sold_time_sk#112886,ss_item_sk#112887,ss_customer_sk#112888,ss_cdemo_sk#112889,ss_hdemo_sk#112890,ss_addr_sk#112891,ss_store_sk#112892,ss_promo_sk#112893,ss_ticket_number#112894,ss_quantity#112895,ss_wholesale_cost#112896,ss_list_price#112897,ss_sales_price#112898,ss_ext_discount_amt#112899,ss_ext_sales_price#112900,ss_ext_wholesale_cost#112901,ss_ext_list_price#112902,ss_ext_tax#112903,ss_coupon_amt#112904,ss_net_paid#112905,ss_net_paid_inc_tax#112906,ss_net_profit#112907,ss_sold_date_sk#112885] parquet
      :     :     +- Project [hd_demo_sk#112908]
      :     :        +- Filter (((((hd_dep_count#112911 = 3) && (hd_vehicle_count#112912 <= 5)) || ((hd_dep_count#112911 = 0) && (hd_vehicle_count#112912 <= 2))) || ((hd_dep_count#112911 = 1) && (hd_vehicle_count#112912 <= 3))) && isnotnull(hd_demo_sk#112908))
      :     :           +- Relation[hd_demo_sk#112908,hd_income_band_sk#112909,hd_buy_potential#112910,hd_dep_count#112911,hd_vehicle_count#112912] parquet
      :     +- Project [t_time_sk#112913]
      :        +- Filter (((isnotnull(t_hour#112916) && isnotnull(t_minute#112917)) && ((t_hour#112916 = 12) && (t_minute#112917 < 30))) && isnotnull(t_time_sk#112913))
      :           +- Relation[t_time_sk#112913,t_time_id#112914,t_time#112915,t_hour#112916,t_minute#112917,t_second#112918,t_am_pm#112919,t_shift#112920,t_sub_shift#112921,t_meal_time#112922] parquet
      +- Project [s_store_sk#112923]
         +- Filter ((isnotnull(s_store_name#112928) && (s_store_name#112928 = ese)) && isnotnull(s_store_sk#112923))
            +- Relation[s_store_sk#112923,s_store_id#112924,s_rec_start_date#112925,s_rec_end_date#112926,s_closed_date_sk#112927,s_store_name#112928,s_number_employees#112929,s_floor_space#112930,s_hours#112931,s_manager#112932,s_market_id#112933,s_geography_class#112934,s_market_desc#112935,s_market_manager#112936,s_division_id#112937,s_division_name#112938,s_company_id#112939,s_company_name#112940,s_street_number#112941,s_street_name#112942,s_street_type#112943,s_suite_number#112944,s_city#112945,s_county#112946,... 5 more fields] parquet
Join condition is missing or trivial.
Use the CROSS JOIN syntax to allow cartesian products between these relations.; (state=,code=0)

Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
STOP hdp2.6_spark21_run_1000_2_query88_sql_2017-04-08-21-34:  Sat Apr 8 21:34:10 CDT 2017
