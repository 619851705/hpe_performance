START hdp2.6_spark21_run_1000_2_query90_sql_2017-04-08-21-34:  Sat Apr 8 21:34:33 CDT 2017
 /usr/hdp/current/spark2-client/bin/beeline -u "jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_$SF" -n hive --incremental=true  -i settings/spark.settings -f sample-queries-tpcds/$1
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
17/04/08 21:34:33 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/08 21:34:33 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/08 21:34:33 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
Connected to: Spark SQL (version 2.1.0.2.6.0.0-598)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from ( select count(*) amc
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        from web_sales, household_demographics , time_dim, web_page
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        where ws_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_web_page_sk = web_page.wp_web_page_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and time_dim.t_hour between 6 and 6+1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and household_demographics.hd_dep_count = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and web_page.wp_char_count between 5000 and 5200) at,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       ( select count(*) pmc
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        from web_sales, household_demographics , time_dim, web_page
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        where ws_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_web_page_sk = web_page.wp_web_page_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and time_dim.t_hour between 14 and 14+1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and household_demographics.hd_dep_count = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and web_page.wp_char_count between 5000 and 5200) pt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  order by am_pm_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  limit 100;
Error: org.apache.spark.sql.AnalysisException: Detected cartesian product for INNER join between logical plans
Aggregate [count(1) AS amc#116155L]
+- Project
   +- Join Inner, (ws_web_page_sk#116170 = wp_web_page_sk#116207)
      :- Project [ws_web_page_sk#116170]
      :  +- Join Inner, (ws_sold_time_sk#116159 = t_time_sk#116197)
      :     :- Project [ws_sold_time_sk#116159, ws_web_page_sk#116170]
      :     :  +- Join Inner, (ws_ship_hdemo_sk#116168 = hd_demo_sk#116192)
      :     :     :- Project [ws_sold_time_sk#116159, ws_ship_hdemo_sk#116168, ws_web_page_sk#116170]
      :     :     :  +- Filter ((isnotnull(ws_ship_hdemo_sk#116168) && isnotnull(ws_sold_time_sk#116159)) && isnotnull(ws_web_page_sk#116170))
      :     :     :     +- Relation[ws_sold_time_sk#116159,ws_ship_date_sk#116160,ws_item_sk#116161,ws_bill_customer_sk#116162,ws_bill_cdemo_sk#116163,ws_bill_hdemo_sk#116164,ws_bill_addr_sk#116165,ws_ship_customer_sk#116166,ws_ship_cdemo_sk#116167,ws_ship_hdemo_sk#116168,ws_ship_addr_sk#116169,ws_web_page_sk#116170,ws_web_site_sk#116171,ws_ship_mode_sk#116172,ws_warehouse_sk#116173,ws_promo_sk#116174,ws_order_number#116175,ws_quantity#116176,ws_wholesale_cost#116177,ws_list_price#116178,ws_sales_price#116179,ws_ext_discount_amt#116180,ws_ext_sales_price#116181,ws_ext_wholesale_cost#116182,... 10 more fields] parquet
      :     :     +- Project [hd_demo_sk#116192]
      :     :        +- Filter ((isnotnull(hd_dep_count#116195) && (hd_dep_count#116195 = 8)) && isnotnull(hd_demo_sk#116192))
      :     :           +- Relation[hd_demo_sk#116192,hd_income_band_sk#116193,hd_buy_potential#116194,hd_dep_count#116195,hd_vehicle_count#116196] parquet
      :     +- Project [t_time_sk#116197]
      :        +- Filter ((isnotnull(t_hour#116200) && ((t_hour#116200 >= 6) && (t_hour#116200 <= 7))) && isnotnull(t_time_sk#116197))
      :           +- Relation[t_time_sk#116197,t_time_id#116198,t_time#116199,t_hour#116200,t_minute#116201,t_second#116202,t_am_pm#116203,t_shift#116204,t_sub_shift#116205,t_meal_time#116206] parquet
      +- Project [wp_web_page_sk#116207]
         +- Filter ((isnotnull(wp_char_count#116217) && ((wp_char_count#116217 >= 5000) && (wp_char_count#116217 <= 5200))) && isnotnull(wp_web_page_sk#116207))
            +- Relation[wp_web_page_sk#116207,wp_web_page_id#116208,wp_rec_start_date#116209,wp_rec_end_date#116210,wp_creation_date_sk#116211,wp_access_date_sk#116212,wp_autogen_flag#116213,wp_customer_sk#116214,wp_url#116215,wp_type#116216,wp_char_count#116217,wp_link_count#116218,wp_image_count#116219,wp_max_ad_count#116220] parquet
and
Aggregate [count(1) AS pmc#116156L]
+- Project
   +- Join Inner, (ws_web_page_sk#116233 = wp_web_page_sk#116270)
      :- Project [ws_web_page_sk#116233]
      :  +- Join Inner, (ws_sold_time_sk#116222 = t_time_sk#116260)
      :     :- Project [ws_sold_time_sk#116222, ws_web_page_sk#116233]
      :     :  +- Join Inner, (ws_ship_hdemo_sk#116231 = hd_demo_sk#116255)
      :     :     :- Project [ws_sold_time_sk#116222, ws_ship_hdemo_sk#116231, ws_web_page_sk#116233]
      :     :     :  +- Filter ((isnotnull(ws_ship_hdemo_sk#116231) && isnotnull(ws_sold_time_sk#116222)) && isnotnull(ws_web_page_sk#116233))
      :     :     :     +- Relation[ws_sold_time_sk#116222,ws_ship_date_sk#116223,ws_item_sk#116224,ws_bill_customer_sk#116225,ws_bill_cdemo_sk#116226,ws_bill_hdemo_sk#116227,ws_bill_addr_sk#116228,ws_ship_customer_sk#116229,ws_ship_cdemo_sk#116230,ws_ship_hdemo_sk#116231,ws_ship_addr_sk#116232,ws_web_page_sk#116233,ws_web_site_sk#116234,ws_ship_mode_sk#116235,ws_warehouse_sk#116236,ws_promo_sk#116237,ws_order_number#116238,ws_quantity#116239,ws_wholesale_cost#116240,ws_list_price#116241,ws_sales_price#116242,ws_ext_discount_amt#116243,ws_ext_sales_price#116244,ws_ext_wholesale_cost#116245,... 10 more fields] parquet
      :     :     +- Project [hd_demo_sk#116255]
      :     :        +- Filter ((isnotnull(hd_dep_count#116258) && (hd_dep_count#116258 = 8)) && isnotnull(hd_demo_sk#116255))
      :     :           +- Relation[hd_demo_sk#116255,hd_income_band_sk#116256,hd_buy_potential#116257,hd_dep_count#116258,hd_vehicle_count#116259] parquet
      :     +- Project [t_time_sk#116260]
      :        +- Filter ((isnotnull(t_hour#116263) && ((t_hour#116263 >= 14) && (t_hour#116263 <= 15))) && isnotnull(t_time_sk#116260))
      :           +- Relation[t_time_sk#116260,t_time_id#116261,t_time#116262,t_hour#116263,t_minute#116264,t_second#116265,t_am_pm#116266,t_shift#116267,t_sub_shift#116268,t_meal_time#116269] parquet
      +- Project [wp_web_page_sk#116270]
         +- Filter ((isnotnull(wp_char_count#116280) && ((wp_char_count#116280 >= 5000) && (wp_char_count#116280 <= 5200))) && isnotnull(wp_web_page_sk#116270))
            +- Relation[wp_web_page_sk#116270,wp_web_page_id#116271,wp_rec_start_date#116272,wp_rec_end_date#116273,wp_creation_date_sk#116274,wp_access_date_sk#116275,wp_autogen_flag#116276,wp_customer_sk#116277,wp_url#116278,wp_type#116279,wp_char_count#116280,wp_link_count#116281,wp_image_count#116282,wp_max_ad_count#116283] parquet
Join condition is missing or trivial.
Use the CROSS JOIN syntax to allow cartesian products between these relations.; (state=,code=0)

Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
STOP hdp2.6_spark21_run_1000_2_query90_sql_2017-04-08-21-34:  Sat Apr 8 21:34:34 CDT 2017
