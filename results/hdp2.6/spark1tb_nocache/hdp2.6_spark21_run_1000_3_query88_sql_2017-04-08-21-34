START hdp2.6_spark21_run_1000_3_query88_sql_2017-04-08-21-34:  Sat Apr 8 21:34:10 CDT 2017
 /usr/hdp/current/spark2-client/bin/beeline -u "jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_$SF" -n hive --incremental=true  -i settings/spark.settings -f sample-queries-tpcds/$1
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
17/04/08 21:34:10 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/08 21:34:10 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/08 21:34:10 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
Connected to: Spark SQL (version 2.1.0.2.6.0.0-598)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  *
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> from
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h8_30_to_9
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk   
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s1,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h9_to_9_30 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 9 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s2,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h9_30_to_10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 9
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s3,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h10_to_10_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s4,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h10_30_to_11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s5,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h11_to_11_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s6,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h11_30_to_12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s7,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h12_to_12_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> ;
Error: org.apache.spark.sql.AnalysisException: Detected cartesian product for INNER join between logical plans
Join Inner
:- Join Inner
:  :- Join Inner
:  :  :- Join Inner
:  :  :  :- Join Inner
:  :  :  :  :- Join Inner
:  :  :  :  :  :- Aggregate [count(1) AS h8_30_to_9#113582L]
:  :  :  :  :  :  +- Project
:  :  :  :  :  :     +- Join Inner, (ss_store_sk#113597 = s_store_sk#113628)
:  :  :  :  :  :        :- Project [ss_store_sk#113597]
:  :  :  :  :  :        :  +- Join Inner, (ss_sold_time_sk#113591 = t_time_sk#113618)
:  :  :  :  :  :        :     :- Project [ss_sold_time_sk#113591, ss_store_sk#113597]
:  :  :  :  :  :        :     :  +- Join Inner, (ss_hdemo_sk#113595 = hd_demo_sk#113613)
:  :  :  :  :  :        :     :     :- Project [ss_sold_time_sk#113591, ss_hdemo_sk#113595, ss_store_sk#113597]
:  :  :  :  :  :        :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#113595) && isnotnull(ss_sold_time_sk#113591)) && isnotnull(ss_store_sk#113597))
:  :  :  :  :  :        :     :     :     +- Relation[ss_sold_time_sk#113591,ss_item_sk#113592,ss_customer_sk#113593,ss_cdemo_sk#113594,ss_hdemo_sk#113595,ss_addr_sk#113596,ss_store_sk#113597,ss_promo_sk#113598,ss_ticket_number#113599,ss_quantity#113600,ss_wholesale_cost#113601,ss_list_price#113602,ss_sales_price#113603,ss_ext_discount_amt#113604,ss_ext_sales_price#113605,ss_ext_wholesale_cost#113606,ss_ext_list_price#113607,ss_ext_tax#113608,ss_coupon_amt#113609,ss_net_paid#113610,ss_net_paid_inc_tax#113611,ss_net_profit#113612,ss_sold_date_sk#113590] parquet
:  :  :  :  :  :        :     :     +- Project [hd_demo_sk#113613]
:  :  :  :  :  :        :     :        +- Filter (((((hd_dep_count#113616 = 3) && (hd_vehicle_count#113617 <= 5)) || ((hd_dep_count#113616 = 0) && (hd_vehicle_count#113617 <= 2))) || ((hd_dep_count#113616 = 1) && (hd_vehicle_count#113617 <= 3))) && isnotnull(hd_demo_sk#113613))
:  :  :  :  :  :        :     :           +- Relation[hd_demo_sk#113613,hd_income_band_sk#113614,hd_buy_potential#113615,hd_dep_count#113616,hd_vehicle_count#113617] parquet
:  :  :  :  :  :        :     +- Project [t_time_sk#113618]
:  :  :  :  :  :        :        +- Filter (((isnotnull(t_hour#113621) && isnotnull(t_minute#113622)) && ((t_hour#113621 = 8) && (t_minute#113622 >= 30))) && isnotnull(t_time_sk#113618))
:  :  :  :  :  :        :           +- Relation[t_time_sk#113618,t_time_id#113619,t_time#113620,t_hour#113621,t_minute#113622,t_second#113623,t_am_pm#113624,t_shift#113625,t_sub_shift#113626,t_meal_time#113627] parquet
:  :  :  :  :  :        +- Project [s_store_sk#113628]
:  :  :  :  :  :           +- Filter ((isnotnull(s_store_name#113633) && (s_store_name#113633 = ese)) && isnotnull(s_store_sk#113628))
:  :  :  :  :  :              +- Relation[s_store_sk#113628,s_store_id#113629,s_rec_start_date#113630,s_rec_end_date#113631,s_closed_date_sk#113632,s_store_name#113633,s_number_employees#113634,s_floor_space#113635,s_hours#113636,s_manager#113637,s_market_id#113638,s_geography_class#113639,s_market_desc#113640,s_market_manager#113641,s_division_id#113642,s_division_name#113643,s_company_id#113644,s_company_name#113645,s_street_number#113646,s_street_name#113647,s_street_type#113648,s_suite_number#113649,s_city#113650,s_county#113651,... 5 more fields] parquet
:  :  :  :  :  +- Aggregate [count(1) AS h9_to_9_30#113583L]
:  :  :  :  :     +- Project
:  :  :  :  :        +- Join Inner, (ss_store_sk#113664 = s_store_sk#113695)
:  :  :  :  :           :- Project [ss_store_sk#113664]
:  :  :  :  :           :  +- Join Inner, (ss_sold_time_sk#113658 = t_time_sk#113685)
:  :  :  :  :           :     :- Project [ss_sold_time_sk#113658, ss_store_sk#113664]
:  :  :  :  :           :     :  +- Join Inner, (ss_hdemo_sk#113662 = hd_demo_sk#113680)
:  :  :  :  :           :     :     :- Project [ss_sold_time_sk#113658, ss_hdemo_sk#113662, ss_store_sk#113664]
:  :  :  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#113662) && isnotnull(ss_sold_time_sk#113658)) && isnotnull(ss_store_sk#113664))
:  :  :  :  :           :     :     :     +- Relation[ss_sold_time_sk#113658,ss_item_sk#113659,ss_customer_sk#113660,ss_cdemo_sk#113661,ss_hdemo_sk#113662,ss_addr_sk#113663,ss_store_sk#113664,ss_promo_sk#113665,ss_ticket_number#113666,ss_quantity#113667,ss_wholesale_cost#113668,ss_list_price#113669,ss_sales_price#113670,ss_ext_discount_amt#113671,ss_ext_sales_price#113672,ss_ext_wholesale_cost#113673,ss_ext_list_price#113674,ss_ext_tax#113675,ss_coupon_amt#113676,ss_net_paid#113677,ss_net_paid_inc_tax#113678,ss_net_profit#113679,ss_sold_date_sk#113657] parquet
:  :  :  :  :           :     :     +- Project [hd_demo_sk#113680]
:  :  :  :  :           :     :        +- Filter (((((hd_dep_count#113683 = 3) && (hd_vehicle_count#113684 <= 5)) || ((hd_dep_count#113683 = 0) && (hd_vehicle_count#113684 <= 2))) || ((hd_dep_count#113683 = 1) && (hd_vehicle_count#113684 <= 3))) && isnotnull(hd_demo_sk#113680))
:  :  :  :  :           :     :           +- Relation[hd_demo_sk#113680,hd_income_band_sk#113681,hd_buy_potential#113682,hd_dep_count#113683,hd_vehicle_count#113684] parquet
:  :  :  :  :           :     +- Project [t_time_sk#113685]
:  :  :  :  :           :        +- Filter (((isnotnull(t_hour#113688) && isnotnull(t_minute#113689)) && ((t_hour#113688 = 9) && (t_minute#113689 < 30))) && isnotnull(t_time_sk#113685))
:  :  :  :  :           :           +- Relation[t_time_sk#113685,t_time_id#113686,t_time#113687,t_hour#113688,t_minute#113689,t_second#113690,t_am_pm#113691,t_shift#113692,t_sub_shift#113693,t_meal_time#113694] parquet
:  :  :  :  :           +- Project [s_store_sk#113695]
:  :  :  :  :              +- Filter ((isnotnull(s_store_name#113700) && (s_store_name#113700 = ese)) && isnotnull(s_store_sk#113695))
:  :  :  :  :                 +- Relation[s_store_sk#113695,s_store_id#113696,s_rec_start_date#113697,s_rec_end_date#113698,s_closed_date_sk#113699,s_store_name#113700,s_number_employees#113701,s_floor_space#113702,s_hours#113703,s_manager#113704,s_market_id#113705,s_geography_class#113706,s_market_desc#113707,s_market_manager#113708,s_division_id#113709,s_division_name#113710,s_company_id#113711,s_company_name#113712,s_street_number#113713,s_street_name#113714,s_street_type#113715,s_suite_number#113716,s_city#113717,s_county#113718,... 5 more fields] parquet
:  :  :  :  +- Aggregate [count(1) AS h9_30_to_10#113584L]
:  :  :  :     +- Project
:  :  :  :        +- Join Inner, (ss_store_sk#113731 = s_store_sk#113762)
:  :  :  :           :- Project [ss_store_sk#113731]
:  :  :  :           :  +- Join Inner, (ss_sold_time_sk#113725 = t_time_sk#113752)
:  :  :  :           :     :- Project [ss_sold_time_sk#113725, ss_store_sk#113731]
:  :  :  :           :     :  +- Join Inner, (ss_hdemo_sk#113729 = hd_demo_sk#113747)
:  :  :  :           :     :     :- Project [ss_sold_time_sk#113725, ss_hdemo_sk#113729, ss_store_sk#113731]
:  :  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#113729) && isnotnull(ss_sold_time_sk#113725)) && isnotnull(ss_store_sk#113731))
:  :  :  :           :     :     :     +- Relation[ss_sold_time_sk#113725,ss_item_sk#113726,ss_customer_sk#113727,ss_cdemo_sk#113728,ss_hdemo_sk#113729,ss_addr_sk#113730,ss_store_sk#113731,ss_promo_sk#113732,ss_ticket_number#113733,ss_quantity#113734,ss_wholesale_cost#113735,ss_list_price#113736,ss_sales_price#113737,ss_ext_discount_amt#113738,ss_ext_sales_price#113739,ss_ext_wholesale_cost#113740,ss_ext_list_price#113741,ss_ext_tax#113742,ss_coupon_amt#113743,ss_net_paid#113744,ss_net_paid_inc_tax#113745,ss_net_profit#113746,ss_sold_date_sk#113724] parquet
:  :  :  :           :     :     +- Project [hd_demo_sk#113747]
:  :  :  :           :     :        +- Filter (((((hd_dep_count#113750 = 3) && (hd_vehicle_count#113751 <= 5)) || ((hd_dep_count#113750 = 0) && (hd_vehicle_count#113751 <= 2))) || ((hd_dep_count#113750 = 1) && (hd_vehicle_count#113751 <= 3))) && isnotnull(hd_demo_sk#113747))
:  :  :  :           :     :           +- Relation[hd_demo_sk#113747,hd_income_band_sk#113748,hd_buy_potential#113749,hd_dep_count#113750,hd_vehicle_count#113751] parquet
:  :  :  :           :     +- Project [t_time_sk#113752]
:  :  :  :           :        +- Filter (((isnotnull(t_hour#113755) && isnotnull(t_minute#113756)) && ((t_hour#113755 = 9) && (t_minute#113756 >= 30))) && isnotnull(t_time_sk#113752))
:  :  :  :           :           +- Relation[t_time_sk#113752,t_time_id#113753,t_time#113754,t_hour#113755,t_minute#113756,t_second#113757,t_am_pm#113758,t_shift#113759,t_sub_shift#113760,t_meal_time#113761] parquet
:  :  :  :           +- Project [s_store_sk#113762]
:  :  :  :              +- Filter ((isnotnull(s_store_name#113767) && (s_store_name#113767 = ese)) && isnotnull(s_store_sk#113762))
:  :  :  :                 +- Relation[s_store_sk#113762,s_store_id#113763,s_rec_start_date#113764,s_rec_end_date#113765,s_closed_date_sk#113766,s_store_name#113767,s_number_employees#113768,s_floor_space#113769,s_hours#113770,s_manager#113771,s_market_id#113772,s_geography_class#113773,s_market_desc#113774,s_market_manager#113775,s_division_id#113776,s_division_name#113777,s_company_id#113778,s_company_name#113779,s_street_number#113780,s_street_name#113781,s_street_type#113782,s_suite_number#113783,s_city#113784,s_county#113785,... 5 more fields] parquet
:  :  :  +- Aggregate [count(1) AS h10_to_10_30#113585L]
:  :  :     +- Project
:  :  :        +- Join Inner, (ss_store_sk#113798 = s_store_sk#113829)
:  :  :           :- Project [ss_store_sk#113798]
:  :  :           :  +- Join Inner, (ss_sold_time_sk#113792 = t_time_sk#113819)
:  :  :           :     :- Project [ss_sold_time_sk#113792, ss_store_sk#113798]
:  :  :           :     :  +- Join Inner, (ss_hdemo_sk#113796 = hd_demo_sk#113814)
:  :  :           :     :     :- Project [ss_sold_time_sk#113792, ss_hdemo_sk#113796, ss_store_sk#113798]
:  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#113796) && isnotnull(ss_sold_time_sk#113792)) && isnotnull(ss_store_sk#113798))
:  :  :           :     :     :     +- Relation[ss_sold_time_sk#113792,ss_item_sk#113793,ss_customer_sk#113794,ss_cdemo_sk#113795,ss_hdemo_sk#113796,ss_addr_sk#113797,ss_store_sk#113798,ss_promo_sk#113799,ss_ticket_number#113800,ss_quantity#113801,ss_wholesale_cost#113802,ss_list_price#113803,ss_sales_price#113804,ss_ext_discount_amt#113805,ss_ext_sales_price#113806,ss_ext_wholesale_cost#113807,ss_ext_list_price#113808,ss_ext_tax#113809,ss_coupon_amt#113810,ss_net_paid#113811,ss_net_paid_inc_tax#113812,ss_net_profit#113813,ss_sold_date_sk#113791] parquet
:  :  :           :     :     +- Project [hd_demo_sk#113814]
:  :  :           :     :        +- Filter (((((hd_dep_count#113817 = 3) && (hd_vehicle_count#113818 <= 5)) || ((hd_dep_count#113817 = 0) && (hd_vehicle_count#113818 <= 2))) || ((hd_dep_count#113817 = 1) && (hd_vehicle_count#113818 <= 3))) && isnotnull(hd_demo_sk#113814))
:  :  :           :     :           +- Relation[hd_demo_sk#113814,hd_income_band_sk#113815,hd_buy_potential#113816,hd_dep_count#113817,hd_vehicle_count#113818] parquet
:  :  :           :     +- Project [t_time_sk#113819]
:  :  :           :        +- Filter (((isnotnull(t_hour#113822) && isnotnull(t_minute#113823)) && ((t_hour#113822 = 10) && (t_minute#113823 < 30))) && isnotnull(t_time_sk#113819))
:  :  :           :           +- Relation[t_time_sk#113819,t_time_id#113820,t_time#113821,t_hour#113822,t_minute#113823,t_second#113824,t_am_pm#113825,t_shift#113826,t_sub_shift#113827,t_meal_time#113828] parquet
:  :  :           +- Project [s_store_sk#113829]
:  :  :              +- Filter ((isnotnull(s_store_name#113834) && (s_store_name#113834 = ese)) && isnotnull(s_store_sk#113829))
:  :  :                 +- Relation[s_store_sk#113829,s_store_id#113830,s_rec_start_date#113831,s_rec_end_date#113832,s_closed_date_sk#113833,s_store_name#113834,s_number_employees#113835,s_floor_space#113836,s_hours#113837,s_manager#113838,s_market_id#113839,s_geography_class#113840,s_market_desc#113841,s_market_manager#113842,s_division_id#113843,s_division_name#113844,s_company_id#113845,s_company_name#113846,s_street_number#113847,s_street_name#113848,s_street_type#113849,s_suite_number#113850,s_city#113851,s_county#113852,... 5 more fields] parquet
:  :  +- Aggregate [count(1) AS h10_30_to_11#113586L]
:  :     +- Project
:  :        +- Join Inner, (ss_store_sk#113865 = s_store_sk#113896)
:  :           :- Project [ss_store_sk#113865]
:  :           :  +- Join Inner, (ss_sold_time_sk#113859 = t_time_sk#113886)
:  :           :     :- Project [ss_sold_time_sk#113859, ss_store_sk#113865]
:  :           :     :  +- Join Inner, (ss_hdemo_sk#113863 = hd_demo_sk#113881)
:  :           :     :     :- Project [ss_sold_time_sk#113859, ss_hdemo_sk#113863, ss_store_sk#113865]
:  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#113863) && isnotnull(ss_sold_time_sk#113859)) && isnotnull(ss_store_sk#113865))
:  :           :     :     :     +- Relation[ss_sold_time_sk#113859,ss_item_sk#113860,ss_customer_sk#113861,ss_cdemo_sk#113862,ss_hdemo_sk#113863,ss_addr_sk#113864,ss_store_sk#113865,ss_promo_sk#113866,ss_ticket_number#113867,ss_quantity#113868,ss_wholesale_cost#113869,ss_list_price#113870,ss_sales_price#113871,ss_ext_discount_amt#113872,ss_ext_sales_price#113873,ss_ext_wholesale_cost#113874,ss_ext_list_price#113875,ss_ext_tax#113876,ss_coupon_amt#113877,ss_net_paid#113878,ss_net_paid_inc_tax#113879,ss_net_profit#113880,ss_sold_date_sk#113858] parquet
:  :           :     :     +- Project [hd_demo_sk#113881]
:  :           :     :        +- Filter (((((hd_dep_count#113884 = 3) && (hd_vehicle_count#113885 <= 5)) || ((hd_dep_count#113884 = 0) && (hd_vehicle_count#113885 <= 2))) || ((hd_dep_count#113884 = 1) && (hd_vehicle_count#113885 <= 3))) && isnotnull(hd_demo_sk#113881))
:  :           :     :           +- Relation[hd_demo_sk#113881,hd_income_band_sk#113882,hd_buy_potential#113883,hd_dep_count#113884,hd_vehicle_count#113885] parquet
:  :           :     +- Project [t_time_sk#113886]
:  :           :        +- Filter (((isnotnull(t_hour#113889) && isnotnull(t_minute#113890)) && ((t_hour#113889 = 10) && (t_minute#113890 >= 30))) && isnotnull(t_time_sk#113886))
:  :           :           +- Relation[t_time_sk#113886,t_time_id#113887,t_time#113888,t_hour#113889,t_minute#113890,t_second#113891,t_am_pm#113892,t_shift#113893,t_sub_shift#113894,t_meal_time#113895] parquet
:  :           +- Project [s_store_sk#113896]
:  :              +- Filter ((isnotnull(s_store_name#113901) && (s_store_name#113901 = ese)) && isnotnull(s_store_sk#113896))
:  :                 +- Relation[s_store_sk#113896,s_store_id#113897,s_rec_start_date#113898,s_rec_end_date#113899,s_closed_date_sk#113900,s_store_name#113901,s_number_employees#113902,s_floor_space#113903,s_hours#113904,s_manager#113905,s_market_id#113906,s_geography_class#113907,s_market_desc#113908,s_market_manager#113909,s_division_id#113910,s_division_name#113911,s_company_id#113912,s_company_name#113913,s_street_number#113914,s_street_name#113915,s_street_type#113916,s_suite_number#113917,s_city#113918,s_county#113919,... 5 more fields] parquet
:  +- Aggregate [count(1) AS h11_to_11_30#113587L]
:     +- Project
:        +- Join Inner, (ss_store_sk#113932 = s_store_sk#113963)
:           :- Project [ss_store_sk#113932]
:           :  +- Join Inner, (ss_sold_time_sk#113926 = t_time_sk#113953)
:           :     :- Project [ss_sold_time_sk#113926, ss_store_sk#113932]
:           :     :  +- Join Inner, (ss_hdemo_sk#113930 = hd_demo_sk#113948)
:           :     :     :- Project [ss_sold_time_sk#113926, ss_hdemo_sk#113930, ss_store_sk#113932]
:           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#113930) && isnotnull(ss_sold_time_sk#113926)) && isnotnull(ss_store_sk#113932))
:           :     :     :     +- Relation[ss_sold_time_sk#113926,ss_item_sk#113927,ss_customer_sk#113928,ss_cdemo_sk#113929,ss_hdemo_sk#113930,ss_addr_sk#113931,ss_store_sk#113932,ss_promo_sk#113933,ss_ticket_number#113934,ss_quantity#113935,ss_wholesale_cost#113936,ss_list_price#113937,ss_sales_price#113938,ss_ext_discount_amt#113939,ss_ext_sales_price#113940,ss_ext_wholesale_cost#113941,ss_ext_list_price#113942,ss_ext_tax#113943,ss_coupon_amt#113944,ss_net_paid#113945,ss_net_paid_inc_tax#113946,ss_net_profit#113947,ss_sold_date_sk#113925] parquet
:           :     :     +- Project [hd_demo_sk#113948]
:           :     :        +- Filter (((((hd_dep_count#113951 = 3) && (hd_vehicle_count#113952 <= 5)) || ((hd_dep_count#113951 = 0) && (hd_vehicle_count#113952 <= 2))) || ((hd_dep_count#113951 = 1) && (hd_vehicle_count#113952 <= 3))) && isnotnull(hd_demo_sk#113948))
:           :     :           +- Relation[hd_demo_sk#113948,hd_income_band_sk#113949,hd_buy_potential#113950,hd_dep_count#113951,hd_vehicle_count#113952] parquet
:           :     +- Project [t_time_sk#113953]
:           :        +- Filter (((isnotnull(t_hour#113956) && isnotnull(t_minute#113957)) && ((t_hour#113956 = 11) && (t_minute#113957 < 30))) && isnotnull(t_time_sk#113953))
:           :           +- Relation[t_time_sk#113953,t_time_id#113954,t_time#113955,t_hour#113956,t_minute#113957,t_second#113958,t_am_pm#113959,t_shift#113960,t_sub_shift#113961,t_meal_time#113962] parquet
:           +- Project [s_store_sk#113963]
:              +- Filter ((isnotnull(s_store_name#113968) && (s_store_name#113968 = ese)) && isnotnull(s_store_sk#113963))
:                 +- Relation[s_store_sk#113963,s_store_id#113964,s_rec_start_date#113965,s_rec_end_date#113966,s_closed_date_sk#113967,s_store_name#113968,s_number_employees#113969,s_floor_space#113970,s_hours#113971,s_manager#113972,s_market_id#113973,s_geography_class#113974,s_market_desc#113975,s_market_manager#113976,s_division_id#113977,s_division_name#113978,s_company_id#113979,s_company_name#113980,s_street_number#113981,s_street_name#113982,s_street_type#113983,s_suite_number#113984,s_city#113985,s_county#113986,... 5 more fields] parquet
+- Aggregate [count(1) AS h11_30_to_12#113588L]
   +- Project
      +- Join Inner, (ss_store_sk#113999 = s_store_sk#114030)
         :- Project [ss_store_sk#113999]
         :  +- Join Inner, (ss_sold_time_sk#113993 = t_time_sk#114020)
         :     :- Project [ss_sold_time_sk#113993, ss_store_sk#113999]
         :     :  +- Join Inner, (ss_hdemo_sk#113997 = hd_demo_sk#114015)
         :     :     :- Project [ss_sold_time_sk#113993, ss_hdemo_sk#113997, ss_store_sk#113999]
         :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#113997) && isnotnull(ss_sold_time_sk#113993)) && isnotnull(ss_store_sk#113999))
         :     :     :     +- Relation[ss_sold_time_sk#113993,ss_item_sk#113994,ss_customer_sk#113995,ss_cdemo_sk#113996,ss_hdemo_sk#113997,ss_addr_sk#113998,ss_store_sk#113999,ss_promo_sk#114000,ss_ticket_number#114001,ss_quantity#114002,ss_wholesale_cost#114003,ss_list_price#114004,ss_sales_price#114005,ss_ext_discount_amt#114006,ss_ext_sales_price#114007,ss_ext_wholesale_cost#114008,ss_ext_list_price#114009,ss_ext_tax#114010,ss_coupon_amt#114011,ss_net_paid#114012,ss_net_paid_inc_tax#114013,ss_net_profit#114014,ss_sold_date_sk#113992] parquet
         :     :     +- Project [hd_demo_sk#114015]
         :     :        +- Filter (((((hd_dep_count#114018 = 3) && (hd_vehicle_count#114019 <= 5)) || ((hd_dep_count#114018 = 0) && (hd_vehicle_count#114019 <= 2))) || ((hd_dep_count#114018 = 1) && (hd_vehicle_count#114019 <= 3))) && isnotnull(hd_demo_sk#114015))
         :     :           +- Relation[hd_demo_sk#114015,hd_income_band_sk#114016,hd_buy_potential#114017,hd_dep_count#114018,hd_vehicle_count#114019] parquet
         :     +- Project [t_time_sk#114020]
         :        +- Filter (((isnotnull(t_hour#114023) && isnotnull(t_minute#114024)) && ((t_hour#114023 = 11) && (t_minute#114024 >= 30))) && isnotnull(t_time_sk#114020))
         :           +- Relation[t_time_sk#114020,t_time_id#114021,t_time#114022,t_hour#114023,t_minute#114024,t_second#114025,t_am_pm#114026,t_shift#114027,t_sub_shift#114028,t_meal_time#114029] parquet
         +- Project [s_store_sk#114030]
            +- Filter ((isnotnull(s_store_name#114035) && (s_store_name#114035 = ese)) && isnotnull(s_store_sk#114030))
               +- Relation[s_store_sk#114030,s_store_id#114031,s_rec_start_date#114032,s_rec_end_date#114033,s_closed_date_sk#114034,s_store_name#114035,s_number_employees#114036,s_floor_space#114037,s_hours#114038,s_manager#114039,s_market_id#114040,s_geography_class#114041,s_market_desc#114042,s_market_manager#114043,s_division_id#114044,s_division_name#114045,s_company_id#114046,s_company_name#114047,s_street_number#114048,s_street_name#114049,s_street_type#114050,s_suite_number#114051,s_city#114052,s_county#114053,... 5 more fields] parquet
and
Aggregate [count(1) AS h12_to_12_30#113589L]
+- Project
   +- Join Inner, (ss_store_sk#114066 = s_store_sk#114097)
      :- Project [ss_store_sk#114066]
      :  +- Join Inner, (ss_sold_time_sk#114060 = t_time_sk#114087)
      :     :- Project [ss_sold_time_sk#114060, ss_store_sk#114066]
      :     :  +- Join Inner, (ss_hdemo_sk#114064 = hd_demo_sk#114082)
      :     :     :- Project [ss_sold_time_sk#114060, ss_hdemo_sk#114064, ss_store_sk#114066]
      :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#114064) && isnotnull(ss_sold_time_sk#114060)) && isnotnull(ss_store_sk#114066))
      :     :     :     +- Relation[ss_sold_time_sk#114060,ss_item_sk#114061,ss_customer_sk#114062,ss_cdemo_sk#114063,ss_hdemo_sk#114064,ss_addr_sk#114065,ss_store_sk#114066,ss_promo_sk#114067,ss_ticket_number#114068,ss_quantity#114069,ss_wholesale_cost#114070,ss_list_price#114071,ss_sales_price#114072,ss_ext_discount_amt#114073,ss_ext_sales_price#114074,ss_ext_wholesale_cost#114075,ss_ext_list_price#114076,ss_ext_tax#114077,ss_coupon_amt#114078,ss_net_paid#114079,ss_net_paid_inc_tax#114080,ss_net_profit#114081,ss_sold_date_sk#114059] parquet
      :     :     +- Project [hd_demo_sk#114082]
      :     :        +- Filter (((((hd_dep_count#114085 = 3) && (hd_vehicle_count#114086 <= 5)) || ((hd_dep_count#114085 = 0) && (hd_vehicle_count#114086 <= 2))) || ((hd_dep_count#114085 = 1) && (hd_vehicle_count#114086 <= 3))) && isnotnull(hd_demo_sk#114082))
      :     :           +- Relation[hd_demo_sk#114082,hd_income_band_sk#114083,hd_buy_potential#114084,hd_dep_count#114085,hd_vehicle_count#114086] parquet
      :     +- Project [t_time_sk#114087]
      :        +- Filter (((isnotnull(t_hour#114090) && isnotnull(t_minute#114091)) && ((t_hour#114090 = 12) && (t_minute#114091 < 30))) && isnotnull(t_time_sk#114087))
      :           +- Relation[t_time_sk#114087,t_time_id#114088,t_time#114089,t_hour#114090,t_minute#114091,t_second#114092,t_am_pm#114093,t_shift#114094,t_sub_shift#114095,t_meal_time#114096] parquet
      +- Project [s_store_sk#114097]
         +- Filter ((isnotnull(s_store_name#114102) && (s_store_name#114102 = ese)) && isnotnull(s_store_sk#114097))
            +- Relation[s_store_sk#114097,s_store_id#114098,s_rec_start_date#114099,s_rec_end_date#114100,s_closed_date_sk#114101,s_store_name#114102,s_number_employees#114103,s_floor_space#114104,s_hours#114105,s_manager#114106,s_market_id#114107,s_geography_class#114108,s_market_desc#114109,s_market_manager#114110,s_division_id#114111,s_division_name#114112,s_company_id#114113,s_company_name#114114,s_street_number#114115,s_street_name#114116,s_street_type#114117,s_suite_number#114118,s_city#114119,s_county#114120,... 5 more fields] parquet
Join condition is missing or trivial.
Use the CROSS JOIN syntax to allow cartesian products between these relations.; (state=,code=0)

Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
STOP hdp2.6_spark21_run_1000_3_query88_sql_2017-04-08-21-34:  Sat Apr 8 21:34:15 CDT 2017
