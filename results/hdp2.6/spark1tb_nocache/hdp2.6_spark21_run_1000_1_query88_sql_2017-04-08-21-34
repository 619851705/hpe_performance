START hdp2.6_spark21_run_1000_1_query88_sql_2017-04-08-21-34:  Sat Apr 8 21:34:00 CDT 2017
 /usr/hdp/current/spark2-client/bin/beeline -u "jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_$SF" -n hive --incremental=true  -i settings/spark.settings -f sample-queries-tpcds/$1
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
17/04/08 21:34:01 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/08 21:34:01 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/08 21:34:01 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
Connected to: Spark SQL (version 2.1.0.2.6.0.0-598)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  *
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> from
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h8_30_to_9
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk   
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s1,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h9_to_9_30 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 9 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s2,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h9_30_to_10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 9
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s3,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h10_to_10_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s4,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h10_30_to_11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s5,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h11_to_11_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s6,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h11_30_to_12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s7,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h12_to_12_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> ;
Error: org.apache.spark.sql.AnalysisException: Detected cartesian product for INNER join between logical plans
Join Inner
:- Join Inner
:  :- Join Inner
:  :  :- Join Inner
:  :  :  :- Join Inner
:  :  :  :  :- Join Inner
:  :  :  :  :  :- Aggregate [count(1) AS h8_30_to_9#111234L]
:  :  :  :  :  :  +- Project
:  :  :  :  :  :     +- Join Inner, (ss_store_sk#111249 = s_store_sk#111280)
:  :  :  :  :  :        :- Project [ss_store_sk#111249]
:  :  :  :  :  :        :  +- Join Inner, (ss_sold_time_sk#111243 = t_time_sk#111270)
:  :  :  :  :  :        :     :- Project [ss_sold_time_sk#111243, ss_store_sk#111249]
:  :  :  :  :  :        :     :  +- Join Inner, (ss_hdemo_sk#111247 = hd_demo_sk#111265)
:  :  :  :  :  :        :     :     :- Project [ss_sold_time_sk#111243, ss_hdemo_sk#111247, ss_store_sk#111249]
:  :  :  :  :  :        :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#111247) && isnotnull(ss_sold_time_sk#111243)) && isnotnull(ss_store_sk#111249))
:  :  :  :  :  :        :     :     :     +- Relation[ss_sold_time_sk#111243,ss_item_sk#111244,ss_customer_sk#111245,ss_cdemo_sk#111246,ss_hdemo_sk#111247,ss_addr_sk#111248,ss_store_sk#111249,ss_promo_sk#111250,ss_ticket_number#111251,ss_quantity#111252,ss_wholesale_cost#111253,ss_list_price#111254,ss_sales_price#111255,ss_ext_discount_amt#111256,ss_ext_sales_price#111257,ss_ext_wholesale_cost#111258,ss_ext_list_price#111259,ss_ext_tax#111260,ss_coupon_amt#111261,ss_net_paid#111262,ss_net_paid_inc_tax#111263,ss_net_profit#111264,ss_sold_date_sk#111242] parquet
:  :  :  :  :  :        :     :     +- Project [hd_demo_sk#111265]
:  :  :  :  :  :        :     :        +- Filter (((((hd_dep_count#111268 = 3) && (hd_vehicle_count#111269 <= 5)) || ((hd_dep_count#111268 = 0) && (hd_vehicle_count#111269 <= 2))) || ((hd_dep_count#111268 = 1) && (hd_vehicle_count#111269 <= 3))) && isnotnull(hd_demo_sk#111265))
:  :  :  :  :  :        :     :           +- Relation[hd_demo_sk#111265,hd_income_band_sk#111266,hd_buy_potential#111267,hd_dep_count#111268,hd_vehicle_count#111269] parquet
:  :  :  :  :  :        :     +- Project [t_time_sk#111270]
:  :  :  :  :  :        :        +- Filter (((isnotnull(t_hour#111273) && isnotnull(t_minute#111274)) && ((t_hour#111273 = 8) && (t_minute#111274 >= 30))) && isnotnull(t_time_sk#111270))
:  :  :  :  :  :        :           +- Relation[t_time_sk#111270,t_time_id#111271,t_time#111272,t_hour#111273,t_minute#111274,t_second#111275,t_am_pm#111276,t_shift#111277,t_sub_shift#111278,t_meal_time#111279] parquet
:  :  :  :  :  :        +- Project [s_store_sk#111280]
:  :  :  :  :  :           +- Filter ((isnotnull(s_store_name#111285) && (s_store_name#111285 = ese)) && isnotnull(s_store_sk#111280))
:  :  :  :  :  :              +- Relation[s_store_sk#111280,s_store_id#111281,s_rec_start_date#111282,s_rec_end_date#111283,s_closed_date_sk#111284,s_store_name#111285,s_number_employees#111286,s_floor_space#111287,s_hours#111288,s_manager#111289,s_market_id#111290,s_geography_class#111291,s_market_desc#111292,s_market_manager#111293,s_division_id#111294,s_division_name#111295,s_company_id#111296,s_company_name#111297,s_street_number#111298,s_street_name#111299,s_street_type#111300,s_suite_number#111301,s_city#111302,s_county#111303,... 5 more fields] parquet
:  :  :  :  :  +- Aggregate [count(1) AS h9_to_9_30#111235L]
:  :  :  :  :     +- Project
:  :  :  :  :        +- Join Inner, (ss_store_sk#111316 = s_store_sk#111347)
:  :  :  :  :           :- Project [ss_store_sk#111316]
:  :  :  :  :           :  +- Join Inner, (ss_sold_time_sk#111310 = t_time_sk#111337)
:  :  :  :  :           :     :- Project [ss_sold_time_sk#111310, ss_store_sk#111316]
:  :  :  :  :           :     :  +- Join Inner, (ss_hdemo_sk#111314 = hd_demo_sk#111332)
:  :  :  :  :           :     :     :- Project [ss_sold_time_sk#111310, ss_hdemo_sk#111314, ss_store_sk#111316]
:  :  :  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#111314) && isnotnull(ss_sold_time_sk#111310)) && isnotnull(ss_store_sk#111316))
:  :  :  :  :           :     :     :     +- Relation[ss_sold_time_sk#111310,ss_item_sk#111311,ss_customer_sk#111312,ss_cdemo_sk#111313,ss_hdemo_sk#111314,ss_addr_sk#111315,ss_store_sk#111316,ss_promo_sk#111317,ss_ticket_number#111318,ss_quantity#111319,ss_wholesale_cost#111320,ss_list_price#111321,ss_sales_price#111322,ss_ext_discount_amt#111323,ss_ext_sales_price#111324,ss_ext_wholesale_cost#111325,ss_ext_list_price#111326,ss_ext_tax#111327,ss_coupon_amt#111328,ss_net_paid#111329,ss_net_paid_inc_tax#111330,ss_net_profit#111331,ss_sold_date_sk#111309] parquet
:  :  :  :  :           :     :     +- Project [hd_demo_sk#111332]
:  :  :  :  :           :     :        +- Filter (((((hd_dep_count#111335 = 3) && (hd_vehicle_count#111336 <= 5)) || ((hd_dep_count#111335 = 0) && (hd_vehicle_count#111336 <= 2))) || ((hd_dep_count#111335 = 1) && (hd_vehicle_count#111336 <= 3))) && isnotnull(hd_demo_sk#111332))
:  :  :  :  :           :     :           +- Relation[hd_demo_sk#111332,hd_income_band_sk#111333,hd_buy_potential#111334,hd_dep_count#111335,hd_vehicle_count#111336] parquet
:  :  :  :  :           :     +- Project [t_time_sk#111337]
:  :  :  :  :           :        +- Filter (((isnotnull(t_hour#111340) && isnotnull(t_minute#111341)) && ((t_hour#111340 = 9) && (t_minute#111341 < 30))) && isnotnull(t_time_sk#111337))
:  :  :  :  :           :           +- Relation[t_time_sk#111337,t_time_id#111338,t_time#111339,t_hour#111340,t_minute#111341,t_second#111342,t_am_pm#111343,t_shift#111344,t_sub_shift#111345,t_meal_time#111346] parquet
:  :  :  :  :           +- Project [s_store_sk#111347]
:  :  :  :  :              +- Filter ((isnotnull(s_store_name#111352) && (s_store_name#111352 = ese)) && isnotnull(s_store_sk#111347))
:  :  :  :  :                 +- Relation[s_store_sk#111347,s_store_id#111348,s_rec_start_date#111349,s_rec_end_date#111350,s_closed_date_sk#111351,s_store_name#111352,s_number_employees#111353,s_floor_space#111354,s_hours#111355,s_manager#111356,s_market_id#111357,s_geography_class#111358,s_market_desc#111359,s_market_manager#111360,s_division_id#111361,s_division_name#111362,s_company_id#111363,s_company_name#111364,s_street_number#111365,s_street_name#111366,s_street_type#111367,s_suite_number#111368,s_city#111369,s_county#111370,... 5 more fields] parquet
:  :  :  :  +- Aggregate [count(1) AS h9_30_to_10#111236L]
:  :  :  :     +- Project
:  :  :  :        +- Join Inner, (ss_store_sk#111383 = s_store_sk#111414)
:  :  :  :           :- Project [ss_store_sk#111383]
:  :  :  :           :  +- Join Inner, (ss_sold_time_sk#111377 = t_time_sk#111404)
:  :  :  :           :     :- Project [ss_sold_time_sk#111377, ss_store_sk#111383]
:  :  :  :           :     :  +- Join Inner, (ss_hdemo_sk#111381 = hd_demo_sk#111399)
:  :  :  :           :     :     :- Project [ss_sold_time_sk#111377, ss_hdemo_sk#111381, ss_store_sk#111383]
:  :  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#111381) && isnotnull(ss_sold_time_sk#111377)) && isnotnull(ss_store_sk#111383))
:  :  :  :           :     :     :     +- Relation[ss_sold_time_sk#111377,ss_item_sk#111378,ss_customer_sk#111379,ss_cdemo_sk#111380,ss_hdemo_sk#111381,ss_addr_sk#111382,ss_store_sk#111383,ss_promo_sk#111384,ss_ticket_number#111385,ss_quantity#111386,ss_wholesale_cost#111387,ss_list_price#111388,ss_sales_price#111389,ss_ext_discount_amt#111390,ss_ext_sales_price#111391,ss_ext_wholesale_cost#111392,ss_ext_list_price#111393,ss_ext_tax#111394,ss_coupon_amt#111395,ss_net_paid#111396,ss_net_paid_inc_tax#111397,ss_net_profit#111398,ss_sold_date_sk#111376] parquet
:  :  :  :           :     :     +- Project [hd_demo_sk#111399]
:  :  :  :           :     :        +- Filter (((((hd_dep_count#111402 = 3) && (hd_vehicle_count#111403 <= 5)) || ((hd_dep_count#111402 = 0) && (hd_vehicle_count#111403 <= 2))) || ((hd_dep_count#111402 = 1) && (hd_vehicle_count#111403 <= 3))) && isnotnull(hd_demo_sk#111399))
:  :  :  :           :     :           +- Relation[hd_demo_sk#111399,hd_income_band_sk#111400,hd_buy_potential#111401,hd_dep_count#111402,hd_vehicle_count#111403] parquet
:  :  :  :           :     +- Project [t_time_sk#111404]
:  :  :  :           :        +- Filter (((isnotnull(t_hour#111407) && isnotnull(t_minute#111408)) && ((t_hour#111407 = 9) && (t_minute#111408 >= 30))) && isnotnull(t_time_sk#111404))
:  :  :  :           :           +- Relation[t_time_sk#111404,t_time_id#111405,t_time#111406,t_hour#111407,t_minute#111408,t_second#111409,t_am_pm#111410,t_shift#111411,t_sub_shift#111412,t_meal_time#111413] parquet
:  :  :  :           +- Project [s_store_sk#111414]
:  :  :  :              +- Filter ((isnotnull(s_store_name#111419) && (s_store_name#111419 = ese)) && isnotnull(s_store_sk#111414))
:  :  :  :                 +- Relation[s_store_sk#111414,s_store_id#111415,s_rec_start_date#111416,s_rec_end_date#111417,s_closed_date_sk#111418,s_store_name#111419,s_number_employees#111420,s_floor_space#111421,s_hours#111422,s_manager#111423,s_market_id#111424,s_geography_class#111425,s_market_desc#111426,s_market_manager#111427,s_division_id#111428,s_division_name#111429,s_company_id#111430,s_company_name#111431,s_street_number#111432,s_street_name#111433,s_street_type#111434,s_suite_number#111435,s_city#111436,s_county#111437,... 5 more fields] parquet
:  :  :  +- Aggregate [count(1) AS h10_to_10_30#111237L]
:  :  :     +- Project
:  :  :        +- Join Inner, (ss_store_sk#111450 = s_store_sk#111481)
:  :  :           :- Project [ss_store_sk#111450]
:  :  :           :  +- Join Inner, (ss_sold_time_sk#111444 = t_time_sk#111471)
:  :  :           :     :- Project [ss_sold_time_sk#111444, ss_store_sk#111450]
:  :  :           :     :  +- Join Inner, (ss_hdemo_sk#111448 = hd_demo_sk#111466)
:  :  :           :     :     :- Project [ss_sold_time_sk#111444, ss_hdemo_sk#111448, ss_store_sk#111450]
:  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#111448) && isnotnull(ss_sold_time_sk#111444)) && isnotnull(ss_store_sk#111450))
:  :  :           :     :     :     +- Relation[ss_sold_time_sk#111444,ss_item_sk#111445,ss_customer_sk#111446,ss_cdemo_sk#111447,ss_hdemo_sk#111448,ss_addr_sk#111449,ss_store_sk#111450,ss_promo_sk#111451,ss_ticket_number#111452,ss_quantity#111453,ss_wholesale_cost#111454,ss_list_price#111455,ss_sales_price#111456,ss_ext_discount_amt#111457,ss_ext_sales_price#111458,ss_ext_wholesale_cost#111459,ss_ext_list_price#111460,ss_ext_tax#111461,ss_coupon_amt#111462,ss_net_paid#111463,ss_net_paid_inc_tax#111464,ss_net_profit#111465,ss_sold_date_sk#111443] parquet
:  :  :           :     :     +- Project [hd_demo_sk#111466]
:  :  :           :     :        +- Filter (((((hd_dep_count#111469 = 3) && (hd_vehicle_count#111470 <= 5)) || ((hd_dep_count#111469 = 0) && (hd_vehicle_count#111470 <= 2))) || ((hd_dep_count#111469 = 1) && (hd_vehicle_count#111470 <= 3))) && isnotnull(hd_demo_sk#111466))
:  :  :           :     :           +- Relation[hd_demo_sk#111466,hd_income_band_sk#111467,hd_buy_potential#111468,hd_dep_count#111469,hd_vehicle_count#111470] parquet
:  :  :           :     +- Project [t_time_sk#111471]
:  :  :           :        +- Filter (((isnotnull(t_hour#111474) && isnotnull(t_minute#111475)) && ((t_hour#111474 = 10) && (t_minute#111475 < 30))) && isnotnull(t_time_sk#111471))
:  :  :           :           +- Relation[t_time_sk#111471,t_time_id#111472,t_time#111473,t_hour#111474,t_minute#111475,t_second#111476,t_am_pm#111477,t_shift#111478,t_sub_shift#111479,t_meal_time#111480] parquet
:  :  :           +- Project [s_store_sk#111481]
:  :  :              +- Filter ((isnotnull(s_store_name#111486) && (s_store_name#111486 = ese)) && isnotnull(s_store_sk#111481))
:  :  :                 +- Relation[s_store_sk#111481,s_store_id#111482,s_rec_start_date#111483,s_rec_end_date#111484,s_closed_date_sk#111485,s_store_name#111486,s_number_employees#111487,s_floor_space#111488,s_hours#111489,s_manager#111490,s_market_id#111491,s_geography_class#111492,s_market_desc#111493,s_market_manager#111494,s_division_id#111495,s_division_name#111496,s_company_id#111497,s_company_name#111498,s_street_number#111499,s_street_name#111500,s_street_type#111501,s_suite_number#111502,s_city#111503,s_county#111504,... 5 more fields] parquet
:  :  +- Aggregate [count(1) AS h10_30_to_11#111238L]
:  :     +- Project
:  :        +- Join Inner, (ss_store_sk#111517 = s_store_sk#111548)
:  :           :- Project [ss_store_sk#111517]
:  :           :  +- Join Inner, (ss_sold_time_sk#111511 = t_time_sk#111538)
:  :           :     :- Project [ss_sold_time_sk#111511, ss_store_sk#111517]
:  :           :     :  +- Join Inner, (ss_hdemo_sk#111515 = hd_demo_sk#111533)
:  :           :     :     :- Project [ss_sold_time_sk#111511, ss_hdemo_sk#111515, ss_store_sk#111517]
:  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#111515) && isnotnull(ss_sold_time_sk#111511)) && isnotnull(ss_store_sk#111517))
:  :           :     :     :     +- Relation[ss_sold_time_sk#111511,ss_item_sk#111512,ss_customer_sk#111513,ss_cdemo_sk#111514,ss_hdemo_sk#111515,ss_addr_sk#111516,ss_store_sk#111517,ss_promo_sk#111518,ss_ticket_number#111519,ss_quantity#111520,ss_wholesale_cost#111521,ss_list_price#111522,ss_sales_price#111523,ss_ext_discount_amt#111524,ss_ext_sales_price#111525,ss_ext_wholesale_cost#111526,ss_ext_list_price#111527,ss_ext_tax#111528,ss_coupon_amt#111529,ss_net_paid#111530,ss_net_paid_inc_tax#111531,ss_net_profit#111532,ss_sold_date_sk#111510] parquet
:  :           :     :     +- Project [hd_demo_sk#111533]
:  :           :     :        +- Filter (((((hd_dep_count#111536 = 3) && (hd_vehicle_count#111537 <= 5)) || ((hd_dep_count#111536 = 0) && (hd_vehicle_count#111537 <= 2))) || ((hd_dep_count#111536 = 1) && (hd_vehicle_count#111537 <= 3))) && isnotnull(hd_demo_sk#111533))
:  :           :     :           +- Relation[hd_demo_sk#111533,hd_income_band_sk#111534,hd_buy_potential#111535,hd_dep_count#111536,hd_vehicle_count#111537] parquet
:  :           :     +- Project [t_time_sk#111538]
:  :           :        +- Filter (((isnotnull(t_hour#111541) && isnotnull(t_minute#111542)) && ((t_hour#111541 = 10) && (t_minute#111542 >= 30))) && isnotnull(t_time_sk#111538))
:  :           :           +- Relation[t_time_sk#111538,t_time_id#111539,t_time#111540,t_hour#111541,t_minute#111542,t_second#111543,t_am_pm#111544,t_shift#111545,t_sub_shift#111546,t_meal_time#111547] parquet
:  :           +- Project [s_store_sk#111548]
:  :              +- Filter ((isnotnull(s_store_name#111553) && (s_store_name#111553 = ese)) && isnotnull(s_store_sk#111548))
:  :                 +- Relation[s_store_sk#111548,s_store_id#111549,s_rec_start_date#111550,s_rec_end_date#111551,s_closed_date_sk#111552,s_store_name#111553,s_number_employees#111554,s_floor_space#111555,s_hours#111556,s_manager#111557,s_market_id#111558,s_geography_class#111559,s_market_desc#111560,s_market_manager#111561,s_division_id#111562,s_division_name#111563,s_company_id#111564,s_company_name#111565,s_street_number#111566,s_street_name#111567,s_street_type#111568,s_suite_number#111569,s_city#111570,s_county#111571,... 5 more fields] parquet
:  +- Aggregate [count(1) AS h11_to_11_30#111239L]
:     +- Project
:        +- Join Inner, (ss_store_sk#111584 = s_store_sk#111615)
:           :- Project [ss_store_sk#111584]
:           :  +- Join Inner, (ss_sold_time_sk#111578 = t_time_sk#111605)
:           :     :- Project [ss_sold_time_sk#111578, ss_store_sk#111584]
:           :     :  +- Join Inner, (ss_hdemo_sk#111582 = hd_demo_sk#111600)
:           :     :     :- Project [ss_sold_time_sk#111578, ss_hdemo_sk#111582, ss_store_sk#111584]
:           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#111582) && isnotnull(ss_sold_time_sk#111578)) && isnotnull(ss_store_sk#111584))
:           :     :     :     +- Relation[ss_sold_time_sk#111578,ss_item_sk#111579,ss_customer_sk#111580,ss_cdemo_sk#111581,ss_hdemo_sk#111582,ss_addr_sk#111583,ss_store_sk#111584,ss_promo_sk#111585,ss_ticket_number#111586,ss_quantity#111587,ss_wholesale_cost#111588,ss_list_price#111589,ss_sales_price#111590,ss_ext_discount_amt#111591,ss_ext_sales_price#111592,ss_ext_wholesale_cost#111593,ss_ext_list_price#111594,ss_ext_tax#111595,ss_coupon_amt#111596,ss_net_paid#111597,ss_net_paid_inc_tax#111598,ss_net_profit#111599,ss_sold_date_sk#111577] parquet
:           :     :     +- Project [hd_demo_sk#111600]
:           :     :        +- Filter (((((hd_dep_count#111603 = 3) && (hd_vehicle_count#111604 <= 5)) || ((hd_dep_count#111603 = 0) && (hd_vehicle_count#111604 <= 2))) || ((hd_dep_count#111603 = 1) && (hd_vehicle_count#111604 <= 3))) && isnotnull(hd_demo_sk#111600))
:           :     :           +- Relation[hd_demo_sk#111600,hd_income_band_sk#111601,hd_buy_potential#111602,hd_dep_count#111603,hd_vehicle_count#111604] parquet
:           :     +- Project [t_time_sk#111605]
:           :        +- Filter (((isnotnull(t_hour#111608) && isnotnull(t_minute#111609)) && ((t_hour#111608 = 11) && (t_minute#111609 < 30))) && isnotnull(t_time_sk#111605))
:           :           +- Relation[t_time_sk#111605,t_time_id#111606,t_time#111607,t_hour#111608,t_minute#111609,t_second#111610,t_am_pm#111611,t_shift#111612,t_sub_shift#111613,t_meal_time#111614] parquet
:           +- Project [s_store_sk#111615]
:              +- Filter ((isnotnull(s_store_name#111620) && (s_store_name#111620 = ese)) && isnotnull(s_store_sk#111615))
:                 +- Relation[s_store_sk#111615,s_store_id#111616,s_rec_start_date#111617,s_rec_end_date#111618,s_closed_date_sk#111619,s_store_name#111620,s_number_employees#111621,s_floor_space#111622,s_hours#111623,s_manager#111624,s_market_id#111625,s_geography_class#111626,s_market_desc#111627,s_market_manager#111628,s_division_id#111629,s_division_name#111630,s_company_id#111631,s_company_name#111632,s_street_number#111633,s_street_name#111634,s_street_type#111635,s_suite_number#111636,s_city#111637,s_county#111638,... 5 more fields] parquet
+- Aggregate [count(1) AS h11_30_to_12#111240L]
   +- Project
      +- Join Inner, (ss_store_sk#111651 = s_store_sk#111682)
         :- Project [ss_store_sk#111651]
         :  +- Join Inner, (ss_sold_time_sk#111645 = t_time_sk#111672)
         :     :- Project [ss_sold_time_sk#111645, ss_store_sk#111651]
         :     :  +- Join Inner, (ss_hdemo_sk#111649 = hd_demo_sk#111667)
         :     :     :- Project [ss_sold_time_sk#111645, ss_hdemo_sk#111649, ss_store_sk#111651]
         :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#111649) && isnotnull(ss_sold_time_sk#111645)) && isnotnull(ss_store_sk#111651))
         :     :     :     +- Relation[ss_sold_time_sk#111645,ss_item_sk#111646,ss_customer_sk#111647,ss_cdemo_sk#111648,ss_hdemo_sk#111649,ss_addr_sk#111650,ss_store_sk#111651,ss_promo_sk#111652,ss_ticket_number#111653,ss_quantity#111654,ss_wholesale_cost#111655,ss_list_price#111656,ss_sales_price#111657,ss_ext_discount_amt#111658,ss_ext_sales_price#111659,ss_ext_wholesale_cost#111660,ss_ext_list_price#111661,ss_ext_tax#111662,ss_coupon_amt#111663,ss_net_paid#111664,ss_net_paid_inc_tax#111665,ss_net_profit#111666,ss_sold_date_sk#111644] parquet
         :     :     +- Project [hd_demo_sk#111667]
         :     :        +- Filter (((((hd_dep_count#111670 = 3) && (hd_vehicle_count#111671 <= 5)) || ((hd_dep_count#111670 = 0) && (hd_vehicle_count#111671 <= 2))) || ((hd_dep_count#111670 = 1) && (hd_vehicle_count#111671 <= 3))) && isnotnull(hd_demo_sk#111667))
         :     :           +- Relation[hd_demo_sk#111667,hd_income_band_sk#111668,hd_buy_potential#111669,hd_dep_count#111670,hd_vehicle_count#111671] parquet
         :     +- Project [t_time_sk#111672]
         :        +- Filter (((isnotnull(t_hour#111675) && isnotnull(t_minute#111676)) && ((t_hour#111675 = 11) && (t_minute#111676 >= 30))) && isnotnull(t_time_sk#111672))
         :           +- Relation[t_time_sk#111672,t_time_id#111673,t_time#111674,t_hour#111675,t_minute#111676,t_second#111677,t_am_pm#111678,t_shift#111679,t_sub_shift#111680,t_meal_time#111681] parquet
         +- Project [s_store_sk#111682]
            +- Filter ((isnotnull(s_store_name#111687) && (s_store_name#111687 = ese)) && isnotnull(s_store_sk#111682))
               +- Relation[s_store_sk#111682,s_store_id#111683,s_rec_start_date#111684,s_rec_end_date#111685,s_closed_date_sk#111686,s_store_name#111687,s_number_employees#111688,s_floor_space#111689,s_hours#111690,s_manager#111691,s_market_id#111692,s_geography_class#111693,s_market_desc#111694,s_market_manager#111695,s_division_id#111696,s_division_name#111697,s_company_id#111698,s_company_name#111699,s_street_number#111700,s_street_name#111701,s_street_type#111702,s_suite_number#111703,s_city#111704,s_county#111705,... 5 more fields] parquet
and
Aggregate [count(1) AS h12_to_12_30#111241L]
+- Project
   +- Join Inner, (ss_store_sk#111718 = s_store_sk#111749)
      :- Project [ss_store_sk#111718]
      :  +- Join Inner, (ss_sold_time_sk#111712 = t_time_sk#111739)
      :     :- Project [ss_sold_time_sk#111712, ss_store_sk#111718]
      :     :  +- Join Inner, (ss_hdemo_sk#111716 = hd_demo_sk#111734)
      :     :     :- Project [ss_sold_time_sk#111712, ss_hdemo_sk#111716, ss_store_sk#111718]
      :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#111716) && isnotnull(ss_sold_time_sk#111712)) && isnotnull(ss_store_sk#111718))
      :     :     :     +- Relation[ss_sold_time_sk#111712,ss_item_sk#111713,ss_customer_sk#111714,ss_cdemo_sk#111715,ss_hdemo_sk#111716,ss_addr_sk#111717,ss_store_sk#111718,ss_promo_sk#111719,ss_ticket_number#111720,ss_quantity#111721,ss_wholesale_cost#111722,ss_list_price#111723,ss_sales_price#111724,ss_ext_discount_amt#111725,ss_ext_sales_price#111726,ss_ext_wholesale_cost#111727,ss_ext_list_price#111728,ss_ext_tax#111729,ss_coupon_amt#111730,ss_net_paid#111731,ss_net_paid_inc_tax#111732,ss_net_profit#111733,ss_sold_date_sk#111711] parquet
      :     :     +- Project [hd_demo_sk#111734]
      :     :        +- Filter (((((hd_dep_count#111737 = 3) && (hd_vehicle_count#111738 <= 5)) || ((hd_dep_count#111737 = 0) && (hd_vehicle_count#111738 <= 2))) || ((hd_dep_count#111737 = 1) && (hd_vehicle_count#111738 <= 3))) && isnotnull(hd_demo_sk#111734))
      :     :           +- Relation[hd_demo_sk#111734,hd_income_band_sk#111735,hd_buy_potential#111736,hd_dep_count#111737,hd_vehicle_count#111738] parquet
      :     +- Project [t_time_sk#111739]
      :        +- Filter (((isnotnull(t_hour#111742) && isnotnull(t_minute#111743)) && ((t_hour#111742 = 12) && (t_minute#111743 < 30))) && isnotnull(t_time_sk#111739))
      :           +- Relation[t_time_sk#111739,t_time_id#111740,t_time#111741,t_hour#111742,t_minute#111743,t_second#111744,t_am_pm#111745,t_shift#111746,t_sub_shift#111747,t_meal_time#111748] parquet
      +- Project [s_store_sk#111749]
         +- Filter ((isnotnull(s_store_name#111754) && (s_store_name#111754 = ese)) && isnotnull(s_store_sk#111749))
            +- Relation[s_store_sk#111749,s_store_id#111750,s_rec_start_date#111751,s_rec_end_date#111752,s_closed_date_sk#111753,s_store_name#111754,s_number_employees#111755,s_floor_space#111756,s_hours#111757,s_manager#111758,s_market_id#111759,s_geography_class#111760,s_market_desc#111761,s_market_manager#111762,s_division_id#111763,s_division_name#111764,s_company_id#111765,s_company_name#111766,s_street_number#111767,s_street_name#111768,s_street_type#111769,s_suite_number#111770,s_city#111771,s_county#111772,... 5 more fields] parquet
Join condition is missing or trivial.
Use the CROSS JOIN syntax to allow cartesian products between these relations.; (state=,code=0)

Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
STOP hdp2.6_spark21_run_1000_1_query88_sql_2017-04-08-21-34:  Sat Apr 8 21:34:05 CDT 2017
