START hdp2.6_spark21_run_1000_1_query88_sql_2017-04-11-08-51:  Tue Apr 11 08:51:36 CDT 2017
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
17/04/11 08:51:37 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/11 08:51:37 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/11 08:51:37 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
Connected to: Spark SQL (version 2.1.0.2.6.0.3-8)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  *
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> from
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h8_30_to_9
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk   
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s1,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h9_to_9_30 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 9 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s2,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h9_30_to_10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 9
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s3,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h10_to_10_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s4,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h10_30_to_11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s5,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h11_to_11_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s6,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h11_30_to_12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s7,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h12_to_12_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> ;
Error: org.apache.spark.sql.AnalysisException: Detected cartesian product for INNER join between logical plans
Join Inner
:- Join Inner
:  :- Join Inner
:  :  :- Join Inner
:  :  :  :- Join Inner
:  :  :  :  :- Join Inner
:  :  :  :  :  :- Aggregate [count(1) AS h8_30_to_9#193473L]
:  :  :  :  :  :  +- Project
:  :  :  :  :  :     +- Join Inner, (ss_store_sk#193488 = s_store_sk#193519)
:  :  :  :  :  :        :- Project [ss_store_sk#193488]
:  :  :  :  :  :        :  +- Join Inner, (ss_sold_time_sk#193482 = t_time_sk#193509)
:  :  :  :  :  :        :     :- Project [ss_sold_time_sk#193482, ss_store_sk#193488]
:  :  :  :  :  :        :     :  +- Join Inner, (ss_hdemo_sk#193486 = hd_demo_sk#193504)
:  :  :  :  :  :        :     :     :- Project [ss_sold_time_sk#193482, ss_hdemo_sk#193486, ss_store_sk#193488]
:  :  :  :  :  :        :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#193486) && isnotnull(ss_sold_time_sk#193482)) && isnotnull(ss_store_sk#193488))
:  :  :  :  :  :        :     :     :     +- Relation[ss_sold_time_sk#193482,ss_item_sk#193483,ss_customer_sk#193484,ss_cdemo_sk#193485,ss_hdemo_sk#193486,ss_addr_sk#193487,ss_store_sk#193488,ss_promo_sk#193489,ss_ticket_number#193490,ss_quantity#193491,ss_wholesale_cost#193492,ss_list_price#193493,ss_sales_price#193494,ss_ext_discount_amt#193495,ss_ext_sales_price#193496,ss_ext_wholesale_cost#193497,ss_ext_list_price#193498,ss_ext_tax#193499,ss_coupon_amt#193500,ss_net_paid#193501,ss_net_paid_inc_tax#193502,ss_net_profit#193503,ss_sold_date_sk#193481] parquet
:  :  :  :  :  :        :     :     +- Project [hd_demo_sk#193504]
:  :  :  :  :  :        :     :        +- Filter (((((hd_dep_count#193507 = 3) && (hd_vehicle_count#193508 <= 5)) || ((hd_dep_count#193507 = 0) && (hd_vehicle_count#193508 <= 2))) || ((hd_dep_count#193507 = 1) && (hd_vehicle_count#193508 <= 3))) && isnotnull(hd_demo_sk#193504))
:  :  :  :  :  :        :     :           +- InMemoryRelation [hd_demo_sk#193504, hd_income_band_sk#193505, hd_buy_potential#193506, hd_dep_count#193507, hd_vehicle_count#193508], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:  :  :  :  :  :        :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:  :  :  :  :  :        :     +- Project [t_time_sk#193509]
:  :  :  :  :  :        :        +- Filter (((isnotnull(t_hour#193512) && isnotnull(t_minute#193513)) && ((t_hour#193512 = 8) && (t_minute#193513 >= 30))) && isnotnull(t_time_sk#193509))
:  :  :  :  :  :        :           +- InMemoryRelation [t_time_sk#193509, t_time_id#193510, t_time#193511, t_hour#193512, t_minute#193513, t_second#193514, t_am_pm#193515, t_shift#193516, t_sub_shift#193517, t_meal_time#193518], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:  :  :  :  :  :        :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:  :  :  :  :  :        +- Project [s_store_sk#193519]
:  :  :  :  :  :           +- Filter ((isnotnull(s_store_name#193524) && (s_store_name#193524 = ese)) && isnotnull(s_store_sk#193519))
:  :  :  :  :  :              +- InMemoryRelation [s_store_sk#193519, s_store_id#193520, s_rec_start_date#193521, s_rec_end_date#193522, s_closed_date_sk#193523, s_store_name#193524, s_number_employees#193525, s_floor_space#193526, s_hours#193527, s_manager#193528, s_market_id#193529, s_geography_class#193530, s_market_desc#193531, s_market_manager#193532, s_division_id#193533, s_division_name#193534, s_company_id#193535, s_company_name#193536, s_street_number#193537, s_street_name#193538, s_street_type#193539, s_suite_number#193540, s_city#193541, s_county#193542, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:  :  :  :  :  :                    +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
:  :  :  :  :  +- Aggregate [count(1) AS h9_to_9_30#193474L]
:  :  :  :  :     +- Project
:  :  :  :  :        +- Join Inner, (ss_store_sk#193555 = s_store_sk#193586)
:  :  :  :  :           :- Project [ss_store_sk#193555]
:  :  :  :  :           :  +- Join Inner, (ss_sold_time_sk#193549 = t_time_sk#193576)
:  :  :  :  :           :     :- Project [ss_sold_time_sk#193549, ss_store_sk#193555]
:  :  :  :  :           :     :  +- Join Inner, (ss_hdemo_sk#193553 = hd_demo_sk#193571)
:  :  :  :  :           :     :     :- Project [ss_sold_time_sk#193549, ss_hdemo_sk#193553, ss_store_sk#193555]
:  :  :  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#193553) && isnotnull(ss_sold_time_sk#193549)) && isnotnull(ss_store_sk#193555))
:  :  :  :  :           :     :     :     +- Relation[ss_sold_time_sk#193549,ss_item_sk#193550,ss_customer_sk#193551,ss_cdemo_sk#193552,ss_hdemo_sk#193553,ss_addr_sk#193554,ss_store_sk#193555,ss_promo_sk#193556,ss_ticket_number#193557,ss_quantity#193558,ss_wholesale_cost#193559,ss_list_price#193560,ss_sales_price#193561,ss_ext_discount_amt#193562,ss_ext_sales_price#193563,ss_ext_wholesale_cost#193564,ss_ext_list_price#193565,ss_ext_tax#193566,ss_coupon_amt#193567,ss_net_paid#193568,ss_net_paid_inc_tax#193569,ss_net_profit#193570,ss_sold_date_sk#193548] parquet
:  :  :  :  :           :     :     +- Project [hd_demo_sk#193571]
:  :  :  :  :           :     :        +- Filter (((((hd_dep_count#193574 = 3) && (hd_vehicle_count#193575 <= 5)) || ((hd_dep_count#193574 = 0) && (hd_vehicle_count#193575 <= 2))) || ((hd_dep_count#193574 = 1) && (hd_vehicle_count#193575 <= 3))) && isnotnull(hd_demo_sk#193571))
:  :  :  :  :           :     :           +- InMemoryRelation [hd_demo_sk#193571, hd_income_band_sk#193572, hd_buy_potential#193573, hd_dep_count#193574, hd_vehicle_count#193575], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:  :  :  :  :           :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:  :  :  :  :           :     +- Project [t_time_sk#193576]
:  :  :  :  :           :        +- Filter (((isnotnull(t_hour#193579) && isnotnull(t_minute#193580)) && ((t_hour#193579 = 9) && (t_minute#193580 < 30))) && isnotnull(t_time_sk#193576))
:  :  :  :  :           :           +- InMemoryRelation [t_time_sk#193576, t_time_id#193577, t_time#193578, t_hour#193579, t_minute#193580, t_second#193581, t_am_pm#193582, t_shift#193583, t_sub_shift#193584, t_meal_time#193585], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:  :  :  :  :           :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:  :  :  :  :           +- Project [s_store_sk#193586]
:  :  :  :  :              +- Filter ((isnotnull(s_store_name#193591) && (s_store_name#193591 = ese)) && isnotnull(s_store_sk#193586))
:  :  :  :  :                 +- InMemoryRelation [s_store_sk#193586, s_store_id#193587, s_rec_start_date#193588, s_rec_end_date#193589, s_closed_date_sk#193590, s_store_name#193591, s_number_employees#193592, s_floor_space#193593, s_hours#193594, s_manager#193595, s_market_id#193596, s_geography_class#193597, s_market_desc#193598, s_market_manager#193599, s_division_id#193600, s_division_name#193601, s_company_id#193602, s_company_name#193603, s_street_number#193604, s_street_name#193605, s_street_type#193606, s_suite_number#193607, s_city#193608, s_county#193609, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:  :  :  :  :                       +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
:  :  :  :  +- Aggregate [count(1) AS h9_30_to_10#193475L]
:  :  :  :     +- Project
:  :  :  :        +- Join Inner, (ss_store_sk#193622 = s_store_sk#193653)
:  :  :  :           :- Project [ss_store_sk#193622]
:  :  :  :           :  +- Join Inner, (ss_sold_time_sk#193616 = t_time_sk#193643)
:  :  :  :           :     :- Project [ss_sold_time_sk#193616, ss_store_sk#193622]
:  :  :  :           :     :  +- Join Inner, (ss_hdemo_sk#193620 = hd_demo_sk#193638)
:  :  :  :           :     :     :- Project [ss_sold_time_sk#193616, ss_hdemo_sk#193620, ss_store_sk#193622]
:  :  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#193620) && isnotnull(ss_sold_time_sk#193616)) && isnotnull(ss_store_sk#193622))
:  :  :  :           :     :     :     +- Relation[ss_sold_time_sk#193616,ss_item_sk#193617,ss_customer_sk#193618,ss_cdemo_sk#193619,ss_hdemo_sk#193620,ss_addr_sk#193621,ss_store_sk#193622,ss_promo_sk#193623,ss_ticket_number#193624,ss_quantity#193625,ss_wholesale_cost#193626,ss_list_price#193627,ss_sales_price#193628,ss_ext_discount_amt#193629,ss_ext_sales_price#193630,ss_ext_wholesale_cost#193631,ss_ext_list_price#193632,ss_ext_tax#193633,ss_coupon_amt#193634,ss_net_paid#193635,ss_net_paid_inc_tax#193636,ss_net_profit#193637,ss_sold_date_sk#193615] parquet
:  :  :  :           :     :     +- Project [hd_demo_sk#193638]
:  :  :  :           :     :        +- Filter (((((hd_dep_count#193641 = 3) && (hd_vehicle_count#193642 <= 5)) || ((hd_dep_count#193641 = 0) && (hd_vehicle_count#193642 <= 2))) || ((hd_dep_count#193641 = 1) && (hd_vehicle_count#193642 <= 3))) && isnotnull(hd_demo_sk#193638))
:  :  :  :           :     :           +- InMemoryRelation [hd_demo_sk#193638, hd_income_band_sk#193639, hd_buy_potential#193640, hd_dep_count#193641, hd_vehicle_count#193642], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:  :  :  :           :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:  :  :  :           :     +- Project [t_time_sk#193643]
:  :  :  :           :        +- Filter (((isnotnull(t_hour#193646) && isnotnull(t_minute#193647)) && ((t_hour#193646 = 9) && (t_minute#193647 >= 30))) && isnotnull(t_time_sk#193643))
:  :  :  :           :           +- InMemoryRelation [t_time_sk#193643, t_time_id#193644, t_time#193645, t_hour#193646, t_minute#193647, t_second#193648, t_am_pm#193649, t_shift#193650, t_sub_shift#193651, t_meal_time#193652], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:  :  :  :           :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:  :  :  :           +- Project [s_store_sk#193653]
:  :  :  :              +- Filter ((isnotnull(s_store_name#193658) && (s_store_name#193658 = ese)) && isnotnull(s_store_sk#193653))
:  :  :  :                 +- InMemoryRelation [s_store_sk#193653, s_store_id#193654, s_rec_start_date#193655, s_rec_end_date#193656, s_closed_date_sk#193657, s_store_name#193658, s_number_employees#193659, s_floor_space#193660, s_hours#193661, s_manager#193662, s_market_id#193663, s_geography_class#193664, s_market_desc#193665, s_market_manager#193666, s_division_id#193667, s_division_name#193668, s_company_id#193669, s_company_name#193670, s_street_number#193671, s_street_name#193672, s_street_type#193673, s_suite_number#193674, s_city#193675, s_county#193676, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:  :  :  :                       +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
:  :  :  +- Aggregate [count(1) AS h10_to_10_30#193476L]
:  :  :     +- Project
:  :  :        +- Join Inner, (ss_store_sk#193689 = s_store_sk#193720)
:  :  :           :- Project [ss_store_sk#193689]
:  :  :           :  +- Join Inner, (ss_sold_time_sk#193683 = t_time_sk#193710)
:  :  :           :     :- Project [ss_sold_time_sk#193683, ss_store_sk#193689]
:  :  :           :     :  +- Join Inner, (ss_hdemo_sk#193687 = hd_demo_sk#193705)
:  :  :           :     :     :- Project [ss_sold_time_sk#193683, ss_hdemo_sk#193687, ss_store_sk#193689]
:  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#193687) && isnotnull(ss_sold_time_sk#193683)) && isnotnull(ss_store_sk#193689))
:  :  :           :     :     :     +- Relation[ss_sold_time_sk#193683,ss_item_sk#193684,ss_customer_sk#193685,ss_cdemo_sk#193686,ss_hdemo_sk#193687,ss_addr_sk#193688,ss_store_sk#193689,ss_promo_sk#193690,ss_ticket_number#193691,ss_quantity#193692,ss_wholesale_cost#193693,ss_list_price#193694,ss_sales_price#193695,ss_ext_discount_amt#193696,ss_ext_sales_price#193697,ss_ext_wholesale_cost#193698,ss_ext_list_price#193699,ss_ext_tax#193700,ss_coupon_amt#193701,ss_net_paid#193702,ss_net_paid_inc_tax#193703,ss_net_profit#193704,ss_sold_date_sk#193682] parquet
:  :  :           :     :     +- Project [hd_demo_sk#193705]
:  :  :           :     :        +- Filter (((((hd_dep_count#193708 = 3) && (hd_vehicle_count#193709 <= 5)) || ((hd_dep_count#193708 = 0) && (hd_vehicle_count#193709 <= 2))) || ((hd_dep_count#193708 = 1) && (hd_vehicle_count#193709 <= 3))) && isnotnull(hd_demo_sk#193705))
:  :  :           :     :           +- InMemoryRelation [hd_demo_sk#193705, hd_income_band_sk#193706, hd_buy_potential#193707, hd_dep_count#193708, hd_vehicle_count#193709], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:  :  :           :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:  :  :           :     +- Project [t_time_sk#193710]
:  :  :           :        +- Filter (((isnotnull(t_hour#193713) && isnotnull(t_minute#193714)) && ((t_hour#193713 = 10) && (t_minute#193714 < 30))) && isnotnull(t_time_sk#193710))
:  :  :           :           +- InMemoryRelation [t_time_sk#193710, t_time_id#193711, t_time#193712, t_hour#193713, t_minute#193714, t_second#193715, t_am_pm#193716, t_shift#193717, t_sub_shift#193718, t_meal_time#193719], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:  :  :           :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:  :  :           +- Project [s_store_sk#193720]
:  :  :              +- Filter ((isnotnull(s_store_name#193725) && (s_store_name#193725 = ese)) && isnotnull(s_store_sk#193720))
:  :  :                 +- InMemoryRelation [s_store_sk#193720, s_store_id#193721, s_rec_start_date#193722, s_rec_end_date#193723, s_closed_date_sk#193724, s_store_name#193725, s_number_employees#193726, s_floor_space#193727, s_hours#193728, s_manager#193729, s_market_id#193730, s_geography_class#193731, s_market_desc#193732, s_market_manager#193733, s_division_id#193734, s_division_name#193735, s_company_id#193736, s_company_name#193737, s_street_number#193738, s_street_name#193739, s_street_type#193740, s_suite_number#193741, s_city#193742, s_county#193743, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:  :  :                       +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
:  :  +- Aggregate [count(1) AS h10_30_to_11#193477L]
:  :     +- Project
:  :        +- Join Inner, (ss_store_sk#193756 = s_store_sk#193787)
:  :           :- Project [ss_store_sk#193756]
:  :           :  +- Join Inner, (ss_sold_time_sk#193750 = t_time_sk#193777)
:  :           :     :- Project [ss_sold_time_sk#193750, ss_store_sk#193756]
:  :           :     :  +- Join Inner, (ss_hdemo_sk#193754 = hd_demo_sk#193772)
:  :           :     :     :- Project [ss_sold_time_sk#193750, ss_hdemo_sk#193754, ss_store_sk#193756]
:  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#193754) && isnotnull(ss_sold_time_sk#193750)) && isnotnull(ss_store_sk#193756))
:  :           :     :     :     +- Relation[ss_sold_time_sk#193750,ss_item_sk#193751,ss_customer_sk#193752,ss_cdemo_sk#193753,ss_hdemo_sk#193754,ss_addr_sk#193755,ss_store_sk#193756,ss_promo_sk#193757,ss_ticket_number#193758,ss_quantity#193759,ss_wholesale_cost#193760,ss_list_price#193761,ss_sales_price#193762,ss_ext_discount_amt#193763,ss_ext_sales_price#193764,ss_ext_wholesale_cost#193765,ss_ext_list_price#193766,ss_ext_tax#193767,ss_coupon_amt#193768,ss_net_paid#193769,ss_net_paid_inc_tax#193770,ss_net_profit#193771,ss_sold_date_sk#193749] parquet
:  :           :     :     +- Project [hd_demo_sk#193772]
:  :           :     :        +- Filter (((((hd_dep_count#193775 = 3) && (hd_vehicle_count#193776 <= 5)) || ((hd_dep_count#193775 = 0) && (hd_vehicle_count#193776 <= 2))) || ((hd_dep_count#193775 = 1) && (hd_vehicle_count#193776 <= 3))) && isnotnull(hd_demo_sk#193772))
:  :           :     :           +- InMemoryRelation [hd_demo_sk#193772, hd_income_band_sk#193773, hd_buy_potential#193774, hd_dep_count#193775, hd_vehicle_count#193776], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:  :           :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:  :           :     +- Project [t_time_sk#193777]
:  :           :        +- Filter (((isnotnull(t_hour#193780) && isnotnull(t_minute#193781)) && ((t_hour#193780 = 10) && (t_minute#193781 >= 30))) && isnotnull(t_time_sk#193777))
:  :           :           +- InMemoryRelation [t_time_sk#193777, t_time_id#193778, t_time#193779, t_hour#193780, t_minute#193781, t_second#193782, t_am_pm#193783, t_shift#193784, t_sub_shift#193785, t_meal_time#193786], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:  :           :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:  :           +- Project [s_store_sk#193787]
:  :              +- Filter ((isnotnull(s_store_name#193792) && (s_store_name#193792 = ese)) && isnotnull(s_store_sk#193787))
:  :                 +- InMemoryRelation [s_store_sk#193787, s_store_id#193788, s_rec_start_date#193789, s_rec_end_date#193790, s_closed_date_sk#193791, s_store_name#193792, s_number_employees#193793, s_floor_space#193794, s_hours#193795, s_manager#193796, s_market_id#193797, s_geography_class#193798, s_market_desc#193799, s_market_manager#193800, s_division_id#193801, s_division_name#193802, s_company_id#193803, s_company_name#193804, s_street_number#193805, s_street_name#193806, s_street_type#193807, s_suite_number#193808, s_city#193809, s_county#193810, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:  :                       +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
:  +- Aggregate [count(1) AS h11_to_11_30#193478L]
:     +- Project
:        +- Join Inner, (ss_store_sk#193823 = s_store_sk#193854)
:           :- Project [ss_store_sk#193823]
:           :  +- Join Inner, (ss_sold_time_sk#193817 = t_time_sk#193844)
:           :     :- Project [ss_sold_time_sk#193817, ss_store_sk#193823]
:           :     :  +- Join Inner, (ss_hdemo_sk#193821 = hd_demo_sk#193839)
:           :     :     :- Project [ss_sold_time_sk#193817, ss_hdemo_sk#193821, ss_store_sk#193823]
:           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#193821) && isnotnull(ss_sold_time_sk#193817)) && isnotnull(ss_store_sk#193823))
:           :     :     :     +- Relation[ss_sold_time_sk#193817,ss_item_sk#193818,ss_customer_sk#193819,ss_cdemo_sk#193820,ss_hdemo_sk#193821,ss_addr_sk#193822,ss_store_sk#193823,ss_promo_sk#193824,ss_ticket_number#193825,ss_quantity#193826,ss_wholesale_cost#193827,ss_list_price#193828,ss_sales_price#193829,ss_ext_discount_amt#193830,ss_ext_sales_price#193831,ss_ext_wholesale_cost#193832,ss_ext_list_price#193833,ss_ext_tax#193834,ss_coupon_amt#193835,ss_net_paid#193836,ss_net_paid_inc_tax#193837,ss_net_profit#193838,ss_sold_date_sk#193816] parquet
:           :     :     +- Project [hd_demo_sk#193839]
:           :     :        +- Filter (((((hd_dep_count#193842 = 3) && (hd_vehicle_count#193843 <= 5)) || ((hd_dep_count#193842 = 0) && (hd_vehicle_count#193843 <= 2))) || ((hd_dep_count#193842 = 1) && (hd_vehicle_count#193843 <= 3))) && isnotnull(hd_demo_sk#193839))
:           :     :           +- InMemoryRelation [hd_demo_sk#193839, hd_income_band_sk#193840, hd_buy_potential#193841, hd_dep_count#193842, hd_vehicle_count#193843], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:           :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:           :     +- Project [t_time_sk#193844]
:           :        +- Filter (((isnotnull(t_hour#193847) && isnotnull(t_minute#193848)) && ((t_hour#193847 = 11) && (t_minute#193848 < 30))) && isnotnull(t_time_sk#193844))
:           :           +- InMemoryRelation [t_time_sk#193844, t_time_id#193845, t_time#193846, t_hour#193847, t_minute#193848, t_second#193849, t_am_pm#193850, t_shift#193851, t_sub_shift#193852, t_meal_time#193853], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:           :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:           +- Project [s_store_sk#193854]
:              +- Filter ((isnotnull(s_store_name#193859) && (s_store_name#193859 = ese)) && isnotnull(s_store_sk#193854))
:                 +- InMemoryRelation [s_store_sk#193854, s_store_id#193855, s_rec_start_date#193856, s_rec_end_date#193857, s_closed_date_sk#193858, s_store_name#193859, s_number_employees#193860, s_floor_space#193861, s_hours#193862, s_manager#193863, s_market_id#193864, s_geography_class#193865, s_market_desc#193866, s_market_manager#193867, s_division_id#193868, s_division_name#193869, s_company_id#193870, s_company_name#193871, s_street_number#193872, s_street_name#193873, s_street_type#193874, s_suite_number#193875, s_city#193876, s_county#193877, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:                       +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
+- Aggregate [count(1) AS h11_30_to_12#193479L]
   +- Project
      +- Join Inner, (ss_store_sk#193890 = s_store_sk#193921)
         :- Project [ss_store_sk#193890]
         :  +- Join Inner, (ss_sold_time_sk#193884 = t_time_sk#193911)
         :     :- Project [ss_sold_time_sk#193884, ss_store_sk#193890]
         :     :  +- Join Inner, (ss_hdemo_sk#193888 = hd_demo_sk#193906)
         :     :     :- Project [ss_sold_time_sk#193884, ss_hdemo_sk#193888, ss_store_sk#193890]
         :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#193888) && isnotnull(ss_sold_time_sk#193884)) && isnotnull(ss_store_sk#193890))
         :     :     :     +- Relation[ss_sold_time_sk#193884,ss_item_sk#193885,ss_customer_sk#193886,ss_cdemo_sk#193887,ss_hdemo_sk#193888,ss_addr_sk#193889,ss_store_sk#193890,ss_promo_sk#193891,ss_ticket_number#193892,ss_quantity#193893,ss_wholesale_cost#193894,ss_list_price#193895,ss_sales_price#193896,ss_ext_discount_amt#193897,ss_ext_sales_price#193898,ss_ext_wholesale_cost#193899,ss_ext_list_price#193900,ss_ext_tax#193901,ss_coupon_amt#193902,ss_net_paid#193903,ss_net_paid_inc_tax#193904,ss_net_profit#193905,ss_sold_date_sk#193883] parquet
         :     :     +- Project [hd_demo_sk#193906]
         :     :        +- Filter (((((hd_dep_count#193909 = 3) && (hd_vehicle_count#193910 <= 5)) || ((hd_dep_count#193909 = 0) && (hd_vehicle_count#193910 <= 2))) || ((hd_dep_count#193909 = 1) && (hd_vehicle_count#193910 <= 3))) && isnotnull(hd_demo_sk#193906))
         :     :           +- InMemoryRelation [hd_demo_sk#193906, hd_income_band_sk#193907, hd_buy_potential#193908, hd_dep_count#193909, hd_vehicle_count#193910], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
         :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
         :     +- Project [t_time_sk#193911]
         :        +- Filter (((isnotnull(t_hour#193914) && isnotnull(t_minute#193915)) && ((t_hour#193914 = 11) && (t_minute#193915 >= 30))) && isnotnull(t_time_sk#193911))
         :           +- InMemoryRelation [t_time_sk#193911, t_time_id#193912, t_time#193913, t_hour#193914, t_minute#193915, t_second#193916, t_am_pm#193917, t_shift#193918, t_sub_shift#193919, t_meal_time#193920], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
         :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
         +- Project [s_store_sk#193921]
            +- Filter ((isnotnull(s_store_name#193926) && (s_store_name#193926 = ese)) && isnotnull(s_store_sk#193921))
               +- InMemoryRelation [s_store_sk#193921, s_store_id#193922, s_rec_start_date#193923, s_rec_end_date#193924, s_closed_date_sk#193925, s_store_name#193926, s_number_employees#193927, s_floor_space#193928, s_hours#193929, s_manager#193930, s_market_id#193931, s_geography_class#193932, s_market_desc#193933, s_market_manager#193934, s_division_id#193935, s_division_name#193936, s_company_id#193937, s_company_name#193938, s_street_number#193939, s_street_name#193940, s_street_type#193941, s_suite_number#193942, s_city#193943, s_county#193944, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
                     +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
and
Aggregate [count(1) AS h12_to_12_30#193480L]
+- Project
   +- Join Inner, (ss_store_sk#193957 = s_store_sk#193988)
      :- Project [ss_store_sk#193957]
      :  +- Join Inner, (ss_sold_time_sk#193951 = t_time_sk#193978)
      :     :- Project [ss_sold_time_sk#193951, ss_store_sk#193957]
      :     :  +- Join Inner, (ss_hdemo_sk#193955 = hd_demo_sk#193973)
      :     :     :- Project [ss_sold_time_sk#193951, ss_hdemo_sk#193955, ss_store_sk#193957]
      :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#193955) && isnotnull(ss_sold_time_sk#193951)) && isnotnull(ss_store_sk#193957))
      :     :     :     +- Relation[ss_sold_time_sk#193951,ss_item_sk#193952,ss_customer_sk#193953,ss_cdemo_sk#193954,ss_hdemo_sk#193955,ss_addr_sk#193956,ss_store_sk#193957,ss_promo_sk#193958,ss_ticket_number#193959,ss_quantity#193960,ss_wholesale_cost#193961,ss_list_price#193962,ss_sales_price#193963,ss_ext_discount_amt#193964,ss_ext_sales_price#193965,ss_ext_wholesale_cost#193966,ss_ext_list_price#193967,ss_ext_tax#193968,ss_coupon_amt#193969,ss_net_paid#193970,ss_net_paid_inc_tax#193971,ss_net_profit#193972,ss_sold_date_sk#193950] parquet
      :     :     +- Project [hd_demo_sk#193973]
      :     :        +- Filter (((((hd_dep_count#193976 = 3) && (hd_vehicle_count#193977 <= 5)) || ((hd_dep_count#193976 = 0) && (hd_vehicle_count#193977 <= 2))) || ((hd_dep_count#193976 = 1) && (hd_vehicle_count#193977 <= 3))) && isnotnull(hd_demo_sk#193973))
      :     :           +- InMemoryRelation [hd_demo_sk#193973, hd_income_band_sk#193974, hd_buy_potential#193975, hd_dep_count#193976, hd_vehicle_count#193977], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
      :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
      :     +- Project [t_time_sk#193978]
      :        +- Filter (((isnotnull(t_hour#193981) && isnotnull(t_minute#193982)) && ((t_hour#193981 = 12) && (t_minute#193982 < 30))) && isnotnull(t_time_sk#193978))
      :           +- InMemoryRelation [t_time_sk#193978, t_time_id#193979, t_time#193980, t_hour#193981, t_minute#193982, t_second#193983, t_am_pm#193984, t_shift#193985, t_sub_shift#193986, t_meal_time#193987], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
      :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
      +- Project [s_store_sk#193988]
         +- Filter ((isnotnull(s_store_name#193993) && (s_store_name#193993 = ese)) && isnotnull(s_store_sk#193988))
            +- InMemoryRelation [s_store_sk#193988, s_store_id#193989, s_rec_start_date#193990, s_rec_end_date#193991, s_closed_date_sk#193992, s_store_name#193993, s_number_employees#193994, s_floor_space#193995, s_hours#193996, s_manager#193997, s_market_id#193998, s_geography_class#193999, s_market_desc#194000, s_market_manager#194001, s_division_id#194002, s_division_name#194003, s_company_id#194004, s_company_name#194005, s_street_number#194006, s_street_name#194007, s_street_type#194008, s_suite_number#194009, s_city#194010, s_county#194011, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
                  +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
Join condition is missing or trivial.
Use the CROSS JOIN syntax to allow cartesian products between these relations.; (state=,code=0)

Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
STOP hdp2.6_spark21_run_1000_1_query88_sql_2017-04-11-08-51:  Tue Apr 11 08:51:41 CDT 2017
