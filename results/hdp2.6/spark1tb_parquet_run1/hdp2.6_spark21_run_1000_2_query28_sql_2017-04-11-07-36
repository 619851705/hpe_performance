START hdp2.6_spark21_run_1000_2_query28_sql_2017-04-11-07-36:  Tue Apr 11 07:36:11 CDT 2017
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
17/04/11 07:36:12 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/11 07:36:12 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/11 07:36:12 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
Connected to: Spark SQL (version 2.1.0.2.6.0.3-8)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  *
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> from (select avg(ss_list_price) B1_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B1_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B1_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 0 and 5
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 11 and 11+10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              or ss_coupon_amt between 460 and 460+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>              or ss_wholesale_cost between 14 and 14+20)) B1,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B2_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B2_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B2_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 6 and 10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 91 and 91+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 1430 and 1430+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 32 and 32+20)) B2,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B3_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B3_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B3_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 11 and 15
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 66 and 66+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 920 and 920+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 4 and 4+20)) B3,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B4_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B4_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B4_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 16 and 20
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 142 and 142+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 3054 and 3054+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 80 and 80+20)) B4,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B5_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B5_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B5_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 21 and 25
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 135 and 135+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 14180 and 14180+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 38 and 38+20)) B5,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      (select avg(ss_list_price) B6_LP
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(ss_list_price) B6_CNT
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>             ,count(distinct ss_list_price) B6_CNTD
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       from store_sales
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       where ss_quantity between 26 and 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>         and (ss_list_price between 28 and 28+10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_coupon_amt between 2513 and 2513+1000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           or ss_wholesale_cost between 42 and 42+20)) B6
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> limit 100;
Error: org.apache.spark.sql.AnalysisException: Detected cartesian product for INNER join between logical plans
Join Inner
:- Join Inner
:  :- Join Inner
:  :  :- Join Inner
:  :  :  :- Aggregate [avg(cast(ss_list_price#42698 as double)) AS B1_LP#42668, count(ss_list_price#42698) AS B1_CNT#42669L, count(distinct ss_list_price#42698) AS B1_CNTD#42670L]
:  :  :  :  +- Project [ss_list_price#42698]
:  :  :  :     +- Filter (isnotnull(ss_quantity#42696) && (((ss_quantity#42696 >= 0) && (ss_quantity#42696 <= 5)) && ((((ss_list_price#42698 >= 11.0) && (ss_list_price#42698 <= 21.0)) || ((ss_coupon_amt#42705 >= 460.0) && (ss_coupon_amt#42705 <= 1460.0))) || ((ss_wholesale_cost#42697 >= 14.0) && (ss_wholesale_cost#42697 <= 34.0)))))
:  :  :  :        +- Relation[ss_sold_time_sk#42687,ss_item_sk#42688,ss_customer_sk#42689,ss_cdemo_sk#42690,ss_hdemo_sk#42691,ss_addr_sk#42692,ss_store_sk#42693,ss_promo_sk#42694,ss_ticket_number#42695,ss_quantity#42696,ss_wholesale_cost#42697,ss_list_price#42698,ss_sales_price#42699,ss_ext_discount_amt#42700,ss_ext_sales_price#42701,ss_ext_wholesale_cost#42702,ss_ext_list_price#42703,ss_ext_tax#42704,ss_coupon_amt#42705,ss_net_paid#42706,ss_net_paid_inc_tax#42707,ss_net_profit#42708,ss_sold_date_sk#42686] parquet
:  :  :  +- Aggregate [avg(cast(ss_list_price#42721 as double)) AS B2_LP#42671, count(ss_list_price#42721) AS B2_CNT#42672L, count(distinct ss_list_price#42721) AS B2_CNTD#42673L]
:  :  :     +- Project [ss_list_price#42721]
:  :  :        +- Filter (isnotnull(ss_quantity#42719) && (((ss_quantity#42719 >= 6) && (ss_quantity#42719 <= 10)) && ((((ss_list_price#42721 >= 91.0) && (ss_list_price#42721 <= 101.0)) || ((ss_coupon_amt#42728 >= 1430.0) && (ss_coupon_amt#42728 <= 2430.0))) || ((ss_wholesale_cost#42720 >= 32.0) && (ss_wholesale_cost#42720 <= 52.0)))))
:  :  :           +- Relation[ss_sold_time_sk#42710,ss_item_sk#42711,ss_customer_sk#42712,ss_cdemo_sk#42713,ss_hdemo_sk#42714,ss_addr_sk#42715,ss_store_sk#42716,ss_promo_sk#42717,ss_ticket_number#42718,ss_quantity#42719,ss_wholesale_cost#42720,ss_list_price#42721,ss_sales_price#42722,ss_ext_discount_amt#42723,ss_ext_sales_price#42724,ss_ext_wholesale_cost#42725,ss_ext_list_price#42726,ss_ext_tax#42727,ss_coupon_amt#42728,ss_net_paid#42729,ss_net_paid_inc_tax#42730,ss_net_profit#42731,ss_sold_date_sk#42709] parquet
:  :  +- Aggregate [avg(cast(ss_list_price#42744 as double)) AS B3_LP#42674, count(ss_list_price#42744) AS B3_CNT#42675L, count(distinct ss_list_price#42744) AS B3_CNTD#42676L]
:  :     +- Project [ss_list_price#42744]
:  :        +- Filter (isnotnull(ss_quantity#42742) && (((ss_quantity#42742 >= 11) && (ss_quantity#42742 <= 15)) && ((((ss_list_price#42744 >= 66.0) && (ss_list_price#42744 <= 76.0)) || ((ss_coupon_amt#42751 >= 920.0) && (ss_coupon_amt#42751 <= 1920.0))) || ((ss_wholesale_cost#42743 >= 4.0) && (ss_wholesale_cost#42743 <= 24.0)))))
:  :           +- Relation[ss_sold_time_sk#42733,ss_item_sk#42734,ss_customer_sk#42735,ss_cdemo_sk#42736,ss_hdemo_sk#42737,ss_addr_sk#42738,ss_store_sk#42739,ss_promo_sk#42740,ss_ticket_number#42741,ss_quantity#42742,ss_wholesale_cost#42743,ss_list_price#42744,ss_sales_price#42745,ss_ext_discount_amt#42746,ss_ext_sales_price#42747,ss_ext_wholesale_cost#42748,ss_ext_list_price#42749,ss_ext_tax#42750,ss_coupon_amt#42751,ss_net_paid#42752,ss_net_paid_inc_tax#42753,ss_net_profit#42754,ss_sold_date_sk#42732] parquet
:  +- Aggregate [avg(cast(ss_list_price#42767 as double)) AS B4_LP#42677, count(ss_list_price#42767) AS B4_CNT#42678L, count(distinct ss_list_price#42767) AS B4_CNTD#42679L]
:     +- Project [ss_list_price#42767]
:        +- Filter (isnotnull(ss_quantity#42765) && (((ss_quantity#42765 >= 16) && (ss_quantity#42765 <= 20)) && ((((ss_list_price#42767 >= 142.0) && (ss_list_price#42767 <= 152.0)) || ((ss_coupon_amt#42774 >= 3054.0) && (ss_coupon_amt#42774 <= 4054.0))) || ((ss_wholesale_cost#42766 >= 80.0) && (ss_wholesale_cost#42766 <= 100.0)))))
:           +- Relation[ss_sold_time_sk#42756,ss_item_sk#42757,ss_customer_sk#42758,ss_cdemo_sk#42759,ss_hdemo_sk#42760,ss_addr_sk#42761,ss_store_sk#42762,ss_promo_sk#42763,ss_ticket_number#42764,ss_quantity#42765,ss_wholesale_cost#42766,ss_list_price#42767,ss_sales_price#42768,ss_ext_discount_amt#42769,ss_ext_sales_price#42770,ss_ext_wholesale_cost#42771,ss_ext_list_price#42772,ss_ext_tax#42773,ss_coupon_amt#42774,ss_net_paid#42775,ss_net_paid_inc_tax#42776,ss_net_profit#42777,ss_sold_date_sk#42755] parquet
+- Aggregate [avg(cast(ss_list_price#42790 as double)) AS B5_LP#42680, count(ss_list_price#42790) AS B5_CNT#42681L, count(distinct ss_list_price#42790) AS B5_CNTD#42682L]
   +- Project [ss_list_price#42790]
      +- Filter (isnotnull(ss_quantity#42788) && (((ss_quantity#42788 >= 21) && (ss_quantity#42788 <= 25)) && ((((ss_list_price#42790 >= 135.0) && (ss_list_price#42790 <= 145.0)) || ((ss_coupon_amt#42797 >= 14180.0) && (ss_coupon_amt#42797 <= 15180.0))) || ((ss_wholesale_cost#42789 >= 38.0) && (ss_wholesale_cost#42789 <= 58.0)))))
         +- Relation[ss_sold_time_sk#42779,ss_item_sk#42780,ss_customer_sk#42781,ss_cdemo_sk#42782,ss_hdemo_sk#42783,ss_addr_sk#42784,ss_store_sk#42785,ss_promo_sk#42786,ss_ticket_number#42787,ss_quantity#42788,ss_wholesale_cost#42789,ss_list_price#42790,ss_sales_price#42791,ss_ext_discount_amt#42792,ss_ext_sales_price#42793,ss_ext_wholesale_cost#42794,ss_ext_list_price#42795,ss_ext_tax#42796,ss_coupon_amt#42797,ss_net_paid#42798,ss_net_paid_inc_tax#42799,ss_net_profit#42800,ss_sold_date_sk#42778] parquet
and
Aggregate [avg(cast(ss_list_price#42813 as double)) AS B6_LP#42683, count(ss_list_price#42813) AS B6_CNT#42684L, count(distinct ss_list_price#42813) AS B6_CNTD#42685L]
+- Project [ss_list_price#42813]
   +- Filter (isnotnull(ss_quantity#42811) && (((ss_quantity#42811 >= 26) && (ss_quantity#42811 <= 30)) && ((((ss_list_price#42813 >= 28.0) && (ss_list_price#42813 <= 38.0)) || ((ss_coupon_amt#42820 >= 2513.0) && (ss_coupon_amt#42820 <= 3513.0))) || ((ss_wholesale_cost#42812 >= 42.0) && (ss_wholesale_cost#42812 <= 62.0)))))
      +- Relation[ss_sold_time_sk#42802,ss_item_sk#42803,ss_customer_sk#42804,ss_cdemo_sk#42805,ss_hdemo_sk#42806,ss_addr_sk#42807,ss_store_sk#42808,ss_promo_sk#42809,ss_ticket_number#42810,ss_quantity#42811,ss_wholesale_cost#42812,ss_list_price#42813,ss_sales_price#42814,ss_ext_discount_amt#42815,ss_ext_sales_price#42816,ss_ext_wholesale_cost#42817,ss_ext_list_price#42818,ss_ext_tax#42819,ss_coupon_amt#42820,ss_net_paid#42821,ss_net_paid_inc_tax#42822,ss_net_profit#42823,ss_sold_date_sk#42801] parquet
Join condition is missing or trivial.
Use the CROSS JOIN syntax to allow cartesian products between these relations.; (state=,code=0)

Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
STOP hdp2.6_spark21_run_1000_2_query28_sql_2017-04-11-07-36:  Tue Apr 11 07:36:13 CDT 2017
