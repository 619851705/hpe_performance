START hdp2.6_spark21_run_1000_3_query90_sql_2017-04-11-08-54:  Tue Apr 11 08:54:31 CDT 2017
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
17/04/11 08:54:32 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/11 08:54:32 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/11 08:54:32 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
Connected to: Spark SQL (version 2.1.0.2.6.0.3-8)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  cast(amc as decimal(15,4))/cast(pmc as decimal(15,4)) am_pm_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from ( select count(*) amc
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        from web_sales, household_demographics , time_dim, web_page
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        where ws_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_web_page_sk = web_page.wp_web_page_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and time_dim.t_hour between 6 and 6+1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and household_demographics.hd_dep_count = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and web_page.wp_char_count between 5000 and 5200) at,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>       ( select count(*) pmc
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        from web_sales, household_demographics , time_dim, web_page
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>        where ws_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_ship_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and ws_web_page_sk = web_page.wp_web_page_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and time_dim.t_hour between 14 and 14+1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and household_demographics.hd_dep_count = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>          and web_page.wp_char_count between 5000 and 5200) pt
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  order by am_pm_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  limit 100;
Error: org.apache.spark.sql.AnalysisException: Detected cartesian product for INNER join between logical plans
Aggregate [count(1) AS amc#205764L]
+- Project
   +- Join Inner, (ws_web_page_sk#205779 = wp_web_page_sk#205816)
      :- Project [ws_web_page_sk#205779]
      :  +- Join Inner, (ws_sold_time_sk#205768 = t_time_sk#205806)
      :     :- Project [ws_sold_time_sk#205768, ws_web_page_sk#205779]
      :     :  +- Join Inner, (ws_ship_hdemo_sk#205777 = hd_demo_sk#205801)
      :     :     :- Project [ws_sold_time_sk#205768, ws_ship_hdemo_sk#205777, ws_web_page_sk#205779]
      :     :     :  +- Filter ((isnotnull(ws_ship_hdemo_sk#205777) && isnotnull(ws_sold_time_sk#205768)) && isnotnull(ws_web_page_sk#205779))
      :     :     :     +- Relation[ws_sold_time_sk#205768,ws_ship_date_sk#205769,ws_item_sk#205770,ws_bill_customer_sk#205771,ws_bill_cdemo_sk#205772,ws_bill_hdemo_sk#205773,ws_bill_addr_sk#205774,ws_ship_customer_sk#205775,ws_ship_cdemo_sk#205776,ws_ship_hdemo_sk#205777,ws_ship_addr_sk#205778,ws_web_page_sk#205779,ws_web_site_sk#205780,ws_ship_mode_sk#205781,ws_warehouse_sk#205782,ws_promo_sk#205783,ws_order_number#205784,ws_quantity#205785,ws_wholesale_cost#205786,ws_list_price#205787,ws_sales_price#205788,ws_ext_discount_amt#205789,ws_ext_sales_price#205790,ws_ext_wholesale_cost#205791,... 10 more fields] parquet
      :     :     +- Project [hd_demo_sk#205801]
      :     :        +- Filter ((isnotnull(hd_dep_count#205804) && (hd_dep_count#205804 = 8)) && isnotnull(hd_demo_sk#205801))
      :     :           +- InMemoryRelation [hd_demo_sk#205801, hd_income_band_sk#205802, hd_buy_potential#205803, hd_dep_count#205804, hd_vehicle_count#205805], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
      :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
      :     +- Project [t_time_sk#205806]
      :        +- Filter ((isnotnull(t_hour#205809) && ((t_hour#205809 >= 6) && (t_hour#205809 <= 7))) && isnotnull(t_time_sk#205806))
      :           +- InMemoryRelation [t_time_sk#205806, t_time_id#205807, t_time#205808, t_hour#205809, t_minute#205810, t_second#205811, t_am_pm#205812, t_shift#205813, t_sub_shift#205814, t_meal_time#205815], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
      :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
      +- Project [wp_web_page_sk#205816]
         +- Filter ((isnotnull(wp_char_count#205826) && ((wp_char_count#205826 >= 5000) && (wp_char_count#205826 <= 5200))) && isnotnull(wp_web_page_sk#205816))
            +- InMemoryRelation [wp_web_page_sk#205816, wp_web_page_id#205817, wp_rec_start_date#205818, wp_rec_end_date#205819, wp_creation_date_sk#205820, wp_access_date_sk#205821, wp_autogen_flag#205822, wp_customer_sk#205823, wp_url#205824, wp_type#205825, wp_char_count#205826, wp_link_count#205827, wp_image_count#205828, wp_max_ad_count#205829], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `web_page`
                  +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.web_page[wp_web_page_sk#3935,wp_web_page_id#3936,wp_rec_start_date#3937,wp_rec_end_date#3938,wp_creation_date_sk#3939,wp_access_date_sk#3940,wp_autogen_flag#3941,wp_customer_sk#3942,wp_url#3943,wp_type#3944,wp_char_count#3945,wp_link_count#3946,wp_image_count#3947,wp_max_ad_count#3948] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<wp_web_page_sk:int,wp_web_page_id:string,wp_rec_start_date:string,wp_rec_end_date:string,w...
and
Aggregate [count(1) AS pmc#205765L]
+- Project
   +- Join Inner, (ws_web_page_sk#205842 = wp_web_page_sk#205879)
      :- Project [ws_web_page_sk#205842]
      :  +- Join Inner, (ws_sold_time_sk#205831 = t_time_sk#205869)
      :     :- Project [ws_sold_time_sk#205831, ws_web_page_sk#205842]
      :     :  +- Join Inner, (ws_ship_hdemo_sk#205840 = hd_demo_sk#205864)
      :     :     :- Project [ws_sold_time_sk#205831, ws_ship_hdemo_sk#205840, ws_web_page_sk#205842]
      :     :     :  +- Filter ((isnotnull(ws_ship_hdemo_sk#205840) && isnotnull(ws_sold_time_sk#205831)) && isnotnull(ws_web_page_sk#205842))
      :     :     :     +- Relation[ws_sold_time_sk#205831,ws_ship_date_sk#205832,ws_item_sk#205833,ws_bill_customer_sk#205834,ws_bill_cdemo_sk#205835,ws_bill_hdemo_sk#205836,ws_bill_addr_sk#205837,ws_ship_customer_sk#205838,ws_ship_cdemo_sk#205839,ws_ship_hdemo_sk#205840,ws_ship_addr_sk#205841,ws_web_page_sk#205842,ws_web_site_sk#205843,ws_ship_mode_sk#205844,ws_warehouse_sk#205845,ws_promo_sk#205846,ws_order_number#205847,ws_quantity#205848,ws_wholesale_cost#205849,ws_list_price#205850,ws_sales_price#205851,ws_ext_discount_amt#205852,ws_ext_sales_price#205853,ws_ext_wholesale_cost#205854,... 10 more fields] parquet
      :     :     +- Project [hd_demo_sk#205864]
      :     :        +- Filter ((isnotnull(hd_dep_count#205867) && (hd_dep_count#205867 = 8)) && isnotnull(hd_demo_sk#205864))
      :     :           +- InMemoryRelation [hd_demo_sk#205864, hd_income_band_sk#205865, hd_buy_potential#205866, hd_dep_count#205867, hd_vehicle_count#205868], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
      :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
      :     +- Project [t_time_sk#205869]
      :        +- Filter ((isnotnull(t_hour#205872) && ((t_hour#205872 >= 14) && (t_hour#205872 <= 15))) && isnotnull(t_time_sk#205869))
      :           +- InMemoryRelation [t_time_sk#205869, t_time_id#205870, t_time#205871, t_hour#205872, t_minute#205873, t_second#205874, t_am_pm#205875, t_shift#205876, t_sub_shift#205877, t_meal_time#205878], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
      :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
      +- Project [wp_web_page_sk#205879]
         +- Filter ((isnotnull(wp_char_count#205889) && ((wp_char_count#205889 >= 5000) && (wp_char_count#205889 <= 5200))) && isnotnull(wp_web_page_sk#205879))
            +- InMemoryRelation [wp_web_page_sk#205879, wp_web_page_id#205880, wp_rec_start_date#205881, wp_rec_end_date#205882, wp_creation_date_sk#205883, wp_access_date_sk#205884, wp_autogen_flag#205885, wp_customer_sk#205886, wp_url#205887, wp_type#205888, wp_char_count#205889, wp_link_count#205890, wp_image_count#205891, wp_max_ad_count#205892], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `web_page`
                  +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.web_page[wp_web_page_sk#3935,wp_web_page_id#3936,wp_rec_start_date#3937,wp_rec_end_date#3938,wp_creation_date_sk#3939,wp_access_date_sk#3940,wp_autogen_flag#3941,wp_customer_sk#3942,wp_url#3943,wp_type#3944,wp_char_count#3945,wp_link_count#3946,wp_image_count#3947,wp_max_ad_count#3948] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<wp_web_page_sk:int,wp_web_page_id:string,wp_rec_start_date:string,wp_rec_end_date:string,w...
Join condition is missing or trivial.
Use the CROSS JOIN syntax to allow cartesian products between these relations.; (state=,code=0)

Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
STOP hdp2.6_spark21_run_1000_3_query90_sql_2017-04-11-08-54:  Tue Apr 11 08:54:33 CDT 2017
