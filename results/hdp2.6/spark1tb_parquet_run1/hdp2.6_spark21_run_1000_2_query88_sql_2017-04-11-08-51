START hdp2.6_spark21_run_1000_2_query88_sql_2017-04-11-08-51:  Tue Apr 11 08:51:41 CDT 2017
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
17/04/11 08:51:41 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/11 08:51:41 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/11 08:51:42 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
Connected to: Spark SQL (version 2.1.0.2.6.0.3-8)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  *
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> from
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h8_30_to_9
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk   
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2)) 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s1,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h9_to_9_30 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 9 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s2,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h9_30_to_10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 9
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s3,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h10_to_10_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s4,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h10_30_to_11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 10 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s5,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h11_to_11_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s6,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h11_30_to_12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 11
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute >= 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s7,
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select count(*) h12_to_12_30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from store_sales, household_demographics , time_dim, store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where store_sales.ss_sold_time_sk = time_dim.t_time_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_hour = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and time_dim.t_minute < 30
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and ((household_demographics.hd_dep_count = 3 and household_demographics.hd_vehicle_count<=3+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 0 and household_demographics.hd_vehicle_count<=0+2) or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>           (household_demographics.hd_dep_count = 1 and household_demographics.hd_vehicle_count<=1+2))
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>      and store.s_store_name = 'ese') s8
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> ;
Error: org.apache.spark.sql.AnalysisException: Detected cartesian product for INNER join between logical plans
Join Inner
:- Join Inner
:  :- Join Inner
:  :  :- Join Inner
:  :  :  :- Join Inner
:  :  :  :  :- Join Inner
:  :  :  :  :  :- Aggregate [count(1) AS h8_30_to_9#196407L]
:  :  :  :  :  :  +- Project
:  :  :  :  :  :     +- Join Inner, (ss_store_sk#196422 = s_store_sk#196453)
:  :  :  :  :  :        :- Project [ss_store_sk#196422]
:  :  :  :  :  :        :  +- Join Inner, (ss_sold_time_sk#196416 = t_time_sk#196443)
:  :  :  :  :  :        :     :- Project [ss_sold_time_sk#196416, ss_store_sk#196422]
:  :  :  :  :  :        :     :  +- Join Inner, (ss_hdemo_sk#196420 = hd_demo_sk#196438)
:  :  :  :  :  :        :     :     :- Project [ss_sold_time_sk#196416, ss_hdemo_sk#196420, ss_store_sk#196422]
:  :  :  :  :  :        :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#196420) && isnotnull(ss_sold_time_sk#196416)) && isnotnull(ss_store_sk#196422))
:  :  :  :  :  :        :     :     :     +- Relation[ss_sold_time_sk#196416,ss_item_sk#196417,ss_customer_sk#196418,ss_cdemo_sk#196419,ss_hdemo_sk#196420,ss_addr_sk#196421,ss_store_sk#196422,ss_promo_sk#196423,ss_ticket_number#196424,ss_quantity#196425,ss_wholesale_cost#196426,ss_list_price#196427,ss_sales_price#196428,ss_ext_discount_amt#196429,ss_ext_sales_price#196430,ss_ext_wholesale_cost#196431,ss_ext_list_price#196432,ss_ext_tax#196433,ss_coupon_amt#196434,ss_net_paid#196435,ss_net_paid_inc_tax#196436,ss_net_profit#196437,ss_sold_date_sk#196415] parquet
:  :  :  :  :  :        :     :     +- Project [hd_demo_sk#196438]
:  :  :  :  :  :        :     :        +- Filter (((((hd_dep_count#196441 = 3) && (hd_vehicle_count#196442 <= 5)) || ((hd_dep_count#196441 = 0) && (hd_vehicle_count#196442 <= 2))) || ((hd_dep_count#196441 = 1) && (hd_vehicle_count#196442 <= 3))) && isnotnull(hd_demo_sk#196438))
:  :  :  :  :  :        :     :           +- InMemoryRelation [hd_demo_sk#196438, hd_income_band_sk#196439, hd_buy_potential#196440, hd_dep_count#196441, hd_vehicle_count#196442], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:  :  :  :  :  :        :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:  :  :  :  :  :        :     +- Project [t_time_sk#196443]
:  :  :  :  :  :        :        +- Filter (((isnotnull(t_hour#196446) && isnotnull(t_minute#196447)) && ((t_hour#196446 = 8) && (t_minute#196447 >= 30))) && isnotnull(t_time_sk#196443))
:  :  :  :  :  :        :           +- InMemoryRelation [t_time_sk#196443, t_time_id#196444, t_time#196445, t_hour#196446, t_minute#196447, t_second#196448, t_am_pm#196449, t_shift#196450, t_sub_shift#196451, t_meal_time#196452], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:  :  :  :  :  :        :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:  :  :  :  :  :        +- Project [s_store_sk#196453]
:  :  :  :  :  :           +- Filter ((isnotnull(s_store_name#196458) && (s_store_name#196458 = ese)) && isnotnull(s_store_sk#196453))
:  :  :  :  :  :              +- InMemoryRelation [s_store_sk#196453, s_store_id#196454, s_rec_start_date#196455, s_rec_end_date#196456, s_closed_date_sk#196457, s_store_name#196458, s_number_employees#196459, s_floor_space#196460, s_hours#196461, s_manager#196462, s_market_id#196463, s_geography_class#196464, s_market_desc#196465, s_market_manager#196466, s_division_id#196467, s_division_name#196468, s_company_id#196469, s_company_name#196470, s_street_number#196471, s_street_name#196472, s_street_type#196473, s_suite_number#196474, s_city#196475, s_county#196476, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:  :  :  :  :  :                    +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
:  :  :  :  :  +- Aggregate [count(1) AS h9_to_9_30#196408L]
:  :  :  :  :     +- Project
:  :  :  :  :        +- Join Inner, (ss_store_sk#196489 = s_store_sk#196520)
:  :  :  :  :           :- Project [ss_store_sk#196489]
:  :  :  :  :           :  +- Join Inner, (ss_sold_time_sk#196483 = t_time_sk#196510)
:  :  :  :  :           :     :- Project [ss_sold_time_sk#196483, ss_store_sk#196489]
:  :  :  :  :           :     :  +- Join Inner, (ss_hdemo_sk#196487 = hd_demo_sk#196505)
:  :  :  :  :           :     :     :- Project [ss_sold_time_sk#196483, ss_hdemo_sk#196487, ss_store_sk#196489]
:  :  :  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#196487) && isnotnull(ss_sold_time_sk#196483)) && isnotnull(ss_store_sk#196489))
:  :  :  :  :           :     :     :     +- Relation[ss_sold_time_sk#196483,ss_item_sk#196484,ss_customer_sk#196485,ss_cdemo_sk#196486,ss_hdemo_sk#196487,ss_addr_sk#196488,ss_store_sk#196489,ss_promo_sk#196490,ss_ticket_number#196491,ss_quantity#196492,ss_wholesale_cost#196493,ss_list_price#196494,ss_sales_price#196495,ss_ext_discount_amt#196496,ss_ext_sales_price#196497,ss_ext_wholesale_cost#196498,ss_ext_list_price#196499,ss_ext_tax#196500,ss_coupon_amt#196501,ss_net_paid#196502,ss_net_paid_inc_tax#196503,ss_net_profit#196504,ss_sold_date_sk#196482] parquet
:  :  :  :  :           :     :     +- Project [hd_demo_sk#196505]
:  :  :  :  :           :     :        +- Filter (((((hd_dep_count#196508 = 3) && (hd_vehicle_count#196509 <= 5)) || ((hd_dep_count#196508 = 0) && (hd_vehicle_count#196509 <= 2))) || ((hd_dep_count#196508 = 1) && (hd_vehicle_count#196509 <= 3))) && isnotnull(hd_demo_sk#196505))
:  :  :  :  :           :     :           +- InMemoryRelation [hd_demo_sk#196505, hd_income_band_sk#196506, hd_buy_potential#196507, hd_dep_count#196508, hd_vehicle_count#196509], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:  :  :  :  :           :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:  :  :  :  :           :     +- Project [t_time_sk#196510]
:  :  :  :  :           :        +- Filter (((isnotnull(t_hour#196513) && isnotnull(t_minute#196514)) && ((t_hour#196513 = 9) && (t_minute#196514 < 30))) && isnotnull(t_time_sk#196510))
:  :  :  :  :           :           +- InMemoryRelation [t_time_sk#196510, t_time_id#196511, t_time#196512, t_hour#196513, t_minute#196514, t_second#196515, t_am_pm#196516, t_shift#196517, t_sub_shift#196518, t_meal_time#196519], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:  :  :  :  :           :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:  :  :  :  :           +- Project [s_store_sk#196520]
:  :  :  :  :              +- Filter ((isnotnull(s_store_name#196525) && (s_store_name#196525 = ese)) && isnotnull(s_store_sk#196520))
:  :  :  :  :                 +- InMemoryRelation [s_store_sk#196520, s_store_id#196521, s_rec_start_date#196522, s_rec_end_date#196523, s_closed_date_sk#196524, s_store_name#196525, s_number_employees#196526, s_floor_space#196527, s_hours#196528, s_manager#196529, s_market_id#196530, s_geography_class#196531, s_market_desc#196532, s_market_manager#196533, s_division_id#196534, s_division_name#196535, s_company_id#196536, s_company_name#196537, s_street_number#196538, s_street_name#196539, s_street_type#196540, s_suite_number#196541, s_city#196542, s_county#196543, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:  :  :  :  :                       +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
:  :  :  :  +- Aggregate [count(1) AS h9_30_to_10#196409L]
:  :  :  :     +- Project
:  :  :  :        +- Join Inner, (ss_store_sk#196556 = s_store_sk#196587)
:  :  :  :           :- Project [ss_store_sk#196556]
:  :  :  :           :  +- Join Inner, (ss_sold_time_sk#196550 = t_time_sk#196577)
:  :  :  :           :     :- Project [ss_sold_time_sk#196550, ss_store_sk#196556]
:  :  :  :           :     :  +- Join Inner, (ss_hdemo_sk#196554 = hd_demo_sk#196572)
:  :  :  :           :     :     :- Project [ss_sold_time_sk#196550, ss_hdemo_sk#196554, ss_store_sk#196556]
:  :  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#196554) && isnotnull(ss_sold_time_sk#196550)) && isnotnull(ss_store_sk#196556))
:  :  :  :           :     :     :     +- Relation[ss_sold_time_sk#196550,ss_item_sk#196551,ss_customer_sk#196552,ss_cdemo_sk#196553,ss_hdemo_sk#196554,ss_addr_sk#196555,ss_store_sk#196556,ss_promo_sk#196557,ss_ticket_number#196558,ss_quantity#196559,ss_wholesale_cost#196560,ss_list_price#196561,ss_sales_price#196562,ss_ext_discount_amt#196563,ss_ext_sales_price#196564,ss_ext_wholesale_cost#196565,ss_ext_list_price#196566,ss_ext_tax#196567,ss_coupon_amt#196568,ss_net_paid#196569,ss_net_paid_inc_tax#196570,ss_net_profit#196571,ss_sold_date_sk#196549] parquet
:  :  :  :           :     :     +- Project [hd_demo_sk#196572]
:  :  :  :           :     :        +- Filter (((((hd_dep_count#196575 = 3) && (hd_vehicle_count#196576 <= 5)) || ((hd_dep_count#196575 = 0) && (hd_vehicle_count#196576 <= 2))) || ((hd_dep_count#196575 = 1) && (hd_vehicle_count#196576 <= 3))) && isnotnull(hd_demo_sk#196572))
:  :  :  :           :     :           +- InMemoryRelation [hd_demo_sk#196572, hd_income_band_sk#196573, hd_buy_potential#196574, hd_dep_count#196575, hd_vehicle_count#196576], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:  :  :  :           :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:  :  :  :           :     +- Project [t_time_sk#196577]
:  :  :  :           :        +- Filter (((isnotnull(t_hour#196580) && isnotnull(t_minute#196581)) && ((t_hour#196580 = 9) && (t_minute#196581 >= 30))) && isnotnull(t_time_sk#196577))
:  :  :  :           :           +- InMemoryRelation [t_time_sk#196577, t_time_id#196578, t_time#196579, t_hour#196580, t_minute#196581, t_second#196582, t_am_pm#196583, t_shift#196584, t_sub_shift#196585, t_meal_time#196586], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:  :  :  :           :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:  :  :  :           +- Project [s_store_sk#196587]
:  :  :  :              +- Filter ((isnotnull(s_store_name#196592) && (s_store_name#196592 = ese)) && isnotnull(s_store_sk#196587))
:  :  :  :                 +- InMemoryRelation [s_store_sk#196587, s_store_id#196588, s_rec_start_date#196589, s_rec_end_date#196590, s_closed_date_sk#196591, s_store_name#196592, s_number_employees#196593, s_floor_space#196594, s_hours#196595, s_manager#196596, s_market_id#196597, s_geography_class#196598, s_market_desc#196599, s_market_manager#196600, s_division_id#196601, s_division_name#196602, s_company_id#196603, s_company_name#196604, s_street_number#196605, s_street_name#196606, s_street_type#196607, s_suite_number#196608, s_city#196609, s_county#196610, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:  :  :  :                       +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
:  :  :  +- Aggregate [count(1) AS h10_to_10_30#196410L]
:  :  :     +- Project
:  :  :        +- Join Inner, (ss_store_sk#196623 = s_store_sk#196654)
:  :  :           :- Project [ss_store_sk#196623]
:  :  :           :  +- Join Inner, (ss_sold_time_sk#196617 = t_time_sk#196644)
:  :  :           :     :- Project [ss_sold_time_sk#196617, ss_store_sk#196623]
:  :  :           :     :  +- Join Inner, (ss_hdemo_sk#196621 = hd_demo_sk#196639)
:  :  :           :     :     :- Project [ss_sold_time_sk#196617, ss_hdemo_sk#196621, ss_store_sk#196623]
:  :  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#196621) && isnotnull(ss_sold_time_sk#196617)) && isnotnull(ss_store_sk#196623))
:  :  :           :     :     :     +- Relation[ss_sold_time_sk#196617,ss_item_sk#196618,ss_customer_sk#196619,ss_cdemo_sk#196620,ss_hdemo_sk#196621,ss_addr_sk#196622,ss_store_sk#196623,ss_promo_sk#196624,ss_ticket_number#196625,ss_quantity#196626,ss_wholesale_cost#196627,ss_list_price#196628,ss_sales_price#196629,ss_ext_discount_amt#196630,ss_ext_sales_price#196631,ss_ext_wholesale_cost#196632,ss_ext_list_price#196633,ss_ext_tax#196634,ss_coupon_amt#196635,ss_net_paid#196636,ss_net_paid_inc_tax#196637,ss_net_profit#196638,ss_sold_date_sk#196616] parquet
:  :  :           :     :     +- Project [hd_demo_sk#196639]
:  :  :           :     :        +- Filter (((((hd_dep_count#196642 = 3) && (hd_vehicle_count#196643 <= 5)) || ((hd_dep_count#196642 = 0) && (hd_vehicle_count#196643 <= 2))) || ((hd_dep_count#196642 = 1) && (hd_vehicle_count#196643 <= 3))) && isnotnull(hd_demo_sk#196639))
:  :  :           :     :           +- InMemoryRelation [hd_demo_sk#196639, hd_income_band_sk#196640, hd_buy_potential#196641, hd_dep_count#196642, hd_vehicle_count#196643], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:  :  :           :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:  :  :           :     +- Project [t_time_sk#196644]
:  :  :           :        +- Filter (((isnotnull(t_hour#196647) && isnotnull(t_minute#196648)) && ((t_hour#196647 = 10) && (t_minute#196648 < 30))) && isnotnull(t_time_sk#196644))
:  :  :           :           +- InMemoryRelation [t_time_sk#196644, t_time_id#196645, t_time#196646, t_hour#196647, t_minute#196648, t_second#196649, t_am_pm#196650, t_shift#196651, t_sub_shift#196652, t_meal_time#196653], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:  :  :           :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:  :  :           +- Project [s_store_sk#196654]
:  :  :              +- Filter ((isnotnull(s_store_name#196659) && (s_store_name#196659 = ese)) && isnotnull(s_store_sk#196654))
:  :  :                 +- InMemoryRelation [s_store_sk#196654, s_store_id#196655, s_rec_start_date#196656, s_rec_end_date#196657, s_closed_date_sk#196658, s_store_name#196659, s_number_employees#196660, s_floor_space#196661, s_hours#196662, s_manager#196663, s_market_id#196664, s_geography_class#196665, s_market_desc#196666, s_market_manager#196667, s_division_id#196668, s_division_name#196669, s_company_id#196670, s_company_name#196671, s_street_number#196672, s_street_name#196673, s_street_type#196674, s_suite_number#196675, s_city#196676, s_county#196677, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:  :  :                       +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
:  :  +- Aggregate [count(1) AS h10_30_to_11#196411L]
:  :     +- Project
:  :        +- Join Inner, (ss_store_sk#196690 = s_store_sk#196721)
:  :           :- Project [ss_store_sk#196690]
:  :           :  +- Join Inner, (ss_sold_time_sk#196684 = t_time_sk#196711)
:  :           :     :- Project [ss_sold_time_sk#196684, ss_store_sk#196690]
:  :           :     :  +- Join Inner, (ss_hdemo_sk#196688 = hd_demo_sk#196706)
:  :           :     :     :- Project [ss_sold_time_sk#196684, ss_hdemo_sk#196688, ss_store_sk#196690]
:  :           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#196688) && isnotnull(ss_sold_time_sk#196684)) && isnotnull(ss_store_sk#196690))
:  :           :     :     :     +- Relation[ss_sold_time_sk#196684,ss_item_sk#196685,ss_customer_sk#196686,ss_cdemo_sk#196687,ss_hdemo_sk#196688,ss_addr_sk#196689,ss_store_sk#196690,ss_promo_sk#196691,ss_ticket_number#196692,ss_quantity#196693,ss_wholesale_cost#196694,ss_list_price#196695,ss_sales_price#196696,ss_ext_discount_amt#196697,ss_ext_sales_price#196698,ss_ext_wholesale_cost#196699,ss_ext_list_price#196700,ss_ext_tax#196701,ss_coupon_amt#196702,ss_net_paid#196703,ss_net_paid_inc_tax#196704,ss_net_profit#196705,ss_sold_date_sk#196683] parquet
:  :           :     :     +- Project [hd_demo_sk#196706]
:  :           :     :        +- Filter (((((hd_dep_count#196709 = 3) && (hd_vehicle_count#196710 <= 5)) || ((hd_dep_count#196709 = 0) && (hd_vehicle_count#196710 <= 2))) || ((hd_dep_count#196709 = 1) && (hd_vehicle_count#196710 <= 3))) && isnotnull(hd_demo_sk#196706))
:  :           :     :           +- InMemoryRelation [hd_demo_sk#196706, hd_income_band_sk#196707, hd_buy_potential#196708, hd_dep_count#196709, hd_vehicle_count#196710], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:  :           :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:  :           :     +- Project [t_time_sk#196711]
:  :           :        +- Filter (((isnotnull(t_hour#196714) && isnotnull(t_minute#196715)) && ((t_hour#196714 = 10) && (t_minute#196715 >= 30))) && isnotnull(t_time_sk#196711))
:  :           :           +- InMemoryRelation [t_time_sk#196711, t_time_id#196712, t_time#196713, t_hour#196714, t_minute#196715, t_second#196716, t_am_pm#196717, t_shift#196718, t_sub_shift#196719, t_meal_time#196720], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:  :           :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:  :           +- Project [s_store_sk#196721]
:  :              +- Filter ((isnotnull(s_store_name#196726) && (s_store_name#196726 = ese)) && isnotnull(s_store_sk#196721))
:  :                 +- InMemoryRelation [s_store_sk#196721, s_store_id#196722, s_rec_start_date#196723, s_rec_end_date#196724, s_closed_date_sk#196725, s_store_name#196726, s_number_employees#196727, s_floor_space#196728, s_hours#196729, s_manager#196730, s_market_id#196731, s_geography_class#196732, s_market_desc#196733, s_market_manager#196734, s_division_id#196735, s_division_name#196736, s_company_id#196737, s_company_name#196738, s_street_number#196739, s_street_name#196740, s_street_type#196741, s_suite_number#196742, s_city#196743, s_county#196744, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:  :                       +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
:  +- Aggregate [count(1) AS h11_to_11_30#196412L]
:     +- Project
:        +- Join Inner, (ss_store_sk#196757 = s_store_sk#196788)
:           :- Project [ss_store_sk#196757]
:           :  +- Join Inner, (ss_sold_time_sk#196751 = t_time_sk#196778)
:           :     :- Project [ss_sold_time_sk#196751, ss_store_sk#196757]
:           :     :  +- Join Inner, (ss_hdemo_sk#196755 = hd_demo_sk#196773)
:           :     :     :- Project [ss_sold_time_sk#196751, ss_hdemo_sk#196755, ss_store_sk#196757]
:           :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#196755) && isnotnull(ss_sold_time_sk#196751)) && isnotnull(ss_store_sk#196757))
:           :     :     :     +- Relation[ss_sold_time_sk#196751,ss_item_sk#196752,ss_customer_sk#196753,ss_cdemo_sk#196754,ss_hdemo_sk#196755,ss_addr_sk#196756,ss_store_sk#196757,ss_promo_sk#196758,ss_ticket_number#196759,ss_quantity#196760,ss_wholesale_cost#196761,ss_list_price#196762,ss_sales_price#196763,ss_ext_discount_amt#196764,ss_ext_sales_price#196765,ss_ext_wholesale_cost#196766,ss_ext_list_price#196767,ss_ext_tax#196768,ss_coupon_amt#196769,ss_net_paid#196770,ss_net_paid_inc_tax#196771,ss_net_profit#196772,ss_sold_date_sk#196750] parquet
:           :     :     +- Project [hd_demo_sk#196773]
:           :     :        +- Filter (((((hd_dep_count#196776 = 3) && (hd_vehicle_count#196777 <= 5)) || ((hd_dep_count#196776 = 0) && (hd_vehicle_count#196777 <= 2))) || ((hd_dep_count#196776 = 1) && (hd_vehicle_count#196777 <= 3))) && isnotnull(hd_demo_sk#196773))
:           :     :           +- InMemoryRelation [hd_demo_sk#196773, hd_income_band_sk#196774, hd_buy_potential#196775, hd_dep_count#196776, hd_vehicle_count#196777], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
:           :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
:           :     +- Project [t_time_sk#196778]
:           :        +- Filter (((isnotnull(t_hour#196781) && isnotnull(t_minute#196782)) && ((t_hour#196781 = 11) && (t_minute#196782 < 30))) && isnotnull(t_time_sk#196778))
:           :           +- InMemoryRelation [t_time_sk#196778, t_time_id#196779, t_time#196780, t_hour#196781, t_minute#196782, t_second#196783, t_am_pm#196784, t_shift#196785, t_sub_shift#196786, t_meal_time#196787], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
:           :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
:           +- Project [s_store_sk#196788]
:              +- Filter ((isnotnull(s_store_name#196793) && (s_store_name#196793 = ese)) && isnotnull(s_store_sk#196788))
:                 +- InMemoryRelation [s_store_sk#196788, s_store_id#196789, s_rec_start_date#196790, s_rec_end_date#196791, s_closed_date_sk#196792, s_store_name#196793, s_number_employees#196794, s_floor_space#196795, s_hours#196796, s_manager#196797, s_market_id#196798, s_geography_class#196799, s_market_desc#196800, s_market_manager#196801, s_division_id#196802, s_division_name#196803, s_company_id#196804, s_company_name#196805, s_street_number#196806, s_street_name#196807, s_street_type#196808, s_suite_number#196809, s_city#196810, s_county#196811, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
:                       +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
+- Aggregate [count(1) AS h11_30_to_12#196413L]
   +- Project
      +- Join Inner, (ss_store_sk#196824 = s_store_sk#196855)
         :- Project [ss_store_sk#196824]
         :  +- Join Inner, (ss_sold_time_sk#196818 = t_time_sk#196845)
         :     :- Project [ss_sold_time_sk#196818, ss_store_sk#196824]
         :     :  +- Join Inner, (ss_hdemo_sk#196822 = hd_demo_sk#196840)
         :     :     :- Project [ss_sold_time_sk#196818, ss_hdemo_sk#196822, ss_store_sk#196824]
         :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#196822) && isnotnull(ss_sold_time_sk#196818)) && isnotnull(ss_store_sk#196824))
         :     :     :     +- Relation[ss_sold_time_sk#196818,ss_item_sk#196819,ss_customer_sk#196820,ss_cdemo_sk#196821,ss_hdemo_sk#196822,ss_addr_sk#196823,ss_store_sk#196824,ss_promo_sk#196825,ss_ticket_number#196826,ss_quantity#196827,ss_wholesale_cost#196828,ss_list_price#196829,ss_sales_price#196830,ss_ext_discount_amt#196831,ss_ext_sales_price#196832,ss_ext_wholesale_cost#196833,ss_ext_list_price#196834,ss_ext_tax#196835,ss_coupon_amt#196836,ss_net_paid#196837,ss_net_paid_inc_tax#196838,ss_net_profit#196839,ss_sold_date_sk#196817] parquet
         :     :     +- Project [hd_demo_sk#196840]
         :     :        +- Filter (((((hd_dep_count#196843 = 3) && (hd_vehicle_count#196844 <= 5)) || ((hd_dep_count#196843 = 0) && (hd_vehicle_count#196844 <= 2))) || ((hd_dep_count#196843 = 1) && (hd_vehicle_count#196844 <= 3))) && isnotnull(hd_demo_sk#196840))
         :     :           +- InMemoryRelation [hd_demo_sk#196840, hd_income_band_sk#196841, hd_buy_potential#196842, hd_dep_count#196843, hd_vehicle_count#196844], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
         :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
         :     +- Project [t_time_sk#196845]
         :        +- Filter (((isnotnull(t_hour#196848) && isnotnull(t_minute#196849)) && ((t_hour#196848 = 11) && (t_minute#196849 >= 30))) && isnotnull(t_time_sk#196845))
         :           +- InMemoryRelation [t_time_sk#196845, t_time_id#196846, t_time#196847, t_hour#196848, t_minute#196849, t_second#196850, t_am_pm#196851, t_shift#196852, t_sub_shift#196853, t_meal_time#196854], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
         :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
         +- Project [s_store_sk#196855]
            +- Filter ((isnotnull(s_store_name#196860) && (s_store_name#196860 = ese)) && isnotnull(s_store_sk#196855))
               +- InMemoryRelation [s_store_sk#196855, s_store_id#196856, s_rec_start_date#196857, s_rec_end_date#196858, s_closed_date_sk#196859, s_store_name#196860, s_number_employees#196861, s_floor_space#196862, s_hours#196863, s_manager#196864, s_market_id#196865, s_geography_class#196866, s_market_desc#196867, s_market_manager#196868, s_division_id#196869, s_division_name#196870, s_company_id#196871, s_company_name#196872, s_street_number#196873, s_street_name#196874, s_street_type#196875, s_suite_number#196876, s_city#196877, s_county#196878, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
                     +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
and
Aggregate [count(1) AS h12_to_12_30#196414L]
+- Project
   +- Join Inner, (ss_store_sk#196891 = s_store_sk#196922)
      :- Project [ss_store_sk#196891]
      :  +- Join Inner, (ss_sold_time_sk#196885 = t_time_sk#196912)
      :     :- Project [ss_sold_time_sk#196885, ss_store_sk#196891]
      :     :  +- Join Inner, (ss_hdemo_sk#196889 = hd_demo_sk#196907)
      :     :     :- Project [ss_sold_time_sk#196885, ss_hdemo_sk#196889, ss_store_sk#196891]
      :     :     :  +- Filter ((isnotnull(ss_hdemo_sk#196889) && isnotnull(ss_sold_time_sk#196885)) && isnotnull(ss_store_sk#196891))
      :     :     :     +- Relation[ss_sold_time_sk#196885,ss_item_sk#196886,ss_customer_sk#196887,ss_cdemo_sk#196888,ss_hdemo_sk#196889,ss_addr_sk#196890,ss_store_sk#196891,ss_promo_sk#196892,ss_ticket_number#196893,ss_quantity#196894,ss_wholesale_cost#196895,ss_list_price#196896,ss_sales_price#196897,ss_ext_discount_amt#196898,ss_ext_sales_price#196899,ss_ext_wholesale_cost#196900,ss_ext_list_price#196901,ss_ext_tax#196902,ss_coupon_amt#196903,ss_net_paid#196904,ss_net_paid_inc_tax#196905,ss_net_profit#196906,ss_sold_date_sk#196884] parquet
      :     :     +- Project [hd_demo_sk#196907]
      :     :        +- Filter (((((hd_dep_count#196910 = 3) && (hd_vehicle_count#196911 <= 5)) || ((hd_dep_count#196910 = 0) && (hd_vehicle_count#196911 <= 2))) || ((hd_dep_count#196910 = 1) && (hd_vehicle_count#196911 <= 3))) && isnotnull(hd_demo_sk#196907))
      :     :           +- InMemoryRelation [hd_demo_sk#196907, hd_income_band_sk#196908, hd_buy_potential#196909, hd_dep_count#196910, hd_vehicle_count#196911], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `household_demographics`
      :     :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.household_demographics[hd_demo_sk#1622,hd_income_band_sk#1623,hd_buy_potential#1624,hd_dep_count#1625,hd_vehicle_count#1626] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<hd_demo_sk:int,hd_income_band_sk:int,hd_buy_potential:string,hd_dep_count:int,hd_vehicle_c...
      :     +- Project [t_time_sk#196912]
      :        +- Filter (((isnotnull(t_hour#196915) && isnotnull(t_minute#196916)) && ((t_hour#196915 = 12) && (t_minute#196916 < 30))) && isnotnull(t_time_sk#196912))
      :           +- InMemoryRelation [t_time_sk#196912, t_time_id#196913, t_time#196914, t_hour#196915, t_minute#196916, t_second#196917, t_am_pm#196918, t_shift#196919, t_sub_shift#196920, t_meal_time#196921], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `time_dim`
      :                 +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.time_dim[t_time_sk#516,t_time_id#517,t_time#518,t_hour#519,t_minute#520,t_second#521,t_am_pm#522,t_shift#523,t_sub_shift#524,t_meal_time#525] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<t_time_sk:int,t_time_id:string,t_time:int,t_hour:int,t_minute:int,t_second:int,t_am_pm:str...
      +- Project [s_store_sk#196922]
         +- Filter ((isnotnull(s_store_name#196927) && (s_store_name#196927 = ese)) && isnotnull(s_store_sk#196922))
            +- InMemoryRelation [s_store_sk#196922, s_store_id#196923, s_rec_start_date#196924, s_rec_end_date#196925, s_closed_date_sk#196926, s_store_name#196927, s_number_employees#196928, s_floor_space#196929, s_hours#196930, s_manager#196931, s_market_id#196932, s_geography_class#196933, s_market_desc#196934, s_market_manager#196935, s_division_id#196936, s_division_name#196937, s_company_id#196938, s_company_name#196939, s_street_number#196940, s_street_name#196941, s_street_type#196942, s_suite_number#196943, s_city#196944, s_county#196945, ... 5 more fields], true, 10000, StorageLevel(disk, memory, deserialized, 1 replicas), `store`
                  +- *FileScan parquet tpcds_bin_partitioned_parquet_1000.store[s_store_sk#1968,s_store_id#1969,s_rec_start_date#1970,s_rec_end_date#1971,s_closed_date_sk#1972,s_store_name#1973,s_number_employees#1974,s_floor_space#1975,s_hours#1976,s_manager#1977,s_market_id#1978,s_geography_class#1979,s_market_desc#1980,s_market_manager#1981,s_division_id#1982,s_division_name#1983,s_company_id#1984,s_company_name#1985,s_street_number#1986,s_street_name#1987,s_street_type#1988,s_suite_number#1989,s_city#1990,s_county#1991,... 5 more fields] Batched: true, Format: Parquet, Location: InMemoryFileIndex[hdfs://h01hn01.hadoop:8020/apps/hive/warehouse/tpcds_bin_partitioned_parquet_10..., PartitionFilters: [], PushedFilters: [], ReadSchema: struct<s_store_sk:int,s_store_id:string,s_rec_start_date:string,s_rec_end_date:string,s_closed_da...
Join condition is missing or trivial.
Use the CROSS JOIN syntax to allow cartesian products between these relations.; (state=,code=0)

Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_1000
STOP hdp2.6_spark21_run_1000_2_query88_sql_2017-04-11-08-51:  Tue Apr 11 08:51:46 CDT 2017
