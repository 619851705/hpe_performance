START hdp2.6_spark21_run_5000_3_query49_sql_2017-04-09-02-44:  Sun Apr 9 02:44:35 CDT 2017
 /usr/hdp/current/spark2-client/bin/beeline -u "jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_$SF" -n hive --incremental=true  -i settings/spark.settings -f sample-queries-tpcds/$1
Connecting to jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_5000
17/04/09 02:44:35 INFO Utils: Supplied authorities: h01hn02.hadoop:10016
17/04/09 02:44:35 INFO Utils: Resolved authority: h01hn02.hadoop:10016
17/04/09 02:44:35 INFO HiveConnection: Will try to open client transport with JDBC Uri: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_5000
Connected to: Spark SQL (version 2.1.0.2.6.0.0-598)
Driver: Hive JDBC (version 1.2.1.spark2.hdp)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/spark.settings
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> select  
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  'web' as channel
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,web.item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,web.return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,web.return_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,web.currency_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  select 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,currency_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,rank() over (order by return_ratio) as return_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,rank() over (order by currency_ratio) as currency_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select ws.ws_item_sk as item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,(cast(sum(coalesce(wr.wr_return_quantity,0)) as decimal(15,4))/
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  cast(sum(coalesce(ws.ws_quantity,0)) as decimal(15,4) )) as return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,(cast(sum(coalesce(wr.wr_return_amt,0)) as decimal(15,4))/
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  cast(sum(coalesce(ws.ws_net_paid,0)) as decimal(15,4) )) as currency_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   web_sales ws left outer join web_returns wr 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  on (ws.ws_order_number = wr.wr_order_number and 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ws.ws_item_sk = wr.wr_item_sk)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                  ,date_dim
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  wr.wr_return_amt > 10000 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  and ws.ws_net_profit > 1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                          and ws.ws_net_paid > 0
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                          and ws.ws_quantity > 0
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                          and ws.ws_sold_date_sk = date_dim.d_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                          and d_year = 2000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                          and d_moy = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  group by ws.ws_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ) in_web
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ) web
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  web.return_rank <= 10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  web.currency_rank <= 10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  )
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  union all
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  select 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  'catalog' as channel
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,catalog.item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,catalog.return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,catalog.return_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,catalog.currency_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  select 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,currency_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,rank() over (order by return_ratio) as return_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,rank() over (order by currency_ratio) as currency_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  cs.cs_item_sk as item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,(cast(sum(coalesce(cr.cr_return_quantity,0)) as decimal(15,4))/
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  cast(sum(coalesce(cs.cs_quantity,0)) as decimal(15,4) )) as return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,(cast(sum(coalesce(cr.cr_return_amount,0)) as decimal(15,4))/
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  cast(sum(coalesce(cs.cs_net_paid,0)) as decimal(15,4) )) as currency_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  catalog_sales cs left outer join catalog_returns cr
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  on (cs.cs_order_number = cr.cr_order_number and 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  cs.cs_item_sk = cr.cr_item_sk)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                 ,date_dim
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  cr.cr_return_amount > 10000 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  and cs.cs_net_profit > 1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                          and cs.cs_net_paid > 0
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                          and cs.cs_quantity > 0
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                          and cs_sold_date_sk = d_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                          and d_year = 2000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                          and d_moy = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                  group by cs.cs_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ) in_cat
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ) catalog
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  catalog.return_rank <= 10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  or
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  catalog.currency_rank <=10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  )
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  union all
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  select 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  'store' as channel
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,store.item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,store.return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,store.return_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,store.currency_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  select 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>   item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,currency_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,rank() over (order by return_ratio) as return_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,rank() over (order by currency_ratio) as currency_rank
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  (select sts.ss_item_sk as item
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,(cast(sum(coalesce(sr.sr_return_quantity,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_quantity,0)) as decima l(15,4) )) as return_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ,(cast(sum(coalesce(sr.sr_return_amt,0)) as decimal(15,4))/cast(sum(coalesce(sts.ss_net_paid,0)) as decimal(15, 4) )) as currency_ratio
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  from 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  store_sales sts left outer join store_returns sr
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  on (sts.ss_ticket_number = sr.sr_ticket_number and sts.ss_item_sk = sr.sr_item_sk)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                 ,date_dim
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  sr.sr_return_amt > 10000 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  and sts.ss_net_profit > 1
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                          and sts.ss_net_paid > 0 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                          and sts.ss_quantity > 0
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                          and ss_sold_date_sk = d_date_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                          and d_year = 2000
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>                          and d_moy = 12
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  group by sts.ss_item_sk
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ) in_store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  ) store
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  where  (
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  store.return_rank <= 10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  or 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  store.currency_rank <= 10
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  )
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  order by 1,4,5
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi>  limit 100;
+-----------------+-------------+-----------------+-------------+---------------+--+
|     channel     |    item     |  return_ratio   | return_rank | currency_rank |
+-----------------+-------------+-----------------+-------------+---------------+--+
| catalog         | 4697        | 0.55256064690026954178 | 1           | 105           |
| catalog         | 24146       | 0.58793103448275862069 | 2           | 13150         |
| catalog         | 15266       | 0.58956521739130434783 | 3           | 7181          |
| catalog         | 12182       | 0.59233449477351916376 | 4           | 7202          |
| catalog         | 29804       | 0.61538461538461538462 | 5           | 114           |
| catalog         | 15986       | 0.61572052401746724891 | 6           | 14            |
| catalog         | 9974        | 0.61600000000000000000 | 7           | 1050          |
| catalog         | 26600       | 0.61800486618004866180 | 8           | 10683         |
| catalog         | 3458        | 0.62206572769953051643 | 9           | 128           |
| catalog         | 22790       | 0.62235649546827794562 | 10          | 3828          |
| catalog         | 4309        | 0.67822468793342579750 | 46          | 7             |
| catalog         | 541         | 0.68457142857142857143 | 54          | 1             |
| catalog         | 24296       | 0.70644391408114558473 | 108         | 10            |
| catalog         | 17411       | 0.71167048054919908467 | 128         | 4             |
| catalog         | 8714        | 0.71455223880597014925 | 142         | 5             |
| catalog         | 9479        | 0.71538461538461538462 | 143         | 6             |
| catalog         | 15869       | 0.71596244131455399061 | 146         | 3             |
| catalog         | 22213       | 0.71857923497267759563 | 169         | 2             |
| catalog         | 25022       | 0.72527472527472527473 | 227         | 8             |
| catalog         | 8305        | 0.73454545454545454545 | 334         | 9             |
| store           | 23107       | 0E-20           | 1           | 40            |
| store           | 9839        | 0E-20           | 1           | 101           |
| store           | 20063       | 0E-20           | 1           | 273           |
| store           | 13835       | 0E-20           | 1           | 583           |
| store           | 26989       | 0E-20           | 1           | 757           |
| store           | 22157       | 0E-20           | 1           | 1120          |
| store           | 19985       | 0E-20           | 1           | 1963          |
| store           | 3269        | 0E-20           | 1           | 2056          |
| store           | 25535       | 0E-20           | 1           | 5732          |
| store           | 5096        | 0E-20           | 1           | 7944          |
| store           | 21752       | 0E-20           | 1           | 9665          |
| store           | 23096       | 0E-20           | 1           | 9857          |
| store           | 24032       | 0E-20           | 1           | 10393         |
| store           | 6991        | 0E-20           | 1           | 10779         |
| store           | 5161        | 0E-20           | 1           | 11312         |
| store           | 17378       | 0E-20           | 1           | 12097         |
| store           | 29828       | 0E-20           | 1           | 13100         |
| store           | 4541        | 0E-20           | 1           | 13282         |
| store           | 28043       | 0E-20           | 1           | 13356         |
| store           | 4172        | 0E-20           | 1           | 13600         |
| store           | 5137        | 0E-20           | 1           | 13971         |
| store           | 4693        | 0E-20           | 1           | 13971         |
| store           | 24035       | 0E-20           | 1           | 13971         |
| store           | 21368       | 0.58000000000000000000 | 145         | 1             |
| store           | 26729       | 0.60824742268041237113 | 195         | 2             |
| store           | 11918       | 0.64285714285714285714 | 277         | 3             |
| store           | 28769       | 0.65000000000000000000 | 298         | 4             |
| store           | 21692       | 0.65882352941176470588 | 317         | 5             |
| store           | 2221        | 0.65979381443298969072 | 321         | 6             |
| store           | 14683       | 0.66315789473684210526 | 331         | 7             |
| store           | 27536       | 0.66666666666666666667 | 343         | 8             |
| store           | 6083        | 0.67391304347826086957 | 377         | 9             |
| store           | 7195        | 0.67391304347826086957 | 377         | 10            |
| web             | 29273       | 0E-20           | 1           | 5644          |
| web             | 13933       | 0E-20           | 1           | 9035          |
| web             | 27047       | 0E-20           | 1           | 11306         |
| web             | 323         | 0E-20           | 1           | 13516         |
| web             | 11114       | 0E-20           | 1           | 13866         |
| web             | 11432       | 0.27956989247311827957 | 6           | 12248         |
| web             | 185         | 0.28975265017667844523 | 7           | 13499         |
| web             | 11771       | 0.30120481927710843373 | 8           | 6714          |
| web             | 1310        | 0.33128834355828220859 | 9           | 5345          |
| web             | 9589        | 0.35869565217391304348 | 10          | 2481          |
| web             | 28142       | 0.46739130434782608696 | 41          | 1             |
| web             | 2413        | 0.47311827956989247312 | 45          | 2             |
| web             | 28889       | 0.47500000000000000000 | 46          | 3             |
| web             | 6097        | 0.50000000000000000000 | 60          | 4             |
| web             | 21443       | 0.51612903225806451613 | 74          | 5             |
| web             | 13910       | 0.54545454545454545455 | 110         | 6             |
| web             | 12247       | 0.55913978494623655914 | 128         | 7             |
| web             | 21992       | 0.56470588235294117647 | 137         | 8             |
| web             | 24242       | 0.57988165680473372781 | 167         | 9             |
| web             | 9455        | 0.58333333333333333333 | 177         | 10            |
+-----------------+-------------+-----------------+-------------+---------------+--+
73 rows selected (229.207 seconds)
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bi> 
Closing: 0: jdbc:hive2://h01hn02.hadoop:10016/tpcds_bin_partitioned_parquet_5000
STOP hdp2.6_spark21_run_5000_3_query49_sql_2017-04-09-02-44:  Sun Apr 9 02:48:25 CDT 2017
