START hdp2.6_hivetez_run_orc_5000_2_query50_sql_2017-04-19-01-35:  Wed Apr 19 01:35:23 CDT 2017
beeline -u jdbc:hive2://h01mgt.hadoop:2181,h01hn01.hadoop:2181,h01hn02.hadoop:2181/tpcds_bin_partitioned_orc_5000;serviceDiscoveryMode=zooKeeper;zooKeeperNamespace=hiveserver2 -n hive --incremental=true -i settings/hive8g-128m.settings -f sample-queries-tpcds/query50.sql
Connecting to jdbc:hive2://h01mgt.hadoop:2181,h01hn01.hadoop:2181,h01hn02.hadoop:2181/tpcds_bin_partitioned_orc_5000;serviceDiscoveryMode=zooKeeper;zooKeeperNamespace=hiveserver2
Connected to: Apache Hive (version 1.2.1000.2.6.0.3-8)
Driver: Hive JDBC (version 1.2.1000.2.6.0.3-8)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Running init script settings/hive8g-128m.settings
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.container.max.java.heap.fraction=0.8;
No rows affected (0.043 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set hive.log.level=WARN;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.tez.exec.print.summary=true;
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set hive.tez.input.format=org.apache.hadoop.hive.ql.io.CombineHiveInputFormat;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.tez.input.format=org.apache.hadoop.hive.ql.io.HiveInputFormat;
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.enforce.bucketing=true;
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.enforce.sorting=true;
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.tez.container.size=8192; 
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.am.resource.memory.mb=8192;
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.task.resource.memory.mb=8192; 
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.runtime.io.sort.mb=3277; 
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.auto.convert.join.noconditionaltask=true; 
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.auto.convert.join.noconditionaltask.size=2834678415; 
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.runtime.unordered.output.buffer.size-mb=819; 
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.grouping.min-size=1073741824; 
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.grouping.max-size=2147483648; 
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.parallel=true; 
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.parallel.thread.number=16; 
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.tez.auto.reducer.parallelism=true; 
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.reducers.bytes.per.reducer=134217728; 
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.optimize.reducededuplication.min.reducer = 1 ;
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set tez.queue.name=llap;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.dynamic.partition.mode=nonstrict;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.max.dynamic.partitions.pernode=100000;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.max.dynamic.partitions=100000;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.max.created.files=1000000;
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.exec.parallel=true;
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set hive.exec.reducers.max=2000;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.stats.autogather=true;
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.optimize.sort.dynamic.partition=true;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.stats.autogather=true;
No rows affected (0.015 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.execution.engine=tez;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.cbo.enable=true;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.compute.query.using.stats=true;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.stats.fetch.column.stats=true;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.stats.fetch.partition.stats=true;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.vectorized.execution.enabled=true;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.vectorized.execution.reduce.enabled = true;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.vectorized.execution.reduce.groupby.enabled = true;
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set mapred.job.reduce.input.buffer.percent=0.0;
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set mapreduce.input.fileinputformat.split.minsize=1073741824;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set mapreduce.input.fileinputformat.split.maxsize=2147483648;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set mapreduce.input.fileinputformat.split.minsize.per.node=1073741824;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set mapreduce.input.fileinputformat.split.minsize.per.rack=1073741824;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set hive.tez.java.opts=-XX:+PrintGCDetails -verbose:gc -XX:+PrintGCTimeStamps -XX:+UseNUMA  -XX:+UseG1GC -XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=/tmp/;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.runtime.empty.partitions.info-via-events.enabled=true;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set tez.runtime.report.partition.stats=true;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> --set mapred.map.tasks=6;
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.limit.pushdown.memory.usage=0.04;
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.map.aggr=true;
No rows affected (0.002 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.mapjoin.bucket.cache.size=10000;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.mapred.reduce.tasks.speculative.execution=false;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.metastore.cache.pinobjtypes=Table,Database,Type,FieldSchema,Order;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.metastore.client.socket.timeout=60;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> set hive.metastore.execute.setugi=true;
No rows affected (0.001 seconds)
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> select  
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>    s_store_name
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_company_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_street_number
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_street_name
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_street_type
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_suite_number
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_city
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_county
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_state
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_zip
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as 30days  
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                  (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as 3160da ys 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                  (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as 6190day s 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>                  (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as 91120d ays 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as 120day s 
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> from
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>    store_sales
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,store_returns
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,store
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,date_dim d1
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,date_dim d2
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> where
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>     d2.d_year = 2000
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> and d2.d_moy  = 9
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> and store_sales.ss_ticket_number = store_returns.sr_ticket_number
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> and store_sales.ss_item_sk = store_returns.sr_item_sk
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> and store_sales.ss_sold_date_sk   = d1.d_date_sk
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> and sr_returned_date_sk   = d2.d_date_sk
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> and store_sales.ss_customer_sk = store_returns.sr_customer_sk
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> and store_sales.ss_store_sk = store.s_store_sk
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> group by
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>    s_store_name
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_company_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_street_number
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_street_name
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_street_type
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_suite_number
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_city
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_county
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_state
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>   ,s_zip
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> order by s_store_name
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>         ,s_company_id
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>         ,s_street_number
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>         ,s_street_name
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>         ,s_street_type
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>         ,s_suite_number
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>         ,s_city
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>         ,s_county
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>         ,s_state
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha>         ,s_zip
0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.ha> limit 100;
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: select
   s_store_name
  ,s_company_id...100(Stage-1)
INFO  : Setting tez.task.scale.memory.reserve-fraction to 0.30000001192092896
INFO  : Status: Running (Executing on YARN cluster with App id application_1491866789844_0505)

[2K--------------------------------------------------------------------------------
[2K[36;1m        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
[22;0m[2K--------------------------------------------------------------------------------
[2KMap 1                RUNNING    339          0      182      157       0       0
Map 3                RUNNING      2          0        2        0       0       0
Map 4 ..........   SUCCEEDED      1          1        0        0       0       0
Map 5 ..........   SUCCEEDED      1          1        0        0       0       0
Map 6 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2             INITED      1          0        0        1       0       0
[2K--------------------------------------------------------------------------------
[2K[31;1mVERTICES: 03/06  [>>--------------------------] 0%    ELAPSED TIME: 6.78 s     
[22;0m[2K--------------------------------------------------------------------------------
[12A[2K--------------------------------------------------------------------------------
[2K[36;1m        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
[22;0m[2K--------------------------------------------------------------------------------
[2KMap 1                RUNNING    339          0      249       90       0       0
Map 3                RUNNING      2          0        2        0       0       0
Map 4 ..........   SUCCEEDED      1          1        0        0       0       0
Map 5 ..........   SUCCEEDED      1          1        0        0       0       0
Map 6 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2             INITED      1          0        0        1       0       0
[2K--------------------------------------------------------------------------------
[2K[31;1mVERTICES: 03/06  [>>--------------------------] 0%    ELAPSED TIME: 11.78 s    
[22;0m[2K--------------------------------------------------------------------------------
[12A[2K--------------------------------------------------------------------------------
[2K[36;1m        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
[22;0m[2K--------------------------------------------------------------------------------
[2KMap 1                RUNNING    339          0      250       89       0       0
Map 3 .....          RUNNING      2          1        1        0       0       0
Map 4 ..........   SUCCEEDED      1          1        0        0       0       0
Map 5 ..........   SUCCEEDED      1          1        0        0       0       0
Map 6 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2             INITED      1          0        0        1       0       0
[2K--------------------------------------------------------------------------------
[2K[31;1mVERTICES: 03/06  [>>--------------------------] 1%    ELAPSED TIME: 16.78 s    
[22;0m[2K--------------------------------------------------------------------------------
[12A[2K--------------------------------------------------------------------------------
[2K[36;1m        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
[22;0m[2K--------------------------------------------------------------------------------
[2KMap 1                RUNNING    339          0      251       88       0       0
Map 3 ..........   SUCCEEDED      2          2        0        0       0       0
Map 4 ..........   SUCCEEDED      1          1        0        0       0       0
Map 5 ..........   SUCCEEDED      1          1        0        0       0       0
Map 6 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2             INITED      1          0        0        1       0       0
[2K--------------------------------------------------------------------------------
[2K[31;1mVERTICES: 04/06  [>>--------------------------] 1%    ELAPSED TIME: 21.78 s    
[22;0m[2K--------------------------------------------------------------------------------
[12A[2K--------------------------------------------------------------------------------
[2K[36;1m        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
[22;0m[2K--------------------------------------------------------------------------------
[2KMap 1                RUNNING    339          0      251       88       0       0
Map 3 ..........   SUCCEEDED      2          2        0        0       0       0
Map 4 ..........   SUCCEEDED      1          1        0        0       0       0
Map 5 ..........   SUCCEEDED      1          1        0        0       0       0
Map 6 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2             INITED      1          0        0        1       0       0
[2K--------------------------------------------------------------------------------
[2K[31;1mVERTICES: 04/06  [>>--------------------------] 1%    ELAPSED TIME: 26.79 s    
[22;0m[2K--------------------------------------------------------------------------------
[12A[2K--------------------------------------------------------------------------------
[2K[36;1m        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
[22;0m[2K--------------------------------------------------------------------------------
[2KMap 1                RUNNING    339          0      251       88       0       0
Map 3 ..........   SUCCEEDED      2          2        0        0       0       0
Map 4 ..........   SUCCEEDED      1          1        0        0       0       0
Map 5 ..........   SUCCEEDED      1          1        0        0       0       0
Map 6 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2             INITED      1          0        0        1       0       0
[2K--------------------------------------------------------------------------------
[2K[31;1mVERTICES: 04/06  [>>--------------------------] 1%    ELAPSED TIME: 31.79 s    
[22;0m[2K--------------------------------------------------------------------------------
[12A[2K--------------------------------------------------------------------------------
[2K[36;1m        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
[22;0m[2K--------------------------------------------------------------------------------
[2KMap 1                RUNNING    339          0      251       88       0       0
Map 3 ..........   SUCCEEDED      2          2        0        0       0       0
Map 4 ..........   SUCCEEDED      1          1        0        0       0       0
Map 5 ..........   SUCCEEDED      1          1        0        0       0       0
Map 6 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2             INITED      1          0        0        1       0       0
[2K--------------------------------------------------------------------------------
[2K[31;1mVERTICES: 04/06  [>>--------------------------] 1%    ELAPSED TIME: 36.79 s    
[22;0m[2K--------------------------------------------------------------------------------
[12A[2K--------------------------------------------------------------------------------
[2K[36;1m        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
[22;0m[2K--------------------------------------------------------------------------------
[2KMap 1                RUNNING    339          0      251       88       0       0
Map 3 ..........   SUCCEEDED      2          2        0        0       0       0
Map 4 ..........   SUCCEEDED      1          1        0        0       0       0
Map 5 ..........   SUCCEEDED      1          1        0        0       0       0
Map 6 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2             INITED      1          0        0        1       0       0
[2K--------------------------------------------------------------------------------
[2K[31;1mVERTICES: 04/06  [>>--------------------------] 1%    ELAPSED TIME: 41.79 s    
[22;0m[2K--------------------------------------------------------------------------------
[12A[2K--------------------------------------------------------------------------------
[2K[36;1m        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
[22;0m[2K--------------------------------------------------------------------------------
[2KMap 1                RUNNING    339          0      251       88       0       0
Map 3 ..........   SUCCEEDED      2          2        0        0       0       0
Map 4 ..........   SUCCEEDED      1          1        0        0       0       0
Map 5 ..........   SUCCEEDED      1          1        0        0       0       0
Map 6 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2             INITED      1          0        0        1       0       0
[2K--------------------------------------------------------------------------------
[2K[31;1mVERTICES: 04/06  [>>--------------------------] 1%    ELAPSED TIME: 46.79 s    
[22;0m[2K--------------------------------------------------------------------------------
[12A[2K--------------------------------------------------------------------------------
[2K[36;1m        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
[22;0m[2K--------------------------------------------------------------------------------
[2KMap 1                RUNNING    339          0      251       88       0       0
Map 3 ..........   SUCCEEDED      2          2        0        0       0       0
Map 4 ..........   SUCCEEDED      1          1        0        0       0       0
Map 5 ..........   SUCCEEDED      1          1        0        0       0       0
Map 6 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2             INITED      1          0        0        1       0       0
[2K--------------------------------------------------------------------------------
[2K[31;1mVERTICES: 04/06  [>>--------------------------] 1%    ELAPSED TIME: 51.79 s    
[22;0m[2K--------------------------------------------------------------------------------
[12A[2K--------------------------------------------------------------------------------
[2K[36;1m        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
[22;0m[2K--------------------------------------------------------------------------------
[2KMap 1                RUNNING    339          1      251       87       0       0
Map 3 ..........   SUCCEEDED      2          2        0        0       0       0
Map 4 ..........   SUCCEEDED      1          1        0        0       0       0
Map 5 ..........   SUCCEEDED      1          1        0        0       0       0
Map 6 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2             INITED      1          0        0        1       0       0
[2K--------------------------------------------------------------------------------
[2K[31;1mVERTICES: 04/06  [>>--------------------------] 1%    ELAPSED TIME: 56.79 s    
[22;0m[2K--------------------------------------------------------------------------------
[12A[2K--------------------------------------------------------------------------------
[2K[36;1m        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
[22;0m[2K--------------------------------------------------------------------------------
[2KMap 1                RUNNING    339          1      251       87       0       0
Map 3 ..........   SUCCEEDED      2          2        0        0       0       0
Map 4 ..........   SUCCEEDED      1          1        0        0       0       0
Map 5 ..........   SUCCEEDED      1          1        0        0       0       0
Map 6 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2             INITED      1          0        0        1       0       0
[2K--------------------------------------------------------------------------------
[2K[31;1mVERTICES: 04/06  [>>--------------------------] 1%    ELAPSED TIME: 61.79 s    
[22;0m[2K--------------------------------------------------------------------------------
[12A[2K--------------------------------------------------------------------------------
[2K[36;1m        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
[22;0m[2K--------------------------------------------------------------------------------
[2KMap 1                RUNNING    339          5      251       83       3       0
Map 3 ..........   SUCCEEDED      2          2        0        0       0       0
Map 4 ..........   SUCCEEDED      1          1        0        0       0       0
Map 5 ..........   SUCCEEDED      1          1        0        0       0       0
Map 6 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2             INITED      1          0        0        1       0       0
[2K--------------------------------------------------------------------------------
[2K[31;1mVERTICES: 04/06  [>>--------------------------] 2%    ELAPSED TIME: 66.80 s    
[22;0m[2K--------------------------------------------------------------------------------
[12A[2K--------------------------------------------------------------------------------
[2K[36;1m        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
[22;0m[2K--------------------------------------------------------------------------------
[2KMap 1                RUNNING    339          7      251       81       5       0
Map 3 ..........   SUCCEEDED      2          2        0        0       0       0
Map 4 ..........   SUCCEEDED      1          1        0        0       0       0
Map 5 ..........   SUCCEEDED      1          1        0        0       0       0
Map 6 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2             INITED      1          0        0        1       0       0
[2K--------------------------------------------------------------------------------
[2K[31;1mVERTICES: 04/06  [>>--------------------------] 3%    ELAPSED TIME: 71.80 s    
[22;0m[2K--------------------------------------------------------------------------------
[12A[2K--------------------------------------------------------------------------------
[2K[36;1m        VERTICES      STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED
[22;0m[2K--------------------------------------------------------------------------------
[2KMap 1                RUNNING    339          9        0      330       7       0
Map 3 ..........   SUCCEEDED      2          2        0        0       0       0
Map 4 ..........   SUCCEEDED      1          1        0        0       0       0
Map 5 ..........   SUCCEEDED      1          1        0        0       0       0
Map 6 ..........   SUCCEEDED      1          1        0        0       0       0
Reducer 2             INITED      1          0        0        1       0       0
[2K--------------------------------------------------------------------------------
[2K[31;1mVERTICES: 04/06  [=>>-------------------------] 4%    ELAPSED TIME: 76.69 s    
[22;0m[2K--------------------------------------------------------------------------------
ERROR : Status: Failed
ERROR : Vertex failed, vertexName=Map 1, vertexId=vertex_1491866789844_0505_2_04, diagnostics=[Task failed, taskId=task_1491866789844_0505_2_04_000276, diagnostics=[TaskAttempt 0 failed, info=[Error: Failure while running task:java.lang.RuntimeException: java.lang.OutOfMemoryError: Java heap space
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:159)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:139)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:347)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:194)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:185)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1866)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:185)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:181)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.OutOfMemoryError: Java heap space
	at java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:57)
	at java.nio.ByteBuffer.allocate(ByteBuffer.java:335)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.allocateSpace(PipelinedSorter.java:234)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.<init>(PipelinedSorter.java:188)
	at org.apache.tez.runtime.library.output.OrderedPartitionedKVOutput.start(OrderedPartitionedKVOutput.java:142)
	at org.apache.hadoop.hive.ql.exec.tez.MapRecordProcessor.init(MapRecordProcessor.java:138)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:149)
	... 14 more
], TaskAttempt 1 failed, info=[Error: Failure while running task:java.lang.RuntimeException: java.lang.OutOfMemoryError: Java heap space
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:159)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:139)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:347)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:194)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:185)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1866)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:185)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:181)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.OutOfMemoryError: Java heap space
	at java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:57)
	at java.nio.ByteBuffer.allocate(ByteBuffer.java:335)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.allocateSpace(PipelinedSorter.java:234)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.<init>(PipelinedSorter.java:188)
	at org.apache.tez.runtime.library.output.OrderedPartitionedKVOutput.start(OrderedPartitionedKVOutput.java:142)
	at org.apache.hadoop.hive.ql.exec.tez.MapRecordProcessor.init(MapRecordProcessor.java:138)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:149)
	... 14 more
], TaskAttempt 2 failed, info=[Error: Failure while running task:java.lang.RuntimeException: java.lang.OutOfMemoryError: Java heap space
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:159)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:139)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:347)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:194)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:185)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1866)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:185)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:181)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.OutOfMemoryError: Java heap space
	at java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:57)
	at java.nio.ByteBuffer.allocate(ByteBuffer.java:335)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.allocateSpace(PipelinedSorter.java:234)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.<init>(PipelinedSorter.java:188)
	at org.apache.tez.runtime.library.output.OrderedPartitionedKVOutput.start(OrderedPartitionedKVOutput.java:142)
	at org.apache.hadoop.hive.ql.exec.tez.MapRecordProcessor.init(MapRecordProcessor.java:138)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:149)
	... 14 more
], TaskAttempt 3 failed, info=[Error: Failure while running task:java.lang.RuntimeException: java.lang.OutOfMemoryError: Java heap space
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:159)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:139)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:347)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:194)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:185)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1866)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:185)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:181)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.OutOfMemoryError: Java heap space
	at java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:57)
	at java.nio.ByteBuffer.allocate(ByteBuffer.java:335)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.allocateSpace(PipelinedSorter.java:234)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.<init>(PipelinedSorter.java:188)
	at org.apache.tez.runtime.library.output.OrderedPartitionedKVOutput.start(OrderedPartitionedKVOutput.java:142)
	at org.apache.hadoop.hive.ql.exec.tez.MapRecordProcessor.init(MapRecordProcessor.java:138)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:149)
	... 14 more
]], Vertex did not succeed due to OWN_TASK_FAILURE, failedTasks:1 killedTasks:329, Vertex vertex_1491866789844_0505_2_04 [Map 1] killed/failed due to:OWN_TASK_FAILURE]
ERROR : Vertex killed, vertexName=Reducer 2, vertexId=vertex_1491866789844_0505_2_05, diagnostics=[Vertex received Kill while in RUNNING state., Vertex did not succeed due to OTHER_VERTEX_FAILURE, failedTasks:0 killedTasks:1, Vertex vertex_1491866789844_0505_2_05 [Reducer 2] killed/failed due to:OTHER_VERTEX_FAILURE]
ERROR : DAG did not succeed due to VERTEX_FAILURE. failedVertices:1 killedVertices:1
INFO  : org.apache.tez.common.counters.DAGCounter:
INFO  :    NUM_FAILED_TASKS: 7
INFO  :    NUM_KILLED_TASKS: 329
INFO  :    NUM_SUCCEEDED_TASKS: 14
INFO  :    TOTAL_LAUNCHED_TASKS: 271
INFO  :    DATA_LOCAL_TASKS: 10
INFO  :    RACK_LOCAL_TASKS: 4
INFO  :    AM_CPU_MILLISECONDS: 60080
INFO  :    AM_GC_TIME_MILLIS: 474
INFO  : File System Counters:
INFO  :    FILE_BYTES_READ: 2369264823
INFO  :    FILE_BYTES_WRITTEN: 2630770855
INFO  :    HDFS_BYTES_READ: 1092672478
INFO  :    HDFS_READ_OPS: 156
INFO  :    HDFS_OP_OPEN: 156
INFO  : org.apache.tez.common.counters.TaskCounter:
INFO  :    SPILLED_RECORDS: 27
INFO  :    NUM_SHUFFLED_INPUTS: 45
INFO  :    NUM_FAILED_SHUFFLE_INPUTS: 0
INFO  :    GC_TIME_MILLIS: 70892
INFO  :    CPU_MILLISECONDS: 751740
INFO  :    PHYSICAL_MEMORY_BYTES: 71095549952
INFO  :    VIRTUAL_MEMORY_BYTES: 129091936256
INFO  :    COMMITTED_HEAP_BYTES: 71095549952
INFO  :    INPUT_RECORDS_PROCESSED: 152128621
INFO  :    INPUT_SPLIT_LENGTH_BYTES: 9289188248
INFO  :    OUTPUT_RECORDS: 16880071
INFO  :    OUTPUT_LARGE_RECORDS: 0
INFO  :    OUTPUT_BYTES: 336510209
INFO  :    OUTPUT_BYTES_WITH_OVERHEAD: 370270435
INFO  :    OUTPUT_BYTES_PHYSICAL: 261505992
INFO  :    ADDITIONAL_SPILLS_BYTES_WRITTEN: 0
INFO  :    ADDITIONAL_SPILLS_BYTES_READ: 0
INFO  :    ADDITIONAL_SPILL_COUNT: 0
INFO  :    SHUFFLE_CHUNK_COUNT: 9
INFO  :    SHUFFLE_BYTES: 2353538259
INFO  :    SHUFFLE_BYTES_DECOMPRESSED: 3332410317
INFO  :    SHUFFLE_BYTES_TO_MEM: 2640276
INFO  :    SHUFFLE_BYTES_TO_DISK: 2350897983
INFO  :    SHUFFLE_BYTES_DISK_DIRECT: 0
INFO  :    SHUFFLE_PHASE_TIME: 248006
INFO  :    FIRST_EVENT_RECEIVED: 98389
INFO  :    LAST_EVENT_RECEIVED: 129474
INFO  : HIVE:
INFO  :    DESERIALIZE_ERRORS: 0
INFO  :    RECORDS_IN_Map_1: 195928980
INFO  :    RECORDS_IN_Map_3: 17117525
INFO  :    RECORDS_IN_Map_4: 54
INFO  :    RECORDS_IN_Map_5: 73049
INFO  :    RECORDS_IN_Map_6: 10000
INFO  :    RECORDS_OUT_INTERMEDIATE_Map_1: 27
INFO  :    RECORDS_OUT_INTERMEDIATE_Map_3: 16806911
INFO  :    RECORDS_OUT_INTERMEDIATE_Map_4: 54
INFO  :    RECORDS_OUT_INTERMEDIATE_Map_5: 73049
INFO  :    RECORDS_OUT_INTERMEDIATE_Map_6: 30
INFO  : TaskCounter_Map_1_INPUT_Map_3:
INFO  :    FIRST_EVENT_RECEIVED: 78616
INFO  :    INPUT_RECORDS_PROCESSED: 151262199
INFO  :    LAST_EVENT_RECEIVED: 109701
INFO  :    NUM_FAILED_SHUFFLE_INPUTS: 0
INFO  :    NUM_SHUFFLED_INPUTS: 18
INFO  :    SHUFFLE_BYTES: 2350897983
INFO  :    SHUFFLE_BYTES_DECOMPRESSED: 3327768486
INFO  :    SHUFFLE_BYTES_DISK_DIRECT: 0
INFO  :    SHUFFLE_BYTES_TO_DISK: 2350897983
INFO  :    SHUFFLE_BYTES_TO_MEM: 0
INFO  :    SHUFFLE_PHASE_TIME: 226013
INFO  : TaskCounter_Map_1_INPUT_Map_4:
INFO  :    FIRST_EVENT_RECEIVED: 6603
INFO  :    INPUT_RECORDS_PROCESSED: 486
INFO  :    LAST_EVENT_RECEIVED: 6603
INFO  :    NUM_FAILED_SHUFFLE_INPUTS: 0
INFO  :    NUM_SHUFFLED_INPUTS: 9
INFO  :    SHUFFLE_BYTES: 19323
INFO  :    SHUFFLE_BYTES_DECOMPRESSED: 37746
INFO  :    SHUFFLE_BYTES_DISK_DIRECT: 0
INFO  :    SHUFFLE_BYTES_TO_DISK: 0
INFO  :    SHUFFLE_BYTES_TO_MEM: 19323
INFO  :    SHUFFLE_PHASE_TIME: 7316
INFO  : TaskCounter_Map_1_INPUT_Map_5:
INFO  :    FIRST_EVENT_RECEIVED: 6607
INFO  :    INPUT_RECORDS_PROCESSED: 657441
INFO  :    LAST_EVENT_RECEIVED: 6607
INFO  :    NUM_FAILED_SHUFFLE_INPUTS: 0
INFO  :    NUM_SHUFFLED_INPUTS: 9
INFO  :    SHUFFLE_BYTES: 2619630
INFO  :    SHUFFLE_BYTES_DECOMPRESSED: 4602141
INFO  :    SHUFFLE_BYTES_DISK_DIRECT: 0
INFO  :    SHUFFLE_BYTES_TO_DISK: 0
INFO  :    SHUFFLE_BYTES_TO_MEM: 2619630
INFO  :    SHUFFLE_PHASE_TIME: 7388
INFO  : TaskCounter_Map_1_INPUT_Map_6:
INFO  :    FIRST_EVENT_RECEIVED: 6563
INFO  :    INPUT_RECORDS_PROCESSED: 270
INFO  :    LAST_EVENT_RECEIVED: 6563
INFO  :    NUM_FAILED_SHUFFLE_INPUTS: 0
INFO  :    NUM_SHUFFLED_INPUTS: 9
INFO  :    SHUFFLE_BYTES: 1323
INFO  :    SHUFFLE_BYTES_DECOMPRESSED: 1944
INFO  :    SHUFFLE_BYTES_DISK_DIRECT: 0
INFO  :    SHUFFLE_BYTES_TO_DISK: 0
INFO  :    SHUFFLE_BYTES_TO_MEM: 1323
INFO  :    SHUFFLE_PHASE_TIME: 7289
INFO  : TaskCounter_Map_1_INPUT_store_sales:
INFO  :    INPUT_RECORDS_PROCESSED: 191408
INFO  :    INPUT_SPLIT_LENGTH_BYTES: 8467621995
INFO  : TaskCounter_Map_1_OUTPUT_Reducer_2:
INFO  :    ADDITIONAL_SPILLS_BYTES_READ: 0
INFO  :    ADDITIONAL_SPILLS_BYTES_WRITTEN: 0
INFO  :    ADDITIONAL_SPILL_COUNT: 0
INFO  :    OUTPUT_BYTES: 2514
INFO  :    OUTPUT_BYTES_PHYSICAL: 1621
INFO  :    OUTPUT_BYTES_WITH_OVERHEAD: 2622
INFO  :    OUTPUT_RECORDS: 27
INFO  :    SHUFFLE_CHUNK_COUNT: 9
INFO  :    SPILLED_RECORDS: 27
INFO  : TaskCounter_Map_3_INPUT_store_returns:
INFO  :    INPUT_RECORDS_PROCESSED: 16734
INFO  :    INPUT_SPLIT_LENGTH_BYTES: 820837131
INFO  : TaskCounter_Map_3_OUTPUT_Map_1:
INFO  :    ADDITIONAL_SPILLS_BYTES_READ: 0
INFO  :    ADDITIONAL_SPILLS_BYTES_WRITTEN: 0
INFO  :    ADDITIONAL_SPILL_COUNT: 0
INFO  :    OUTPUT_BYTES: 336138220
INFO  :    OUTPUT_BYTES_PHYSICAL: 261210935
INFO  :    OUTPUT_BYTES_WITH_OVERHEAD: 369752054
INFO  :    OUTPUT_LARGE_RECORDS: 0
INFO  :    OUTPUT_RECORDS: 16806911
INFO  :    SPILLED_RECORDS: 0
INFO  : TaskCounter_Map_4_INPUT_store:
INFO  :    INPUT_RECORDS_PROCESSED: 1
INFO  :    INPUT_SPLIT_LENGTH_BYTES: 6282
INFO  : TaskCounter_Map_4_OUTPUT_Map_1:
INFO  :    ADDITIONAL_SPILLS_BYTES_READ: 0
INFO  :    ADDITIONAL_SPILLS_BYTES_WRITTEN: 0
INFO  :    ADDITIONAL_SPILL_COUNT: 0
INFO  :    OUTPUT_BYTES: 4080
INFO  :    OUTPUT_BYTES_PHYSICAL: 2171
INFO  :    OUTPUT_BYTES_WITH_OVERHEAD: 4194
INFO  :    OUTPUT_LARGE_RECORDS: 0
INFO  :    OUTPUT_RECORDS: 54
INFO  :    SPILLED_RECORDS: 0
INFO  : TaskCounter_Map_5_INPUT_d1:
INFO  :    INPUT_RECORDS_PROCESSED: 72
INFO  :    INPUT_SPLIT_LENGTH_BYTES: 361420
INFO  : TaskCounter_Map_5_OUTPUT_Map_1:
INFO  :    ADDITIONAL_SPILLS_BYTES_READ: 0
INFO  :    ADDITIONAL_SPILLS_BYTES_WRITTEN: 0
INFO  :    ADDITIONAL_SPILL_COUNT: 0
INFO  :    OUTPUT_BYTES: 365245
INFO  :    OUTPUT_BYTES_PHYSICAL: 291094
INFO  :    OUTPUT_BYTES_WITH_OVERHEAD: 511349
INFO  :    OUTPUT_LARGE_RECORDS: 0
INFO  :    OUTPUT_RECORDS: 73049
INFO  :    SPILLED_RECORDS: 0
INFO  : TaskCounter_Map_6_INPUT_d2:
INFO  :    INPUT_RECORDS_PROCESSED: 10
INFO  :    INPUT_SPLIT_LENGTH_BYTES: 361420
INFO  : TaskCounter_Map_6_OUTPUT_Map_1:
INFO  :    ADDITIONAL_SPILLS_BYTES_READ: 0
INFO  :    ADDITIONAL_SPILLS_BYTES_WRITTEN: 0
INFO  :    ADDITIONAL_SPILL_COUNT: 0
INFO  :    OUTPUT_BYTES: 150
INFO  :    OUTPUT_BYTES_PHYSICAL: 171
INFO  :    OUTPUT_BYTES_WITH_OVERHEAD: 216
INFO  :    OUTPUT_LARGE_RECORDS: 0
INFO  :    OUTPUT_RECORDS: 30
INFO  :    SPILLED_RECORDS: 0
Error: Error while processing statement: FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.tez.TezTask. Vertex failed, vertexName=Map 1, vertexId=vertex_1491866789844_0505_2_04, diagnostics=[Task failed, taskId=task_1491866789844_0505_2_04_000276, diagnostics=[TaskAttempt 0 failed, info=[Error: Failure while running task:java.lang.RuntimeException: java.lang.OutOfMemoryError: Java heap space
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:159)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:139)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:347)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:194)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:185)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1866)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:185)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:181)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.OutOfMemoryError: Java heap space
	at java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:57)
	at java.nio.ByteBuffer.allocate(ByteBuffer.java:335)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.allocateSpace(PipelinedSorter.java:234)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.<init>(PipelinedSorter.java:188)
	at org.apache.tez.runtime.library.output.OrderedPartitionedKVOutput.start(OrderedPartitionedKVOutput.java:142)
	at org.apache.hadoop.hive.ql.exec.tez.MapRecordProcessor.init(MapRecordProcessor.java:138)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:149)
	... 14 more
], TaskAttempt 1 failed, info=[Error: Failure while running task:java.lang.RuntimeException: java.lang.OutOfMemoryError: Java heap space
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:159)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:139)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:347)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:194)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:185)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1866)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:185)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:181)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.OutOfMemoryError: Java heap space
	at java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:57)
	at java.nio.ByteBuffer.allocate(ByteBuffer.java:335)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.allocateSpace(PipelinedSorter.java:234)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.<init>(PipelinedSorter.java:188)
	at org.apache.tez.runtime.library.output.OrderedPartitionedKVOutput.start(OrderedPartitionedKVOutput.java:142)
	at org.apache.hadoop.hive.ql.exec.tez.MapRecordProcessor.init(MapRecordProcessor.java:138)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:149)
	... 14 more
], TaskAttempt 2 failed, info=[Error: Failure while running task:java.lang.RuntimeException: java.lang.OutOfMemoryError: Java heap space
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:159)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:139)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:347)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:194)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:185)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1866)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:185)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:181)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.OutOfMemoryError: Java heap space
	at java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:57)
	at java.nio.ByteBuffer.allocate(ByteBuffer.java:335)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.allocateSpace(PipelinedSorter.java:234)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.<init>(PipelinedSorter.java:188)
	at org.apache.tez.runtime.library.output.OrderedPartitionedKVOutput.start(OrderedPartitionedKVOutput.java:142)
	at org.apache.hadoop.hive.ql.exec.tez.MapRecordProcessor.init(MapRecordProcessor.java:138)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:149)
	... 14 more
], TaskAttempt 3 failed, info=[Error: Failure while running task:java.lang.RuntimeException: java.lang.OutOfMemoryError: Java heap space
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:159)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.run(TezProcessor.java:139)
	at org.apache.tez.runtime.LogicalIOProcessorRuntimeTask.run(LogicalIOProcessorRuntimeTask.java:347)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:194)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable$1.run(TezTaskRunner.java:185)
	at java.security.AccessController.doPrivileged(Native Method)
	at javax.security.auth.Subject.doAs(Subject.java:422)
	at org.apache.hadoop.security.UserGroupInformation.doAs(UserGroupInformation.java:1866)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:185)
	at org.apache.tez.runtime.task.TezTaskRunner$TaskRunnerCallable.callInternal(TezTaskRunner.java:181)
	at org.apache.tez.common.CallableWithNdc.call(CallableWithNdc.java:36)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.OutOfMemoryError: Java heap space
	at java.nio.HeapByteBuffer.<init>(HeapByteBuffer.java:57)
	at java.nio.ByteBuffer.allocate(ByteBuffer.java:335)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.allocateSpace(PipelinedSorter.java:234)
	at org.apache.tez.runtime.library.common.sort.impl.PipelinedSorter.<init>(PipelinedSorter.java:188)
	at org.apache.tez.runtime.library.output.OrderedPartitionedKVOutput.start(OrderedPartitionedKVOutput.java:142)
	at org.apache.hadoop.hive.ql.exec.tez.MapRecordProcessor.init(MapRecordProcessor.java:138)
	at org.apache.hadoop.hive.ql.exec.tez.TezProcessor.initializeAndRunProcessor(TezProcessor.java:149)
	... 14 more
]], Vertex did not succeed due to OWN_TASK_FAILURE, failedTasks:1 killedTasks:329, Vertex vertex_1491866789844_0505_2_04 [Map 1] killed/failed due to:OWN_TASK_FAILURE]Vertex killed, vertexName=Reducer 2, vertexId=vertex_1491866789844_0505_2_05, diagnostics=[Vertex received Kill while in RUNNING state., Vertex did not succeed due to OTHER_VERTEX_FAILURE, failedTasks:0 killedTasks:1, Vertex vertex_1491866789844_0505_2_05 [Reducer 2] killed/failed due to:OTHER_VERTEX_FAILURE]DAG did not succeed due to VERTEX_FAILURE. failedVertices:1 killedVertices:1 (state=08S01,code=2)

Closing: 0: jdbc:hive2://h01mgt.hadoop:2181,h01hn01.hadoop:2181,h01hn02.hadoop:2181/tpcds_bin_partitioned_orc_5000;serviceDiscoveryMode=zooKeeper;zooKeeperNamespace=hiveserver2
STOP hdp2.6_hivetez_run_orc_5000_2_query50_sql_2017-04-19-01-35:  Wed Apr 19 01:36:52 CDT 2017
